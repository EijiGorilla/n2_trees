"use strict";(self.webpackChunkn2_trees=self.webpackChunkn2_trees||[]).push([[2354,4397,2463,2170,5140],{84397:(t,e,n)=>{n.d(e,{c:()=>i,g:()=>o});var i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function o(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}},82218:(t,e,n)=>{n.d(e,{a:()=>m,b:()=>Y,c:()=>b,f:()=>x,u:()=>w});n(93169);var i=n(32718),o=n(16889),r=n(21530),s=n(29134),a=n(7025),l=n(32035),c=n(12400),u=n(65156),h=n(14320),d=n(85981),p=n(55652),v=n(40885),f=n(40927),g=n(11185);const _=()=>i.Z.getLogger("esri.views.3d.support.geometryUtils.boundedPlane");const y=class{constructor(){this.plane=(0,p.Ue)(),this.origin=(0,c.Ue)(),this.basis1=(0,c.Ue)(),this.basis2=(0,c.Ue)()}};function m(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Z;return{plane:(0,p.Ue)(t.plane),origin:(0,c.d9)(t.origin),basis1:(0,c.d9)(t.basis1),basis2:(0,c.d9)(t.basis2)}}function b(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:m();return x(t.origin,t.basis1,t.basis2,e)}function x(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:m();return(0,l.c)(i.origin,t),(0,l.c)(i.basis1,e),(0,l.c)(i.basis2,n),w(i),function(t,e){Math.abs((0,l.f)(t.basis1,t.basis2)/((0,l.l)(t.basis1)*(0,l.l)(t.basis2)))>1e-6&&_().warn(e,"Provided basis vectors are not perpendicular"),Math.abs((0,l.f)(t.basis1,V(t)))>1e-6&&_().warn(e,"Basis vectors and plane normal are not perpendicular"),Math.abs(-(0,l.f)(V(t),t.origin)-t.plane[3])>1e-6&&_().warn(e,"Plane offset is not consistent with plane origin")}(i,"fromValues()"),i}function w(t){(0,p.my)(t.basis2,t.basis1,t.origin,t.plane)}function C(t,e,n){t!==n&&b(t,n);const i=(0,l.h)(g.WM.get(),V(t),e);return(0,l.g)(n.origin,n.origin,i),n.plane[3]-=e,n}function M(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:m();const n=(t[2]-t[0])/2,i=(t[3]-t[1])/2;return(0,l.i)(e.origin,t[0]+n,t[1]+i,0),(0,l.i)(e.basis1,n,0,0),(0,l.i)(e.basis2,0,i,0),(0,p.al)(0,0,1,0,e.plane),e}function S(t,e,n){return!!(0,p.BR)(t.plane,e,n)&&U(t,n)}function E(t,e,n){const i=L.get();G(t,e,i,L.get());let r=Number.POSITIVE_INFINITY;for(const s of N){const a=O(t,s,D.get()),c=g.WM.get();if((0,p.rx)(i,a,c)){const t=(0,l.o)(g.WM.get(),e.origin,c),i=Math.abs((0,o.ZF)((0,l.f)(e.direction,t)));i<r&&(r=i,(0,l.c)(n,c))}}return r===Number.POSITIVE_INFINITY?T(t,e,n):n}function T(t,e,n){if(S(t,e,n))return n;const i=L.get(),o=L.get();G(t,e,i,o);let r=Number.POSITIVE_INFINITY;for(const s of N){const a=O(t,s,D.get()),c=g.WM.get();if((0,p.dZ)(i,a,c)){const t=(0,v.Jk)(e,c);if(!(0,p.Ac)(o,c))continue;t<r&&(r=t,(0,l.c)(n,c))}}return R(t,e.origin)<r&&P(t,e.origin,n),n}function P(t,e,n){const i=(0,p.nF)(t.plane,e,g.WM.get()),o=(0,d.ct)(I(t,t.basis1),i,-1,1,g.WM.get()),r=(0,d.ct)(I(t,t.basis2),i,-1,1,g.WM.get());return(0,l.d)(n,(0,l.g)(g.WM.get(),o,r),t.origin),n}function k(t,e,n){const{origin:i,basis1:o,basis2:r}=t,s=(0,l.d)(g.WM.get(),e,i),a=(0,f.SR)(o,s),c=(0,f.SR)(r,s),u=(0,f.SR)(V(t),s);return(0,l.i)(n,a,c,u)}function R(t,e){const n=k(t,e,g.WM.get()),{basis1:i,basis2:o}=t,r=(0,l.l)(i),s=(0,l.l)(o),a=Math.max(Math.abs(n[0])-r,0),c=Math.max(Math.abs(n[1])-s,0),u=n[2];return a*a+c*c+u*u}function A(t,e){const n=-t.plane[3];return(0,f.SR)(V(t),e)-n}function V(t){return(0,p.st)(t.plane)}function U(t,e){const n=(0,l.d)(g.WM.get(),e,t.origin),i=(0,l.k)(t.basis1),o=(0,l.k)(t.basis2),r=(0,l.f)(t.basis1,n),s=(0,l.f)(t.basis2,n);return-r-i<0&&r-i<0&&-s-o<0&&s-o<0}function I(t,e){const n=D.get();return(0,l.c)(n.origin,t.origin),(0,l.c)(n.vector,e),n}function O(t,e,n){const{basis1:i,basis2:o,origin:r}=t,s=(0,l.h)(g.WM.get(),i,e.origin[0]),a=(0,l.h)(g.WM.get(),o,e.origin[1]);(0,l.g)(n.origin,s,a),(0,l.g)(n.origin,n.origin,r);const c=(0,l.h)(g.WM.get(),i,e.direction[0]),u=(0,l.h)(g.WM.get(),o,e.direction[1]);return(0,l.h)(n.vector,(0,l.g)(c,c,u),2),n}function G(t,e,n,i){const o=V(t);(0,p.my)(o,e.direction,e.origin,n),(0,p.my)((0,p.st)(n),o,e.origin,i)}const Z={plane:(0,p.Ue)(),origin:(0,c.al)(0,0,0),basis1:(0,c.al)(1,0,0),basis2:(0,c.al)(0,1,0)},L=new r.x(p.Ue),D=new r.x(d.Ue),z=(0,c.Ue)(),H=new r.x((()=>m())),N=[{origin:[-1,-1],direction:[1,0]},{origin:[1,-1],direction:[0,1]},{origin:[1,1],direction:[-1,0]},{origin:[-1,1],direction:[0,-1]}],F=(0,a.Ue)(),j=(0,a.Ue)(),Y=Object.freeze(Object.defineProperty({__proto__:null,BoundedPlaneClass:y,altitudeAt:A,axisAt:function(t,e,n,i){return function(t,e,n){switch(e){case h.R.X:(0,l.c)(n,t.basis1),(0,l.n)(n,n);break;case h.R.Y:(0,l.c)(n,t.basis2),(0,l.n)(n,n);break;case h.R.Z:(0,l.c)(n,V(t))}return n}(t,n,i)},cameraFrustumCoverage:function(t,e){return(e-t)/e},closestPoint:T,closestPointOnSilhouette:E,copy:b,copyWithoutVerify:function(t,e){(0,l.c)(e.origin,t.origin),(0,l.c)(e.basis1,t.basis1),(0,l.c)(e.basis2,t.basis2),(0,p.JG)(e.plane,t.plane)},create:m,distance:function(t,e){return Math.sqrt(R(t,e))},distance2:R,distanceToSilhouette:function(t,e){let n=Number.NEGATIVE_INFINITY;for(const i of N){const o=O(t,i,D.get()),r=(0,d.Jk)(o,e);r>n&&(n=r)}return Math.sqrt(n)},elevate:C,equals:function(t,e){return(0,l.p)(t.basis1,e.basis1)&&(0,l.p)(t.basis2,e.basis2)&&(0,l.p)(t.origin,e.origin)},extrusionContainsPoint:function(t,e){return(0,p.Ac)(t.plane,e)&&U(t,e)},fromAABoundingRect:M,fromValues:x,getExtent:function(t,e){const n=t.basis1[0],i=t.basis2[1],[o,r]=t.origin;return(0,u.al)(o-n,r-i,o+n,r+i,e)},intersectRay:S,intersectRayClosestSilhouette:function(t,e,n){if(S(t,e,n))return n;const i=E(t,e,g.WM.get());return(0,l.g)(n,e.origin,(0,l.h)(g.WM.get(),e.direction,(0,l.j)(e.origin,i)/(0,l.l)(e.direction))),n},normal:V,projectPoint:P,projectPointLocal:k,rotate:function(t,e,n,i){return t!==i&&b(t,i),(0,s.Us)(j,e,n),(0,l.t)(i.basis1,t.basis1,j),(0,l.t)(i.basis2,t.basis2,j),w(i),i},setAltitudeAt:function(t,e,n,i){const o=A(t,e),r=(0,l.h)(z,V(t),n-o);return(0,l.g)(i,e,r),i},setExtent:function(t,e,n){return M(e,n),C(n,A(t,t.origin),n),n},transform:function(t,e,n){return t!==n&&b(t,n),(0,s.U_)(F,e),(0,s.p4)(F,F),(0,l.t)(n.basis1,t.basis1,F),(0,l.t)(n.basis2,t.basis2,F),(0,l.t)((0,p.st)(n.plane),(0,p.st)(t.plane),F),(0,l.t)(n.origin,t.origin,e),(0,p.T5)(n.plane,n.plane,n.origin),n},up:Z,updateUnboundedPlane:w,wrap:function(t,e,n){const i=H.get();return i.origin=t,i.basis1=e,i.basis2=n,i.plane=(0,p.re)(0,0,0,0),w(i),i}},Symbol.toStringTag,{value:"Module"}))},70116:(t,e,n)=>{var i;n.d(e,{Y:()=>i}),function(t){t[t.KILOBYTES=1024]="KILOBYTES",t[t.MEGABYTES=1048576]="MEGABYTES",t[t.GIGABYTES=1073741824]="GIGABYTES"}(i||(i={}))},2622:(t,e,n)=>{n.d(e,{Z:()=>r});var i=n(39052),o=n(56885);class r{constructor(t){this._observable=new o.s,this._set=new Set(t)}get size(){return(0,i.it)(this._observable),this._set.size}add(t){const e=this._set.size;return this._set.add(t),this._set.size!==e&&this._observable.notify(),this}clear(){this._set.size>0&&(this._set.clear(),this._observable.notify())}delete(t){const e=this._set.delete(t);return e&&this._observable.notify(),e}entries(){return(0,i.it)(this._observable),this._set.entries()}forEach(t,e){(0,i.it)(this._observable),this._set.forEach(((n,i)=>t.call(e,n,i,this)),e)}has(t){return(0,i.it)(this._observable),this._set.has(t)}keys(){return(0,i.it)(this._observable),this._set.keys()}values(){return(0,i.it)(this._observable),this._set.values()}[Symbol.iterator](){return(0,i.it)(this._observable),this._set[Symbol.iterator]()}get[Symbol.toStringTag](){return this._set[Symbol.toStringTag]}}},68700:(t,e,n)=>{n.d(e,{Bh:()=>u,I6:()=>k,Jp:()=>h,Kx:()=>v,Su:()=>g,U_:()=>p,b0:()=>A,t8:()=>y,yY:()=>c});var i=n(21389),o=n(50894),r=n(12400),s=n(24204),a=n(32035),l=n(19093);function c(t,e,n){n*=.5;const i=Math.sin(n);return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=Math.cos(n),t}function u(t,e){const n=2*Math.acos(e[3]),i=Math.sin(n/2);return i>(0,s.bn)()?(t[0]=e[0]/i,t[1]=e[1]/i,t[2]=e[2]/i):(t[0]=1,t[1]=0,t[2]=0),n}function h(t,e,n){const i=e[0],o=e[1],r=e[2],s=e[3],a=n[0],l=n[1],c=n[2],u=n[3];return t[0]=i*u+s*a+o*c-r*l,t[1]=o*u+s*l+r*a-i*c,t[2]=r*u+s*c+i*l-o*a,t[3]=s*u-i*a-o*l-r*c,t}function d(t,e,n,i){const o=e[0],r=e[1],a=e[2],l=e[3];let c,u,h,d,p,v=n[0],f=n[1],g=n[2],_=n[3];return u=o*v+r*f+a*g+l*_,u<0&&(u=-u,v=-v,f=-f,g=-g,_=-_),1-u>(0,s.bn)()?(c=Math.acos(u),h=Math.sin(c),d=Math.sin((1-i)*c)/h,p=Math.sin(i*c)/h):(d=1-i,p=i),t[0]=d*o+p*v,t[1]=d*r+p*f,t[2]=d*a+p*g,t[3]=d*l+p*_,t}function p(t,e){const n=e[0],i=e[1],o=e[2],r=e[3],s=n*n+i*i+o*o+r*r,a=s?1/s:0;return t[0]=-n*a,t[1]=-i*a,t[2]=-o*a,t[3]=r*a,t}function v(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function f(t,e){const n=e[0]+e[4]+e[8];let i;if(n>0)i=Math.sqrt(n+1),t[3]=.5*i,i=.5/i,t[0]=(e[5]-e[7])*i,t[1]=(e[6]-e[2])*i,t[2]=(e[1]-e[3])*i;else{let n=0;e[4]>e[0]&&(n=1),e[8]>e[3*n+n]&&(n=2);const o=(n+1)%3,r=(n+2)%3;i=Math.sqrt(e[3*n+n]-e[3*o+o]-e[3*r+r]+1),t[n]=.5*i,i=.5/i,t[3]=(e[3*o+r]-e[3*r+o])*i,t[o]=(e[3*o+n]+e[3*n+o])*i,t[r]=(e[3*r+n]+e[3*n+r])*i}return t}function g(t,e,n,i){const o=.5*Math.PI/180;e*=o,n*=o,i*=o;const r=Math.sin(e),s=Math.cos(e),a=Math.sin(n),l=Math.cos(n),c=Math.sin(i),u=Math.cos(i);return t[0]=r*l*u-s*a*c,t[1]=s*a*u+r*l*c,t[2]=s*l*c-r*a*u,t[3]=s*l*u+r*a*c,t}const _=l.c,y=l.s,m=l.g,b=h,x=l.d,w=l.h,C=l.l,M=l.j,S=M,E=l.b,T=E,P=l.n,k=l.a,R=l.e;function A(t,e,n){const i=(0,a.f)(e,n);return i<-.999999?((0,a.e)(V,U,e),(0,a.G)(V)<1e-6&&(0,a.e)(V,I,e),(0,a.n)(V,V),c(t,V,Math.PI),t):i>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):((0,a.e)(V,e,n),t[0]=V[0],t[1]=V[1],t[2]=V[2],t[3]=1+i,P(t,t))}const V=(0,r.Ue)(),U=(0,r.al)(1,0,0),I=(0,r.al)(0,1,0);const O=(0,o.Ue)(),G=(0,o.Ue)();const Z=(0,i.Ue)();Object.freeze(Object.defineProperty({__proto__:null,add:m,calculateW:function(t,e){const n=e[0],i=e[1],o=e[2];return t[0]=n,t[1]=i,t[2]=o,t[3]=Math.sqrt(Math.abs(1-n*n-i*i-o*o)),t},conjugate:v,copy:_,dot:w,equals:R,exactEquals:k,fromEuler:g,fromMat3:f,getAxisAngle:u,identity:function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},invert:p,len:S,length:M,lerp:C,mul:b,multiply:h,normalize:P,random:function(t){const e=s.FD,n=e(),i=e(),o=e(),r=Math.sqrt(1-n),a=Math.sqrt(n);return t[0]=r*Math.sin(2*Math.PI*i),t[1]=r*Math.cos(2*Math.PI*i),t[2]=a*Math.sin(2*Math.PI*o),t[3]=a*Math.cos(2*Math.PI*o),t},rotateX:function(t,e,n){n*=.5;const i=e[0],o=e[1],r=e[2],s=e[3],a=Math.sin(n),l=Math.cos(n);return t[0]=i*l+s*a,t[1]=o*l+r*a,t[2]=r*l-o*a,t[3]=s*l-i*a,t},rotateY:function(t,e,n){n*=.5;const i=e[0],o=e[1],r=e[2],s=e[3],a=Math.sin(n),l=Math.cos(n);return t[0]=i*l-r*a,t[1]=o*l+s*a,t[2]=r*l+i*a,t[3]=s*l-o*a,t},rotateZ:function(t,e,n){n*=.5;const i=e[0],o=e[1],r=e[2],s=e[3],a=Math.sin(n),l=Math.cos(n);return t[0]=i*l+o*a,t[1]=o*l-i*a,t[2]=r*l+s*a,t[3]=s*l-r*a,t},rotationTo:A,scale:x,set:y,setAxes:function(t,e,n,i){const o=Z;return o[0]=n[0],o[3]=n[1],o[6]=n[2],o[1]=i[0],o[4]=i[1],o[7]=i[2],o[2]=-e[0],o[5]=-e[1],o[8]=-e[2],P(t,f(t,o))},setAxisAngle:c,slerp:d,sqlerp:function(t,e,n,i,o,r){return d(O,e,o,r),d(G,n,i,r),d(t,O,G,2*r*(1-r)),t},sqrLen:T,squaredLength:E,str:function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}},Symbol.toStringTag,{value:"Module"}))},47898:(t,e,n)=>{n.d(e,{GJ:()=>a,M1:()=>o,MQ:()=>d,Ww:()=>p,hw:()=>u,mE:()=>c,ne:()=>s,nn:()=>l,qF:()=>v,yG:()=>r,yP:()=>h});var i=n(68860);function o(t){return{value:t}}function r(t,e){return{type:(0,i.UF)(e),value:t,unit:e}}function s(t,e){return{type:(0,i.UF)(e),value:t,unit:e}}function a(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"arithmetic";return{type:(0,i.UF)(e),value:t,unit:e,rotationType:n}}function l(t,e){const n=c(t,e);return"angle"===t.type?a(n,e,t.rotationType):function(t,e){return{type:(0,i.UF)(e),value:t,unit:e}}(n,e)}function c(t,e){return(0,i.En)(t.value,t.unit,e)}function u(t,e,n){if(e===n)return t;switch(n){case"arithmetic":case"geographic":return 90-t}}const h=r(0,"meters"),d=s(0,"square-meters"),p=(a(0,"radians"),a(0,"degrees")),v=a(0,"degrees","geographic")},5163:(t,e,n)=>{n.d(e,{L4:()=>M,LO:()=>d,Qv:()=>u,Rd:()=>p,Ud:()=>_,VG:()=>h,Wv:()=>f,Zv:()=>m,aC:()=>b,h9:()=>g,ld:()=>x,mg:()=>v,q6:()=>y,sS:()=>P,yc:()=>w});var i=n(70116),o=n(17768),r=n(16889),s=n(47898),a=n(643),l=n(68860),c=n(6291);function u(t,e,n){return t.units[e][n]}function h(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";return"".concat((0,c.uf)(e,{minimumFractionDigits:i,maximumFractionDigits:i,signDisplay:e>0?"never":"exceptZero"})," ").concat(u(t,n,o))}function d(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";return"".concat((0,c.uf)(e,{minimumFractionDigits:i,maximumFractionDigits:i,signDisplay:"exceptZero"})," ").concat(u(t,n,o))}function p(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";const r=(0,l.Y8)(e,n);return h(t,(0,l.En)(e,n,r),r,i,o)}function v(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";const r=(0,l.Y8)(e,n);return d(t,(0,l.En)(e,n,r),r,i,o)}function f(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";const r=(0,l.Dw)(e,n);return h(t,(0,l.En)(e,n,r),r,i,o)}function g(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";const r=(0,l.Dw)(e,n);return d(t,(0,l.En)(e,n,r),r,i,o)}function _(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";const r=(0,l.Q7)(e,n);return h(t,(0,l.En)(e,n,r),r,i,o)}function y(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";const r=(0,l.Q7)(e,n);return d(t,(0,l.En)(e,n,r),r,i,o)}function m(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";const r=(0,l.jl)(e,n);return h(t,(0,l.En)(e,n,r),r,i,o)}function b(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";const r=(0,l.jl)(e,n);return d(t,(0,l.En)(e,n,r),r,i,o)}function x(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";const r=(0,l.ZI)(e,n);return h(t,(0,l.En)(e,n,r),r,i,o)}function w(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";const r=(0,l.LV)(e,n);return h(t,(0,l.En)(e,n,r),r,i,o)}const C=(t,e)=>({style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:e,minimumFractionDigits:e,signDisplay:t>0?"never":"exceptZero"});function M(t,e,n,i,r){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:o.BV,u=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],h=a.normalize((0,s.hw)((0,l.En)(t,e,"degrees"),n,i),0,u);const d=C(h,null!==r&&void 0!==r?r:2);return h=E(h,d),(0,c.uf)(h,d)}const S=new Map;function E(t,e){const n=JSON.stringify(e);let i=S.get(n);return i||(i=new Intl.NumberFormat("en-US",e),S.set(n,i)),/^[-+]?360\.?0*\xb0?$/.test(i.format(t))?0:t}const T=["B","kB","MB","GB","TB"];function P(t,e){let n=0===(e=Math.round(e))?0:Math.floor(Math.log(e)/Math.log(i.Y.KILOBYTES));n=(0,r.uZ)(n,0,T.length-1);const o=(0,c.uf)(e/i.Y.KILOBYTES**n,{maximumFractionDigits:2});return(0,a.gx)(t.units.bytes[T[n]],{fileSize:o})}},92463:(t,e,n)=>{n.r(e),n.d(e,{hydratedAdapter:()=>l});var i=n(53866),o=n(77577),r=n(848),s=n(80885),a=n(29909);const l={convertToGEGeometry:function(t,e){if(null==e)return null;let n="cache"in e?e.cache._geVersion:void 0;return null==n&&(n=t.convertJSONToGeometry(e),"cache"in e&&(e.cache._geVersion=n)),n},exportPoint:function(t,e,n){const i=t.hasZ(e),o=t.hasM(e),s=new r.Z({x:t.getPointX(e),y:t.getPointY(e),spatialReference:n});return i&&(s.z=t.getPointZ(e)),o&&(s.m=t.getPointM(e)),s.cache._geVersion=e,s},exportPolygon:function(t,e,n){const i=new s.Z({rings:t.exportPaths(e),hasZ:t.hasZ(e),hasM:t.hasM(e),spatialReference:n});return i.cache._geVersion=e,i},exportPolyline:function(t,e,n){const i=new a.Z({paths:t.exportPaths(e),hasZ:t.hasZ(e),hasM:t.hasM(e),spatialReference:n});return i.cache._geVersion=e,i},exportMultipoint:function(t,e,n){const i=new o.Z({hasZ:t.hasZ(e),hasM:t.hasM(e),points:t.exportPoints(e),spatialReference:n});return i.cache._geVersion=e,i},exportExtent:function(t,e,n){const o=t.hasZ(e),r=t.hasM(e),s=new i.Z({xmin:t.getXMin(e),ymin:t.getYMin(e),xmax:t.getXMax(e),ymax:t.getYMax(e),spatialReference:n});if(o){const n=t.getZExtent(e);s.zmin=n.vmin,s.zmax=n.vmax}if(r){const n=t.getMExtent(e);s.mmin=n.vmin,s.mmax=n.vmax}return s.cache._geVersion=e,s}}},2170:(t,e,n)=>{n.r(e),n.d(e,{buffer:()=>k,changeDefaultSpatialReferenceTolerance:()=>B,clearDefaultSpatialReferenceTolerance:()=>W,clip:()=>c,contains:()=>h,convexHull:()=>C,crosses:()=>d,cut:()=>u,densify:()=>D,difference:()=>M,disjoint:()=>y,distance:()=>p,equals:()=>v,extendedSpatialReferenceInfo:()=>l,flipHorizontal:()=>G,flipVertical:()=>Z,generalize:()=>L,geodesicArea:()=>F,geodesicBuffer:()=>R,geodesicDensify:()=>z,geodesicLength:()=>j,intersect:()=>E,intersectLinesToPoints:()=>Y,intersects:()=>f,isSimple:()=>x,nearestCoordinate:()=>A,nearestVertex:()=>V,nearestVertices:()=>U,offset:()=>P,overlaps:()=>m,planarArea:()=>H,planarLength:()=>N,relate:()=>b,rotate:()=>O,simplify:()=>w,symmetricDifference:()=>S,touches:()=>g,union:()=>T,within:()=>_});n(59486);var i=n(25243),o=n(99058),r=n(92463),s=n(78952);function a(t){const e=Array.isArray(t)?t[0].spatialReference:t.spatialReference;return e?(0,i.TJ)(s.Z,e):s.Z.WGS84}function l(t){return o.G.extendedSpatialReferenceInfo(t)}function c(t,e){return o.G.clip(r.hydratedAdapter,a(t),t,e)}function u(t,e){return o.G.cut(r.hydratedAdapter,a(t),t,e)}function h(t,e){return o.G.contains(r.hydratedAdapter,a(t),t,e)}function d(t,e){return o.G.crosses(r.hydratedAdapter,a(t),t,e)}function p(t,e,n){return o.G.distance(r.hydratedAdapter,a(t),t,e,n)}function v(t,e){return o.G.equals(r.hydratedAdapter,a(t),t,e)}function f(t,e){return o.G.intersects(r.hydratedAdapter,a(t),t,e)}function g(t,e){return o.G.touches(r.hydratedAdapter,a(t),t,e)}function _(t,e){return o.G.within(r.hydratedAdapter,a(t),t,e)}function y(t,e){return o.G.disjoint(r.hydratedAdapter,a(t),t,e)}function m(t,e){return o.G.overlaps(r.hydratedAdapter,a(t),t,e)}function b(t,e,n){return o.G.relate(r.hydratedAdapter,a(t),t,e,n)}function x(t){return o.G.isSimple(r.hydratedAdapter,a(t),t)}function w(t){return o.G.simplify(r.hydratedAdapter,a(t),t)}function C(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return o.G.convexHull(r.hydratedAdapter,a(t),t,e)}function M(t,e){return o.G.difference(r.hydratedAdapter,a(t),t,e)}function S(t,e){return o.G.symmetricDifference(r.hydratedAdapter,a(t),t,e)}function E(t,e){return o.G.intersect(r.hydratedAdapter,a(t),t,e)}function T(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return o.G.union(r.hydratedAdapter,a(t),t,e)}function P(t,e,n,i,s,l){return o.G.offset(r.hydratedAdapter,a(t),t,e,n,i,s,l)}function k(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return o.G.buffer(r.hydratedAdapter,a(t),t,e,n,i)}function R(t,e,n,i,s,l){return o.G.geodesicBuffer(r.hydratedAdapter,a(t),t,e,n,i,s,l)}function A(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return o.G.nearestCoordinate(r.hydratedAdapter,a(t),t,e,n)}function V(t,e){return o.G.nearestVertex(r.hydratedAdapter,a(t),t,e)}function U(t,e,n,i){return o.G.nearestVertices(r.hydratedAdapter,a(t),t,e,n,i)}function I(t){var e,n;return"xmin"in t?"center"in t?t.center:null:"x"in t?t:"extent"in t&&null!==(e=null===(n=t.extent)||void 0===n?void 0:n.center)&&void 0!==e?e:null}function O(t,e,n){var i;if(null==t)throw new q;const r=t.spatialReference;if(null==(n=null!==(i=n)&&void 0!==i?i:I(t)))throw new q;const s=t.constructor.fromJSON(o.G.rotate(t,e,n));return s.spatialReference=r,s}function G(t,e){var n;if(null==t)throw new q;const i=t.spatialReference;if(null==(e=null!==(n=e)&&void 0!==n?n:I(t)))throw new q;const r=t.constructor.fromJSON(o.G.flipHorizontal(t,e));return r.spatialReference=i,r}function Z(t,e){var n;if(null==t)throw new q;const i=t.spatialReference;if(null==(e=null!==(n=e)&&void 0!==n?n:I(t)))throw new q;const r=t.constructor.fromJSON(o.G.flipVertical(t,e));return r.spatialReference=i,r}function L(t,e,n,i){return o.G.generalize(r.hydratedAdapter,a(t),t,e,n,i)}function D(t,e,n){return o.G.densify(r.hydratedAdapter,a(t),t,e,n)}function z(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return o.G.geodesicDensify(r.hydratedAdapter,a(t),t,e,n,i)}function H(t,e){return o.G.planarArea(r.hydratedAdapter,a(t),t,e)}function N(t,e){return o.G.planarLength(r.hydratedAdapter,a(t),t,e)}function F(t,e,n){return o.G.geodesicArea(r.hydratedAdapter,a(t),t,e,n)}function j(t,e,n){return o.G.geodesicLength(r.hydratedAdapter,a(t),t,e,n)}function Y(t,e){return o.G.intersectLinesToPoints(r.hydratedAdapter,a(t),t,e)}function B(t,e){o.G.changeDefaultSpatialReferenceTolerance(t,e)}function W(t){o.G.clearDefaultSpatialReferenceTolerance(t)}class q extends Error{constructor(){super("Illegal Argument Exception")}}},68859:(t,e,n)=>{n.d(e,{K:()=>s});var i=n(12400),o=n(45925),r=n(50628);function s(t,e,n,i){var s,l;if((0,o.canProjectWithoutEngine)(t.spatialReference,n)){var c;a[0]=t.x,a[1]=t.y;const o=t.z;return a[2]=null!==(c=null!==o&&void 0!==o?o:i)&&void 0!==c?c:0,(0,r.projectBuffer)(a,t.spatialReference,0,e,n,0)}const u=(0,o.tryProjectWithZConversion)(t,n);return!!u&&(e[0]=null===u||void 0===u?void 0:u.x,e[1]=null===u||void 0===u?void 0:u.y,e[2]=null!==(s=null!==(l=null===u||void 0===u?void 0:u.z)&&void 0!==l?l:i)&&void 0!==s?s:0,!0)}const a=(0,i.Ue)()},5986:(t,e,n)=>{n.d(e,{S:()=>r});n(45925);var i=n(78952),o=n(68859);function r(t,e,n,i,r){return!(null==e||null==i||t.length<2)&&(s.x=t[0],s.y=t[1],s.z=t[2],s.spatialReference=e,(0,o.K)(s,n,i,r))}const s=(0,n(55946).T)(0,0,0,i.Z.WGS84)},29691:(t,e,n)=>{n.d(e,{rS:()=>u,wY:()=>c});var i=n(83448),o=n(78952),r=n(92975);const s=new o.Z(i.kU),a=new o.Z(i.JL),l=new o.Z(i.mM),c=new o.Z(i.pn);function u(t){const e=h.get(t);if(e)return e;let n=s;if(t)if(t===a)n=a;else if(t===l)n=l;else{const e=t.wkid,o=t.latestWkid;if(null!=e||null!=o)(0,r.o$)(e)||(0,r.o$)(o)?n=a:((0,r.ME)(e)||(0,r.ME)(o))&&(n=l);else{var i;const e=null!==(i=t.wkt2)&&void 0!==i?i:t.wkt;if(e){const t=e.toUpperCase();t===d?n=a:t===p&&(n=l)}}}return h.set(t,n),n}const h=new Map,d=a.wkt.toUpperCase(),p=l.wkt.toUpperCase()},8623:(t,e,n)=>{n.d(e,{Z:()=>h});var i,o=n(27366),r=n(11582),s=n(46784),a=n(49861),l=(n(93169),n(32718),n(84936),n(27135)),c=n(69912);let u=i=class extends((0,r.J)(s.wq)){constructor(t){super(t),this.type="georeferenced",this.origin=null}};u.absolute=new i,(0,o._)([(0,l.J)({georeferenced:"georeferenced"},{readOnly:!0})],u.prototype,"type",void 0),(0,o._)([(0,a.Cb)({type:[Number],nonNullable:!1,json:{write:!0}})],u.prototype,"origin",void 0),u=i=(0,o._)([(0,c.j)("esri.geometry.support.MeshGeoreferencedVertexSpace")],u);const h=u},50250:(t,e,n)=>{n.d(e,{Z:()=>h});var i=n(27366),o=n(11582),r=n(46784),s=n(49861),a=(n(93169),n(32718),n(84936),n(27135)),l=n(69912),c=n(12400);let u=class extends((0,o.J)(r.wq)){constructor(t){super(t),this.type="local",this.origin=(0,c.Ue)()}};(0,i._)([(0,a.J)({local:"local"},{readOnly:!0})],u.prototype,"type",void 0),(0,i._)([(0,s.Cb)({type:[Number],nonNullable:!0,json:{write:!0}})],u.prototype,"origin",void 0),u=(0,i._)([(0,l.j)("esri.geometry.support.MeshLocalVertexSpace")],u);const h=u},76046:(t,e,n)=>{n.d(e,{Z:()=>g});var i,o=n(27366),r=n(46784),s=n(49861),a=(n(93169),n(32718),n(84936),n(69912)),l=n(29134),c=n(7025),u=n(68700),h=n(50894),d=n(12400),p=n(45238);let v=i=class extends r.wq{constructor(t){super(t),this.translation=(0,d.Ue)(),this.rotationAxis=(0,d.nI)(p.up),this.rotationAngle=0,this.scale=(0,d.al)(1,1,1)}get rotation(){return(0,p.uT)(this.rotationAxis,this.rotationAngle)}set rotation(t){this.rotationAxis=(0,d.d9)((0,p.ZZ)(t)),this.rotationAngle=(0,p.EU)(t)}get localMatrix(){const t=(0,c.Ue)();return(0,u.yY)(f,(0,p.ZZ)(this.rotation),(0,p.WH)(this.rotation)),(0,l.Iw)(t,f,this.translation,this.scale),t}get localMatrixInverse(){return(0,l.U_)((0,c.Ue)(),this.localMatrix)}equals(t){return this===t||null!=t&&(0,l.I6)(this.localMatrix,t.localMatrix)}clone(){const t={translation:(0,d.d9)(this.translation),rotationAxis:(0,d.d9)(this.rotationAxis),rotationAngle:this.rotationAngle,scale:(0,d.d9)(this.scale)};return new i(t)}};(0,o._)([(0,s.Cb)({type:[Number],nonNullable:!0,json:{write:!0}})],v.prototype,"translation",void 0),(0,o._)([(0,s.Cb)({type:[Number],nonNullable:!0,json:{write:!0}})],v.prototype,"rotationAxis",void 0),(0,o._)([(0,s.Cb)({type:Number,nonNullable:!0,json:{write:!0}})],v.prototype,"rotationAngle",void 0),(0,o._)([(0,s.Cb)({type:[Number],nonNullable:!0,json:{write:!0}})],v.prototype,"scale",void 0),(0,o._)([(0,s.Cb)()],v.prototype,"rotation",null),(0,o._)([(0,s.Cb)()],v.prototype,"localMatrix",null),(0,o._)([(0,s.Cb)()],v.prototype,"localMatrixInverse",null),v=i=(0,o._)([(0,a.j)("esri.geometry.support.MeshTransform")],v);const f=(0,h.Ue)(),g=v},45238:(t,e,n)=>{n.d(e,{EU:()=>f,Ue:()=>c,WH:()=>g,ZZ:()=>v,q_:()=>h,qw:()=>p,uT:()=>u,up:()=>y});var i=n(16889),o=n(29134),r=n(68700),s=n(50894),a=n(32035),l=n(12400);function c(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y;return[t[0],t[1],t[2],t[3]]}function u(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:c();return(0,a.c)(n,t),n[3]=e,n}function h(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c();const n=(0,o.j6)(m,t);return _(e,(0,i.BV)((0,r.Bh)(e,n))),e}function d(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:c();return(0,r.yY)(m,t,g(t)),(0,r.yY)(b,e,g(e)),(0,r.Jp)(m,b,m),_(n,(0,i.BV)((0,r.Bh)(n,m)))}function p(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:c();return u(l.E9,t,x),u(l.IO,e,w),u(l.eG,n,C),d(x,w,x),d(x,C,i),i}function v(t){return t}function f(t){return t[3]}function g(t){return(0,i.Vl)(t[3])}function _(t,e){return t[3]=e,t}const y=[0,0,1,0],m=(0,s.Ue)(),b=(0,s.Ue)(),x=(c(),c()),w=c(),C=c()},15559:(t,e,n)=>{n.d(e,{Gb:()=>v,Jf:()=>g,Lc:()=>x,TB:()=>m,_q:()=>y,cA:()=>b,p8:()=>f});n(59486);var i=n(10064),o=n(68860),r=n(25243),s=n(38516),a=n(92975),l=n(78952),c=n(29909),u=n(80885);n(848);function h(t){var e;if(!t)return null;const n=t.wkid;if(n)return s.Dg[n];const i=null!==(e=t.wkt2)&&void 0!==e?e:t.wkt;return i?function(t){const e=s.FQ.exec(t);if(!e||2!==e.length)return null;const n=e[1].split(",");if(!n||n.length<3)return null;const i=parseFloat(n[1]),o=parseFloat(n[2]);return isNaN(i)||isNaN(o)?null:{a:i,f:0===o?0:1/o}}(i):null}function d(t){const e=h(t);if(function(t){return null!=t&&"b"in t&&"eSq"in t&&"radius"in t}(e))return e;const n=e.a*(1-e.f);return Object.assign(e,{b:n,eSq:1-(n/e.a)**2,radius:(2*e.a+n)/3,densificationRatio:1e4/((2*e.a+n)/3)})}function p(t,e,n){const{a:i,eSq:o}=d(n),r=Math.sqrt(o),a=Math.sin(e[1]*s.Yr),l=i*e[0]*s.Yr;let c;return c=o>0?i*((1-o)*(a/(1-o*(a*a))-1/(2*r)*Math.log((1-r*a)/(1+r*a))))*.5:i*a,t[0]=l,t[1]=c,t}function v(t){return(0,a.sT)(t)&&!!h(t)}function f(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"square-meters";if(t.some((t=>!v(t.spatialReference))))throw new i.Z("geodesic-areas:invalid-spatial-reference","the input geometries spatial reference is not supported");const n=[];for(let i=0;i<t.length;i++){const e=t[i],o=e.spatialReference,{radius:r,densificationRatio:s}=d(o),a=r*s;n.push(_(e,a))}const r=[],s=[0,0],a=[0,0];for(let i=0;i<n.length;i++){const{rings:t,spatialReference:l}=n[i];let c=0;for(let e=0;e<t.length;e++){const n=t[e];p(s,n[0],l),p(a,n[n.length-1],l);let i=a[0]*s[1]-s[0]*a[1];for(let t=0;t<n.length-1;t++)p(s,n[t+1],l),p(a,n[t],l),i+=a[0]*s[1]-s[0]*a[1];c+=i}c=(0,o.En)(c,"square-meters",e),r.push(c/-2)}return r}function g(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"meters";if(!t)throw new i.Z("geodesic-lengths:invalid-geometries","the input geometries type is not supported");if(t.some((t=>!v(t.spatialReference))))throw new i.Z("geodesic-lengths:invalid-spatial-reference","the input geometries spatial reference is not supported");const n=[];for(let i=0;i<t.length;i++){const r=t[i],{spatialReference:s}=r,a="polyline"===r.type?r.paths:r.rings;let l=0;for(let t=0;t<a.length;t++){const e=a[t];let n=0;for(let t=1;t<e.length;t++){const i=e[t-1][0],o=e[t][0],r=e[t-1][1],a=e[t][1];if(r!==a||i!==o){const t=new y;b(t,[i,r],[o,a],s),n+=t.distance}}l+=n}l=(0,o.En)(l,"meters",e),n.push(l)}return n}function _(t,e){if("polyline"!==t.type&&"polygon"!==t.type)throw new i.Z("geodesic-densify:invalid-geometry","the input geometry is neither polyline nor polygon");const{spatialReference:n}=t;if(!v(n))throw new i.Z("geodesic-densify:invalid-spatial-reference","the input geometry spatial reference is not supported");const o="polyline"===t.type?t.paths:t.rings,s=[],a=[0,0],h=new y;for(const i of o){const t=[];s.push(t),t.push([i[0][0],i[0][1]]);let o,r,l=i[0][0],c=i[0][1];for(let s=0;s<i.length-1;s++){if(o=i[s+1][0],r=i[s+1][1],l===o&&c===r)continue;const u=[l,c];b(h,[l,c],[o,r],n);const{azimuth:d,distance:p}=h,v=p/e;if(v>1){for(let i=1;i<=v-1;i++)m(a,u,d,i*e,n),t.push(a.slice());m(a,u,d,(p+Math.floor(v-1)*e)/2,n),t.push(a.slice())}m(a,u,d,p,n),t.push(a.slice()),l=a[0],c=a[1]}}const d=(0,r.TJ)(l.Z,n);return"polyline"===t.type?new c.Z({paths:s,spatialReference:d}):new u.Z({rings:s,spatialReference:d})}class y{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;this.distance=t,this.azimuth=e,this.reverseAzimuth=n}}function m(t,e,n,i,o){const r=e[0],a=e[1],l=r*s.Yr,c=a*s.Yr,u=(null!==n&&void 0!==n?n:0)*s.Yr,{a:h,b:p,f:v}=d(o),f=Math.sin(u),g=Math.cos(u),_=(1-v)*Math.tan(c),y=1/Math.sqrt(1+_*_),m=_*y,b=Math.atan2(_,g),x=y*f,w=x*x,C=1-w,M=C*(h*h-p*p)/(p*p),S=1+M/16384*(4096+M*(M*(320-175*M)-768)),E=M/1024*(256+M*(M*(74-47*M)-128));let T,P,k,R,A=i/(p*S),V=2*Math.PI;for(;Math.abs(A-V)>1e-12;)k=Math.cos(2*b+A),T=Math.sin(A),P=Math.cos(A),R=E*T*(k+E/4*(P*(2*k*k-1)-E/6*k*(4*T*T-3)*(4*k*k-3))),V=A,A=i/(p*S)+R;const U=m*T-y*P*g,I=Math.atan2(m*P+y*T*g,(1-v)*Math.sqrt(w+U*U)),O=Math.atan2(T*f,y*P-m*T*g),G=v/16*C*(4+v*(4-3*C)),Z=I/s.Yr,L=(l+(O-(1-G)*v*x*(A+G*T*(k+G*P*(2*k*k-1)))))/s.Yr;return t[0]=L,t[1]=Z,t}function b(t,e,n,i){const o=e[0]*s.Yr,r=e[1]*s.Yr,a=n[0]*s.Yr,l=n[1]*s.Yr,{a:c,b:u,f:h,radius:p}=d(i),v=a-o,f=Math.atan((1-h)*Math.tan(r)),g=Math.atan((1-h)*Math.tan(l)),_=Math.sin(f),y=Math.cos(f),m=Math.sin(g),b=Math.cos(g);let x,w,C,M,S,E,T,P,k,R,A=1e3,V=v;do{if(T=Math.sin(V),P=Math.cos(V),C=Math.sqrt(b*T*(b*T)+(y*m-_*b*P)*(y*m-_*b*P)),0===C)return t.distance=0,t.azimuth=void 0,t.reverseAzimuth=void 0,t;S=_*m+y*b*P,E=Math.atan2(C,S),k=y*b*T/C,w=1-k*k,M=S-2*_*m/w,isNaN(M)&&(M=0),R=h/16*w*(4+h*(4-3*w)),x=V,V=v+(1-R)*h*k*(E+R*C*(M+R*S*(2*M*M-1)))}while(Math.abs(V-x)>1e-12&&--A>0);if(0===A){const e=p,n=Math.acos(Math.sin(r)*Math.sin(l)+Math.cos(r)*Math.cos(l)*Math.cos(a-o))*e,i=a-o,c=Math.sin(i)*Math.cos(l),u=Math.cos(r)*Math.sin(l)-Math.sin(r)*Math.cos(l)*Math.cos(i),h=Math.atan2(c,u);return t.azimuth=h/s.Yr,t.distance=n,t.reverseAzimuth=void 0,t}const U=w*(c*c-u*u)/(u*u),I=U/1024*(256+U*(U*(74-47*U)-128)),O=u*(1+U/16384*(4096+U*(U*(320-175*U)-768)))*(E-I*C*(M+I/4*(S*(2*M*M-1)-I/6*M*(4*C*C-3)*(4*M*M-3)))),G=Math.atan2(b*Math.sin(V),y*m-_*b*Math.cos(V)),Z=Math.atan2(y*Math.sin(V),y*m*Math.cos(V)-_*b);return t.azimuth=G/s.Yr,t.distance=O,t.reverseAzimuth=Z/s.Yr,t}function x(t){return v(t)?t:(0,a.sS)(t)?l.Z.WGS84:null}},85981:(t,e,n)=>{n.d(e,{Jk:()=>u,Ue:()=>l,ct:()=>d,nF:()=>h,zk:()=>c});var i=n(16889),o=n(21530),r=n(32035),s=n(12400),a=n(11185);function l(t){return t?{origin:(0,s.d9)(t.origin),vector:(0,s.d9)(t.vector)}:{origin:(0,s.Ue)(),vector:(0,s.Ue)()}}function c(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l();return(0,r.c)(n.origin,t),(0,r.d)(n.vector,e,t),n}function u(t,e){const n=(0,r.d)(a.WM.get(),e,t.origin),o=(0,r.f)(t.vector,n),s=(0,r.f)(t.vector,t.vector),l=(0,i.uZ)(o/s,0,1),c=(0,r.d)(a.WM.get(),(0,r.h)(a.WM.get(),t.vector,l),n);return(0,r.f)(c,c)}function h(t,e,n){return d(t,e,0,1,n)}function d(t,e,n,o,s){const{vector:l,origin:c}=t,u=(0,r.d)(a.WM.get(),e,c),h=(0,r.f)(l,u)/(0,r.k)(l);return(0,r.h)(s,l,(0,i.uZ)(h,n,o)),(0,r.g)(s,s,t.origin)}(0,s.Ue)(),(0,s.Ue)(),new o.x((()=>l()))},69048:(t,e,n)=>{n.d(e,{G7:()=>p,QK:()=>h,rU:()=>d,vI:()=>v,zZ:()=>u});var i=n(44927),o=n(32718),r=n(32035),s=n(848),a=n(8623),l=n(50250);function c(){return o.Z.getLogger("esri.geometry.Mesh")}function u(t){return null!=t.origin}function h(t){return u(t.vertexSpace)}function d(t,e){if(!u(t))return null;const[n,i,o]=t.origin;return new s.Z({x:n,y:i,z:o,spatialReference:e})}function p(t,e){var n,o;const{x:r,y:s,z:u,spatialReference:h}=t,d=[r,s,null!==u&&void 0!==u?u:0];return void 0!==(null===e||void 0===e?void 0:e.geographic)&&((0,i.x9)(c(),"option: geographic",{replacement:"Use the `vertexSpace` option instead.",version:"4.29",warnOnce:!0}),e.vertexSpace&&c().warn("Deprecated geographic flag ignored since vertexSpace option is provided.")),"local"===(null!==(n=null!==(o=null===e||void 0===e?void 0:e.vertexSpace)&&void 0!==o?o:function(t){return null==t?void 0:t?"local":"georeferenced"}(null===e||void 0===e?void 0:e.geographic))&&void 0!==n?n:function(t){return t.isGeographic||t.isWebMercator?"local":"georeferenced"}(h))?new l.Z({origin:d}):new a.Z({origin:d})}function v(t,e){return t.type===e.type&&(t.origin===e.origin||null!=t.origin&&null!=e.origin&&(0,r.p)(t.origin,e.origin))}},74702:(t,e,n)=>{n.d(e,{bE:()=>c,wu:()=>l});var i=n(21530),o=n(32035),r=n(12400),s=n(85981);n(11185);function a(t){return t?{p0:(0,r.d9)(t.p0),p1:(0,r.d9)(t.p1),p2:(0,r.d9)(t.p2)}:{p0:(0,r.Ue)(),p1:(0,r.Ue)(),p2:(0,r.Ue)()}}function l(t,e,n){const i=e[0]-t[0],o=e[1]-t[1],r=n[0]-t[0],s=n[1]-t[1];return.5*Math.abs(i*s-o*r)}function c(t,e,n){return(0,o.d)(u,e,t),(0,o.d)(h,n,t),.5*(0,o.l)((0,o.e)(u,u,h))}new i.x(s.Ue),new i.x((()=>a()));const u=(0,r.Ue)(),h=(0,r.Ue)()},93655:(t,e,n)=>{n.d(e,{Z:()=>p});var i=n(27366),o=n(49861),r=(n(93169),n(32718),n(84936),n(69912)),s=n(68748),a=n(30651),l=n(6693),c=n(56811),u=n(78983),h=n(64575);let d=class extends((0,l.h7)((0,c.M)(a.Z))){constructor(t){super(t),this.elevationInfo=null,this.graphics=new u.J,this.screenSizePerspectiveEnabled=!0,this.type="graphics",this.internal=!1}destroy(){this.removeAll(),this.graphics.destroy()}add(t){return this.graphics.add(t),this}addMany(t){return this.graphics.addMany(t),this}removeAll(){return this.graphics.removeAll(),this}remove(t){this.graphics.remove(t)}removeMany(t){this.graphics.removeMany(t)}on(t,e){return super.on(t,e)}graphicChanged(t){this.emit("graphic-update",t)}};(0,i._)([(0,o.Cb)({type:h.Z})],d.prototype,"elevationInfo",void 0),(0,i._)([(0,o.Cb)((0,s.z)(u.J,"graphics"))],d.prototype,"graphics",void 0),(0,i._)([(0,o.Cb)({type:["show","hide"]})],d.prototype,"listMode",void 0),(0,i._)([(0,o.Cb)()],d.prototype,"screenSizePerspectiveEnabled",void 0),(0,i._)([(0,o.Cb)({readOnly:!0})],d.prototype,"type",void 0),(0,i._)([(0,o.Cb)({constructOnly:!0})],d.prototype,"internal",void 0),d=(0,i._)([(0,r.j)("esri.layers.GraphicsLayer")],d);const p=d},70178:(t,e,n)=>{n.d(e,{Fz:()=>s,kg:()=>r});n(93169);var i=n(16889),o=n(92975);function r(t,e){return t===e||null!=t&&null!=e&&(0,o.fS)(t.spatialReference,e.spatialReference)&&t.x===e.x&&t.y===e.y&&t.z===e.z&&t.m===e.m}function s(t,e,n){var r,s,a,l;return t===e||null!=t&&null!=e&&(0,o.fS)(t.spatialReference,e.spatialReference)&&(0,i.W8)(t.x,e.x,n)&&(0,i.W8)(t.y,e.y,n)&&(0,i.W8)(null!==(r=t.z)&&void 0!==r?r:0,null!==(s=e.z)&&void 0!==s?s:0,n)&&(0,i.W8)(null!==(a=t.m)&&void 0!==a?a:0,null!==(l=e.m)&&void 0!==l?l:0,n)}},55946:(t,e,n)=>{function i(t,e,n,i){return{x:t,y:e,z:n,hasZ:null!=n,hasM:!1,spatialReference:i,type:"point"}}function o(t,e,n,i,o){t.x=e,t.y=n,t.z=i,t.hasZ=null!=i,t.spatialReference=o}n.d(e,{T:()=>i,y:()=>o})},37818:(t,e,n)=>{n.d(e,{WG:()=>r});n(59486),n(52639),n(93169),n(84652),n(18722),n(77981);var i=n(55946);n(78952);function o(t){return"declaredClass"in t}function r(t,e){if(!t)return null;let n;if(o(t)){if(null==e)return t.clone();if(o(e))return e.copy(t)}return null!=e?(n=e,n.x=t.x,n.y=t.y,n.spatialReference=t.spatialReference,t.hasZ?(n.z=t.z,n.hasZ=t.hasZ):(n.z=void 0,n.hasZ=!1),t.hasM?(n.m=t.m,n.hasM=!0):(n.m=void 0,n.hasM=!1)):(n=(0,i.T)(t.x,t.y,t.z,t.spatialReference),t.hasM&&(n.m=t.m,n.hasM=!0)),n}},96669:(t,e,n)=>{function i(t,e){return e?"xoffset"in e&&e.xoffset?Math.max(t,Math.abs(e.xoffset)):"yoffset"in e&&e.yoffset?Math.max(t,Math.abs(e.yoffset||0)):t:t}function o(t,e){var n;return"number"==typeof t?t:null!==t&&void 0!==t&&null!==(n=t.stops)&&void 0!==n&&n.length?function(t){let e=0,n=0;for(let i=0;i<t.length;i++){const o=t[i].size;"number"==typeof o&&(e+=o,n++)}return e/n}(t.stops):e}function r(t,e){if(!e)return t;const n=e.filter((t=>"size"===t.type)).map((e=>{const{maxSize:n,minSize:i}=e;return(o(n,t)+o(i,t))/2}));let i=0;const r=n.length;if(0===r)return t;for(let o=0;o<r;o++)i+=n[o];const s=Math.floor(i/r);return Math.max(s,t)}function s(t){const e=null===t||void 0===t?void 0:t.renderer,n="touch"===(null===t||void 0===t?void 0:t.pointerType)?9:6;if(!e)return n;const o="visualVariables"in e?r(n,e.visualVariables):n;if("simple"===e.type)return i(o,e.symbol);if("unique-value"===e.type){var s;let t=o;return null!==(s=e.uniqueValueInfos)&&void 0!==s&&s.forEach((e=>{t=i(t,e.symbol)})),t}if("class-breaks"===e.type){let t=o;return e.classBreakInfos.forEach((e=>{t=i(t,e.symbol)})),t}return"dot-density"===e.type||e.type,o}n.d(e,{k:()=>s})},74509:(t,e,n)=>{n.d(e,{LR:()=>b,O3:()=>f,Ou:()=>d,RL:()=>c,Uy:()=>_,VW:()=>a,Wb:()=>y,fm:()=>x,jG:()=>w,kf:()=>m,mF:()=>s,tq:()=>g,vQ:()=>p,vu:()=>l,zx:()=>v});var i=n(68860),o=n(88152);function r(t){return t?w:C}function s(t,e){return null!=e?e:r(t)}function a(t,e){var n;return function(t,e){return null!==e&&void 0!==e&&e.mode?e.mode:r(t).mode}(null==t||null!==(n=t.hasZ)&&void 0!==n&&n,e)}function l(t){const e=u(t);return a(t.geometry,e)}function c(t){const e=u(t),n=a(t.geometry,e);return{mode:n,offset:null!=e&&"on-the-ground"!==n?x(e):0,featureExpressionInfo:null===e||void 0===e?void 0:e.featureExpressionInfo}}function u(t){return t.layer&&"elevationInfo"in t.layer?t.layer.elevationInfo:null}function h(t,e){if(null===t||void 0===t||!t.offset)return 0;const{offset:n,unit:o}=t;if("decimal-degrees"===o)return 0;const r="unknown"!==o&&o?o:"meters",s=(0,i.y)(e);return s?(0,i.En)(n,r,s):0}function d(t,e,n){var i,o;if(null===n||void 0===n||!n.mode)return;const r=t.hasZ?t.z:0,s=h(n,t.spatialReference);switch(n.mode){case"absolute-height":return r-s;case"on-the-ground":return 0;case"relative-to-ground":return r-((null!==(i=e.elevationProvider.getElevation(t.x,t.y,r,t.spatialReference,"ground"))&&void 0!==i?i:0)+s);case"relative-to-scene":return r-((null!==(o=e.elevationProvider.getElevation(t.x,t.y,r,t.spatialReference,"scene"))&&void 0!==o?o:0)+s)}}function p(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return f(t,e.x,e.y,e.hasZ?e.z:0,e.spatialReference,n,i)}function v(t,e,n,i){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return f(t,e[0],e[1],e.length>2?e[2]:0,n,i,o)}function f(t,e,n,i,o,r){let s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;if(null==r)return;const a=null!=s?s.mode:"absolute-height";if("on-the-ground"===a)return 0;const{absoluteZ:l}=g(e,n,i,o,t,r);return function(t,e,n,i,o,r,s,a){var l,c;const u=h(s,o);switch(a){case"absolute-height":return t-u;case"relative-to-ground":return t-((null!==(l=r.elevationProvider.getElevation(e,n,i,o,"ground"))&&void 0!==l?l:0)+u);case"relative-to-scene":return t-((null!==(c=r.elevationProvider.getElevation(e,n,i,o,"scene"))&&void 0!==c?c:0)+u)}}(l,e,n,i,o,t,s,a)}function g(t,e,n,i,o,r){const s=h(r,i);switch(r.mode){case"absolute-height":return{absoluteZ:n+s,elevation:0};case"on-the-ground":{var a;const n=null!==(a=o.elevationProvider.getElevation(t,e,0,i,"ground"))&&void 0!==a?a:0;return{absoluteZ:n,elevation:n}}case"relative-to-ground":{var l;const r=null!==(l=o.elevationProvider.getElevation(t,e,n,i,"ground"))&&void 0!==l?l:0;return{absoluteZ:n+r+s,elevation:r}}case"relative-to-scene":{var c;const r=null!==(c=o.elevationProvider.getElevation(t,e,n,i,"scene"))&&void 0!==c?c:0;return{absoluteZ:n+r+s,elevation:r}}}}function _(t,e,n){return n&&n.mode!==e?"".concat(t," only support ").concat(e," elevation mode"):null}function y(t,e,n){return(null===n||void 0===n?void 0:n.mode)===e?"".concat(t," do not support ").concat(e," elevation mode"):null}function m(t,e){return null!=(null===e||void 0===e?void 0:e.featureExpressionInfo)&&"0"!==e.featureExpressionInfo.expression?"".concat(t," do not support featureExpressionInfo"):null}function b(t,e){e&&t.warn(".elevationInfo=",e)}function x(t){var e;return(null!==(e=null===t||void 0===t?void 0:t.offset)&&void 0!==e?e:0)*(0,o.Z7)(null===t||void 0===t?void 0:t.unit)}const w={mode:"absolute-height",offset:0},C={mode:"on-the-ground",offset:null}},38309:(t,e,n)=>{n.d(e,{ControlPointsTransformTool:()=>Xl,TransformTool:()=>vc});var i,o=n(1413),r=n(27366),s=(n(59486),n(52639)),a=n(42537),l=n(92026),c=n(94172),u=n(49861),h=(n(93169),n(32718),n(84936),n(69912)),d=(n(51508),n(17842)),p=n(25243),v=n(13611),f=n(6644),g=n(12400),_=n(48202),y=n(55946),m=n(74509);function b(t,e,n){return x(t,e,n)}function x(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return(0,g.al)(t,e,n)}function w(t,e,n){return(0,g.al)(t,e,n)}function C(t){const[e,n,i]=t;return t.length>3?[e,n,i,t[3]]:[e,n,i]}function M(t,e,n){var i,o;let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:x();return r[0]=t.x,r[1]=t.y,r[2]=null!==(i=t.z)&&void 0!==i?i:0,null==e||("2d"===e.type?r[2]=0:r[2]=null!==(o=(0,m.vQ)(e,t,n,m.jG))&&void 0!==o?o:0),r}!function(t){t[t.NONE=0]="NONE",t[t.TARGET=1]="TARGET"}(i||(i={}));(0,y.T)(0,0,0,null);var S=n(51995),E=n(46784);let T=class extends E.wq{constructor(){super(...arguments),this.enabled=!0}};(0,r._)([(0,u.Cb)({type:Boolean})],T.prototype,"enabled",void 0),T=(0,r._)([(0,h.j)("esri.views.interactive.snapping.Settings.DefaultSnappingAlgorithm")],T);let P=class extends E.wq{constructor(t){super(t),this.lineSnapper=new T,this.parallelLineSnapper=new T,this.rightAngleSnapper=new T,this.rightAngleTriangleSnapper=new T,this.shortLineThreshold=15,this.distance=5,this.pointThreshold=1e-6,this.intersectionParallelLineThreshold=1e-6,this.parallelLineThreshold=1e-6,this.verticalLineThresholdMeters=.3,this.touchSensitivityMultiplier=1.5,this.pointOnLineThreshold=1e-6,this.orange=new S.Z([255,127,0]),this.orangeTransparent=new S.Z([255,127,0,.5]),this.lineHintWidthReference=3,this.lineHintWidthTarget=3,this.lineHintFadedExtensions=.3,this.parallelLineHintWidth=2,this.parallelLineHintLength=24,this.parallelLineHintOffset=1.5,this.rightAngleHintSize=24,this.rightAngleHintOutlineSize=1.5,this.satisfiesConstraintScreenThreshold=1}};(0,r._)([(0,u.Cb)({type:T,constructOnly:!0,nonNullable:!0,json:{write:!0}})],P.prototype,"lineSnapper",void 0),(0,r._)([(0,u.Cb)({type:T,constructOnly:!0,nonNullable:!0,json:{write:!0}})],P.prototype,"parallelLineSnapper",void 0),(0,r._)([(0,u.Cb)({type:T,constructOnly:!0,nonNullable:!0,json:{write:!0}})],P.prototype,"rightAngleSnapper",void 0),(0,r._)([(0,u.Cb)({type:T,constructOnly:!0,nonNullable:!0,json:{write:!0}})],P.prototype,"rightAngleTriangleSnapper",void 0),(0,r._)([(0,u.Cb)({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],P.prototype,"shortLineThreshold",void 0),(0,r._)([(0,u.Cb)({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],P.prototype,"distance",void 0),(0,r._)([(0,u.Cb)({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],P.prototype,"pointThreshold",void 0),(0,r._)([(0,u.Cb)({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],P.prototype,"intersectionParallelLineThreshold",void 0),(0,r._)([(0,u.Cb)({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],P.prototype,"parallelLineThreshold",void 0),(0,r._)([(0,u.Cb)({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],P.prototype,"verticalLineThresholdMeters",void 0),(0,r._)([(0,u.Cb)({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],P.prototype,"touchSensitivityMultiplier",void 0),(0,r._)([(0,u.Cb)({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],P.prototype,"pointOnLineThreshold",void 0),(0,r._)([(0,u.Cb)({type:S.Z,nonNullable:!0})],P.prototype,"orange",void 0),(0,r._)([(0,u.Cb)({type:S.Z,nonNullable:!0})],P.prototype,"orangeTransparent",void 0),(0,r._)([(0,u.Cb)({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],P.prototype,"lineHintWidthReference",void 0),(0,r._)([(0,u.Cb)({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],P.prototype,"lineHintWidthTarget",void 0),(0,r._)([(0,u.Cb)({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],P.prototype,"lineHintFadedExtensions",void 0),(0,r._)([(0,u.Cb)({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],P.prototype,"parallelLineHintWidth",void 0),(0,r._)([(0,u.Cb)({type:Number,nonNullable:!0,range:{min:0,max:50},json:{write:!0}})],P.prototype,"parallelLineHintLength",void 0),(0,r._)([(0,u.Cb)({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],P.prototype,"parallelLineHintOffset",void 0),(0,r._)([(0,u.Cb)({type:Number,nonNullable:!0,range:{min:0,max:46},json:{write:!0}})],P.prototype,"rightAngleHintSize",void 0),(0,r._)([(0,u.Cb)({type:Number,nonNullable:!0,range:{min:0,max:6},json:{write:!0}})],P.prototype,"rightAngleHintOutlineSize",void 0),(0,r._)([(0,u.Cb)({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],P.prototype,"satisfiesConstraintScreenThreshold",void 0),P=(0,r._)([(0,h.j)("esri.views.interactive.snapping.Settings.Defaults")],P);const k=new P;var R,A=n(32035);!function(t){t[t.FEATURE=1]="FEATURE",t[t.SELF=2]="SELF",t[t.ALL=3]="ALL"}(R||(R={}));class V{constructor(t,e){this.isDraped=t,this.domain=e}}class U extends V{constructor(t,e){super(e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:R.ALL),this.intersectionPoint=t}equals(t){return t instanceof U&&(0,A.p)(this.intersectionPoint,t.intersectionPoint)}}class I extends V{constructor(t,e,n,i){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:R.ALL,r=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],s=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];super(i,o),this.type=t,this.lineStart=e,this.lineEnd=n,this.fadeLeft=r,this.fadeRight=s}equals(t){return t instanceof I&&this.type===t.type&&(0,A.p)(this.lineStart,t.lineStart)&&(0,A.p)(this.lineEnd,t.lineEnd)&&this.fadeLeft===t.fadeLeft&&this.fadeRight===t.fadeRight}get length(){return(0,A.j)(this.lineStart,this.lineEnd)}}class O extends V{constructor(t,e,n){super(n,arguments.length>3&&void 0!==arguments[3]?arguments[3]:R.ALL),this.lineStart=t,this.lineEnd=e}equals(t){return t instanceof O&&(0,A.p)(this.lineStart,t.lineStart)&&(0,A.p)(this.lineEnd,t.lineEnd)}}class G extends V{constructor(t,e,n){super(e,n),this.point=t}equals(t){return t instanceof G&&(0,A.p)(this.point,t.point)}}class Z extends V{constructor(t,e,n,i){super(i,arguments.length>4&&void 0!==arguments[4]?arguments[4]:R.ALL),this.previousVertex=t,this.centerVertex=e,this.nextVertex=n}equals(t){return t instanceof Z&&(0,A.p)(this.previousVertex,t.previousVertex)&&(0,A.p)(this.centerVertex,t.centerVertex)&&(0,A.p)(this.nextVertex,t.nextVertex)}}class L{draw(t,e){const n=function(t){const e=[];for(const n of t){let t=!0;for(const i of e)if(n.equals(i)){t=!1;break}t&&e.push(n)}return e}(t),i=this.sortUniqueHints(n),o=[];for(const r of i)r instanceof U&&o.push(this.visualizeIntersectionPoint(r,e)),r instanceof I&&o.push(this.visualizeLine(r,e)),r instanceof O&&o.push(this.visualizeParallelSign(r,e)),r instanceof Z&&o.push(this.visualizeRightAngleQuad(r,e)),r instanceof G&&o.push(this.visualizePoint(r,e));return(0,a.AL)(o)}sortUniqueHints(t){return t}}var D=n(848),z=n(29909),H=n(78952),N=n(75021),F=n(16072),j=n(16851);class Y extends L{constructor(t){super(),this._graphicsLayer=t,this._symbolPairingsByType=new Map}visualizeIntersectionPoint(t,e){return this._visualizeSnappingIndicator(new D.Z({x:t.intersectionPoint[0],y:t.intersectionPoint[1],spatialReference:e.spatialReference}),this._getOrCreateSymbol("intersectionPoint",e.view.effectiveTheme.accentColor))}visualizePoint(t,e){return this._visualizeSnappingIndicator(new D.Z({x:t.point[0],y:t.point[1],spatialReference:e.spatialReference}),this._getOrCreateSymbol("point",e.view.effectiveTheme.accentColor))}visualizeLine(t,e){return this._visualizeSnappingIndicator(new z.Z({paths:[[[...t.lineStart],[...t.lineEnd]]],spatialReference:(0,p.TJ)(H.Z,e.spatialReference)}),this._getOrCreateSymbol("line",e.view.effectiveTheme.accentColor))}visualizeParallelSign(t,e){return this._visualizeSnappingIndicator(new z.Z({paths:[[[...t.lineStart],[...t.lineEnd]]],spatialReference:(0,p.TJ)(H.Z,e.spatialReference)}),this._getOrCreateSymbol("parallelSign",e.view.effectiveTheme.accentColor))}visualizeRightAngleQuad(t,e){const n=(0,f.Ue)(),i=(0,f.Ue)(),o=(0,g.Ue)();(0,v.$X)(n,t.centerVertex,t.previousVertex),(0,v.$X)(i,t.nextVertex,t.previousVertex),(0,v.kC)(o,n,i);const r="rightAngleQuad".concat(o[2]<0?45:225);return this._visualizeSnappingIndicator(new z.Z({paths:[[[...t.previousVertex],[...t.centerVertex],[...t.nextVertex]]],spatialReference:(0,p.TJ)(H.Z,e.spatialReference)}),this._getOrCreateSymbol(r,e.view.effectiveTheme.accentColor))}_visualizeSnappingIndicator(t,e){const n=new s.Z({geometry:t,symbol:e});return this._graphicsLayer.add(n),(0,a.kB)((()=>{this._graphicsLayer.remove(n)}))}_getOrCreateSymbol(t,e){var n;const i=this._symbolPairingsByType;return(null===(n=i.get(t))||void 0===n?void 0:n.color)!==e&&i.set(t,{color:e,symbol:B(t,e)}),i.get(t).symbol}}function B(t,e){const n=[...e.toRgb(),255*e.a];switch(t){case"point":return new F.Z({outline:{width:.5,color:[0,0,0,1]},size:10,color:e});case"intersectionPoint":return new F.Z({outline:new j.Z({width:1.5,color:e}),size:15,color:[0,0,0,0]});case"line":return new N.Z({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",enable:!0,capStyle:_.kP.Butt,joinStyle:_.r4.Round,miterLimit:10,width:(0,d.Wz)(k.lineHintWidthTarget),color:n}]}}});case"parallelSign":return new N.Z({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,anchorPoint:{x:0,y:-1,z:0},anchorPointUnits:"Relative",size:5,markerPlacement:{type:"CIMMarkerPlacementOnLine",placePerPart:!0,angleToLine:!0,relativeTo:"LineMiddle"},frame:{xmin:-5,ymin:-1.5,xmax:5,ymax:1.5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{rings:[[[7,0],[-7,0],[-7,1.5],[7,1.5]]]},symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:n}]}}],scaleSymbolsProportionally:!0,respectFrame:!0},{type:"CIMVectorMarker",enable:!0,anchorPoint:{x:0,y:1,z:0},anchorPointUnits:"Relative",size:5,markerPlacement:{type:"CIMMarkerPlacementOnLine",placePerPart:!0,angleToLine:!0,relativeTo:"LineMiddle"},frame:{xmin:-5,ymin:-1.5,xmax:5,ymax:1.5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{rings:[[[7,0],[-7,0],[-7,-1.5],[7,-1.5]]]},symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:n}]}}],scaleSymbolsProportionally:!0,respectFrame:!0}]}}});case"rightAngleQuad45":case"rightAngleQuad225":{const i="rightAngleQuad45"===t?45:225;return new N.Z({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,anchorPoint:{x:.5,y:.5,z:0},anchorPointUnits:"Relative",size:(0,d.Wz)(k.rightAngleHintSize),rotation:i,markerPlacement:{type:"CIMMarkerPlacementOnVertices",placePerPart:!0,angleToLine:!0,placeOnEndPoints:!1},frame:{xmin:-5,ymin:-5,xmax:5,ymax:5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{paths:[[[5,-5],[-5,-5],[-5,5],[5,5],[5,-5]]]},symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",enable:!0,capStyle:"Butt",joinStyle:"Round",miterLimit:10,width:(0,d.Wz)(k.rightAngleHintOutlineSize),color:n},{type:"CIMSolidFill",enable:!0,color:[...e.toRgb(),255*e.a*.4]}]}}],scaleSymbolsProportionally:!0,respectFrame:!0}]}}})}}}const W=new N.Z({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",effects:[{type:"CIMGeometricEffectDashes",dashTemplate:[3.75,3.75],lineDashEnding:"HalfPattern",controlPointEnding:"NoConstraint"}],enable:!0,capStyle:"Butt",joinStyle:"Round",miterLimit:10,width:1.6,color:[255,255,255,255]},{type:"CIMSolidStroke",enable:!0,capStyle:"Butt",joinStyle:"Round",miterLimit:10,width:2,color:[0,0,0,255]}]}}}),q=new F.Z({style:"circle",size:6,color:[127,127,127,1],outline:{color:[50,50,50],width:1}}),X=new F.Z({style:"circle",size:6,color:[255,127,0,1],outline:{color:[50,50,50],width:1}});var J,K,Q=n(7138),$=n(40281),tt=n(46634);!function(t){t[t.NeverApplied=0]="NeverApplied",t[t.Applied=1]="Applied",t[t.Undone=2]="Undone"}(J||(J={})),function(t){t.UndoRedoUpdating="UndoRedoUpdating",t.UndoInvalidError="UndoInvalidError",t.RedoInvalidError="RedoInvalidError",t.ApplyInvalidError="ApplyInvalidError"}(K||(K={}));const et={[K.UndoRedoUpdating]:"Cannot perform operation whilst undo redo is updating",[K.UndoInvalidError]:"There are no items to Undo",[K.RedoInvalidError]:"There are no items to Redo",[K.ApplyInvalidError]:"Cannot apply an item that is already applied"};class nt extends Error{constructor(){super(et[K.UndoRedoUpdating]),this.type="undo-redo-updating-error"}}class it extends Error{constructor(){super(et[K.UndoInvalidError]),this.type="undo-redo-undo-error"}}class ot extends Error{constructor(){super(et[K.RedoInvalidError]),this.type="undo-redo-redo-error"}}class rt extends Error{constructor(){super(et[K.ApplyInvalidError]),this.type="undo-redo-apply-error"}}var st;!function(t){t[t.Apply=0]="Apply",t[t.Undo=1]="Undo",t[t.Redo=2]="Redo"}(st||(st={}));let at=class extends Q.Z{constructor(){super(...arguments),this.name="",this.tag=Symbol(),this.status=J.NeverApplied}get canUndo(){return this.status===J.Applied}get canRedo(){return this.status===J.Undone}async executeUndoRedoOperation(t){switch(t){case st.Apply:if(this.status!==J.NeverApplied)throw new rt;return await this.apply(),void(this.status=J.Applied);case st.Undo:if(this.status!==J.Applied)throw new it;return await this.undo(),void(this.status=J.Undone);case st.Redo:if(this.status!==J.Undone)throw new it;return await this.redo(),void(this.status=J.Applied)}}};(0,r._)([(0,u.Cb)()],at.prototype,"name",void 0),(0,r._)([(0,u.Cb)()],at.prototype,"tag",void 0),at=(0,r._)([(0,h.j)("esri.undoredo.UndoableOperation")],at);let lt=class extends Q.Z{constructor(){super(...arguments),this._stack=new $.Z,this._stackPosition=-1,this._updatingHandles=new tt.R}get updating(){return this._updatingHandles.updating}get canUndo(){return this.hasUndo&&!this.updating}get hasUndo(){return this._stackPosition>=0}get canRedo(){return this.hasRedo&&!this.updating}get hasRedo(){return this._stackPosition<this._stack.length-1}_truncateForwardStack(){this._stack.splice(this._stackPosition+1,this._stack.length-this._stackPosition).forEach((t=>t.destroy()))}_drainStack(){this._stack.drain((t=>t.destroy())),this._stackPosition=-1}async undo(){if(!this.hasUndo)throw new it;if(this.updating)throw new nt;const t=this._stack.getItemAt(this._stackPosition);t&&await this._updatingHandles.addPromise((async()=>{await t.executeUndoRedoOperation(st.Undo),--this._stackPosition,t.canRedo||this._truncateForwardStack()})())}async redo(){if(!this.hasRedo)throw new ot;if(this.updating)throw new nt;const t=this._stack.getItemAt(this._stackPosition+1);if(!t)throw new ot;await this._updatingHandles.addPromise((async()=>{await t.executeUndoRedoOperation(st.Redo),++this._stackPosition})())}peekUndo(){if(this.canUndo)return this._stack.getItemAt(this._stackPosition)}peekRedo(){if(this.canRedo)return this._stack.getItemAt(this._stackPosition+1)}async inject(t){if(this.updating)throw new nt;await this._updatingHandles.addPromise((async()=>{t.status===J.NeverApplied&&await t.executeUndoRedoOperation(st.Apply),t.canUndo?(this._stack.splice(this._stackPosition+1,0,t),this._stackPosition++):this._stackPosition>-1&&(this._stack.splice(0,this._stackPosition+1).forEach((t=>t.destroy())),this._stackPosition=-1)})())}async add(t){if(this.updating)throw new nt;await this._updatingHandles.addPromise((async()=>{t.status===J.NeverApplied&&await t.executeUndoRedoOperation(st.Apply),this._stackPosition>=-1&&this._truncateForwardStack(),t.canUndo?(this._stack.push(t),this._stackPosition=this._stack.length-1):this._drainStack()})())}async removeTagged(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.updating&&!e)return;await(0,c.N1)((()=>!this.updating));const n=new $.Z;for(let i=0;i<this._stack.length;i++){const e=this._stack.getItemAt(i);e&&(e.tag===t?(e.destroy(),i===this._stackPosition&&(this._stackPosition=n.length-1)):n.push(e))}this._stack=n,this._stackPosition>n.length-1&&(this._stackPosition=n.length-1)}async clear(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.updating&&!t)throw new nt;await(0,c.N1)((()=>!this.updating)),this._drainStack()}};(0,r._)([(0,u.Cb)()],lt.prototype,"_stack",void 0),(0,r._)([(0,u.Cb)()],lt.prototype,"_stackPosition",void 0),(0,r._)([(0,u.Cb)()],lt.prototype,"updating",null),(0,r._)([(0,u.Cb)({readOnly:!0})],lt.prototype,"canUndo",null),(0,r._)([(0,u.Cb)({readOnly:!0})],lt.prototype,"hasUndo",null),(0,r._)([(0,u.Cb)({readOnly:!0})],lt.prototype,"canRedo",null),(0,r._)([(0,u.Cb)({readOnly:!0})],lt.prototype,"hasRedo",null),lt=(0,r._)([(0,h.j)("esri.UndoRedo")],lt);var ct=n(14921),ut=n(91505),ht=n(10064),dt=n(15075),pt=n(6291);function vt(){return(0,dt.i)()}function ft(t,e){const n=[];t=(t=(t=t.replaceAll(/[\u00B0\u00BA]/g,"^")).replaceAll("\u2032","'")).replaceAll("\u2033",'"');const i=gt(e);return dt.c.dmsToGeog(i,1,[t],n)?new D.Z(n[0][0],n[0][1],e||H.Z.WGS84):null}function gt(t){let e=null;if(t||(t=H.Z.WGS84),t.wkid){if(e=dt.P.geogcs(t.wkid),!e)throw new ht.Z("coordinate-formatter:invalid-spatial-reference","wkid is not valid")}else{if(!t.wkt2&&!t.wkt)throw new ht.Z("coordinate-formatter:invalid-spatial-reference","wkid and wkt are missing");if(e=dt.P.fromString(dt.a.PE_TYPE_GEOGCS,t.wkt2||t.wkt),!e)throw new ht.Z("coordinate-formatter:invalid-spatial-reference","wkt is not valid")}return e}var _t=n(93655),yt=n(70178);class mt{constructor(){this.committedVertices=null,this.cursorVertex=null,this.full=null,this.outline=null,this.cursorEdge=null,this.circle=null,this.rectangle=null}}var bt,xt=n(63780),wt=n(84652),Ct=n(68860),Mt=n(83448),St=n(80885),Et=n(15559),Tt=n(81753),Pt=n(89093);let kt=bt=class extends St.Z{constructor(t){super(t),this.center=null,this.geodesic=!1,this.numberOfPoints=60,this.radius=1e3,this.radiusUnit="meters"}initialize(){var t;const e=this.center,n=this.numberOfPoints;if(this.hasZ=null!==(t=null===e||void 0===e?void 0:e.hasZ)&&void 0!==t&&t,0!==this.rings.length||!e)return;const i=(0,Ct.En)(this.radius,this.radiusUnit,"meters"),o=e.spatialReference;let r,s="geographic";if(o.isWebMercator?s="webMercator":(null!=(o.wkid&&Pt.Z[o.wkid])||(o.wkt2||o.wkt)&&(0,Ct.s_)(o.wkt2||o.wkt))&&(s="projected"),this.geodesic){let t;switch(s){case"webMercator":t=(0,Tt.Sx)(e);break;case"projected":console.error("Creating a geodesic circle requires the center to be specified in web mercator or geographic coordinate system");break;case"geographic":t=e}r=this._createGeodesicCircle(t,i,n),"webMercator"===s&&(r=(0,Tt.$)(r))}else{let t;"webMercator"===s||"projected"===s?t=i/(0,Ct.Z7)(e.spatialReference):"geographic"===s&&(t=(0,Ct.ty)(i,"meters",(0,Mt.Iu)(e.spatialReference).radius)),r=this._createPlanarCircle(e,t,n)}this.spatialReference=r.spatialReference,this.addRing(r.rings[0])}clone(){const{center:t,numberOfPoints:e,radius:n,radiusUnit:i,geodesic:o}=this;return new bt({center:null===t||void 0===t?void 0:t.clone(),numberOfPoints:e,radius:n,radiusUnit:i,geodesic:o})}_createGeodesicCircle(t,e,n){let i=0;const o=[];for(;i<360;){const r=[0,0],s=[t.x,t.y];(0,Et.TB)(r,s,i,e,H.Z.WGS84),this.hasZ&&r.push(t.z),o.push(r),i+=360/n}return o.push(o[0]),new St.Z({rings:[o]})}_createPlanarCircle(t,e,n){const i=[],o=2*Math.PI/n;for(let r=0;r<n;++r){const n=o*r,s=[t.x+Math.cos(-n)*e,t.y+Math.sin(-n)*e];this.hasZ&&s.push(t.z),i.push(s)}return i.push(i[0]),new St.Z({spatialReference:t.spatialReference,rings:[i]})}};(0,r._)([(0,u.Cb)({type:D.Z})],kt.prototype,"center",void 0),(0,r._)([(0,u.Cb)()],kt.prototype,"geodesic",void 0),(0,r._)([(0,u.Cb)()],kt.prototype,"numberOfPoints",void 0),(0,r._)([(0,u.Cb)()],kt.prototype,"radius",void 0),(0,r._)([(0,u.Cb)()],kt.prototype,"radiusUnit",void 0),kt=bt=(0,r._)([(0,h.j)("esri.geometry.Circle")],kt);const Rt=kt;var At=n(2170),Vt=n(69662),Ut=n(92975),It=n(50264),Ot=n(55364),Gt=n(68700),Zt=n(50894),Lt=n(14320);function Dt(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return null!=n?[t,e,n]:[t,e]}function zt(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return null!=n?{x:t,y:e,z:n}:{x:t,y:e}}class Ht{constructor(t){this.spatialReference=t}mapToLocalMultiple(t){return t.map((t=>this.mapToLocal(t))).filter(xt.pC)}get doUnnormalization(){return!1}}class Nt extends Ht{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;super(e),this._defaultZ=n,this.transform=(0,Ot.Ue)(),this.transformInv=(0,Ot.Ue)(),this.transform=(0,Ot.d9)(t),(0,It.U_)(this.transformInv,this.transform)}makeMapPoint(t,e){return Dt(t,e,this._defaultZ)}mapToLocal(t){return zt(this.transform[0]*t[0]+this.transform[2]*t[1]+this.transform[4],this.transform[1]*t[0]+this.transform[3]*t[1]+this.transform[5])}localToMap(t){return Dt(this.transformInv[0]*t.x+this.transformInv[2]*t.y+this.transformInv[4],this.transformInv[1]*t.x+this.transformInv[3]*t.y+this.transformInv[5],this._defaultZ)}}class Ft extends Ht{constructor(t,e){super(t.spatialReference),this.view=t,this.defaultZ=null,this.pWS=(0,g.Ue)(),this.tangentFrameUpWS=(0,g.Ue)(),this.tangentFrameRightWS=(0,g.Ue)(),this.tangentFrameForwardWS=(0,g.Ue)(),this.localFrameRightWS=(0,g.Ue)(),this.localFrameUpWS=(0,g.Ue)(),this.worldToLocalTransform=(0,Zt.Ue)(),this.localToWorldTransform=(0,Zt.Ue)(),this.scale=1,this.scale=t.resolution,this.referenceMapPoint=e,this.defaultZ=e.hasZ?e.z:null;const n=t.state.camera.viewRight;this.view.renderCoordsHelper.toRenderCoords(this.referenceMapPoint,this.pWS),this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS,Lt.R.X,this.tangentFrameRightWS),this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS,Lt.R.Y,this.tangentFrameUpWS),this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS,Lt.R.Z,this.tangentFrameForwardWS);const i=(0,g.Ue)();(0,A.h)(i,this.tangentFrameForwardWS,(0,A.f)(n,this.tangentFrameForwardWS)),(0,A.d)(this.localFrameRightWS,n,i),(0,A.n)(this.localFrameRightWS,this.localFrameRightWS),(0,A.e)(this.localFrameUpWS,this.tangentFrameForwardWS,this.localFrameRightWS),(0,Gt.b0)(this.worldToLocalTransform,this.localFrameRightWS,this.tangentFrameRightWS),(0,Gt.U_)(this.localToWorldTransform,this.worldToLocalTransform)}get doUnnormalization(){return"global"===this.view.viewingMode}makeMapPoint(t,e){return Dt(t,e,this.defaultZ)}mapToLocal(t){const e=(0,g.Ue)();this.view.renderCoordsHelper.toRenderCoords(new D.Z({x:t[0],y:t[1],spatialReference:this.spatialReference}),e),(0,A.w)(e,e,this.worldToLocalTransform);const n=this.view.renderCoordsHelper.fromRenderCoords(e,new D.Z({spatialReference:this.view.spatialReference}));return null!=n?zt(n.x/this.scale,n.y/this.scale):null}localToMap(t){const e=(0,g.Ue)();this.view.renderCoordsHelper.toRenderCoords(new D.Z({x:t.x*this.scale,y:t.y*this.scale,spatialReference:this.spatialReference}),e),(0,A.w)(e,e,this.localToWorldTransform);const n=this.view.renderCoordsHelper.fromRenderCoords(e,new D.Z({spatialReference:this.view.spatialReference}));return null!=n?Dt(n.x,n.y,this.defaultZ):null}}var jt=n(77577);function Yt(t,e){const n=new D.Z({x:t[0],y:t[1],spatialReference:e});return t.length>2&&(n.z=t[2]),n}function Bt(t,e,n){const i=new z.Z({paths:t,spatialReference:e});return n&&(0,Vt.nc)(i),i}function Wt(t,e,n){let i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const o=(0,wt.d9)(t);o.forEach((t=>{const e=t[0],n=t[t.length-1];(0,xt.fS)(e,n)&&1!==t.length||t.push(t[0])}));let r=new St.Z({rings:o,spatialReference:e});return r.rings.forEach((t=>{(0,Vt.bu)(t)||t.reverse()})),n&&(0,Vt.nc)(r),i&&r.isSelfIntersecting&&(0,Ut.JY)(e)&&(r=(0,At.simplify)(r)),r}function qt(t,e,n){const i=e.mapToLocalMultiple(t),o=[],r={x:i[0].x,y:i[0].y},s=i[1].x,a=i[1].y,l=Math.round(s-r.x),c=Math.round(a-r.y),u=Math.max(Math.abs(l),Math.abs(c));if(n){const t={x:r.x+u,y:r.y+u},e={x:r.x-u,y:r.y-u};o.push(zt(t.x,e.y),zt(e.x,e.y),zt(e.x,t.y),zt(t.x,t.y))}else{const t={x:l>0?r.x+u:r.x-u,y:c>0?r.y+u:r.y-u};o.push(zt(r.x,r.y),zt(t.x,r.y),zt(t.x,t.y),zt(r.x,t.y))}return Xt(Wt([o.map((t=>e.localToMap(t))).filter(xt.pC)],e.spatialReference,e.doUnnormalization,!0),o,e)}function Xt(t,e,n){const i=Jt(e[3],e[2],n),o=Jt(e[1],e[2],n),r=Jt(e[0],e[1],n),s=Jt(e[0],e[3],n);return{geometry:t,midpoints:null!=i&&null!=o&&null!=r&&null!=s?{top:i,right:o,bottom:r,left:s}:null}}function Jt(t,e,n){Qt[0]=t.x,Qt[1]=t.y,Qt[2]=0,$t[0]=e.x,$t[1]=e.y,$t[2]=0,(0,A.m)(Qt,Qt,$t,.5),Kt.x=Qt[0],Kt.y=$t[1],Kt.z=$t[2];const i=n.localToMap(Kt);return null!=i?Yt(i,n.spatialReference):null}const Kt=zt(0,0,0),Qt=(0,g.Ue)(),$t=(0,g.Ue)();function te(t,e,n,i){const o=e.mapToLocalMultiple(t);let r=null,s=null;if(n)r=o[0],s=o[1];else{const t=o[0],e=o[1],n=Math.round(e.x-t.x),i=Math.round(e.y-t.y),a=Math.max(Math.abs(n),Math.abs(i));r=zt(n>0?t.x+a/2:t.x-a/2,i>0?t.y+a/2:t.y-a/2),s=zt(Math.abs(n)>Math.abs(i)?r.x-a/2:r.x,Math.abs(n)>Math.abs(i)?r.y:r.y-a/2)}const a=e.localToMap(r),l=e.localToMap(s);if(null==a||null==l)return null;e.doUnnormalization&&(0,Vt.Sq)([[a,l]],e.spatialReference);const c=Yt(a,e.spatialReference),u=Yt(l,e.spatialReference),h=(0,Ct.c9)(e.spatialReference);let d=0;if((0,Ut.JY)(e.spatialReference))d=h*(0,At.distance)(c,u,null);else{const t=r.x-s.x,e=r.y-s.y;d=h*Math.sqrt(t*t+e*e)*(i||1)}const p=new Rt({center:c,radius:d,radiusUnit:"meters",spatialReference:e.spatialReference});return{geometry:Wt(p.rings,p.spatialReference,!1),center:c,edge:u}}var ee=n(47898);function ne(t,e){switch(t){case"point":case"multipoint":return"point";case"polyline":return function(t){return(null!=t&&"polyline"===t.type&&t.paths.length?t.paths[0].length:0)<2?"polylineZeroVertices":"polylineOneVertex"}(e);case"polygon":return function(t){const e=null!=t&&"polygon"===t.type&&t.rings.length?t.rings[0].length:0;return e<3?"polylineZeroVertices":e<4?"polygonOneVertex":"polygonTwoVertices"}(e);default:return}}const ie=20,oe=1,re=.1,se=(0,g.Ue)();var ae,le=n(5986),ce=n(16889),ue=n(19093),he=n(86361),de=n(38516),pe=n(55652),ve=n(83479),fe=n(80064),ge=n(24204);function _e(t,e){return t[0]*e[1]-t[1]*e[0]}!function(t){t[t.RAY=0]="RAY",t[t.LINE=1]="LINE"}(ae||(ae={}));const ye=1e-6,me=(0,f.Ue)(),be=(0,f.Ue)(),xe=(0,f.Ue)(),we=(0,f.Ue)();function Ce(t,e,n){let{start:i,end:o,type:r}=t;const s=[],a=(0,v.$X)(ze,o,i),l=(0,v.$X)(He,i,e),c=(0,v.we)(a),u=2*(0,v.AK)(a,l),h=u*u-4*c*((0,v.we)(l)-n*n);if(0===h){const t=-u/(2*c);(r===Le.PLANE||t>=0)&&s.push((0,v.od)((0,f.Ue)(),i,a,t))}else if(h>0){const t=Math.sqrt(h),e=(-u+t)/(2*c);(r===Le.PLANE||e>=0)&&s.push((0,v.od)((0,f.Ue)(),i,a,e));const n=(-u-t)/(2*c);(r===Le.PLANE||n>=0)&&s.push((0,v.od)((0,f.Ue)(),i,a,n))}return s}function Me(t,e){const n=t.start,i=t.end,o=(0,v.$X)(ze,i,n),r=(0,A.i)(Fe,-o[1],o[0],0),s=e.start,a=e.end,l=(0,A.a)(je,a,s),c=(0,A.f)(l,r),u=(0,A.i)(Ye,n[0],n[1],0),h=(0,A.a)(Be,u,s),d=(0,A.f)(h,r),p=(0,ge.bn)();if(Math.abs(c)<p)return Math.abs(d),[];const f=(0,A.b)(We,s,l,d/c);if(e.type===ae.RAY){const t=(0,A.a)(qe,f,s);if((0,A.f)(t,l)<-p)return[]}if(t.type===Le.HALF_PLANE){const t=(0,v.lu)(He,f,n);if((0,v.AK)(t,o)<-p)return[]}return[(0,g.d9)(f)]}function Se(t,e){return function(t,e){let{start:n,end:i,type:o}=t;const r=(0,A.a)(Ne,e,n),s=(0,A.a)(Fe,i,n),a=(0,A.e)(je,s,r),l=(0,A.z)(a)/(0,A.z)(s),c=(0,ge.bn)();if(l<c)switch(o){case ae.LINE:return[(0,g.d9)(e)];case ae.RAY:return(0,A.f)(s,r)<-c?[]:[(0,g.d9)(e)]}return[]}(Ie(Je,e[2],t),e)}function Ee(t,e){return Ve(Ie(Je,0,t),Ie(Ke,0,e)).map((t=>{let[e,n]=t;return(0,f.al)(e,n)}))}function Te(t,e,n){return ke(t,Ie(Je,t[2],e),n)}function Pe(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:(0,g.Ue)();const o=(0,v.$X)(ze,t,e),r=(0,v.kE)(o);return(0,v.od)(i,e,o,0===r?1:n/r),i[2]=t[2],i}function ke(t,e){let{start:n,end:i,type:o}=e,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(0,g.Ue)();const s=(0,A.a)(Ne,t,n),a=(0,A.a)(Fe,i,n),l=(0,A.f)(s,a)/(0,A.f)(a,a);return(0,A.b)(r,n,a,o===ae.RAY?Math.max(l,0):l)}const Re=(()=>{const t=(0,g.Ue)(),e=(0,g.Ue)(),n=(0,g.Ue)();return(i,o)=>{let{start:r,end:s}=i,{center:a,radius:l,normal:c,slicePlane:u}=o;const h=(0,pe.Yq)(a,c,Xe);if(Ge((0,pe.TE)(h,r),0)&&Ge((0,pe.TE)(h,s),0)){(0,fe._F)(c,t,e);const i=(i,o)=>((0,A.d)(n,o,a),(0,v.t8)(i,(0,A.f)(n,t),(0,A.f)(n,e)),i),o=function(t,e,n){const i=[],o=(0,v.$X)(me,t.end,t.start),r=(0,v.$X)(be,t.start,e),s=(0,v.we)(o),a=2*(0,v.AK)(o,r),l=a*a-4*s*((0,v.we)(r)-n*n);if(0===l){const e=-a/(2*s);(t.type===ae.LINE||e>=0)&&i.push((0,v.od)(we,t.start,o,e))}else if(l>0){const e=Math.sqrt(l),n=(-a+e)/(2*s);(t.type===ae.LINE||n>=0)&&i.push((0,v.od)(we,t.start,o,n));const r=(-a-e)/(2*s);(t.type===ae.LINE||r>=0)&&i.push((0,v.od)(xe,t.start,o,r))}return i}({start:i(ze,r),end:i(He,s),type:ae.LINE},f.AG,l),h=[];for(const[n,r]of o){const i=(0,A.c)((0,g.Ue)(),a);(0,A.b)(i,i,t,n),(0,A.b)(i,i,e,r),u&&!Ze(u,i)||h.push(i)}return h}const d=(0,g.Ue)();return(0,pe.fn)(h,r,s,d)?!Ge((0,A.j)(d,a),l)||u&&!Ze(u,d)?[]:[d]:[]}})();function Ae(t,e,n){let{start:i,end:o,type:r}=t;const s=[],a=(0,A.d)(Ne,o,i),l=(0,v.$X)(He,i,e),c=(0,v.we)(a),u=2*(0,v.AK)(a,l),h=u*u-4*c*((0,v.we)(l)-n*n);if(0===h){const t=-u/(2*c);(r===ae.LINE||t>=0)&&s.push((0,A.b)((0,g.Ue)(),i,a,t))}else if(h>0){const t=Math.sqrt(h),e=(-u+t)/(2*c);(r===ae.LINE||e>=0)&&s.push((0,A.b)((0,g.Ue)(),i,a,e));const n=(-u-t)/(2*c);(r===ae.LINE||n>=0)&&s.push((0,A.b)((0,g.Ue)(),i,a,n))}return s}function Ve(t,e){const n=t.start,i=t.end,o=e.start,r=e.end,s=(0,A.a)(Ne,i,n),a=(0,A.a)(Fe,r,o),l=(0,A.a)(je,o,n),c=(0,A.e)(Ye,s,a);if(!Ge((0,A.f)(l,c),0))return[];const u=(0,A.z)(c);if(Ge(u,0))return[];const h=(0,A.e)(Be,l,a),d=(0,A.f)(h,c)/u,p=(0,A.b)(We,n,s,d);if(t.type===ae.RAY){const t=(0,A.a)(qe,p,n);if((0,A.f)(s,t)<-(0,ge.bn)())return[]}if(e.type===ae.RAY){const t=(0,A.a)(qe,p,o);if((0,A.f)(a,t)<-(0,ge.bn)())return[]}return[(0,g.d9)(p)]}function Ue(t,e,n,i){const[o,r]=t,[s,a]=n,l=s-o,c=a-r,u=l*l+c*c,h=Math.sqrt(u);if(h>e+i)return[];if(h<Math.abs(e-i))return[];if(Ge(h,0)&&Ge(e,i))return[];const d=(e*e-i*i+u)/(2*h),p=Math.sqrt(e*e-d*d),g=p*c/h,_=p*l/h,[y,m]=(0,v.t7)(ze,t,n,d/h);return Ge(g,_)?[(0,f.al)(y,m)]:[(0,f.al)(y+g,m-_),(0,f.al)(y-g,m+_)]}function Ie(t,e,n){let{start:i,end:o,type:r}=n;return(0,A.i)(t.start,i[0],i[1],e),(0,A.i)(t.end,o[0],o[1],e),t.type=De[r],t}function Oe(t,e){return Ge(t[2],e[2])}function Ge(t,e){return(0,ce.W8)(Math.abs(t-e),0,(0,ge.bn)())}function Ze(t,e){return(0,pe.Ac)(t,e)}var Le;!function(t){t[t.PLANE=0]="PLANE",t[t.HALF_PLANE=1]="HALF_PLANE"}(Le||(Le={}));const De={[Le.PLANE]:ae.LINE,[Le.HALF_PLANE]:ae.RAY},ze=(0,f.Ue)(),He=(0,f.Ue)(),Ne=(0,g.Ue)(),Fe=(0,g.Ue)(),je=(0,g.Ue)(),Ye=(0,g.Ue)(),Be=(0,g.Ue)(),We=(0,g.Ue)(),qe=(0,g.Ue)(),Xe=(0,pe.Ue)(),Je={start:(0,g.Ue)(),end:(0,g.Ue)(),type:ae.LINE},Ke={start:(0,g.Ue)(),end:(0,g.Ue)(),type:ae.LINE};class Qe{intersect(t){return Sn(this,t)}closestPoints(t){return[this.closestTo(t)]}}class $e extends Qe{constructor(t){super(),this.point=t}equals(t){return this===t||Ln(t)&&(0,A.p)(this.point,t.point)}closestTo(){return C(this.point)}}class tn extends Qe{constructor(t,e,n){super(),this.start=t,this.end=e,this.lineLike={start:t,end:e,type:n}}equals(t){return this===t||Dn(t)&&this.lineLike.type===t.lineLike.type&&(0,A.p)(this.start,t.start)&&(0,A.p)(this.end,t.end)}closestTo(t){const e=x();return ke(t,this.lineLike,e),e}}class en extends tn{constructor(t,e){super(t,e,ae.LINE)}}class nn extends tn{constructor(t,e){super(t,e,ae.RAY)}}class on extends Qe{constructor(t){super(),this.constraints=t}equals(t){return this===t||Zn(t)&&(0,xt.fS)(this.constraints,t.constraints,((t,e)=>t.equals(e)))}closestTo(t){var e;let n,i=1/0;for(const o of this.constraints){const e=o.closestTo(t),r=(0,A.s)(t,e);r<i&&(i=r,n=e)}return C(null!==(e=n)&&void 0!==e?e:t)}closestPoints(t){return this.constraints.flatMap((e=>e===this?[]:e.closestPoints(t)))}}class rn extends Qe{constructor(t,e){super(),this.center=t,this.radius=e}equals(t){return this===t||Nn(t)&&this.center[0]===t.center[0]&&this.center[1]===t.center[1]&&this.radius===t.radius}closestTo(t){const e=x();return Pe(t,this.center,this.radius,e),e}}class sn extends Qe{constructor(t,e){super(),this.center=t,this.radius=e}equals(t){return this===t||Fn(t)&&(0,A.p)(this.center,t.center)&&this.radius===t.radius}closestTo(t){const e=x();return Pe(t,this.center,this.radius,e),e[2]=this.center[2],e}asCircle(){return new an(C(this.center),this.radius,w(0,0,1))}}class an extends Qe{constructor(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0;super(),this.center=t,this.radius=e,this.normal=n,this.slicePlane=i}equals(t){return this===t||jn(t)&&(0,A.p)(this.center,t.center)&&(0,A.p)(this.normal,t.normal)&&this.radius===t.radius}closestTo(t){const{center:e,radius:n}=this;(0,pe.nF)(this.getPlane(cn),t,ln);const i=(0,A.a)(ln,ln,e),o=(0,A.k)(i);if(Ge(o,0))return C(t);const r=n/Math.sqrt(o),s=x();(0,A.b)(s,e,i,r);const{slicePlane:a}=this;if(a&&!Ze(a,s)){var l;const e=Tn(a,this);return null!==(l=null===e||void 0===e?void 0:e.closestTo(t))&&void 0!==l?l:C(t)}return s}getPlane(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,pe.Ue)();return(0,pe.Yq)(this.center,this.normal,t)}}const ln=(0,g.Ue)(),cn=(0,pe.Ue)();class un extends Qe{constructor(t){super(),this.z=t}equals(t){return this===t||zn(t)&&this.z===t.z}closestTo(t){return w(t[0],t[1],this.z)}getPlane(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,pe.Ue)();return(0,A.i)(hn,0,0,this.z),(0,pe.Yq)(hn,g.eG,t)}}const hn=(0,g.Ue)();class dn extends Qe{constructor(t,e,n){super(),this.start=t,this.end=e,this.planeLike={start:t,end:e,type:n}}equals(t){return this===t||Hn(t)&&this.planeLike.type===t.planeLike.type&&(0,A.p)(this.start,t.start)&&(0,A.p)(this.end,t.end)}closestTo(t){const e=x();return Te(t,this.planeLike,e),e}closestEndTo(t){const{start:e,end:n}=this.planeLike;return Math.sign((0,v.AK)((0,v.$X)(pn,n,e),(0,v.$X)(vn,t,e)))>0?this.end:this.start}getPlane(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,pe.Ue)();const e=(0,A.c)(fn,this.end);return e[2]+=1,(0,pe.zk)(this.start,this.end,e,t)}getSlicePlane(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,pe.Ue)();const{start:e,end:n,type:i}=this.planeLike;if(i===Le.PLANE)return;const o=(0,A.i)(fn,e[0],e[1],0),r=(0,A.i)(gn,n[0],n[1],0),s=(0,A.d)(gn,r,o);return(0,pe.Yq)(o,s,t),t}}const pn=(0,f.Ue)(),vn=(0,f.Ue)(),fn=(0,g.Ue)(),gn=(0,g.Ue)();class _n extends dn{constructor(t,e){super(t,e,Le.HALF_PLANE)}}class yn extends Qe{constructor(t,e){super(),this.sphere=(0,ve.l)(t,e)}equals(t){return this===t||Yn(t)&&(0,ve.m)(this.sphere,t.sphere)}closestTo(t){const e=x();return(0,ve.p)(this.sphere,t,e),e}get center(){return(0,ve.a)(this.sphere)}get radius(){return this.sphere[3]}}class mn extends Qe{constructor(t,e,n){super(),this.start=t,this.end=e,this.getZ=n,this.planeLike={start:t,end:e,type:Le.PLANE}}equals(t){return this===t||Bn(t)&&(0,A.p)(this.start,t.start)&&(0,A.p)(this.end,t.end)&&this.getZ===t.getZ}closestTo(t){return function(t,e){var n;const i=x();return Te(e,t.planeLike,i),i[2]=null!==(n=t.getZ(i[0],i[1]))&&void 0!==n?n:Wn,i}(this,t)}addIfOnTheGround(t,e){for(const i of e){var n;const e=null!==(n=this.getZ(i[0],i[1]))&&void 0!==n?n:0;Ge(i[2],e)&&(i[2]=e,t.push(i))}}}class bn extends Qe{constructor(t,e,n){super(),this._x=t,this._y=e,this._z=n}equals(t){return this===t||function(t){return t instanceof bn}(t)&&this._x===t._x&&this._y===t._y&&this._z===t._z}closestTo(t){var e,n,i;let[o,r,s]=t;return b(null!==(e=this._x)&&void 0!==e?e:o,null!==(n=this._y)&&void 0!==n?n:r,null!==(i=this._z)&&void 0!==i?i:s)}}class xn extends Qe{constructor(t,e,n,i,o){super(),this._origin=t,this._spatialReference=e,this._distanceMeters=n,this._z=i,this._directionDegrees=o}equals(t){return this===t||function(t){return t instanceof xn}(t)&&(0,v.I6)(this._origin,t._origin)&&this._spatialReference===t._spatialReference&&this._distanceMeters===t._distanceMeters&&this._z===t._z&&this._directionDegrees===t._directionDegrees}closestTo(t){var e;let[n,i,o]=t;return(0,v.t8)(wn,n,i),(0,v.I6)(wn,this._origin)||this._applyDirectionAndDistance(wn),b(wn[0],wn[1],null!==(e=this._z)&&void 0!==e?e:o)}_applyDirectionAndDistance(t){if(null!=this._directionDegrees&&null!=this._distanceMeters)(0,Et.TB)(t,this._origin,this._directionDegrees,this._distanceMeters,this._spatialReference);else if(null!=this._directionDegrees)!function(t,e,n,i,o){var r;let{azimuth:s,distance:a}=(0,Et.cA)(Mn,e,i,o);null!==(r=s)&&void 0!==r||(s=0);let l=a*Math.cos((s-n)*de.Yr);l=Math.max(0,l),(0,Et.TB)(t,e,n,l,o)}(t,this._origin,this._directionDegrees,t,this._spatialReference);else if(null!=this._distanceMeters){const{azimuth:e}=(0,Et.cA)(Cn,this._origin,t,this._spatialReference);(0,Et.TB)(t,this._origin,null!==e&&void 0!==e?e:0,this._distanceMeters,this._spatialReference)}}}const wn=[0,0],Cn=new Et._q;const Mn=new Et._q;function Sn(t,e){if(Zn(t)){const n=[];for(const i of t.constraints){const t=i.intersect(e);t&&n.push(t)}return Gn(n)}if(Zn(e))return Sn(e,t);if(Bn(t))return Vn(t,e);if(Bn(e))return Vn(e,t);if(Ln(t)){const{point:n}=t;if(Ln(e))return(0,A.p)(n,e.point)?t:void 0;const i=e.closestTo(n);return(0,A.H)(i,n)?t:void 0}if(Dn(t)){if(Ln(e))return Sn(e,t);if(Dn(e))return In(Ve(t.lineLike,e.lineLike));if(zn(e))return En(t,e);if(Hn(e))return In(Me(e.planeLike,t.lineLike));if(Nn(e))return In(Ae(t.lineLike,e.center,e.radius));if(jn(e))return In(Re(t.lineLike,e));if(Fn(e))return function(t,e){let{lineLike:n}=t,{center:i,radius:o}=e;const r=i[2];return In(Ae(n,i,o).filter((t=>Ge(t[2],r))))}(t,e);if(Yn(e))return function(t,e){let{lineLike:n}=t,{sphere:i}=e;return In((0,ve.n)(i,n.start,n.end))}(t,e)}else if(zn(t)){if(Ln(e)||Dn(e))return Sn(e,t);if(zn(e))return function(t,e){return Ge(t.z,e.z)?t:void 0}(t,e);if(Hn(e))return function(t,e){let{z:n}=t,{planeLike:i}=e;const[o,r]=i.start,[s,a]=i.end,l=w(o,r,n),c=w(s,a,n);return i.type===Le.PLANE?new en(l,c):new nn(l,c)}(t,e);if(Nn(e))return function(t,e){const[n,i]=e.center;return new sn(w(n,i,t.z),e.radius)}(t,e);if(jn(e))return Pn(t,e);if(Fn(e))return function(t,e){return Ge(e.center[2],t.z)?e:void 0}(t,e);if(Yn(e))return function(t,e){let{center:n,radius:i}=e;const o=Math.abs(n[2]-t.z);if(o>i&&!Ge(o,i))return;const r=w(n[0],n[1],t.z),s=Math.sqrt(i**2-o**2);return Ge(s,0)?void 0:new sn(r,s)}(t,e)}else if(Hn(t)){if(Ln(e)||Dn(e)||zn(e))return Sn(e,t);if(Hn(e))return Un(Ee(t.planeLike,e.planeLike));if(Nn(e))return Un(Ce(t.planeLike,e.center,e.radius));if(jn(e))return Rn(t,e);if(Fn(e))return kn(t,e);if(Yn(e))return An(t,e)}else if(Nn(t)){if(Ln(e)||Dn(e)||zn(e)||Hn(e))return Sn(e,t);if(Nn(e))return Un(Ue(t.center,t.radius,e.center,e.radius));if(jn(e))return;if(Fn(e))return function(t,e){const n=(0,v.bI)(t.center,e.center);return Ge(n,0)&&Ge(t.radius,e.radius)?e:On(Ue(t.center,t.radius,e.center,e.radius),e.center[2])}(t,e);if(Yn(e))return}else if(jn(t)){if(Ln(e)||Dn(e)||zn(e)||Hn(e)||Nn(e))return Sn(e,t);if(jn(e))return;if(Fn(e))return void e.asCircle();if(Yn(e))return}else if(Fn(t)){if(Ln(e)||Dn(e)||zn(e)||Hn(e)||Nn(e)||jn(e))return Sn(e,t);if(Fn(e))return function(t,e){if(!Oe(t.center,e.center))return;const n=(0,v.bI)(t.center,e.center);return Ge(n,0)&&Ge(t.radius,e.radius)?t:On(Ue(t.center,t.radius,e.center,e.radius),t.center[2])}(e,t);if(Yn(e))return}else if(Yn(t)){if(Ln(e)||Dn(e)||zn(e)||Hn(e)||Nn(e)||Fn(e))return Sn(e,t);if(Yn(e))return}}const En=(()=>{const t=(0,pe.Ue)();return(e,n)=>{const{start:i,end:o}=e;if(Oe(i,o)&&Ge(i[2],n.z))return e;const r=x();return(0,pe.fn)(n.getPlane(t),i,o,r)?new $e(r):void 0}})();const Tn=(()=>{const t=(0,he.Ue)(),e=(0,g.Ue)(),n=(0,g.Ue)();return(i,o,r)=>{const{normal:s,center:a,radius:l}=o;(0,fe._F)(s,e,n);const c=(0,pe.st)(i),u=l*(0,A.f)(c,e),h=l*(0,A.f)(c,n);(0,ue.s)(t,a[0],a[1],a[2],1);const d=(0,ue.h)(i,t),p=Math.hypot(u,h),v=Ge(p,0);if(Ge((0,pe.TE)(i,a),0)){if(v)return o;if(Ge(l,0))return!r||Ze(r,a)?new $e(C(a)):void 0;(0,A.e)(e,c,s),(0,A.n)(e,e);const t=new Array,n=(0,g.d9)(a);(0,A.b)(n,n,e,l),r&&!Ze(r,n)||t.push(n);const i=(0,g.d9)(a);return(0,A.b)(i,i,e,-l),r&&!Ze(r,i)||t.push(i),In(t)}if(v)return;const f=-d/p;if(Math.abs(f)>1||Ge(f,1))return;const _=Math.atan(u/h),y=(0,ce.Kt)(f)-_,m=Math.PI-y,b=new Array,x=(0,g.Ue)();(0,A.b)(x,a,e,l*Math.cos(y)),(0,A.b)(x,x,n,l*Math.sin(y)),b.push(x);const w=(0,g.Ue)();return(0,A.b)(w,a,e,l*Math.cos(m)),(0,A.b)(w,w,n,l*Math.sin(m)),b.push(w),In(r?function(t,e){return e.filter((e=>Ze(t,e)))}(r,b):b)}})();const Pn=(()=>{const t=(0,pe.Ue)();return(e,n)=>Tn(e.getPlane(t),n,n.slicePlane)})();const kn=(()=>{const t=(0,pe.Ue)();return(e,n)=>{let{center:i,radius:o}=n;const r=Ce(e.planeLike,i,o),s=i[2];e.getSlicePlane(t);const a=new Array;for(const[l,c]of r){const e=[l,c,s];Ze(t,e)&&a.push(e)}return In(a)}})(),Rn=(()=>{const t=(0,pe.Ue)(),e=(0,pe.Ue)();return(n,i)=>Tn(n.getPlane(t),i,n.getSlicePlane(e))})(),An=(()=>{const t=(0,pe.Ue)();return(e,n)=>{let{center:i,radius:o}=n;const r=e.getPlane(t),s=(0,pe.jH)(r,i),a=Math.abs(s);if(a>o&&!Ge(a,o))return;const l=Math.sqrt(o**2-s**2);if(Ge(l,0)){const t=x();return(0,pe.nF)(r,i,t),new $e(t)}const c=x(),u=(0,g.d9)((0,pe.st)(r));return(0,A.b)(c,i,u,s),new an(c,l,u,e.getSlicePlane())}})();function Vn(t,e){const{planeLike:n,getZ:i}=t,o=new Array;if(Ln(e))t.addIfOnTheGround(o,Se(n,e.point));else if(Dn(e))t.addIfOnTheGround(o,Me(n,e.lineLike));else if(Nn(e))for(const[s,a]of Ce(n,e.center,e.radius)){const t=i(s,a);null!=t&&o.push((0,g.al)(s,a,t))}else if(Hn(e)||Bn(e))for(const[s,a]of Ee(n,e.planeLike)){var r;const t=null!==(r=i(s,a))&&void 0!==r?r:Wn;o.push((0,g.al)(s,a,t))}return In(o)}function Un(t){return Gn(t.map((t=>{let[e,n]=t;const i=w(e,n,0),o=w(e,n,1);return new en(i,o)})))}function In(t){return Gn(t.map((t=>t?new $e(t):void 0)))}function On(t,e){return In(t.map((t=>{let[n,i]=t;return[n,i,e]})))}function Gn(t){var e;if(0!==t.length)return 1===t.length?null!==(e=t[0])&&void 0!==e?e:void 0:new on(t.filter(xt.pC))}function Zn(t){return t instanceof on}function Ln(t){return t instanceof $e}function Dn(t){return t instanceof tn}function zn(t){return t instanceof un}function Hn(t){return t instanceof dn}function Nn(t){return t instanceof rn}function Fn(t){return t instanceof sn}function jn(t){return t instanceof an}function Yn(t){return t instanceof yn}function Bn(t){return t instanceof mn}const Wn=0;var qn,Xn=n(17768);function Jn(t,e){if(null==t||null==e)return;const n=Kn(t,e);return null!=n?(0,ee.GJ)(n,"radians","geographic"):void 0}!function(t){t.Absolute="absolute",t.Relative="relative",t.RelativeBilateral="relative-bilateral"}(qn||(qn={}));const Kn=(()=>{const t=(0,g.Ue)(),e=(0,g.Ue)();return(n,i)=>{var o,r;return(0,A.i)(t,n.x,n.y,null!==(o=n.z)&&void 0!==o?o:0),(0,A.i)(e,i.x,i.y,null!==(r=i.z)&&void 0!==r?r:0),Qn(t,e,n.spatialReference,i.spatialReference)}})(),Qn=(()=>{const t=(0,f.Ue)(),e=(0,g.Ue)(),n=(0,g.Ue)();return(i,o,r,s)=>{if((0,A.p)(i,o))return;const a=(0,Et.Lc)(r),l=(0,Et.Lc)(s);if(a&&l&&(0,Ut.fS)(a,l)&&(0,le.S)(i,r,e,a)&&(0,le.S)(o,s,n,l)){const{azimuth:t}=(0,Et.cA)(ri,e,n,a);return null!=t?(0,Ct.En)(t,"degrees","radians"):void 0}t[0]=o[0]-i[0],t[1]=o[1]-i[1];let c=(0,v.EU)(f.IO,t);return t[0]<0&&(c=si-c),c}})();function $n(t,e,n){if(!t||!e||!n)return;const i=Kn(t,e),o=Kn(e,n);return null!=i&&null!=o?(0,ee.GJ)(o-i,"radians","geographic"):void 0}function ti(t,e){if(null!=t)switch(e){case qn.Absolute:return ei(t);case qn.Relative:{const e=ii(t);let n=li.normalize(e,0,!0);return-180===n&&(n=180),(0,ee.GJ)(n,"degrees","geographic")}case qn.RelativeBilateral:{const e=ii(t),n=Math.abs(li.normalize(e,0,!0));return(0,ee.GJ)(n,"degrees","geographic")}}}function ei(t){const e=ii(t),n=ai.normalize(e,0,!0);return(0,ee.GJ)(n,"degrees","geographic")}const ni=(()=>{const t=(0,g.Ue)();return function(e,n,i,o,r){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"geodesic";(0,A.c)(t,n);const a=ii(r);if("geodesic"===s){const r=(0,Et.Lc)(i);if(r&&(0,le.S)(t,i,t,r))return(0,Et.TB)(e,t,a,o,r),e[2]=n[2],!!(0,le.S)(e,r,e,i)}const l=(0,ee.hw)(a,"geographic","arithmetic"),c=(0,Ct.En)(l,"degrees","radians"),u=n[0]+o*Math.cos(c),h=n[1]+o*Math.sin(c),d=n[2];return(0,A.i)(e,u,h,d),!0}})();function ii(t){if(null!=t)return(0,ee.hw)(oi(t),t.rotationType,"geographic")}function oi(t){return(0,Ct.En)(t.value,t.unit,"degrees")}const ri=new Et._q,si=2*Math.PI,ai=Xn.BV,li=new Xn.pE(-180,180);function ci(t,e,n){if(null==e||null==t)return;const i=(0,Ct.j5)(n.measurementSR);if(null==i)return;const o=gi(t,n);if(null==o)return;const r=(0,ee.mE)(e,i);return new rn(o,r)}function ui(t,e,n,i){if(null==n||null==t)return;const o=gi(t,i);if(null==o)return;const r=ii(n),s=t=>{if(null==t)return;const e=x(),n=(0,ee.GJ)(t,"degrees","geographic");return ni(e,o,i.measurementSR,10,n,i.mode)?new _n(o,e):void 0},a=()=>{if(null!=e&&null!=t)return ii(Jn(e,t))};switch(i.directionMode){case qn.Absolute:return s(r);case qn.Relative:{const t=a();if(null==t)return;return s(t+r)}case qn.RelativeBilateral:{const t=a();if(null==t)return;return Gn([s(t+r),s(t-r)])}}}function hi(t,e){const n=yi(t,e);return null!=n?new un(n):void 0}function di(t,e,n){const{context:i,longitude:o,latitude:r,direction:s,distance:a,elevation:l}=n;if(null!=o||null!=r||null!=a||null!=l||null!=s){if(null!=o||null!=r){const t=ii(o),e=ii(r),n=yi(l,i);return new bn(t,e,n)}return function(t,e,n){let{context:i,direction:o,distance:r,elevation:s}=n;if(null==e)return hi(s,i);const{view:a,elevationInfo:l,measurementSR:c}=i,u=M(e,a,l);if(!c||!(0,le.S)(u,e.spatialReference,mi,c))return;const[h,d]=mi,p=null!=r?(0,ee.mE)(r,"meters"):void 0,v=ii(o),f=yi(s,i),g=t=>{const e=new xn([h,d],c,p,f,t);return null==p||null==t||null==f&&i.hasZ?e:new $e(e.closestTo(u))};if(null==v)return g(void 0);const _=()=>{if(null!=t&&null!=e)return ii(Jn(t,e))};switch(i.directionMode){case qn.Absolute:return g(v);case qn.Relative:{const t=_();if(null==t)return;return g(t+v)}case qn.RelativeBilateral:{const t=_();if(null==t)return;return Gn([g(t+v),g(t-v)])}}}(t,e,n)}}function pi(t){return"geodesic"===t.context.mode?di(null,null,t):fi(t)}function vi(t,e,n){const{context:i,x:o,y:r,distance:s,direction:a,elevation:l}=n;return"geodesic"===i.mode?di(e,t,n):null!=o||null!=r?fi(n):function(t){let e;for(const o of t){var n,i;o&&(e=null!==(n=null===(i=e)||void 0===i?void 0:i.intersect(o))&&void 0!==n?n:o)}return e}([ci(t,s,i),ui(t,e,a,i),hi(l,i)])}function fi(t){var e,n;let{x:i,y:o,elevation:r,context:s}=t;wi.x=null!==(e=null===i||void 0===i?void 0:i.value)&&void 0!==e?e:0,wi.y=null!==(n=null===o||void 0===o?void 0:o.value)&&void 0!==n?n:0,wi.spatialReference=s.spatialReference;const a=gi(wi,s,bi);return new bn(null!=i&&null!=a?a[0]:void 0,null!=o&&null!=a?a[1]:void 0,yi(r,s))}function gi(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:x();const{view:i,elevationInfo:o,measurementSR:r,origin:s,mode:a}=e;if(M(t,i,o,n),(0,le.S)(n,t.spatialReference,n,r))return"geodesic"!==a&&(0,A.d)(n,n,s),n}function _i(t,e,n,i){const{view:o,measurementSR:r,spatialReference:s,origin:a,mode:l}=n;if("geodesic"===l?(0,A.c)(xi,t):(0,A.g)(xi,t,a),(0,le.S)(xi,r,xi,s))return function(t,e,n,i,o){let{z:r,m:s}=n;const{spatialReference:a,elevationInfo:l}=i;let c;if(null==r&&null==s)c=void 0;else if(null==e||"2d"===e.type)c=null!==r&&void 0!==r?r:void 0;else{var u;c=null!==(u=(0,m.zx)(e,t,a,m.jG,l))&&void 0!==u?u:0}const[h,d]=t;return o?(0,y.y)(o,h,d,c,a):o=(0,y.T)(h,d,c,a),null!=s&&(o.m=s,o.hasM=!0),o}(xi,o,e,n,i)}function yi(t,e){var n,i;return null!==(n=null===(i=function(t,e){let{view:n,origin:i,elevationInfo:o,hasZ:r,measurementSR:s}=e;if(null==t||!r)return;const a=(0,Ct.y)(s);if(null==a)return;const[l,c]=i,u=(0,ee.mE)(t,a),h="3d"===(null===n||void 0===n?void 0:n.type)?(0,m.O3)(n,l,c,u,s,o):u;return null!=h?(0,ee.yG)(h,a):void 0}(t,e))||void 0===i?void 0:i.value)&&void 0!==n?n:void 0}const mi=x(),bi=x(),xi=x(),wi=(0,y.T)(0,0,0,H.Z.WGS84);n(76046);var Ci=n(69048),Mi=n(77427),Si=n(81752),Ei=n(67750);const Ti="Control",Pi="Tab",ki="Enter",Ri="Escape",Ai="Tab",Vi={moveUp:{key:"ArrowUp",modifier:"Shift",repeats:!0},moveDown:{key:"ArrowDown",modifier:"Shift",repeats:!0},moveLeft:{key:"ArrowLeft",modifier:"Shift",repeats:!0},moveRight:{key:"ArrowRight",modifier:"Shift",repeats:!0},scaleUp:{key:"+",modifier:"Shift"},scaleDown:{key:"-",modifier:"Shift"},factorModifier:{key:Ei.C,continuePropagation:!0},toggleOpacity:"t",preserveAspectRatio:{key:"Shift",continuePropagation:!0},rotateIncrements:{key:"Shift",continuePropagation:!0},undo:"z",redo:"r"};class Ui{constructor(){this._bindings=new Map}add(t,e){return this.addToggle(t,(t=>{"key-down"===t.type&&e(t)}))}addToggle(t,e){const n=Ii.fromDefinition(t,e),i=(0,Mi.s1)(this._bindings,n.key,(()=>[]));return i.push(n),(0,a.kB)((()=>(0,xt.Od)(i,n)))}register(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Si.f.WIDGET;return(0,a.AL)([t.on("key-down",(e=>this.dispatch(t.inputManager,e)),e),t.on("key-up",(e=>this.dispatch(t.inputManager,e)),e)])}dispatch(t,e){const n=e.key,i=this._bindings.get(n);if(i)for(const o of i)o.process(t,e)}}class Ii{constructor(t,e,n,i,o){this.key=t,this.modifiers=e,this.repeats=n,this.continuePropagation=i,this.callback=o}process(t,e){if(!(e.key!==this.key||"repeat"in e&&e.repeat&&!this.repeats)){for(const e of this.modifiers)if(!t.isModifierKeyDown(e))return;this.continuePropagation||e.stopPropagation(),this.callback(e)}}static fromDefinition(t,e){if("string"==typeof t)return new Ii(t,[],!1,!1,e);const{key:n,modifier:i,repeats:o,continuePropagation:r}=t;return new Ii(n,i?Array.isArray(i)?i:[i]:[],!!o,!!r,e)}}var Oi=n(98928),Gi=n(37384);const Zi="esri-tooltip",Li="".concat(Zi,"-content"),Di="".concat(Zi,"-content--input"),zi="".concat(Zi,"-content__header"),Hi="".concat(Zi,"-content__header__spacer"),Ni="".concat(Zi,"-content__header__actions"),Fi="".concat(Zi,"-draw-header-actions"),ji="".concat(Zi,"-table"),Yi="".concat(Zi,"-help-message"),Bi="".concat(Zi,"-help-message__text"),Wi="".concat(Zi,"-help-message__icon");var qi=n(33565),Xi=n(80975),Ji=n(67005);const Ki="".concat(Zi,"-field"),Qi={base:Ki,inputMode:"".concat(Ki,"--input"),title:"".concat(Ki,"__title"),value:"".concat(Ki,"__value")};let $i=class extends qi.Z{constructor(){super(...arguments),this.hidden=!1,this.mode="feedback"}render(){return(0,Ji.u)("div",{class:this.classes({[Qi.base]:!0,[Qi.inputMode]:"input"===this.mode})},(0,Ji.u)("div",{class:Qi.title,key:"title"},this.title),(0,Ji.u)("div",{class:Qi.value,key:"value"},this.value))}};(0,r._)([(0,u.Cb)()],$i.prototype,"hidden",void 0),(0,r._)([(0,u.Cb)()],$i.prototype,"mode",void 0),(0,r._)([(0,u.Cb)()],$i.prototype,"title",void 0),(0,r._)([(0,u.Cb)()],$i.prototype,"value",void 0),$i=(0,r._)([(0,h.j)("esri.views.interactive.tooltip.components.TooltipField")],$i);const to={base:"".concat(Zi,"-value-by-value")};let eo=class extends qi.Z{constructor(){super(...arguments),this.divider="\xd7"}render(){return(0,Ji.u)("div",{class:to.base},(0,Ji.u)("span",null,this.left),(0,Ji.u)("span",null,this.divider),(0,Ji.u)("span",null,this.right))}};(0,r._)([(0,u.Cb)()],eo.prototype,"left",void 0),(0,r._)([(0,u.Cb)()],eo.prototype,"divider",void 0),(0,r._)([(0,u.Cb)()],eo.prototype,"right",void 0),eo=(0,r._)([(0,h.j)("esri.views.interactive.tooltip.components.ValueByValue")],eo);var no=n(90193);function io(t){let e,n,i=[],o=!1;return function(){for(var r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];return o&&e===this&&function(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}(s,i)||(n=t.apply(this,s),e=this,i=s,o=!0),n}}var oo=n(66978),ro=n(99346),so=n(5163),ao=n(7575);function lo(t){var e,n,i,o,r;const s="metric";if(null==t)return s;const a=t.map,l=null!==(e=a&&"portalItem"in a?null===(n=a.portalItem)||void 0===n?void 0:n.portal:null)&&void 0!==e?e:ao.Z.getDefault();switch(null!==(i=null===(o=l.user)||void 0===o?void 0:o.units)&&void 0!==i?i:l.units){case s:return s;case"english":return"imperial"}return null!==(r=(0,Ct.yT)(t.spatialReference))&&void 0!==r?r:s}function co(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";return(0,so.VG)(t,(0,ee.nn)(e,n).value,n,i,o)}function uo(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";return(0,so.LO)(t,(0,ee.nn)(e,n).value,n,i,o)}function ho(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Xn.BV,o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];return(0,so.L4)(t.value,t.unit,t.rotationType,e,n,i,o)}function po(t,e,n,i){var o;let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";switch(i=null!==(o=i)&&void 0!==o?o:2,n){case"imperial":return function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"abbr";return(0,so.Ud)(t,e.value,e.unit,n,i)}(t,e,i,r);case"metric":return function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"abbr";return(0,so.Rd)(t,e.value,e.unit,n,i)}(t,e,i,r);default:return co(t,e,n,i,r)}}function vo(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";switch(n){case"imperial":return function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"abbr";return(0,so.q6)(t,e.value,e.unit,n,i)}(t,e,i,o);case"metric":return function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"abbr";return(0,so.mg)(t,e.value,e.unit,n,i)}(t,e,i,o);default:return uo(t,e,n,i,o)}}function fo(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";switch(n){case"imperial":return function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"abbr";return(0,so.Zv)(t,e.value,e.unit,n,i)}(t,e,i,o);case"metric":return function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"abbr";return(0,so.Wv)(t,e.value,e.unit,n,i)}(t,e,i,o);default:return co(t,e,n,i,o)}}function go(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";switch(n){case"imperial":return function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"abbr";return(0,so.aC)(t,e.value,e.unit,n,i)}(t,e,i,o);case"metric":return function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"abbr";return(0,so.h9)(t,e.value,e.unit,n,i)}(t,e,i,o);default:return uo(t,e,n,i,o)}}function _o(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";switch(n){case"imperial":return function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"abbr";return(0,so.yc)(t,e.value,e.unit,n,i)}(t,e,i,o);case"metric":return function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"abbr";return(0,so.ld)(t,e.value,e.unit,n,i)}(t,e,i,o);default:return co(t,e,n,i,o)}}const yo=1,mo=6;function bo(t,e){return{angleRelative:xo,direction:wo,directionRelative:Co,directionRelativeBilateral:Mo,latitudeDecimalDegrees:Eo,longitudeDecimalDegrees:So,area:(n,i)=>_o(t,n,null!==i&&void 0!==i?i:e.area),length:(n,i,o)=>po(t,n,null!==i&&void 0!==i?i:e.length,o),lengthRelative:(n,i)=>vo(t,n,null!==i&&void 0!==i?i:e.length),totalLength:(n,i)=>po(t,n,null!==i&&void 0!==i?i:e.length),verticalLength:(n,i)=>fo(t,n,null!==i&&void 0!==i?i:e.verticalLength),verticalLengthRelative:(n,i)=>go(t,n,null!==i&&void 0!==i?i:e.verticalLength),percentage:ko,scalar:Ao,scale:Ro}}function xo(t){return(0,pt.uf)(t,(0,o.Z)({signDisplay:"exceptZero"},Vo(yo)))}function wo(t){return ho(t,t.rotationType,yo)}function Co(t){const e=ii(t);return(0,pt.uf)(e,(0,o.Z)({style:"unit",unitDisplay:"narrow",unit:"degree",signDisplay:e>0?"never":"exceptZero"},Vo(yo)))}function Mo(t){return ho(t,t.rotationType,yo)}function So(t){return To(t,Ho)}function Eo(t){return To(t,No)}function To(t,e){return ho((0,ee.nn)(t,"degrees"),"geographic",mo,e,!1)}function Po(t,e){const n=e.normalize((0,ee.nn)(t,"degrees").value,void 0,!1);return Ao((0,ee.M1)(n),mo)}function ko(t){return(0,pt.uf)(t.value,{style:"percent"})}function Ro(t){return(0,pt.uf)(t,{style:"percent",maximumFractionDigits:0})}function Ao(t,e){return(0,pt.uf)(t.value,Vo(e))}function Vo(t){return{minimumFractionDigits:t,maximumFractionDigits:t}}function Uo(t){let{createQuantity:e,sanitize:n}=t;return(t,i)=>{if(null==t)return null;n&&(t=n(t));const o=(0,pt.p3)(t);return null==o?null:e(o,i)}}function Io(t){return t.replaceAll(/[*^~\xb0\xba]/g,"")}const Oo=t=>{let e="[-+]?[0-9".concat(t.thousands,"]+");return""!==t.decimal&&(e+="".concat(t.decimal,"[0-9]+")),new RegExp("^(".concat(e,"\\s*)").concat(t.separator,"(\\s*").concat(e,")$"),"i")},Go=[];for(const yc of[",","\\|","\\s+"])for(const t of["\\.",",",""])for(const e of["",",","\\.","\u202f","\\s+"])yc!==t&&yc!==e&&t!==e&&Go.push({separator:yc,decimal:t,thousands:e,pattern:Oo({decimal:t,thousands:e,separator:yc})});function Zo(t,e,n){let i=t.replaceAll(/[\s+]/g,"");return""!==n&&(i=i.replaceAll(n,"")),""!==e&&(i=i.replaceAll(e,".")),i}function Lo(t){return zo(function(t){var e,n,i,o,r;return t&&vt()&&null!==(e=null!==(n=null!==(i=(0,pt.p3)(t))&&void 0!==i?i:null===(o=ft("0\xb0 0' 0\" N | ".concat(t)))||void 0===o?void 0:o.longitude)&&void 0!==n?n:null===(r=ft("0 | ".concat(t)))||void 0===r?void 0:r.longitude)&&void 0!==e?e:null}(t))}function Do(t){return zo(function(t){var e,n,i,o,r;return t&&vt()&&null!==(e=null!==(n=null!==(i=(0,pt.p3)(t))&&void 0!==i?i:null===(o=ft("".concat(t," | 0\xb0 0' 0\" E")))||void 0===o?void 0:o.latitude)&&void 0!==n?n:null===(r=ft("".concat(t," | 0")))||void 0===r?void 0:r.latitude)&&void 0!==e?e:null}(t))}function zo(t){return null!=t?(0,ee.GJ)(t,"degrees","geographic"):null}const Ho=new Xn.pE(-180,180),No=new Xn.pE(-90,90);var Fo=n(8905),jo=n(80532);const Yo=Symbol("dragHandles");let Bo=class extends qi.Z{constructor(){super(...arguments),this._focusAbortController=new AbortController,this._transitionInfo=null,this._mode="feedback",this._getFormatters=io(bo),this._onHeaderPointerDown=t=>{var e;const n=t.target;n instanceof HTMLElement&&"calcite-button"!==(null===n||void 0===n||null===(e=n.tagName)||void 0===e?void 0:e.toLowerCase())&&(this.removeHandles(Yo),n.setPointerCapture(t.pointerId),this.tooltip.onDragStart(t.clientX,t.clientY),this.addHandles([(0,Oi.on)(n,"pointermove",(t=>{let{clientX:e,clientY:n}=t;this.tooltip.onDrag(e,n)})),(0,Oi.on)(n,["pointerup","pointercancel"],(e=>{this.removeHandles(Yo),n.releasePointerCapture(t.pointerId),this.tooltip.onDragEnd()})),(0,Oi.on)(n,"touchstart",(t=>t.preventDefault()))],Yo))},this._onDiscard=()=>{this.destroyed||(this.tooltip.emit("discard"),this.info.clearInputValues(),this.exitInputMode())},this._onCommit=(t,e)=>{if(this.destroyed)return;if(this.tooltip.emit("commit",{type:e}),"commit-and-exit"===e)return void this.exitInputMode();if("commit-on-blur"===e)return;const n=this._getFocusableElements(),i=n.length,o=n.indexOf(t);if(-1===o)return void this.exitInputMode();const r=((o+("commit-and-next"===e?1:-1))%i+i)%i;Wo(n.at(r))},this._onKeyDown=t=>{switch(t.code){case Ai:return this._onNextKey(t);case Ri:return t.stopPropagation(),this._onDiscard()}}}get mode(){return this._mode}get _displayUnits(){var t,e,n;const{displayUnits:i}=this.info.sketchOptions.values,o=lo(this.tooltip.view);return{length:null!==(t=i.length)&&void 0!==t?t:o,verticalLength:null!==(e=i.verticalLength)&&void 0!==e?e:o,area:null!==(n=i.area)&&void 0!==n?n:o}}get _inputUnitInfos(){var t,e,n;const i=this._messagesUnits,o=t=>({unit:t,abbreviation:(0,so.Qv)(i,t,"abbr")}),{inputUnits:r}=this.info.sketchOptions.values,s=lo(this.tooltip.view),a=null!==(t=r.length)&&void 0!==t?t:s,l=null!==(e=r.verticalLength)&&void 0!==e?e:s,c=null!==(n=r.area)&&void 0!==n?n:s;return{length:o((0,Ct.h8)(a)),verticalLength:o((0,Ct.up)(l)),area:o((0,Ct.V7)(c)),angle:o("degrees")}}get _formatters(){return this._getFormatters(this._messagesUnits,this._displayUnits)}get fieldContext(){return{formatters:this._formatters,inputUnitInfos:this._inputUnitInfos,messages:this._messagesTooltip,sketchOptions:this.info.sketchOptions,onCommit:this._onCommit,onDiscard:this._onDiscard}}render(){const{visibleElements:t}=this.info.sketchOptions.tooltips,e=this._renderedContent,n=this._renderedActions,i=this._renderedHelpMessage,o=e.length>0,r=o||!!i,s="input"===this.mode;return(0,Ji.u)("div",{class:(0,Xi.Sh)(Li,s&&Di),onkeydown:this._onKeyDown,tabIndex:-1},s&&r&&t.header?(0,Ji.u)("div",{class:zi,"data-testid":"tooltip-header",key:"header",onpointerdown:this._onHeaderPointerDown},(0,Ji.u)("calcite-button",{appearance:"transparent","data-testid":"tooltip-back-button",iconFlipRtl:"both",iconStart:"chevron-left",key:"discard-button",kind:"neutral",onclick:this._onDiscard,scale:"s",tabIndex:-1}),n.length>0?(0,Ji.u)(Ji.D,null,(0,Ji.u)("div",{class:Hi,key:"spacer"}),(0,Ji.u)("div",{class:Ni,key:"actions"},n)):null):null,o?(0,Ji.u)("div",{class:ji,key:"content"},...e):null,i)}destroy(){var t;this._focusAbortController.abort(),null===(t=this._transitionInfo)||void 0===t||t.transition.skipTransition()}_renderActions(){return null}loadDependencies(){return(0,Fo.h)({button:()=>n.e(2275).then(n.bind(n,32275)),icon:()=>n.e(7474).then(n.bind(n,87474)),input:()=>n.e(5655).then(n.bind(n,75655))})}async enterInputMode(t,e){try{await this._transitionTo("input",e),await this._focusField(t)}catch(n){(0,oo.H9)(n)}}async exitInputMode(){let{focusOnView:t=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{var e;const{container:n,info:i}=this;i.clearInputValues();const o=t?null===n||void 0===n||null===(e=n.closest(".esri-view"))||void 0===e?void 0:e.querySelector(".esri-view-surface"):null;await this._transitionTo("feedback"),o instanceof HTMLElement&&o.focus()}catch(n){(0,oo.H9)(n)}}_onNextKey(t){const e=this._getFocusableElements(),n=e.at(0),i=e.at(-1);n&&i&&(t.shiftKey?document.activeElement===n&&(t.preventDefault(),t.stopPropagation(),Wo(i)):document.activeElement===i&&(t.preventDefault(),t.stopPropagation(),Wo(n)))}get _renderedContent(){return qo(this._renderContent())}get _renderedActions(){return qo(this._renderActions())}get _renderedHelpMessage(){var t,e;const{sketchOptions:n,visibleElements:i}=this.info;if(!i.helpMessage)return null;const o=null!==(t=n.tooltips.helpMessage)&&void 0!==t?t:this._defaultHelpMessage;if(!o)return null;const r=null!==(e=n.tooltips.helpMessageIcon)&&void 0!==e?e:"information";return(0,Ji.u)("div",{class:Yi,key:"help-message"},r?(0,Ji.u)("calcite-icon",{class:Wi,icon:r,scale:"s"}):null,(0,Ji.u)("div",{class:Bi},o))}get _defaultHelpMessage(){var t;const{helpMessage:e,viewType:n}=this.info;if(null==e)return null;const i="3d"===n?"helpMessages3d":"helpMessages2d";return null===(t=this._messagesTooltip)||void 0===t||null===(t=t.sketch)||void 0===t||null===(t=t[i])||void 0===t?void 0:t[e]}async _focusField(t){var e;null!==(e=this._focusAbortController)&&void 0!==e&&e.abort(),this._focusAbortController=new AbortController;const{signal:n}=this._focusAbortController;await this._waitForInputs(),(0,oo.k_)(n);const i=this._getFocusableInputs(),o=t?i.find((e=>e.getAttribute("data-field-name")===t)):i.at(0);await Wo(o)}async _transitionTo(t,e){var n,i,o;if(this._mode===t&&!this._transitionInfo)return;if((null===(n=this._transitionInfo)||void 0===n?void 0:n.mode)===t)return this._transitionInfo.transition.finished;null===(i=this._transitionInfo)||void 0===i||i.transition.skipTransition();const r=async()=>{this.destroyed||(this._mode=t,await(0,ro.Yn)(),this.destroyed||(this.renderNow(),await(0,ro.Yn)(),this.destroyed||null===e||void 0===e||e()))};if(null===(o=this.domNode)||void 0===o||!o.firstChild||!document.startViewTransition||(0,no.n)())return void await r();this.autoRenderingEnabled=!1;const s=this._transitionInfo={transition:document.startViewTransition((async()=>{this.destroyed||s!==this._transitionInfo||(this.autoRenderingEnabled=!0,await r())})),mode:t};try{await s.transition.finished}finally{s===this._transitionInfo&&(this._transitionInfo=null)}}async _waitForInputs(){const t=()=>{var t,e;return Array.from(null!==(t=null===(e=this.domNode)||void 0===e?void 0:e.querySelectorAll("calcite-input"))&&void 0!==t?t:[])};for(;0===t().length;)await(0,oo.e4)(Xo);await(0,ro.JM)()}_getFocusableInputs(){var t,e;return Array.from(null!==(t=null===(e=this.domNode)||void 0===e?void 0:e.querySelectorAll("calcite-input:not([read-only]):not([disabled])"))&&void 0!==t?t:[])}_getFocusableElements(){var t,e;const n=null===(t=this.domNode)||void 0===t?void 0:t.querySelector(".".concat(Fi));return[...Array.from(null!==(e=null===n||void 0===n?void 0:n.querySelectorAll(".".concat(Ni," calcite-button:not([disabled])")))&&void 0!==e?e:[]),...this._getFocusableInputs()]}};async function Wo(t){await(null===t||void 0===t?void 0:t.setFocus())}function qo(t){return(Array.isArray(t)?t:[t]).flat(10).filter((t=>!!t))}(0,r._)([(0,jo.H)("esri/core/t9n/Units"),(0,u.Cb)()],Bo.prototype,"_messagesUnits",void 0),(0,r._)([(0,jo.H)("esri/views/interactive/tooltip/t9n/Tooltip"),(0,u.Cb)()],Bo.prototype,"_messagesTooltip",void 0),(0,r._)([(0,u.Cb)()],Bo.prototype,"info",void 0),(0,r._)([(0,u.Cb)()],Bo.prototype,"tooltip",void 0),(0,r._)([(0,u.Cb)()],Bo.prototype,"_mode",void 0),(0,r._)([(0,u.Cb)()],Bo.prototype,"mode",null),(0,r._)([(0,u.Cb)()],Bo.prototype,"_displayUnits",null),(0,r._)([(0,u.Cb)()],Bo.prototype,"_inputUnitInfos",null),(0,r._)([(0,u.Cb)()],Bo.prototype,"_formatters",null),(0,r._)([(0,u.Cb)()],Bo.prototype,"fieldContext",null),(0,r._)([(0,u.Cb)()],Bo.prototype,"_renderedContent",null),(0,r._)([(0,u.Cb)()],Bo.prototype,"_renderedActions",null),(0,r._)([(0,u.Cb)()],Bo.prototype,"_renderedHelpMessage",null),(0,r._)([(0,u.Cb)()],Bo.prototype,"_defaultHelpMessage",null),Bo=(0,r._)([(0,h.j)("esri.views.interactive.tooltip.content.TooltipContent")],Bo);const Xo=20;let Jo=class extends Bo{_renderContent(){const{area:t,radius:e,xSize:n,ySize:i,visibleElements:o}=this.info,r=this._messagesTooltip.sketch,s=this._formatters;return(0,Ji.u)(Ji.D,null,o.radius&&null!=e?(0,Ji.u)($i,{title:r.radius,value:s.length(e)}):null,o.size&&null!=n&&null!=i?(0,Ji.u)($i,{title:r.size,value:(0,Ji.u)(eo,{left:s.length(n),right:s.length(i)})}):null,o.area?(0,Ji.u)($i,{title:r.area,value:s.area(t)}):null)}};Jo=(0,r._)([(0,h.j)("esri.views.interactive.tooltip.content.TooltipContentDrawCircle")],Jo);const Ko="".concat(Zi,"-editable-field"),Qo={base:Ko,inputMode:"".concat(Ko,"--input"),feedbackMode:"".concat(Ko,"--feedback"),readOnly:"".concat(Ko,"--read-only"),locked:"".concat(Ko,"--locked"),title:"".concat(Ko,"__title"),value:"".concat(Ko,"__value"),valueContent:"".concat(Ko,"__value__content"),valueContentReadOnly:"".concat(Ko,"__value__content--read-only"),lockIcon:"".concat(Ko,"__lock-icon"),input:"".concat(Ko,"__input"),inputSuffix:"".concat(Ko,"__input-suffix"),button:"".concat(Ko,"__button")},$o="lock",tr="unlock";let er=class extends qi.Z{constructor(){super(...arguments),this._input=null,this._lock=null,this._onLockClick=()=>{this.field.toggleLock(this.context)},this._onLockAfterCreate=t=>{this._lock=t},this._onLockAfterRemoved=()=>{this._lock=null},this._onKeyDown=t=>{t.key===Ri&&"input"===this.mode&&this._input&&this.context.onDiscard(this._input)},this._onInputKeyDown=t=>{const e=this._input;if(e)switch(t.key){case ki:return this.field.onCommit("commit-and-exit",e,this.context);case Ai:{t.preventDefault(),t.stopPropagation();const n=t.shiftKey?"commit-and-previous":"commit-and-next";return this.field.onCommit(n,e,this.context)}}},this._onInput=t=>{this.field.onInput(t.target.value)},this._onInputBlur=t=>{const e=this._input;e&&t.relatedTarget!==this._lock&&this.field.onCommit("commit-on-blur",e,this.context)},this._selectText=()=>{const t=()=>{var t;this._input===document.activeElement&&(null===(t=this._input)||void 0===t||t.selectText())};t(),(0,ro.JM)().then(t)},this._onAfterCreate=t=>{this._input=t,t.addEventListener("paste",this._onPaste),t.addEventListener("beforeinput",this._onBeforeInput)},this._onAfterRemoved=t=>{t.removeEventListener("paste",this._onPaste),t.removeEventListener("beforeinput",this._onBeforeInput)},this._onPaste=t=>{var e;const n=null===(e=t.clipboardData)||void 0===e?void 0:e.getData("text");n&&null!=this.field.parse(n,this.context)&&(t.stopPropagation(),this.field.onInput(n))},this._onBeforeInput=t=>{("historyUndo"===t.inputType||"historyRedo"===t.inputType)&&!this.field.dirty&&t.preventDefault()}}initialize(){this.addHandles((0,c.YP)((()=>this._rawDisplayValue),(()=>{const{committed:t,inputValue:e}=this.field;t||e||this._input!==document.activeElement||this._selectText()})))}loadDependencies(){return(0,Fo.h)({button:()=>n.e(2275).then(n.bind(n,32275)),icon:()=>n.e(7474).then(n.bind(n,87474)),input:()=>n.e(5655).then(n.bind(n,75655))})}render(){const{field:t,mode:e}=this,n="input"===e,{locked:i,readOnly:o}=t;return(0,Ji.u)("div",{class:this.classes({[Qo.base]:!0,[Qo.feedbackMode]:"feedback"===e,[Qo.inputMode]:"input"===e,[Qo.locked]:i,[Qo.readOnly]:o})},(0,Ji.u)("div",{class:Qo.title,key:"title"},this._title),(0,Ji.u)("div",{class:Qo.value,key:"value",onkeydown:this._onKeyDown},n?this._renderValueInputMode():this._renderValueFeedbackMode()))}get _formattedValue(){return this.field.getFormattedValue(this.context)||nr}get _rawDisplayValue(){return this.field.getRawDisplayValue(this.context)}get _suffix(){return this.field.getSuffix(this.context)}get _title(){const{title:t}=this.field;return"string"==typeof t?t:t(this.context)}_renderValueFeedbackMode(){return(0,Ji.u)(Ji.D,null,(0,Ji.u)("div",{class:Qo.valueContent,key:"value-feedback"},this._formattedValue),this.field.locked&&"input"!==this.mode?(0,Ji.u)("calcite-icon",{class:Qo.lockIcon,icon:$o,key:"icon",scale:"s"}):null)}_renderValueInputMode(){return this.field.readOnly?this._renderValueReadOnly():this._renderValueWritable()}_renderValueReadOnly(){return(0,Ji.u)("div",{class:this.classes(Qo.valueContent,Qo.valueContentReadOnly),key:"value-read-only"},this._formattedValue)}_renderValueWritable(){var t,e,n;const{field:i}=this,{name:o,invalid:r,locked:s}=i,a=null!==(t=null===(e=this.context)||void 0===e?void 0:e.messages.sketch)&&void 0!==t?t:{},l=s?a.unlockConstraint:a.lockConstraint;return(0,Ji.u)(Ji.D,null,(0,Ji.u)("calcite-input",{afterCreate:this._onAfterCreate,afterRemoved:this._onAfterRemoved,class:Qo.input,"data-field-name":o,"data-testid":"tooltip-field-".concat(o),key:"input",onblur:this._onInputBlur,onfocus:this._selectText,onkeydown:this._onInputKeyDown,scale:"s",status:r?"invalid":"idle",type:"text",value:null!==(n=this._rawDisplayValue)&&void 0!==n?n:nr,onCalciteInputInput:this._onInput}),(0,Ji.u)("div",{class:Qo.inputSuffix,key:"suffix"},this._suffix),i.lockable?(0,Ji.u)("calcite-button",{afterCreate:this._onLockAfterCreate,afterRemoved:this._onLockAfterRemoved,alignment:"center",appearance:"transparent",class:Qo.button,"data-testid":"tooltip-field-".concat(o,"-lock"),iconStart:s?$o:tr,key:"lock",kind:"neutral",label:l,onclick:this._onLockClick,scale:"s",tabIndex:-1,title:l}):(0,Ji.u)("div",{key:"lock-empty"}))}};(0,r._)([(0,u.Cb)()],er.prototype,"field",void 0),(0,r._)([(0,u.Cb)()],er.prototype,"context",void 0),(0,r._)([(0,u.Cb)()],er.prototype,"mode",void 0),(0,r._)([(0,u.Cb)()],er.prototype,"_input",void 0),(0,r._)([(0,u.Cb)()],er.prototype,"_lock",void 0),(0,r._)([(0,u.Cb)()],er.prototype,"_formattedValue",null),(0,r._)([(0,u.Cb)()],er.prototype,"_rawDisplayValue",null),(0,r._)([(0,u.Cb)()],er.prototype,"_suffix",null),(0,r._)([(0,u.Cb)()],er.prototype,"_title",null),er=(0,r._)([(0,h.j)("esri.views.interactive.tooltip.components.TooltipEditableField")],er);const nr="\u2014";function ir(t){const e=t.fields.filter((t=>!0===(null===t||void 0===t?void 0:t.visible)));return 0===e.length?null:(0,Ji.u)(Ji.D,null,e.map((e=>(0,Ji.u)(er,{context:t.context,field:e,key:e.id,mode:t.mode}))))}let or=class extends Bo{_renderContent(){const{fieldContext:t,info:e,mode:n}=this,{visibleElements:i}=e;return(0,Ji.u)(ir,{context:t,fields:[i.coordinates?e.effectiveX:void 0,i.coordinates?e.effectiveY:void 0,i.elevation?e.elevation:void 0,i.orientation?e.orientation:void 0,i.scale?e.scale:void 0],mode:n})}};or=(0,r._)([(0,h.j)("esri.views.interactive.tooltip.content.TooltipContentDrawMesh")],or);let rr=class extends Bo{_renderContent(){const{fieldContext:t,info:e,mode:n}=this,{elevation:i,visibleElements:o}=e;return(0,Ji.u)(ir,{context:t,fields:[o.coordinates?e.effectiveX:void 0,o.coordinates?e.effectiveY:void 0,o.elevation?i:void 0],mode:n})}};rr=(0,r._)([(0,h.j)("esri.views.interactive.tooltip.content.TooltipContentDrawPoint")],rr);const sr={absolute:"absolute-direction",relative:"relative-direction"};let ar=class extends qi.Z{constructor(t){super(t),this.visibleElements={}}render(){return(0,Ji.u)("div",{class:Fi},this._isElementVisible("direction")?(0,Ji.u)(lr,{messages:this.messages,sketchOptions:this.sketchOptions}):null)}loadDependencies(){return(0,Fo.h)({button:()=>n.e(2275).then(n.bind(n,32275)),dropdown:()=>n.e(3001).then(n.bind(n,43001)),"dropdown-item":()=>n.e(9784).then(n.bind(n,19784)),"dropdown-group":()=>n.e(9992).then(n.bind(n,89992))})}_isElementVisible(t){var e,n;return null!==(e=null===(n=this.visibleElements)||void 0===n?void 0:n[t])&&void 0!==e?e:this.sketchOptions.tooltips.visibleElements[t]}};function lr(t){var e,n,i,o;const{directionMode:r}=t.sketchOptions.values,s=null===(e=t.messages)||void 0===e?void 0:e.sketch,a=null===s||void 0===s||null===(n=s.directionModeSelect)||void 0===n?void 0:n.title,l="absolute",c="relative";return(0,Ji.u)("calcite-dropdown",{key:"direction-mode",placement:"bottom-end",scale:"s",widthScale:"s",onCalciteDropdownSelect:e=>{var n;const i=null===(n=e.target.selectedItems)||void 0===n||null===(n=n[0])||void 0===n?void 0:n.getAttribute("data-mode");t.sketchOptions.values.directionMode=null!==i&&void 0!==i?i:"absolute"}},(0,Ji.u)("calcite-button",{alignment:"end",appearance:"transparent",iconStart:sr[r],kind:"neutral",label:a,scale:"s",slot:"trigger",title:a}),(0,Ji.u)("calcite-dropdown-group",{selectionMode:"single"},(0,Ji.u)("calcite-dropdown-item",{"data-mode":c,"data-testid":"tooltip-direction-mode-relative",iconStart:sr.relative,key:"relative",selected:r===c},null===s||void 0===s||null===(i=s.directionModeSelect)||void 0===i?void 0:i.relative),(0,Ji.u)("calcite-dropdown-item",{"data-mode":l,"data-testid":"tooltip-direction-mode-absolute",iconStart:sr.absolute,key:"absolute",selected:r===l},null===s||void 0===s||null===(o=s.directionModeSelect)||void 0===o?void 0:o.absolute)))}(0,r._)([(0,jo.H)("esri/views/interactive/tooltip/t9n/Tooltip"),(0,u.Cb)()],ar.prototype,"messages",void 0),(0,r._)([(0,u.Cb)()],ar.prototype,"sketchOptions",void 0),(0,r._)([(0,u.Cb)()],ar.prototype,"visibleElements",void 0),ar=(0,r._)([(0,h.j)("esri.views.interactive.tooltip.components.DrawHeaderActions")],ar);let cr=class extends Bo{_renderContent(){const{fieldContext:t,info:e,mode:n}=this,{xyMode:i,visibleElements:o}=e;return(0,Ji.u)(ir,{context:t,fields:[..."direction-distance"===i?[o.direction?e.direction:void 0,o.distance?e.distance:void 0]:[o.coordinates?e.effectiveX:void 0,o.coordinates?e.effectiveY:void 0],o.elevation?e.elevation:void 0,o.area?e.area:void 0],mode:n})}_renderActions(){const{xyMode:t,sketchOptions:e}=this.info;return(0,Ji.u)(ar,{sketchOptions:e,visibleElements:{direction:"direction-distance"===t}})}};cr=(0,r._)([(0,h.j)("esri.views.interactive.tooltip.content.TooltipContentDrawPolygon")],cr);let ur=class extends Bo{_renderContent(){const{fieldContext:t,info:e,mode:n}=this,{xyMode:i,visibleElements:o}=e;return(0,Ji.u)(ir,{context:t,fields:[..."direction-distance"===i?[o.direction?e.direction:void 0,o.distance?e.distance:void 0]:[o.coordinates?e.effectiveX:void 0,o.coordinates?e.effectiveY:void 0],o.elevation?e.elevation:void 0,o.totalLength?e.totalLength:void 0],mode:n})}_renderActions(){const{xyMode:t,sketchOptions:e}=this.info;return(0,Ji.u)(ar,{sketchOptions:e,visibleElements:{direction:"direction-distance"===t}})}};ur=(0,r._)([(0,h.j)("esri.views.interactive.tooltip.content.TooltipContentDrawPolyline")],ur);let hr=class extends Bo{_renderContent(){const{area:t,xSize:e,ySize:n,visibleElements:i}=this.info,o=this._messagesTooltip.sketch,r=this._formatters;return(0,Ji.u)(Ji.D,null,i.size&&null!=e&&null!=n?(0,Ji.u)($i,{title:o.size,value:(0,Ji.u)(eo,{left:r.length(e),right:r.length(n)})}):null,i.area?(0,Ji.u)($i,{title:o.area,value:r.area(t)}):null)}};hr=(0,r._)([(0,h.j)("esri.views.interactive.tooltip.content.TooltipContentDrawRectangle")],hr);let dr=class extends Bo{_renderContent(){const{angle:t,visibleElements:e}=this.info,n=this._messagesTooltip.sketch;return(0,Ji.u)(Ji.D,null,e.rotation?(0,Ji.u)($i,{title:n.rotation,value:this._formatters.angleRelative(t)}):null)}};dr=(0,r._)([(0,h.j)("esri.views.interactive.tooltip.content.TooltipContentExtentRotate")],dr);let pr=class extends Bo{_renderContent(){const t=this.info,{visibleElements:e}=t,n=this._messagesTooltip.sketch,i=this._formatters;return(0,Ji.u)(Ji.D,null,e.size?(0,Ji.u)($i,{title:n.size,value:(0,Ji.u)(eo,{left:i.length(t.xSize),right:i.length(t.ySize)})}):null,e.scale?(0,Ji.u)($i,{title:n.scale,value:(0,Ji.u)(eo,{left:i.scale(t.xScale),right:i.scale(t.yScale)})}):null)}};pr=(0,r._)([(0,h.j)("esri.views.interactive.tooltip.content.TooltipContentExtentScale")],pr);let vr=class extends Bo{_renderContent(){const{fieldContext:t,info:e,mode:n}=this,{visibleElements:i}=e;return(0,Ji.u)(ir,{context:t,fields:[i.coordinates?e.effectiveX:void 0,i.coordinates?e.effectiveY:void 0,i.elevation?e.elevation:void 0],mode:n})}};vr=(0,r._)([(0,h.j)("esri.views.interactive.tooltip.content.TooltipContentMovePoint")],vr);let fr=class extends Bo{_renderContent(){const{fieldContext:t,info:e,mode:n}=this,{visibleElements:i}=e;return(0,Ji.u)(ir,{context:t,fields:[i.distance?e.distance:void 0,i.area?e.area:void 0,i.totalLength?e.totalLength:void 0],mode:n})}};fr=(0,r._)([(0,h.j)("esri.views.interactive.tooltip.content.TooltipContentReshapeEdgeOffset")],fr);let gr=class extends Bo{_renderContent(){const{fieldContext:t,info:e,mode:n}=this,{visibleElements:i}=e;return(0,Ji.u)(ir,{context:t,fields:[i.coordinates?e.effectiveX:void 0,i.coordinates?e.effectiveY:void 0,i.elevation?e.elevation:void 0,i.area&&"polygon"===e.geometryType?e.area:null,i.totalLength&&"polyline"===e.geometryType?e.totalLength:null],mode:n})}};gr=(0,r._)([(0,h.j)("esri.views.interactive.tooltip.content.TooltipContentSelectedVertex")],gr);let _r=class extends Bo{_renderContent(){const{fieldContext:t,info:e,mode:n}=this,{visibleElements:i}=e;return(0,Ji.u)(ir,{context:t,fields:[i.coordinates?e.effectiveX:void 0,i.coordinates?e.effectiveY:void 0,i.elevation?e.elevation:void 0,i.orientation?e.orientation:void 0,i.scale?e.scale:void 0],mode:n})}};_r=(0,r._)([(0,h.j)("esri.views.interactive.tooltip.content.TooltipContentTransformMesh")],_r);let yr=class extends Bo{_renderContent(){const{fieldContext:t,info:e,mode:n}=this,{visibleElements:i}=e;return(0,Ji.u)(ir,{context:t,fields:[i.coordinates?e.effectiveX:void 0,i.coordinates?e.effectiveY:void 0,i.elevation?e.elevation:void 0,i.orientation?e.orientation:void 0,i.size?e.size:void 0],mode:n})}};yr=(0,r._)([(0,h.j)("esri.views.interactive.tooltip.content.TooltipContentTransformPoint")],yr);let mr=class extends Bo{_renderContent(){const{info:t}=this,{visibleElements:e}=t,n=this._messagesTooltip.sketch,i=this._formatters;return(0,Ji.u)(Ji.D,null,e.distance?(0,Ji.u)($i,{title:n.distance,value:i.length(t.distance)}):null)}};mr=(0,r._)([(0,h.j)("esri.views.interactive.tooltip.content.TooltipContentTranslate")],mr);let br=class extends Bo{_renderContent(){const{distance:t,elevation:e,area:n,totalLength:i,visibleElements:o}=this.info,r=this._messagesTooltip.sketch,s=this._formatters;return(0,Ji.u)(Ji.D,null,o.distance?(0,Ji.u)($i,{title:r.distance,value:s.length(t)}):null,o.elevation&&null!=(null===e||void 0===e?void 0:e.actual)?(0,Ji.u)($i,{title:r.elevation,value:s.verticalLength(e.actual)}):null,o.area&&null!=n?(0,Ji.u)($i,{title:r.area,value:s.area(n)}):null,o.totalLength&&null!=i?(0,Ji.u)($i,{title:r.totalLength,value:s.length(i)}):null)}};br=(0,r._)([(0,h.j)("esri.views.interactive.tooltip.content.TooltipContentTranslateVertex")],br);let xr=class extends Bo{_renderContent(){const{info:t}=this,{visibleElements:e}=t,n=this._messagesTooltip.sketch,i=this._formatters;return(0,Ji.u)(Ji.D,null,e.distance?(0,Ji.u)($i,{title:n.distance,value:i.length(t.distance)}):null)}};xr=(0,r._)([(0,h.j)("esri.views.interactive.tooltip.content.TooltipContentTranslateXY")],xr);let wr=class extends Bo{_renderContent(){const{info:t}=this,{visibleElements:e}=t,n=this._messagesTooltip.sketch;return(0,Ji.u)(Ji.D,null,e.distance?(0,Ji.u)($i,{title:n.distance,value:this._formatters.verticalLengthRelative(t.distance)}):null)}};wr=(0,r._)([(0,h.j)("esri.views.interactive.tooltip.content.TooltipContentTranslateZ")],wr);const Cr={base:"".concat(Zi),ltr:"".concat(Zi,"--ltr"),rtl:"".concat(Zi,"--rtl"),debug:"".concat(Zi,"--debug")};let Mr=class extends ut.Z.EventedAccessor{constructor(t){super(t),this.info=null,this.options=null,this.position=null,this.content=null,this._focused=!1,this.outerContainer=document.createElement("div"),this.debug=!1,this._lastPosition=null,this._rtl=!1,this._prevXY=[0,0]}initialize(){const{outerContainer:t}=this;this.addHandles([(0,c.YP)((()=>{var t;return null===(t=this.view.overlay)||void 0===t?void 0:t.surface}),(e=>{t.remove(),null!==e&&void 0!==e&&e.appendChild(t),this._rtl=(0,Xi.dZ)(e)}),c.tX),(0,c.YP)((()=>this.info),((e,n)=>{if(null!=this.content&&null!=e&&null!=n&&e.type===n.type)this.content.info=e;else{(0,l.SC)(this.content);const n=function(t,e){if(null==e)return null;const n=document.createElement("div");switch(e.type){case"draw-point":return new rr({tooltip:t,info:e,container:n});case"draw-polygon":return new cr({tooltip:t,info:e,container:n});case"draw-polyline":return new ur({tooltip:t,info:e,container:n});case"draw-mesh":return new or({tooltip:t,info:e,container:n});case"draw-rectangle":return new hr({tooltip:t,info:e,container:n});case"draw-circle":return new Jo({tooltip:t,info:e,container:n});case"extent-rotate":return new dr({tooltip:t,info:e,container:n});case"extent-scale":return new pr({tooltip:t,info:e,container:n});case"move-point":return new vr({tooltip:t,info:e,container:n});case"selected-vertex":return new gr({tooltip:t,info:e,container:n});case"transform-point":return new yr({tooltip:t,info:e,container:n});case"transform-mesh":return new _r({tooltip:t,info:e,container:n});case"translate":return new mr({tooltip:t,info:e,container:n});case"translate-vertex":return new br({tooltip:t,info:e,container:n});case"translate-z":return new wr({tooltip:t,info:e,container:n});case"translate-xy":return new xr({tooltip:t,info:e,container:n});case"reshape-edge-offset":return new fr({tooltip:t,info:e,container:n})}}(this,e);n?(this.content=n,n.container&&t.appendChild(n.container),this.exitInputMode()):this.content=null}}),c.tX),(0,c.YP)((()=>({container:this.outerContainer,style:this._outerContainerStyle})),(t=>{let{container:e,style:n}=t;Object.assign(e.style,n)}),c.nn),(0,c.YP)((()=>({outerContainer:this.outerContainer,placement:this.effectivePlacement,effectiveOffset:this._effectiveOffset,rtl:this._rtl,debug:this.debug})),(t=>{let{outerContainer:e,placement:n,effectiveOffset:i,rtl:o,debug:r}=t;const{classList:s}=e;s.add(Cr.base),s.toggle(Cr.rtl,o),s.toggle(Cr.ltr,!o),s.toggle(Cr.debug,r),this.outerContainer.style.setProperty("--offset","".concat(i,"px")),(0,Gi.V$)(e),function(t,e){let{classList:n}=t;Sr.forEach((t=>n.remove(t))),n.add(Er(e))}(e,n)}),c.nn),(0,c.gx)((()=>"feedback"===this.mode),(()=>{this.position=null,this._clearOverride("effectivePlacement")}),c.Z_),(0,Oi.on)(this.outerContainer,"paste",(t=>{this.emit("paste",t)})),(0,Oi.on)(this.outerContainer,["focusin","focusout"],(()=>{setTimeout((()=>{var t,e;this._focused=null!==(t=null===(e=this.content)||void 0===e||null===(e=e.container)||void 0===e?void 0:e.contains(document.activeElement))&&void 0!==t&&t}))}))])}destroy(){this.info=null,this.content=(0,l.SC)(this.content),this.outerContainer.remove()}get mode(){var t,e;return null!==(t=null===(e=this.content)||void 0===e?void 0:e.mode)&&void 0!==t?t:"feedback"}get focused(){return this._focused}get visible(){return"none"!==this._outerContainerStyle.display}get contentContainer(){var t;return null===(t=this.content)||void 0===t?void 0:t.container}get effectivePlacement(){var t;const e=null===(t=this.options)||void 0===t?void 0:t.placement;return"auto"===e?"bottom-end":null!==e&&void 0!==e?e:"bottom-end"}get _screenPoint(){const{inputManager:t}=this.view;return null!==t&&void 0!==t&&t.multiTouchActive?null:null===t||void 0===t?void 0:t.latestPointerLocation}get _effectiveOffset(){var t,e;return null!==(t=null===(e=this.options)||void 0===e?void 0:e.offset)&&void 0!==t?t:20}get _outerContainerStyle(){var t;const e=null!==(t=this.position)&&void 0!==t?t:this._screenPoint;return this._lastPosition=(0,d.zF)(e),null!=e&&null!=this.content?{display:"block",transform:"translate(".concat(Math.round(e.x),"px, ").concat(Math.round(e.y),"px)")}:{display:"none",transform:"none"}}clear(){this.info=null}async enterInputMode(t){var e,n,i;const o=null!==(e=null!==(n=this.position)&&void 0!==n?n:this._lastPosition)&&void 0!==e?e:this._screenPoint,r=this.position=(0,d.zF)(o),{effectivePlacement:s}=this;this._override("effectivePlacement",s);await(null===(i=this.content)||void 0===i?void 0:i.enterInputMode(t,(()=>{r&&(this.position=function(t,e,n,i){if(!t||!i.container)return e;const o=t.getBoundingClientRect(),{left:r,top:s}=i.container.getBoundingClientRect();let{x:a,y:l}=e;const c=o.left-r-n;c<0&&(a-=c);const u=o.right-r+n-i.width;u>0&&(a-=u);const h=o.top-s-n;h<0&&(l-=h);const p=o.bottom-s+n-i.height;return p>0&&(l-=p),(0,d.vW)(a,l)}(this.contentContainer,r,this._effectiveOffset,this.view),Object.assign(this.outerContainer.style,this._outerContainerStyle))})))}async exitInputMode(t){var e;await(null===(e=this.content)||void 0===e?void 0:e.exitInputMode(t))}onDragStart(t,e){this._prevXY=[t,e]}onDrag(t,e){const n=t-this._prevXY[0],i=e-this._prevXY[1];this._prevXY=[t,e];const{position:o}=this;if(o){const{view:r}=this,s=t-r.position[0],a=e-r.position[1];if(s<0||s>r.width||a<0||a>r.height-16)return;this.position=(0,d.vW)(o.x+n,o.y+i)}}onDragEnd(){this._prevXY=[0,0]}};(0,r._)([(0,u.Cb)({nonNullable:!0})],Mr.prototype,"view",void 0),(0,r._)([(0,u.Cb)()],Mr.prototype,"info",void 0),(0,r._)([(0,u.Cb)()],Mr.prototype,"options",void 0),(0,r._)([(0,u.Cb)()],Mr.prototype,"position",void 0),(0,r._)([(0,u.Cb)()],Mr.prototype,"content",void 0),(0,r._)([(0,u.Cb)({readOnly:!0})],Mr.prototype,"mode",null),(0,r._)([(0,u.Cb)()],Mr.prototype,"_focused",void 0),(0,r._)([(0,u.Cb)({readOnly:!0})],Mr.prototype,"focused",null),(0,r._)([(0,u.Cb)({readOnly:!0})],Mr.prototype,"outerContainer",void 0),(0,r._)([(0,u.Cb)({readOnly:!0})],Mr.prototype,"contentContainer",null),(0,r._)([(0,u.Cb)({readOnly:!0})],Mr.prototype,"effectivePlacement",null),(0,r._)([(0,u.Cb)()],Mr.prototype,"debug",void 0),(0,r._)([(0,u.Cb)()],Mr.prototype,"_lastPosition",void 0),(0,r._)([(0,u.Cb)()],Mr.prototype,"_screenPoint",null),(0,r._)([(0,u.Cb)()],Mr.prototype,"_rtl",void 0),(0,r._)([(0,u.Cb)()],Mr.prototype,"_effectiveOffset",null),(0,r._)([(0,u.Cb)()],Mr.prototype,"_outerContainerStyle",null),Mr=(0,r._)([(0,h.j)("esri.views.interactive.Tooltip")],Mr);const Sr=["top","bottom","leading","trailing"].flatMap((t=>[Er("".concat(t,"-start")),Er(t),Er("".concat(t,"-end"))]));function Er(t){return"".concat(Cr.base,"--").concat(t)}const Tr=Mr;function Pr(t,e){const n=(0,Ci.zZ)(e.vertexSpace),{scale:i,orientation:o}=t,{transform:r}=e,s=function(t){if(!t)return 0;const e=kr(t.rotationAxis);return null!=e?e*t.rotationAngle:null}(r);n&&null!=s?(o.actual=(0,ee.GJ)(s,"degrees","arithmetic"),o.visible=!0):(o.actual=null,o.visible=!1),n?(i.actual=(0,ee.M1)(Ar(r)),i.visible=!0):(i.actual=null,i.visible=!1)}function kr(t){return(0,A.H)(t,g.eG)?1:(0,A.H)(t,Rr)?-1:null}const Rr=(0,A.v)((0,g.Ue)(),g.eG);function Ar(t){return t?Math.max(...t.scale):1}function Vr(t,e,n){var i;if(!e||!("geographic"in e))return;const o=null===(i=t.clipboardData)||void 0===i?void 0:i.getData("text");if(!o)return;const r=e=>{t.stopPropagation(),t.preventDefault(),null!==n&&void 0!==n&&n.onBeforePaste(),e(),null===n||void 0===n||n.onAfterPaste()};if(e.geographic){const t=function(t){if(!t||null!=(0,pt.p3)(t)||!vt())return null;const e=ft(t),n=zo(null===e||void 0===e?void 0:e.latitude),i=zo(null===e||void 0===e?void 0:e.longitude);return null!=i&&null!=n?{latitude:n,longitude:i}:null}(o);t&&r((()=>{e.longitude.applyValue(t.longitude),e.latitude.applyValue(t.latitude)}))}else{const t=function(t){for(const{decimal:e,thousands:n,pattern:i}of Go){i.lastIndex=0;const o=t.match(i);if(!o)continue;const r=(0,pt.p3)(Zo(o[1],e,n)),s=(0,pt.p3)(Zo(o[2],e,n));if(null!=r&&null!=s)return{x:(0,ee.M1)(r),y:(0,ee.M1)(s)}}return null}(o);t&&r((()=>{e.x.applyValue(t.x),e.y.applyValue(t.y)}))}}let Ur=class extends Q.Z{constructor(t){super(t),this.helpMessage=void 0,this.viewType=void 0}get visibleElements(){return this.sketchOptions.tooltips.visibleElements}get allFields(){return[]}get editableFields(){return this.allFields.filter((t=>t.visible&&!t.readOnly))}clearInputValues(){this.allFields.forEach((t=>t.clearInputValue()))}};(0,r._)([(0,u.Cb)()],Ur.prototype,"sketchOptions",void 0),(0,r._)([(0,u.Cb)()],Ur.prototype,"visibleElements",null),(0,r._)([(0,u.Cb)()],Ur.prototype,"helpMessage",void 0),(0,r._)([(0,u.Cb)()],Ur.prototype,"viewType",void 0),(0,r._)([(0,u.Cb)()],Ur.prototype,"allFields",null),(0,r._)([(0,u.Cb)()],Ur.prototype,"editableFields",null),Ur=(0,r._)([(0,h.j)("esri.views.interactive.tooltip.infos.SketchTooltipInfo")],Ur);let Ir=class extends Ur{constructor(t){super(t),this.type="draw-circle",this.radius=null,this.xSize=null,this.ySize=null,this.area=ee.MQ}get allFields(){return[]}};(0,r._)([(0,u.Cb)()],Ir.prototype,"type",void 0),(0,r._)([(0,u.Cb)()],Ir.prototype,"radius",void 0),(0,r._)([(0,u.Cb)()],Ir.prototype,"xSize",void 0),(0,r._)([(0,u.Cb)()],Ir.prototype,"ySize",void 0),(0,r._)([(0,u.Cb)()],Ir.prototype,"area",void 0),(0,r._)([(0,u.Cb)()],Ir.prototype,"allFields",null),Ir=(0,r._)([(0,h.j)("esri.views.interactive.tooltip.infos.DrawCircleTooltipInfo")],Ir);var Or=n(71907);let Gr=class extends Q.Z{constructor(t){super(t),this.actual=null,this.lockable=!0,this.id=(0,Or.DO)(),this.inputValue=null,this.readOnly=!1,this.suffix=null,this.visible=!0,this.invalid=!1,this.unlockOnVertexPlacement=!0}get committed(){return this.lockable?this._get("committed"):null}set committed(t){this.lockable&&this._set("committed",t)}get dirty(){return null!=this.inputValue}get locked(){return this.lockable&&null!=this.committed}onInput(t){this.inputValue=t}onCommit(t,e,n){this.lockable?this._onCommitLockable(t,n):this._onCommitNonLockable(n),this.invalid&&"commit-and-exit"===t||n.onCommit(e,t)}_onCommitLockable(t,e){const{inputValue:n,locked:i}=this;i&&Zr(n)?this.unlock():("commit-and-exit"===t&&!i||null!=n)&&this._parseInputAndLock(e)}_onCommitNonLockable(t){const{inputValue:e}=this;Zr(e)?this.setActual(null):null!=e&&this._parseInputAndSetActual(t)}applyValue(t){this.lockable?this.lock(t):this.setActual(t)}clearInputValue(){this.inputValue=null,this.invalid=!1}setActual(t){this.actual=t,this.clearInputValue()}lock(t){this.lockable&&(this.committed=null!==t&&void 0!==t?t:this.actual,this.clearInputValue())}unlock(){this.lockable&&(this.committed=null,this.clearInputValue())}toggleLock(t){this.lockable&&(this.locked?this.unlock():this._parseInputAndLock(t))}getSuffix(t){const{suffix:e}=this;return"function"==typeof e?e(t):e}getFormattedValue(t){const{actual:e,committed:n,format:i}=this;return null!=n?i(n,t):null!=e?i(e,t):null}getRawDisplayValue(t){const{actual:e,committed:n,inputValue:i}=this;return null!=i?i:this.lockable&&null!=n?this.formatForInputMode(n,t):null!=e?this.formatForInputMode(e,t):null}_parseInputAndSetActual(t){const{inputValue:e}=this;if(null==e||Zr(e))return this.setActual(null);const n=this.parse(e,t);null!=n?this.setActual(n):this.invalid=!0}_parseInputAndLock(t){const{inputValue:e,actual:n}=this;if(Zr(e))return this.unlock();if(null==e)return this.lock(n);const i=this.parse(e,t);null!=i?this.lock(i):this.invalid=!0}};function Zr(t){return null!=t&&""===t.trim()}(0,r._)([(0,u.Cb)()],Gr.prototype,"actual",void 0),(0,r._)([(0,u.Cb)()],Gr.prototype,"committed",null),(0,r._)([(0,u.Cb)()],Gr.prototype,"dirty",null),(0,r._)([(0,u.Cb)()],Gr.prototype,"format",void 0),(0,r._)([(0,u.Cb)()],Gr.prototype,"formatForInputMode",void 0),(0,r._)([(0,u.Cb)()],Gr.prototype,"lockable",void 0),(0,r._)([(0,u.Cb)()],Gr.prototype,"locked",null),(0,r._)([(0,u.Cb)()],Gr.prototype,"id",void 0),(0,r._)([(0,u.Cb)()],Gr.prototype,"inputValue",void 0),(0,r._)([(0,u.Cb)()],Gr.prototype,"name",void 0),(0,r._)([(0,u.Cb)()],Gr.prototype,"parse",void 0),(0,r._)([(0,u.Cb)()],Gr.prototype,"readOnly",void 0),(0,r._)([(0,u.Cb)()],Gr.prototype,"suffix",void 0),(0,r._)([(0,u.Cb)()],Gr.prototype,"title",void 0),(0,r._)([(0,u.Cb)()],Gr.prototype,"visible",void 0),(0,r._)([(0,u.Cb)()],Gr.prototype,"invalid",void 0),(0,r._)([(0,u.Cb)()],Gr.prototype,"unlockOnVertexPlacement",void 0),Gr=(0,r._)([(0,h.j)("esri.views.interactive.tooltip.fields.TooltipField")],Gr);let Lr=class extends Gr{constructor(t){super(t),this.showAsZ=!1}normalizeCtorArgs(t){const e=t=>t.inputUnitInfos.verticalLength.unit;return(0,o.Z)({name:"elevation",actual:ee.yP,parse:Uo({createQuantity:(t,n)=>(0,ee.yG)(t,e(n))}),format:(t,e)=>e.formatters.verticalLength(t),formatForInputMode:(t,n)=>n.formatters.scalar((0,ee.nn)(t,e(n))),suffix:t=>t.inputUnitInfos.verticalLength.abbreviation,title:t=>t.messages.sketch[this.showAsZ?"z":"elevation"],unlockOnVertexPlacement:!1},t)}};(0,r._)([(0,u.Cb)()],Lr.prototype,"showAsZ",void 0),Lr=(0,r._)([(0,h.j)("esri.views.interactive.tooltip.fields.TooltipFieldElevation")],Lr);let Dr=class extends Gr{constructor(t){super(t),this.precision=1}normalizeCtorArgs(t){return(0,o.Z)({name:"orientation",actual:null,parse:Uo({createQuantity:(t,e)=>(0,ee.GJ)(t,(t=>t.inputUnitInfos.angle.unit)(e),"geographic"),sanitize:Io}),format:t=>ho(ei(t),"geographic",this.precision),formatForInputMode:(t,e)=>{const n=ei(t);return e.formatters.scalar(n)},suffix:t=>t.inputUnitInfos.angle.abbreviation,title:t=>t.messages.sketch.orientation},t)}};(0,r._)([(0,u.Cb)()],Dr.prototype,"precision",void 0),Dr=(0,r._)([(0,h.j)("esri.views.interactive.tooltip.fields.TooltipFieldOrientation")],Dr);let zr=class extends Gr{constructor(t){super(t),this.precision=null}normalizeCtorArgs(t){const e=t=>t.inputUnitInfos.length.unit;return(0,o.Z)({name:"size",actual:null,parse:Uo({createQuantity:(t,n)=>(0,ee.yG)(t,e(n))}),format:(t,e)=>e.formatters.length(t),formatForInputMode:(t,n)=>n.formatters.scalar((0,ee.nn)(t,e(n))),suffix:t=>t.inputUnitInfos.length.abbreviation,title:t=>t.messages.sketch.size},t)}};function Hr(t){const e=t=>t.inputUnitInfos.angle.unit,n=t=>t.sketchOptions.values.effectiveDirectionMode;return new Gr((0,o.Z)({name:"direction",actual:ee.Ww,parse:Uo({createQuantity:(t,n)=>(0,ee.GJ)(t,e(n),"geographic"),sanitize:Io}),format:(t,e)=>{const i=n(e),o=ti(t,i);switch(i){case qn.Absolute:return e.formatters.direction(o);case qn.Relative:return e.formatters.directionRelative(o);case qn.RelativeBilateral:return e.formatters.directionRelativeBilateral(o)}},formatForInputMode:(t,i)=>{const o=ti(t,n(i));return i.formatters.scalar((0,ee.nn)(o,e(i)))},suffix:t=>t.inputUnitInfos.angle.abbreviation,title:t=>{const e=n(t),{absolute:i,relative:o}=t.messages.sketch.direction;switch(e){case qn.Absolute:return i;case qn.Relative:case qn.RelativeBilateral:return o}}},t))}function Nr(t){const e=t=>t.inputUnitInfos.length.unit;return new Gr((0,o.Z)({name:"distance",actual:ee.yP,parse:Uo({createQuantity:(t,n)=>(0,ee.yG)(Math.max(t,0),e(n))}),format:(t,e)=>e.formatters.length(t),formatForInputMode:(t,n)=>n.formatters.scalar((0,ee.nn)(t,e(n))),suffix:t=>t.inputUnitInfos.length.abbreviation,title:t=>t.messages.sketch.distance},t))}function Fr(t){return Nr((0,o.Z)({},t))}function jr(t){return new Gr((0,o.Z)({name:"x",actual:ee.Ww,parse:Lo,format:(t,e)=>e.formatters.longitudeDecimalDegrees(t),formatForInputMode:t=>function(t){return Po(t,Ho)}(t),suffix:t=>t.inputUnitInfos.angle.abbreviation,title:t=>t.messages.sketch.longitude},t))}function Yr(t){return new Gr((0,o.Z)({name:"y",actual:ee.Ww,parse:Do,format:(t,e)=>e.formatters.latitudeDecimalDegrees(t),formatForInputMode:t=>function(t){return Po(t,No)}(t),suffix:t=>t.inputUnitInfos.angle.abbreviation,title:t=>t.messages.sketch.latitude},t))}function Br(t,e){return new Gr((0,o.Z)({actual:(0,ee.M1)(0),parse:Uo({createQuantity:t=>(0,ee.M1)(t)}),format:(t,e)=>e.formatters.scalar(t),formatForInputMode:(t,e)=>e.formatters.scalar(t),title:e=>e.messages.sketch[t]},e))}(0,r._)([(0,u.Cb)()],zr.prototype,"precision",void 0),zr=(0,r._)([(0,h.j)("esri.views.interactive.tooltip.fields.TooltipFieldSize")],zr);var Wr=n(41258);function qr(t,e,n){for(var i=arguments.length,o=new Array(i>3?i-3:0),r=3;r<i;r++)o[r-3]=arguments[r];return(0,Et.Gb)(t)?e.apply(void 0,o):(0,Ut.sS)(t)?n.apply(void 0,o):null}const Xr=t=>{let e=class extends t{constructor(){super(...arguments),this.longitude=jr(),this.latitude=Yr(),this.x=function(t){return Br("x",(0,o.Z)({name:"x"},t))}(),this.y=function(t){return Br("y",(0,o.Z)({name:"y"},t))}(),this.elevation=function(t){return new Lr(t)}(),this.geographic=!1}get effectiveX(){return this.geographic?this.longitude:this.x}get effectiveY(){return this.geographic?this.latitude:this.y}get key(){return{longitude:this.longitude.actual,latitude:this.latitude.actual,x:this.x.actual,y:this.y.actual,elevation:this.elevation.actual,geographic:this.geographic}}setLocationFromPoint(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null===t||void 0===t?void 0:t.spatialReference;if(this.geographic=!!e&&function(t){return(0,Et.Gb)(t)||(0,Ut.sS)(t)}(e),null==t)return this._setActualLonLat(null,null),void this._setActualXY(null,null);if(this.geographic){const e=(0,Wr.MW)(t,Jr);this._setActualLonLat(zo(null===e||void 0===e?void 0:e[0]),zo(null===e||void 0===e?void 0:e[1]))}else this._setActualXY((0,ee.M1)(t.x),(0,ee.M1)(t.y))}_setActualLonLat(t,e){this.longitude.actual=t,this.latitude.actual=e}_setActualXY(t,e){this.x.actual=t,this.y.actual=e}};return(0,r._)([(0,u.Cb)()],e.prototype,"geographic",void 0),(0,r._)([(0,u.Cb)()],e.prototype,"effectiveX",null),(0,r._)([(0,u.Cb)()],e.prototype,"effectiveY",null),(0,r._)([(0,u.Cb)()],e.prototype,"key",null),e=(0,r._)([(0,h.j)("esri.views.interactive.tooltip.infos.TooltipInfoWithCoordinates")],e),e},Jr=[0,0];let Kr=class extends(Xr(Ur)){constructor(t){super(t),this.type="draw-mesh",this.orientation=function(t){return new Dr(t)}({lockable:!1}),this.scale=function(t){return Br("scale",(0,o.Z)({name:"scale",actual:null,parse:Uo({createQuantity:t=>(0,ee.M1)(Math.abs(t))})},t))}({lockable:!1})}get allFields(){return[this.longitude,this.latitude,this.x,this.y,this.elevation,this.orientation,this.scale]}};(0,r._)([(0,u.Cb)()],Kr.prototype,"helpMessage",void 0),(0,r._)([(0,u.Cb)()],Kr.prototype,"allFields",null),Kr=(0,r._)([(0,h.j)("esri.views.interactive.tooltip.infos.DrawMeshTooltipInfo")],Kr);let Qr=class extends(Xr(Ur)){constructor(t){super(t),this.type="draw-point"}get allFields(){return[this.longitude,this.latitude,this.x,this.y,this.elevation]}};(0,r._)([(0,u.Cb)()],Qr.prototype,"helpMessage",void 0),(0,r._)([(0,u.Cb)()],Qr.prototype,"allFields",null),Qr=(0,r._)([(0,h.j)("esri.views.interactive.tooltip.infos.DrawPointTooltipInfo")],Qr);let $r=class extends(Xr(Ur)){constructor(t){super(t),this.type="draw-polygon",this.direction=Hr(),this.distance=Fr(),this.area=function(t){const e=t=>t.inputUnitInfos.area.unit;return new Gr((0,o.Z)({name:"area",actual:ee.MQ,parse:Uo({createQuantity:(t,n)=>(0,ee.ne)(t,e(n))}),format:(t,e)=>e.formatters.area(t),formatForInputMode:(t,n)=>n.formatters.scalar((0,ee.nn)(t,e(n))),suffix:t=>t.inputUnitInfos.area.abbreviation,title:t=>t.messages.sketch.area,readOnly:!0},t))}(),this.xyMode="direction-distance"}get allFields(){return[this.direction,this.distance,this.longitude,this.latitude,this.x,this.y,this.elevation,this.area]}};(0,r._)([(0,u.Cb)()],$r.prototype,"xyMode",void 0),(0,r._)([(0,u.Cb)()],$r.prototype,"helpMessage",void 0),(0,r._)([(0,u.Cb)()],$r.prototype,"allFields",null),$r=(0,r._)([(0,h.j)("esri.views.interactive.tooltip.infos.DrawPolygonTooltipInfo")],$r);let ts=class extends(Xr(Ur)){constructor(t){super(t),this.type="draw-polyline",this.direction=Hr(),this.distance=Fr(),this.totalLength=function(t){return Nr((0,o.Z)({format:(t,e)=>e.formatters.totalLength(t),title:t=>t.messages.sketch.totalLength,readOnly:!0},t))}(),this.xyMode="direction-distance"}get allFields(){return[this.direction,this.distance,this.longitude,this.latitude,this.x,this.y,this.elevation,this.totalLength]}};(0,r._)([(0,u.Cb)()],ts.prototype,"helpMessage",void 0),(0,r._)([(0,u.Cb)()],ts.prototype,"xyMode",void 0),(0,r._)([(0,u.Cb)()],ts.prototype,"allFields",null),ts=(0,r._)([(0,h.j)("esri.views.interactive.tooltip.infos.DrawPolylineTooltipInfo")],ts);let es=class extends Ur{constructor(t){super(t),this.type="draw-rectangle",this.xSize=ee.yP,this.ySize=ee.yP,this.area=ee.MQ}get allFields(){return[]}};(0,r._)([(0,u.Cb)()],es.prototype,"type",void 0),(0,r._)([(0,u.Cb)()],es.prototype,"xSize",void 0),(0,r._)([(0,u.Cb)()],es.prototype,"ySize",void 0),(0,r._)([(0,u.Cb)()],es.prototype,"area",void 0),(0,r._)([(0,u.Cb)()],es.prototype,"allFields",null),es=(0,r._)([(0,h.j)("esri.views.interactive.tooltip.infos.DrawRectangleTooltipInfo")],es);var ns=n(79347),is=n(74702),os=n(29691);function rs(t){return(0,Ut.N$)(t)?(0,Ut.oR)(t)||(0,Ut.sS)(t)||(0,Ut.yW)(t)||(0,Mt.fY)(t)?os.wY:t:(0,os.rS)(t)}function ss(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.hasZ;const i=rs(t.spatialReference),o=(0,Ct.oq)(i);if(null==o)return null;const r=(t,e)=>!(e.length<2)&&((0,A.i)(t,e[0],e[1],n&&e[2]||0),!0);let s=0;for(const a of t.rings){const n=a.length;if(n<3)continue;const{positionsWorldCoords:o}=e;for(;o.length<n;)o.push((0,g.Ue)());const l=as,c=(0,A.i)(ls,0,0,0),u=1/n;for(let e=0;e<n;e++){if(!r(l,a[e]))return null;if(!(0,le.S)(l,t.spatialReference,o[e],i))return null;(0,A.b)(c,c,o[e],u)}const h=(0,pe.zk)(o[0],o[1],c,(0,pe.re)());if(0===(0,A.k)((0,pe.st)(h)))continue;for(let t=0;t<n;t++)(0,pe.tx)(h,c,o[t],o[t]);const d=cs(o);for(let t=0;t<d.length;t+=3)s+=(0,is.wu)(o[d[t]],o[d[t+1]],o[d[t+2]])}return(0,ee.ne)(s,o)}const as=(0,g.Ue)(),ls=(0,g.Ue)();function cs(t){return(0,ns.e)(function(t){const e=new Float64Array(2*t.length);for(let n=0;n<t.length;++n){const i=t[n],o=2*n;e[o]=i[0],e[o+1]=i[1]}return e}(t),[],2)}function us(t){return(0,ee.ne)(Math.abs((0,Et.p8)([t],"square-meters")[0]),"square-meters")}function hs(t){try{return(0,ee.ne)(Math.abs((0,At.geodesicArea)(t,"square-meters")),"square-meters")}catch(e){return null}}function ds(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{positionsWorldCoords:[]};if("on-the-ground"===e){const e=function(t){const{spatialReference:e}=t;return qr(e,us,hs,t)}(t);return null!=e?e:function(t){return ss(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{positionsWorldCoords:[]},!1)}(t,n)}return function(t){return ss(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{positionsWorldCoords:[]})}(t,n)}function ps(t){return ds(t,"on-the-ground",arguments.length>1&&void 0!==arguments[1]?arguments[1]:{positionsWorldCoords:[]})}var vs;function fs(t,e){const{hasZ:n,spatialReference:i}=t,o=rs(i);let r=0;const s=(0,Ct.j5)(o);if(null==s)return null;const a=e===vs.Direct?_s:ys;for(const l of t.paths){if(l.length<2)continue;const t=l.length-1;for(let e=0;e<t;++e){const t=l[e];bs[0]=t[0],bs[1]=t[1],bs[2]=n?t[2]:0;const o=l[e+1];xs[0]=o[0],xs[1]=o[1],xs[2]=n?o[2]:0;const s=a(bs,xs,i);if(null==s)return null;r+=s.value}}return(0,ee.yG)(r,s)}function gs(t,e){const n=(0,Ct.y)(e);return null!=n?(0,ee.yG)(null!==t&&void 0!==t?t:0,n):null}function _s(t,e,n){const i=ms(t,e,n,vs.Direct);return null!=i?(0,ee.yG)(i.direct,i.unit):null}function ys(t,e,n){const i=ms(t,e,n,vs.Horizontal);return null!=i?(0,ee.yG)(i.horizontal,i.unit):null}function ms(t,e,n,i){const o=rs(n),r=(0,Ct.j5)(o);if(null==r)return null;const s=e[2]-t[2];if(i===vs.Vertical)return{verticalSigned:s,unit:r};if(!(0,le.S)(t,n,ws,o)||!(0,le.S)(e,n,Cs,o))return null;if(i===vs.Direct)return{direct:(0,A.j)(Cs,ws),unit:r};if((0,A.i)(Ms,t[0],t[1],e[2]),!(0,le.S)(Ms,n,Ms,o))return null;const a=(0,A.j)(Ms,Cs);return i===vs.Horizontal?{horizontal:a,unit:r}:{direct:(0,A.j)(Cs,ws),horizontal:a,vertical:Math.abs(s),unit:r}}!function(t){t[t.Direct=0]="Direct",t[t.Horizontal=1]="Horizontal",t[t.Vertical=2]="Vertical"}(vs||(vs={}));const bs=(0,g.Ue)(),xs=(0,g.Ue)(),ws=(0,g.Ue)(),Cs=(0,g.Ue)(),Ms=(0,g.Ue)();function Ss(t,e){if(!(0,Ut.fS)(t.spatialReference,e.spatialReference))return null;const{spatialReference:n}=t;return As[0]=t.x,As[1]=t.y,As[2]=t.hasZ?t.z:0,Vs[0]=e.x,Vs[1]=e.y,Vs[2]=e.hasZ?e.z:0,function(t,e,n){return qr(n,Es,Ts,t,e,n)}(As,Vs,n)}function Es(t,e,n){return(0,ee.yG)((0,Et.cA)(Rs,t,e,n).distance,"meters")}function Ts(t,e,n){return(0,ee.yG)((0,At.geodesicLength)(function(t,e,n){return{type:"polyline",spatialReference:n,paths:[[[...t],[...e]]]}}(t,e,n),"meters"),"meters")}function Ps(t){return(0,ee.yG)((0,Et.Jf)([t],"meters")[0],"meters")}function ks(t){return(0,ee.yG)((0,At.geodesicLength)(t,"meters"),"meters")}const Rs=new Et._q,As=(0,g.Ue)(),Vs=(0,g.Ue)();function Us(t){var e;return null!==(e=function(t){const{spatialReference:e}=t;return qr(e,Ps,ks,t)}(t))&&void 0!==e?e:function(t){return fs(t,vs.Horizontal)}(t)}function Is(t,e){var n;return null!==(n=Ss(t,e))&&void 0!==n?n:function(t,e){const{spatialReference:n}=t;return(0,Ut.fS)(n,e.spatialReference)?(bs[0]=t.x,bs[1]=t.y,bs[2]=t.hasZ?t.z:0,xs[0]=e.x,xs[1]=e.y,xs[2]=e.hasZ?e.z:0,ys(bs,xs,n)):null}(t,e)}(0,g.Ue)(),(0,g.Ue)();function Os(t){const{directionOptions:e,geometryType:n,sketchOptions:i,tooltipInfos:o}=t,r=e=>{const n=Ws(t).mode,i=o[e].elevation;"relative-to-ground"===n||"relative-to-scene"===n||"on-the-ground"===n?i.lock(Xs(t)):i.unlock()};switch(n){case"polygon":case"polyline":r(n),(t=>{if(e){const n=o[t].direction;n.committed=e.angle,n.unlockOnVertexPlacement=!1,i.values.directionMode=e.mode}})(n);break;case"point":case"mesh":r(n)}}function Gs(t,e){const{drawOperation:n,view:i}=e,o=Ls(e),r=Ws(e);if("2d"===i.type||!t||"absolute-height"!==r.mode||1!==(null===n||void 0===n?void 0:n.numCommittedVertices)||!o||"draw-polyline"!==o.type&&"draw-polygon"!==o.type||o.elevation.locked)return;const[s,a,l]=t,c=function(t,e,n,i,o){var r,s;const{view:a,drawOperation:l}=o;if("3d"!==a.type||!l)return;null!==(r=n)&&void 0!==r||(n=0);const c=qs(o),u=Ws(o),h=(0,m.O3)(a,t,e,n,c,u,i);return null!==(s=gs(h,c))&&void 0!==s?s:Xs(o)}(s,a,l,r,e);null!=c&&o.elevation.lock(c)}function Zs(t){var e;null===(e=Ls(t))||void 0===e||e.allFields.forEach((t=>{t.unlockOnVertexPlacement&&t.unlock()}))}function Ls(t){var e;let{geometryType:n,graphic:i,tooltipInfos:o}=t;return"multipoint"===n||(null===i||void 0===i||null===(e=i.geometry)||void 0===e?void 0:e.type)!==Ds[n]?null:o[n]}const Ds={point:"point",mesh:"mesh",polyline:"polyline",polygon:"polygon",circle:"polygon",rectangle:"polygon"};function zs(t,e){switch(null===t||void 0===t?void 0:t.type){case"draw-point":!function(t,e){var n;const i=null===(n=e.graphic)||void 0===n?void 0:n.geometry;"point"===(null===i||void 0===i?void 0:i.type)&&(Hs(t,i,e),t.helpMessage=ne("point",i))}(t,e);break;case"draw-polyline":!function(t,e){var n;const{createOperationGeometry:i,drawOperation:o}=e,r=null!=i?i.full:null;r&&"polyline"!==r.type||(Ns(t,e),t.totalLength.actual=o.lastVertex?null!==(n=r?Us(r):null)&&void 0!==n?n:ee.yP:null,t.helpMessage=ne("polyline",r))}(t,e);break;case"draw-polygon":!function(t,e){var n;const{createOperationGeometry:i,drawOperation:o}=e,r=null!=i?i.full:null;r&&"polygon"!==r.type||(Ns(t,e),t.area.actual=o.lastVertex?null!==(n=r?ps(r):null)&&void 0!==n?n:ee.MQ:null,t.helpMessage=ne("polygon",r))}(t,e);break;case"draw-rectangle":!function(t,e){t.sketchOptions=e.sketchOptions,t.xSize=Ys(e),t.ySize=Bs(e),t.area=js(e)}(t,e);break;case"draw-circle":!function(t,e){const{forceUniformSize:n,sketchOptions:i}=e;t.sketchOptions=i,t.radius=n?function(t){var e,n;let{createOperationGeometry:i}=t;return null!==(e=null!=(null===i||void 0===i||null===(n=i.circle)||void 0===n?void 0:n.center)&&null!=i.circle.edge?Is(i.circle.center,i.circle.edge):null)&&void 0!==e?e:ee.yP}(e):null,t.xSize=n?null:Ys(e),t.ySize=n?null:Bs(e),t.area=js(e)}(t,e);break;case"draw-mesh":!function(t,e){const{graphic:n,view:i}=e,o=null===n||void 0===n?void 0:n.geometry;"3d"!==i.type||o&&"mesh"!==o.type||(Hs(t,null===o||void 0===o?void 0:o.origin,e),o&&Pr(t,o),t.helpMessage=function(t,e){var n,i,o,r;const s=null===t||void 0===t?void 0:t.geometry;if(!t||"mesh"!==(null===s||void 0===s?void 0:s.type)||!e)return;const{renderCoordsHelper:a,elevationProvider:l}=e,{camera:c}=e.state,{extent:u}=s,{center:h,spatialReference:d}=u,p=(0,Ct.c9)(d),v=(0,Ct._R)(d),f=(0,Ct.c9)(a.spatialReference),g=u.width*p,_=u.height*v,y=(null!==(n=u.zmax)&&void 0!==n?n:0)*v,b=y-(null!==(i=u.zmin)&&void 0!==i?i:0)*v,x=Math.max(g,_,b)/f,{x:w,y:C}=h,M=null!==(o=h.z)&&void 0!==o?o:0;(0,A.i)(se,w,C,M),a.toRenderCoords(se,d,se);const S=x/c.computeScreenPixelSizeAt(se);if(S>c.width*oe)return"meshTooClose";if(S<ie)return"meshTooFar";const E=(0,m.RL)(t),{absoluteZ:T}=(0,m.tq)(w,C,y,d,e,E);return T<(null!==(r=l.getElevation(w,C,M,d,"ground"))&&void 0!==r?r:0)*v+b*re?"meshUnderground":"mesh"}(n,i))}(t,e)}}function Hs(t,e,n){const{drawOperation:i,view:o,sketchOptions:r}=n,{cursorVertex:s}=i;if(t.sketchOptions=r,t.viewType=o.type,t.setLocationFromPoint(e,qs(n)),Fs(t.elevation,n),!s)return void(i.constraints=void 0);const a=s;i.constraints={context:Js(a,n),x:t.x.committed,y:t.y.committed,longitude:t.longitude.committed,latitude:t.latitude.committed,elevation:t.elevation.committed,distance:null,direction:null}}function Ns(t,e){var n;const{drawOperation:i,sketchOptions:o,view:r}=e,{cursorVertex:s,lastVertex:a,secondToLastVertex:l}=i,c=o.values.effectiveDirectionMode;t.sketchOptions=o,t.viewType=r.type;const u=a&&s?null!==(n=Is(a,s))&&void 0!==n?n:ee.yP:null;if(t.distance.actual=u,t.distance.readOnly=null==a,t.direction.actual=null,t.direction.readOnly=!0,a&&s&&("absolute"===c||l)){const e=function(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:qn.Absolute;if(e&&n)switch(i){case qn.Absolute:return Jn(e,n);case qn.Relative:return ti($n(t,e,n),qn.Relative);case qn.RelativeBilateral:return ti($n(t,e,n),qn.RelativeBilateral)}}(l,a,s,c);t.direction.actual=null!==e&&void 0!==e?e:ee.qF,t.direction.readOnly=!1}t.setLocationFromPoint(s,qs(e)),Fs(t.elevation,e);const h=function(t,e){let{sketchOptions:n}=e;const i=n.tooltips.xyMode;return"auto"===i?t?"direction-distance":"coordinates":i}(a,e);t.xyMode=h,t.direction.visible="direction-distance"===h,t.distance.visible="direction-distance"===h,t.effectiveX.visible="coordinates"===h,t.effectiveY.visible="coordinates"===h;const d=null!==s&&void 0!==s?s:a;i.constraints=d?{context:Js(d,e),x:t.x.committed,y:t.y.committed,longitude:t.longitude.committed,latitude:t.latitude.committed,elevation:t.elevation.committed,distance:t.distance.committed,direction:t.direction.committed}:void 0}function Fs(t,e){var n,i;const{drawOperation:o}=e,r=null!==(n=null===o||void 0===o?void 0:o.cursorVertex)&&void 0!==n?n:null===o||void 0===o?void 0:o.lastVertex;t.actual=null!==(i=function(t){return null!=t?gs(t.hasZ?t.z:0,t.spatialReference):null}(r))&&void 0!==i?i:Xs(e),t.visible=o.hasZ,t.readOnly=!1,t.showAsZ=!0}function js(t){var e,n;const i=null===(e=t.createOperationGeometry)||void 0===e?void 0:e.full;return"polygon"!==(null===i||void 0===i?void 0:i.type)?ee.MQ:null!==(n=ps(i))&&void 0!==n?n:ee.MQ}function Ys(t){var e,n;const i=null===(e=t.createOperationGeometry)||void 0===e||null===(e=e.rectangle)||void 0===e?void 0:e.midpoints;return null!==(n=null!=i?Is(i.left,i.right):null)&&void 0!==n?n:ee.yP}function Bs(t){var e,n;const i=null===(e=t.createOperationGeometry)||void 0===e||null===(e=e.rectangle)||void 0===e?void 0:e.midpoints;return null!==(n=null!=i?Is(i.top,i.bottom):null)&&void 0!==n?n:ee.yP}function Ws(t){var e;return null!==(e=t.drawOperation.elevationInfo)&&void 0!==e?e:m.jG}function qs(t){return t.drawOperation.coordinateHelper.spatialReference}function Xs(t){const e=(0,Ct._R)(qs(t));return(0,ee.yG)(t.defaultZ*e,"meters")}function Js(t,e){return function(t,e,n,i,o,r){let s="geodesic",a=(0,Et.Lc)(n);const l=x();return M(t,e,i,l),l[2]=0,a&&(0,le.S)(l,n,l,a)||(s="euclidean",a=n),{mode:s,view:e,elevationInfo:i,hasZ:o,directionMode:r,spatialReference:t.spatialReference,measurementSR:a,origin:l}}(t,e.view,qs(e),Ws(e),e.drawOperation.coordinateHelper.hasZ(),e.sketchOptions.values.effectiveDirectionMode)}var Ks,Qs=n(99034);!function(t){t[t.WhenToolEditable=0]="WhenToolEditable",t[t.WhenToolNotEditable=1]="WhenToolNotEditable",t[t.Always=2]="Always"}(Ks||(Ks={}));class $s{constructor(){this._isToolEditable=!0,this._manipulators=new $.Z,this._resourceContexts={manipulator3D:{}},this._attached=!1}set isToolEditable(t){this._isToolEditable=t}get length(){return this._manipulators.length}add(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ks.WhenToolEditable;this.addMany([t],e)}addMany(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ks.WhenToolEditable;for(const n of t){const t={manipulator:n,visibilityPredicate:e,attached:!1};this._manipulators.add(t),this._attached&&this._updateManipulatorAttachment(t)}}remove(t){for(let e=0;e<this._manipulators.length;e++)if(this._manipulators.at(e).manipulator===t){const t=this._manipulators.splice(e,1)[0];this._detachManipulator(t);break}}removeAll(){this._manipulators.forEach((t=>{this._detachManipulator(t)})),this._manipulators.removeAll()}attach(){this._manipulators.forEach((t=>{this._updateManipulatorAttachment(t)})),this._attached=!0}detach(){this._manipulators.forEach((t=>{this._detachManipulator(t)})),this._attached=!1}destroy(){this.detach(),this._manipulators.forEach((t=>{let{manipulator:e}=t;return e.destroy()})),this._manipulators.destroy(),this._resourceContexts=null}on(t,e){return this._manipulators.on(t,(t=>{e(t)}))}forEach(t){for(const e of this._manipulators.items)t(e)}some(t){return this._manipulators.items.some(t)}toArray(){const t=[];return this.forEach((e=>t.push(e.manipulator))),t}intersect(t,e){let n=null,i=Number.MAX_VALUE;return this._manipulators.forEach((o=>{let{manipulator:r,attached:s}=o;if(!s||!r.interactive)return;const a=r.intersectionDistance(t,e);null!=a&&a<i&&(i=a,n=r)})),n}_updateManipulatorAttachment(t){this._isManipulatorItemVisible(t)?this._attachManipulator(t):this._detachManipulator(t)}_attachManipulator(t){t.attached||(t.manipulator.attach&&t.manipulator.attach(this._resourceContexts),t.attached=!0)}_detachManipulator(t){if(!t.attached)return;const e=t.manipulator;e.grabbing=!1,e.dragging=!1,e.hovering=!1,e.selected=!1,e.detach&&e.detach(this._resourceContexts),t.attached=!1}_isManipulatorItemVisible(t){return t.visibilityPredicate===Ks.Always||(this._isToolEditable?t.visibilityPredicate===Ks.WhenToolEditable:t.visibilityPredicate===Ks.WhenToolNotEditable)}}let ta=class extends Q.Z{constructor(t){super(t),this.manipulators=new $s,this.automaticManipulatorSelection=!0,this.hasGrabbedManipulators=!1,this.hasHoveredManipulators=!1,this.firstGrabbedManipulator=null,this.created=!1,this.removeIncompleteOnCancel=!0,this._editableFlags=new Map([[Qs.bH.MANAGER,!0],[Qs.bH.USER,!0]]),this._creationFinishedResolver=(0,oo.hh)()}get active(){return null!=this.view&&this.view.activeTool===this}set visible(t){this._get("visible")!==t&&(this._set("visible",t),this._syncVisible())}get editable(){return this.getEditableFlag(Qs.bH.USER)}set editable(t){this.setEditableFlag(Qs.bH.USER,t)}get updating(){return!1}get cursor(){return null}get hasFocusedManipulators(){return this.hasGrabbedManipulators||this.hasHoveredManipulators}destroy(){this.manipulators.destroy(),this._set("view",null)}onAdd(){this._syncVisible()}activate(){null!=this.view&&(this.view.focus(),this.onActivate())}deactivate(){this.onDeactivate()}handleInputEvent(t){this.onInputEvent(t)}handleInputEventAfter(t){this.onInputEventAfter(t)}setEditableFlag(t,e){this._editableFlags.set(t,e),this.manipulators.isToolEditable=this.internallyEditable,this._updateManipulatorAttachment(),t===Qs.bH.USER&&this.notifyChange("editable"),this.onEditableChange(),this.onManipulatorSelectionChanged()}getEditableFlag(t){var e;return null!==(e=this._editableFlags.get(t))&&void 0!==e&&e}endDrag(){const t=this.view.inputManager.latestPointerLocation;if(!t)return;let e=!1;this.manipulators.forEach((n=>{let{manipulator:i}=n;i.dragging&&(e=!0,i.events.emit("drag",{action:"end",start:t,screenPoint:t}))})),e&&(this.view.toolViewManager.activeTool=null)}whenCreated(){return this._creationFinishedResolver.promise}onManipulatorSelectionChanged(){}onActivate(){}onDeactivate(){}onShow(){}onHide(){}onEditableChange(){}onInputEvent(t){}onInputEventAfter(t){}get internallyEditable(){return this.getEditableFlag(Qs.bH.USER)&&this.getEditableFlag(Qs.bH.MANAGER)}finishToolCreation(){this.created||this._creationFinishedResolver.resolve(this),this._set("created",!0)}_syncVisible(){if(this.initialized)if(this.visible)this._show();else if(this._hide(),this.active)return void(this.view.activeTool=null)}_show(){this._updateManipulatorAttachment(),this.onShow()}_hide(){this._updateManipulatorAttachment(),this.onHide()}_updateManipulatorAttachment(){this.visible?this.manipulators.attach():this.manipulators.detach()}};(0,r._)([(0,u.Cb)({constructOnly:!0})],ta.prototype,"view",void 0),(0,r._)([(0,u.Cb)({readOnly:!0})],ta.prototype,"active",null),(0,r._)([(0,u.Cb)({value:!0})],ta.prototype,"visible",null),(0,r._)([(0,u.Cb)({value:!0})],ta.prototype,"editable",null),(0,r._)([(0,u.Cb)({readOnly:!0})],ta.prototype,"manipulators",void 0),(0,r._)([(0,u.Cb)({readOnly:!0})],ta.prototype,"updating",null),(0,r._)([(0,u.Cb)()],ta.prototype,"cursor",null),(0,r._)([(0,u.Cb)({readOnly:!0})],ta.prototype,"automaticManipulatorSelection",void 0),(0,r._)([(0,u.Cb)()],ta.prototype,"hasFocusedManipulators",null),(0,r._)([(0,u.Cb)()],ta.prototype,"hasGrabbedManipulators",void 0),(0,r._)([(0,u.Cb)()],ta.prototype,"hasHoveredManipulators",void 0),(0,r._)([(0,u.Cb)()],ta.prototype,"firstGrabbedManipulator",void 0),(0,r._)([(0,u.Cb)({readOnly:!0})],ta.prototype,"created",void 0),(0,r._)([(0,u.Cb)({readOnly:!0})],ta.prototype,"removeIncompleteOnCancel",void 0),ta=(0,r._)([(0,h.j)("esri.views.interactive.InteractiveToolBase")],ta);let ea=class extends Q.Z{constructor(t){super(t),this.enabled=!1}};(0,r._)([(0,u.Cb)({type:Boolean,nonNullable:!0})],ea.prototype,"enabled",void 0),ea=(0,r._)([(0,h.j)("esri.views.interactive.sketch.SketchLabelOptions")],ea);const na=ea;let ia=class extends Q.Z{constructor(t){super(t),this.mode="absolute-height"}toJSON(){return{mode:this.mode}}};(0,r._)([(0,u.Cb)({type:String,nonNullable:!0})],ia.prototype,"mode",void 0),ia=(0,r._)([(0,h.j)("esri.views.interactive.sketch.SketchTooltipElevationOptions")],ia);let oa=class extends Q.Z{constructor(t){super(t),this.area=!0,this.coordinates=!0,this.direction=!0,this.distance=!0,this.elevation=!0,this.header=!0,this.helpMessage=!1,this.orientation=!0,this.radius=!0,this.rotation=!0,this.scale=!0,this.size=!0,this.totalLength=!0}};(0,r._)([(0,u.Cb)({type:Boolean,nonNullable:!0})],oa.prototype,"area",void 0),(0,r._)([(0,u.Cb)({type:Boolean,nonNullable:!0})],oa.prototype,"coordinates",void 0),(0,r._)([(0,u.Cb)({type:Boolean,nonNullable:!0})],oa.prototype,"direction",void 0),(0,r._)([(0,u.Cb)({type:Boolean,nonNullable:!0})],oa.prototype,"distance",void 0),(0,r._)([(0,u.Cb)({type:Boolean,nonNullable:!0})],oa.prototype,"elevation",void 0),(0,r._)([(0,u.Cb)({type:Boolean,nonNullable:!0})],oa.prototype,"header",void 0),(0,r._)([(0,u.Cb)({type:Boolean,nonNullable:!0})],oa.prototype,"helpMessage",void 0),(0,r._)([(0,u.Cb)({type:Boolean,nonNullable:!0})],oa.prototype,"orientation",void 0),(0,r._)([(0,u.Cb)({type:Boolean,nonNullable:!0})],oa.prototype,"radius",void 0),(0,r._)([(0,u.Cb)({type:Boolean,nonNullable:!0})],oa.prototype,"rotation",void 0),(0,r._)([(0,u.Cb)({type:Boolean,nonNullable:!0})],oa.prototype,"scale",void 0),(0,r._)([(0,u.Cb)({type:Boolean,nonNullable:!0})],oa.prototype,"size",void 0),(0,r._)([(0,u.Cb)({type:Boolean,nonNullable:!0})],oa.prototype,"totalLength",void 0),oa=(0,r._)([(0,h.j)("esri.views.interactive.sketch.SketchTooltipVisibleElements")],oa);const ra=oa;let sa=class extends Q.Z{constructor(t){super(t),this.enabled=!1,this.forceEnabled=!1,this.helpMessage=null,this.helpMessageIcon=null,this.inputEnabled=!0,this.elevation=new ia,this.placement="auto",this.offset=null,this.visibleElements=new ra,this.visualVariables=null,this.xyMode="auto"}get effectiveEnabled(){return this.forceEnabled||this.enabled}};(0,r._)([(0,u.Cb)({type:Boolean,nonNullable:!0})],sa.prototype,"enabled",void 0),(0,r._)([(0,u.Cb)()],sa.prototype,"forceEnabled",void 0),(0,r._)([(0,u.Cb)()],sa.prototype,"effectiveEnabled",null),(0,r._)([(0,u.Cb)()],sa.prototype,"helpMessage",void 0),(0,r._)([(0,u.Cb)()],sa.prototype,"helpMessageIcon",void 0),(0,r._)([(0,u.Cb)({type:Boolean,nonNullable:!0})],sa.prototype,"inputEnabled",void 0),(0,r._)([(0,u.Cb)({type:ia,nonNullable:!0})],sa.prototype,"elevation",void 0),(0,r._)([(0,u.Cb)()],sa.prototype,"placement",void 0),(0,r._)([(0,u.Cb)()],sa.prototype,"offset",void 0),(0,r._)([(0,u.Cb)({type:ra,nonNullable:!0})],sa.prototype,"visibleElements",void 0),(0,r._)([(0,u.Cb)()],sa.prototype,"visualVariables",void 0),(0,r._)([(0,u.Cb)()],sa.prototype,"xyMode",void 0),sa=(0,r._)([(0,h.j)("esri.views.interactive.sketch.SketchTooltipOptions")],sa);const aa=sa;let la=class extends Q.Z{constructor(t){super(t),this.length=null,this.verticalLength=null,this.area=null}};(0,r._)([(0,u.Cb)()],la.prototype,"length",void 0),(0,r._)([(0,u.Cb)()],la.prototype,"verticalLength",void 0),(0,r._)([(0,u.Cb)()],la.prototype,"area",void 0),la=(0,r._)([(0,h.j)("esri.views.interactive.sketch.Units")],la);const ca=la;let ua=class extends Q.Z{constructor(t){super(t),this.directionMode="relative",this.relativeDirectionIsBilateral=!1}get effectiveDirectionMode(){switch(this.directionMode){case"relative":return this.relativeDirectionIsBilateral?qn.RelativeBilateral:qn.Relative;case"absolute":return qn.Absolute}}get displayUnits(){var t;return null!==(t=this._get("displayUnits"))&&void 0!==t?t:new ca}set displayUnits(t){this._set("displayUnits",t)}get inputUnits(){var t;return null!==(t=this._get("inputUnits"))&&void 0!==t?t:new ca}set inputUnits(t){this._set("inputUnits",t)}};(0,r._)([(0,u.Cb)({type:String,nonNullable:!0})],ua.prototype,"directionMode",void 0),(0,r._)([(0,u.Cb)({type:Boolean,nonNullable:!0})],ua.prototype,"relativeDirectionIsBilateral",void 0),(0,r._)([(0,u.Cb)()],ua.prototype,"effectiveDirectionMode",null),(0,r._)([(0,u.Cb)({type:ca,nonNullable:!0})],ua.prototype,"displayUnits",null),(0,r._)([(0,u.Cb)({type:ca,nonNullable:!0})],ua.prototype,"inputUnits",null),ua=(0,r._)([(0,h.j)("esri.views.interactive.sketch.SketchValueOptions")],ua);const ha=ua;let da=class extends Q.Z{constructor(t){super(t),this.labels=new na,this.tooltips=new aa,this.values=new ha}};(0,r._)([(0,u.Cb)({nonNullable:!0,type:na})],da.prototype,"labels",void 0),(0,r._)([(0,u.Cb)({nonNullable:!0,type:aa})],da.prototype,"tooltips",void 0),(0,r._)([(0,u.Cb)({nonNullable:!0,type:ha})],da.prototype,"values",void 0),da=(0,r._)([(0,h.j)("esri.views.interactive.sketch.SketchOptions")],da);const pa=da;var va=n(27088);let fa=class extends(ut.Z.EventedMixin(ta)){constructor(t){super(t),this._graphic=null,this._coordinateFormatterLoadTask=null,this._createOperationGeometry=null,this.defaultZ=0,this.directionOptions=null,this.geometryType=null,this.hasZ=!0,this.geometryToPlace=null,this.snappingManager=null,this.snapToScene=!1,this.sketchOptions=new pa}initialize(){const{view:t}=this;this.internalGraphicsLayer=new _t.Z({listMode:"hide",internal:!0}),this.view.map.layers.add(this.internalGraphicsLayer);const e=this.drawOperation=this.makeDrawOperation();this.tooltipInfos=function(t,e){return{point:new Qr({sketchOptions:e,viewType:t}),polyline:new ts({sketchOptions:e,viewType:t}),polygon:new $r({sketchOptions:e,viewType:t}),mesh:new Kr({sketchOptions:e,viewType:t}),rectangle:new es({sketchOptions:e}),circle:new Ir({sketchOptions:e})}}(t.type,this.sketchOptions);const n=function(t){const e=new Tr(t());return e.addHandles((0,c.YP)((()=>t()),(t=>{let{view:n,options:i,info:o}=t;e.view=n,void 0!==i&&(e.options=i),void 0!==o&&(e.info=o)}))),e}((()=>({view:t,options:this.sketchOptions.tooltips})));this.tooltip=n,Os(this._tooltipsContext),this._coordinateFormatterLoadTask=(0,ct.vr)((()=>(0,dt.l)())),this.addHandles([e.on("vertex-add",(t=>this.onVertexAdd(t))),e.on("vertex-remove",(t=>this.onVertexRemove(t))),e.on("vertex-update",(t=>this.onVertexUpdate(t))),e.on("cursor-update",(t=>this.onCursorUpdate(t))),e.on("cursor-remove",(()=>this._updateGraphic())),e.on("complete",(t=>this.onComplete(t))),this._coordinateFormatterLoadTask,n.on("paste",(t=>Vr(t,this.activeTooltipInfo))),(0,c.YP)((()=>this.cursor),(t=>{e.cursor=t}),c.tX),(0,va.EH)((()=>{const{activeTooltipInfo:t,sketchOptions:e}=this;zs(t,this._tooltipsContext),n.info=e.tooltips.effectiveEnabled?t:null})),(0,va.EH)((()=>{e.constraintZ=function(t){const{geometryType:e,tooltipInfos:n}=t;switch(e){case"point":case"mesh":case"polyline":case"polygon":{const i=n[e].elevation.committed;if(!i)return;return(0,ee.mE)(i,"meters")/(0,Ct._R)(qs(t))}default:return}}(this._tooltipsContext)}),c.Z_)]),this.finishToolCreation()}destroy(){this.drawOperation=(0,l.SC)(this.drawOperation),this.tooltip=(0,l.SC)(this.tooltip),this._destroyAllVisualizations(),this.view.map.remove(this.internalGraphicsLayer),this.internalGraphicsLayer=(0,l.SC)(this.internalGraphicsLayer),this._set("view",null)}get _drawSpatialReference(){return this.drawOperation.coordinateHelper.spatialReference}get _tooltipsContext(){return{createOperationGeometry:this._createOperationGeometry,defaultZ:this.defaultZ,directionOptions:this.directionOptions,drawOperation:this.drawOperation,forceUniformSize:this.forceUniformSize,geometryType:this.geometryType,graphic:this.graphic,sketchOptions:this.sketchOptions,tooltipInfos:this.tooltipInfos,view:this.view}}get canRedo(){return this.drawOperation.canRedo}get canUndo(){return this.drawOperation.canUndo}set centered(t){this._set("centered",t),this._updateGraphic()}get cursor(){return this._get("cursor")}set cursor(t){this._set("cursor",t)}set enabled(t){this.drawOperation.interactive=t,this._set("enabled",t)}set forceUniformSize(t){this._set("forceUniformSize",t),this._updateGraphic()}get graphic(){return this._graphic}set graphicSymbol(t){this._set("graphicSymbol",t),null!=this._graphic&&(this._graphic.symbol=t)}set mode(t){const e=this.drawOperation;e&&(e.drawingMode=t),this._set("mode",t)}get updating(){var t,e;return null!==(t=null===(e=this.drawOperation)||void 0===e?void 0:e.updating)&&void 0!==t&&t}get undoRedo(){const{view:{type:t,map:e}}=this;return"2d"===t&&e&&"undoRedo"in e&&e.undoRedo instanceof lt?e.undoRedo:null}set undoRedo(t){this._override("undoRedo",t)}completeCreateOperation(){this.drawOperation.complete()}onInputEvent(t){this.destroyed||function(t,e){return!("key-down"!==t.type||t.key!==Pi||!e||!function(t){const e=null===t||void 0===t?void 0:t.sketchOptions;if(!e)return!1;const{inputEnabled:n,visibleElements:i}=e.tooltips;return n&&!0===t.editableFields.some((t=>{let{name:e}=t;return"x"===e||"y"===e?i.coordinates:i[e]}))}(e.info))&&(e.enterInputMode(),t.preventDefault(),t.stopPropagation(),!0)}(t,this.tooltip)||this.drawOperation.onInputEvent(t)}redo(){this.drawOperation.redo()}reset(){}undo(){this.drawOperation.undo(),0===this.drawOperation.numCommittedVertices&&Os(this._tooltipsContext)}_destroyAllVisualizations(){this.removeHandles(_a.outline),this.removeHandles(_a.regularVertices),this.removeHandles(_a.activeVertex),this.removeHandles(_a.activeEdge),this.removeHandles(ga)}_createOrUpdateGraphic(t){if(null!=this._graphic)return this.updateGraphicGeometry(t),this._graphic;const e=new s.Z((0,o.Z)((0,o.Z)({},this.graphicProperties),{},{symbol:this.graphicSymbol}));return this._graphic=e,this.updateGraphicGeometry(t),this.internalGraphicsLayer.add(e),this.addHandles(this.initializeGraphic(e)),this.notifyChange("graphic"),this.addHandles((0,a.kB)((()=>{this.internalGraphicsLayer.remove(e),this._graphic===e&&(this._graphic=null)})),ga),e}updateGraphicGeometry(t){this._graphic.geometry=t}_getCreateOperationGeometry(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{operationComplete:!1};if(null==this.drawOperation)return;const{coordinateHelper:e,view:n,visualizationCursorVertex:i,lastVertex:o,committedVertices:r,geometryIncludingUncommittedVertices:s,numCommittedVertices:a}=this.drawOperation;if(!(a>0||null!=i))return;const l=t.operationComplete?r:s,c=l.length,u=null!=i?e.pointToArray(i):null,h=this._drawSpatialReference,d="3d"===n.type&&"global"===n.viewingMode,p=new mt;p.committedVertices=r,p.cursorVertex=u;const{geometryType:v}=this;switch(v){case"point":case"mesh":p.full=e.arrayToPoint(l[0]);break;case"multipoint":p.full=c>0?function(t,e){return new jt.Z({points:t,spatialReference:e})}(l,h):null;break;case"polyline":case"polygon":c>0&&(p.full="polygon"===v?Wt([l],h,d,!0):Bt([l],h,d),p.cursorEdge=null!=u&&o&&!(0,yt.kg)(i,o)?Bt([[u,e.pointToArray(o)]],h,d):null,p.outline=c>1?p.full:null);break;case"circle":case"rectangle":{var f,g;if(p.committedVertices=p.cursorVertex=null,!c)break;const e=function(t,e){if("2d"===t.type)return new Nt(t.state.transform,t.spatialReference,e.length>2?e[2]:null);if("3d"===t.type){const n=e.length>2?new D.Z({x:e[0],y:e[1],z:e[2],spatialReference:t.spatialReference}):new D.Z({x:e[0],y:e[1],spatialReference:t.spatialReference});return new Ft(t,n)}return null}(n,l[0]),i=l[0],o=e.makeMapPoint(i[0]+ma*n.resolution,i[1]);"circle"===v?1===c&&t.operationComplete?p.circle=te([i,o],e,!0):2===c&&(this.forceUniformSize?p.circle=te(l,e,this.centered):p.rectangle=function(t,e,n){const i=e.mapToLocalMultiple(t),o=i[0],r=i[1],s=Math.round(r.x-o.x),a=Math.round(r.y-o.y),l=zt(n?o.x:o.x+s/2,n?o.y:o.y+a/2),c=n?s:s/2,u=n?a:a/2,h=[],d=2*Math.PI/60;function p(t){const e=Math.cos(t),n=Math.sin(t);return zt(c*e+l.x,u*n+l.y)}for(let x=0;x<60;x++)h.push(p(x*d));h.push(h[0]);const{spatialReference:v,doUnnormalization:f}=e,g=Wt([h.map((t=>e.localToMap(t))).filter(xt.pC)],v,f,!1),_=e.localToMap(p(Math.PI/2)),y=e.localToMap(p(0)),m=e.localToMap(p(-Math.PI/2)),b=e.localToMap(p(Math.PI));return{geometry:g,midpoints:null!=_&&null!=y&&null!=m&&null!=b?{top:Yt(_,v),right:Yt(y,v),bottom:Yt(m,v),left:Yt(b,v)}:null}}(l,e,this.centered)):1===c&&t.operationComplete?p.rectangle=qt([i,o],e,!0):2===c&&(p.rectangle=this.forceUniformSize?qt(l,e,this.centered):function(t,e,n){let i=e.mapToLocalMultiple(t);if(1===i.length){const t=48,e=i[0];i=[zt(e.x-t,e.y+t),zt(e.x+t,e.y-t),zt(e.x+t,e.y-t),zt(e.x-t,e.y+t)]}const o=[],r={x:i[0].x,y:i[0].y},s={x:i[1].x,y:i[1].y};if(n){const t=Math.round(s.x-r.x),e=Math.round(s.y-r.y);o.push(zt(r.x-t,r.y-e),zt(s.x,r.y-e),zt(s.x,s.y),zt(r.x-t,s.y))}else o.push(zt(r.x,r.y),zt(s.x,r.y),zt(s.x,s.y),zt(r.x,s.y));return Xt(Wt([o.map((t=>e.localToMap(t))).filter(xt.pC)],e.spatialReference,e.doUnnormalization,!0),o,e)}(l,e,this.centered)),p.full=null!=p.circle?p.circle.geometry:null===(f=p.rectangle)||void 0===f?void 0:f.geometry,p.outline="polygon"===(null===(g=p.full)||void 0===g?void 0:g.type)?p.full:null;break}default:return null}return p}initializeGraphic(t){return(0,a.kB)()}onComplete(t){if(!this.drawOperation)return;this._updateGraphic();let e=null;if(this.drawOperation.isCompleted){const t=this._getCreateOperationGeometry({operationComplete:!0});null!=t&&(e=this._createOrUpdateGraphic(t.full))}this._createOperationGeometry=null,this.emit("complete",(0,o.Z)({graphic:e},t))}onCursorUpdate(t){this._updateGraphic(),this.emit("cursor-update",t)}onDeactivate(){const{drawOperation:t}=this;t&&(t.isCompleted||t.cancel())}onOutlineChanged(t){return(0,a.kB)()}onCursorEdgeChanged(t){return(0,a.kB)()}onVertexAdd(t){var e;Zs(this._tooltipsContext),this._updateGraphic(),Gs(null===(e=t.vertices.at(0))||void 0===e?void 0:e.coordinates,this._tooltipsContext),this.emit("vertex-add",t)}onVertexRemove(t){Zs(this._tooltipsContext),this._updateGraphic(),this.emit("vertex-remove",t)}onVertexUpdate(t){this._updateGraphic(),this.emit("vertex-update",t)}_updateGraphic(){const t=this._getCreateOperationGeometry();this._createOperationGeometry=t,null!=t?(null!=t.cursorEdge?this.addHandles(this.onCursorEdgeChanged(t.cursorEdge),_a.activeEdge):this.removeHandles(_a.activeEdge),null!=t.outline?this.addHandles(this.onOutlineChanged(t.outline),_a.outline):this.removeHandles(_a.outline),null!=t.committedVertices?this.addHandles(this.onRegularVerticesChanged(t.committedVertices),_a.regularVertices):this.removeHandles(_a.regularVertices),null!=t.cursorVertex?this.addHandles(this.onActiveVertexChanged(t.cursorVertex),_a.activeVertex):this.removeHandles(_a.activeVertex),null!=t.full?this._createOrUpdateGraphic(t.full):this.removeHandles(ga)):this._destroyAllVisualizations()}get activeTooltipInfo(){var t;return null!==(t=this._coordinateFormatterLoadTask)&&void 0!==t&&t.finished?Ls(this._tooltipsContext):null}};(0,r._)([(0,u.Cb)()],fa.prototype,"_coordinateFormatterLoadTask",void 0),(0,r._)([(0,u.Cb)()],fa.prototype,"_createOperationGeometry",void 0),(0,r._)([(0,u.Cb)()],fa.prototype,"_tooltipsContext",null),(0,r._)([(0,u.Cb)({value:!0})],fa.prototype,"centered",null),(0,r._)([(0,u.Cb)()],fa.prototype,"cursor",null),(0,r._)([(0,u.Cb)({nonNullable:!0})],fa.prototype,"defaultZ",void 0),(0,r._)([(0,u.Cb)({constructOnly:!0})],fa.prototype,"directionOptions",void 0),(0,r._)([(0,u.Cb)()],fa.prototype,"drawOperation",void 0),(0,r._)([(0,u.Cb)({value:!0})],fa.prototype,"enabled",null),(0,r._)([(0,u.Cb)({value:!0})],fa.prototype,"forceUniformSize",null),(0,r._)([(0,u.Cb)({constructOnly:!0})],fa.prototype,"geometryType",void 0),(0,r._)([(0,u.Cb)()],fa.prototype,"graphic",null),(0,r._)([(0,u.Cb)({constructOnly:!0})],fa.prototype,"graphicProperties",void 0),(0,r._)([(0,u.Cb)()],fa.prototype,"graphicSymbol",null),(0,r._)([(0,u.Cb)({constructOnly:!0})],fa.prototype,"hasZ",void 0),(0,r._)([(0,u.Cb)({constructOnly:!0})],fa.prototype,"geometryToPlace",void 0),(0,r._)([(0,u.Cb)()],fa.prototype,"mode",null),(0,r._)([(0,u.Cb)()],fa.prototype,"snappingManager",void 0),(0,r._)([(0,u.Cb)()],fa.prototype,"snapToScene",void 0),(0,r._)([(0,u.Cb)()],fa.prototype,"tooltip",void 0),(0,r._)([(0,u.Cb)()],fa.prototype,"tooltipInfos",void 0),(0,r._)([(0,u.Cb)({constructOnly:!0,type:pa})],fa.prototype,"sketchOptions",void 0),(0,r._)([(0,u.Cb)()],fa.prototype,"updating",null),(0,r._)([(0,u.Cb)({constructOnly:!0,nonNullable:!0})],fa.prototype,"view",void 0),(0,r._)([(0,u.Cb)({constructOnly:!0})],fa.prototype,"undoRedo",null),(0,r._)([(0,u.Cb)()],fa.prototype,"activeTooltipInfo",null),fa=(0,r._)([(0,h.j)("esri.views.draw.DrawGraphicTool")],fa);const ga=Symbol("create-operation-graphic"),_a={outline:Symbol("outline-visual"),regularVertices:Symbol("regular-vertices-visual"),activeVertex:Symbol("active-vertex-visual"),activeEdge:Symbol("active-edge-visual")};function ya(t){switch(t){case"point":case"polyline":case"polygon":case"multipoint":return t;case"circle":case"rectangle":return"segment";case"mesh":return"point"}}const ma=48;var ba=n(2622),xa=n(48732),wa=n(50951);const Ca="click";class Ma{constructor(t){let{consumesClicks:e,grabbableForEvent:n}=t;this.events=new ut.Z,this.interactive=!0,this.selectable=!1,this.cursor=null,this.grabbable=!0,this.consumesClicks=e,this.grabbableForEvent=n}destroy(){}intersectionDistance(t,e){return 0}attach(){}detach(){}onElevationChange(){}onViewChange(){}}var Sa;!function(t){t[t.Z=0]="Z",t[t.M=1]="M"}(Sa||(Sa={}));class Ea{constructor(t){this.spatialReference=t}createVector(){return this._tag((0,f.Ue)())}pointToVector(t){return this._tag((0,f.al)(t.x,t.y))}arrayToVector(t){return this._tag((0,f.al)(t[0],t[1]))}vectorToArray(t){return[t[0],t[1]]}pointToArray(t){return[t.x,t.y]}vectorToPoint(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new D.Z;return e.x=t[0],e.y=t[1],e.z=void 0,e.m=void 0,e.spatialReference=this.spatialReference,e}arrayToPoint(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new D.Z;return e.x=t[0],e.y=t[1],e.z=void 0,e.m=void 0,e.spatialReference=this.spatialReference,e}vectorToDehydratedPoint(t,e){var n;if(t)return null!==(n=e)&&void 0!==n||(e={x:void 0,y:void 0,z:void 0,m:void 0,hasZ:void 0,hasM:void 0,spatialReference:void 0,type:"point"}),e.x=t[0],e.y=t[1],e.z=void 0,e.m=void 0,e.hasZ=!1,e.hasM=!1,e.spatialReference=this.spatialReference,e}lerp(t,e,n,i){return(0,v.t7)(i,t,e,n)}addDelta(t,e,n){t[0]+=e,t[1]+=n}distance(t,e){return(0,v.TE)(t,e)}getZ(t){return arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0}hasZ(){return!1}getM(t){return arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0}hasM(){return!1}clone(t){return this._tag((0,f.nI)(t))}copy(t,e){return(0,v.JG)(e,t)}fromXYZ(t){return this._tag((0,f.al)(t[0],t[1]))}toXYZ(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(0,g.Ue)();return(0,A.i)(e,t[0],t[1],0)}pointToXYZ(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(0,g.Ue)();return(0,A.i)(e,t.x,t.y,0)}equals(t,e){return(0,v.fS)(t,e)}_tag(t){return t}}class Ta{constructor(t,e){this._valueType=t,this.spatialReference=e}createVector(){return this._tag((0,g.Ue)())}pointToVector(t){return this._tag((0,g.al)(t.x,t.y,this._valueType===Sa.Z?t.z:t.m))}arrayToVector(t){return this._tag((0,g.al)(t[0],t[1],t[2]||0))}vectorToArray(t){return[t[0],t[1],t[2]]}pointToArray(t){return this._valueType===Sa.Z?[t.x,t.y,t.z]:[t.x,t.y,t.m]}vectorToPoint(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new D.Z;return e.x=t[0],e.y=t[1],e.z=this._valueType===Sa.Z?t[2]:void 0,e.m=this._valueType===Sa.M?t[2]:void 0,e.spatialReference=this.spatialReference,e}arrayToPoint(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new D.Z;return e.x=t[0],e.y=t[1],e.z=this._valueType===Sa.Z?t[2]:void 0,e.m=this._valueType===Sa.M?t[2]:void 0,e.spatialReference=this.spatialReference,e}vectorToDehydratedPoint(t,e){var n;if(!t)return;null!==(n=e)&&void 0!==n||(e={x:void 0,y:void 0,z:void 0,m:void 0,hasZ:void 0,hasM:void 0,spatialReference:void 0,type:"point"});const i=this._valueType===Sa.Z,o=this._valueType===Sa.M;return e.x=t[0],e.y=t[1],e.z=i?t[2]:void 0,e.m=o?t[2]:void 0,e.hasZ=i,e.hasM=o,e.spatialReference=this.spatialReference,e}lerp(t,e,n,i){return(0,A.m)(i,t,e,n)}addDelta(t,e,n,i){t[0]+=e,t[1]+=n,this._valueType===Sa.Z&&(t[2]+=i)}distance(t,e){return this._valueType===Sa.Z?(0,A.j)(t,e):(0,v.TE)(t,e)}getZ(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return this._valueType===Sa.Z?t[2]:e}hasZ(){return this._valueType===Sa.Z}getM(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return this._valueType===Sa.M?t[2]:e}hasM(){return this._valueType===Sa.M}clone(t){return this._tag((0,g.nI)(t))}copy(t,e){return(0,A.c)(e,t)}fromXYZ(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this._tag((0,g.al)(t[0],t[1],this._valueType===Sa.Z?t.length>2?t[2]:e:n))}toXYZ(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(0,g.Ue)();return(0,A.i)(e,t[0],t[1],this._valueType===Sa.Z?t[2]:0)}pointToXYZ(t){var e;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(0,g.Ue)();return(0,A.i)(n,t.x,t.y,this._valueType===Sa.Z&&null!==(e=t.z)&&void 0!==e?e:0)}equals(t,e){return(0,A.H)(t,e)}_tag(t){return t}}class Pa{constructor(t){this.spatialReference=t}createVector(){return this._tag((0,he.Ue)())}pointToVector(t){return this._tag((0,he.al)(t.x,t.y,t.z,t.m))}arrayToVector(t){return this._tag((0,he.al)(t[0],t[1],t[2]||0,t[3]||0))}vectorToArray(t){return[t[0],t[1],t[2],t[3]]}pointToArray(t){return[t.x,t.y,t.z,t.m]}vectorToPoint(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new D.Z;return e.x=t[0],e.y=t[1],e.z=t[2],e.m=t[3],e.spatialReference=this.spatialReference,e}arrayToPoint(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new D.Z;return e.x=t[0],e.y=t[1],e.z=t[2],e.m=t[3],e.spatialReference=this.spatialReference,e}vectorToDehydratedPoint(t,e){var n;if(t)return null!==(n=e)&&void 0!==n||(e={x:void 0,y:void 0,z:void 0,m:void 0,hasZ:void 0,hasM:void 0,spatialReference:void 0,type:"point"}),e.x=t[0],e.y=t[1],e.z=t[2],e.m=t[3],e.hasZ=!0,e.hasM=!0,e.spatialReference=this.spatialReference,e}lerp(t,e,n,i){return(0,ue.l)(i,t,e,n)}addDelta(t,e,n,i){t[0]+=e,t[1]+=n,t[2]+=i}distance(t,e){return(0,A.j)(t,e)}getZ(t){return t[2]}hasZ(){return!0}getM(t){return t[3]}hasM(){return!0}clone(t){return this._tag((0,he.nI)(t))}copy(t,e){return(0,ue.c)(e,t)}fromXYZ(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this._tag((0,he.al)(t[0],t[1],t.length>2?t[2]:e,n))}toXYZ(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(0,g.Ue)();return(0,A.i)(e,t[0],t[1],t[2])}pointToXYZ(t){var e;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(0,g.Ue)();return(0,A.i)(n,t.x,t.y,null!==(e=t.z)&&void 0!==e?e:0)}equals(t,e){return(0,ue.e)(t,e)}_tag(t){return t}}function ka(t,e,n){return t&&e?new Pa(n):e?new Ta(Sa.M,n):t?new Ta(Sa.Z,n):new Ea(n)}var Ra,Aa,Va=n(45925),Ua=n(37818),Ia=n(41644);class Oa{constructor(t){this.component=t,this.leftEdge=null,this.rightEdge=null,this.type="vertex",this.index=null}get pos(){return this._pos}set pos(t){this._pos=t,this.component.unnormalizeVertexPositions()}}class Ga{constructor(t,e,n){this.component=t,this.leftVertex=e,this.rightVertex=n,this.type="edge",e.rightEdge=this,n.leftEdge=this}}class Za{constructor(t,e){this._spatialReference=t,this._viewingMode=e,this.vertices=[],this.edges=[],this.index=null}unnormalizeVertexPositions(){this.vertices.length<=1||function(t,e){if(!e.supported)return;let n=1/0,i=-1/0;const o=e.upperBoundX-e.lowerBoundX;t.forEach((t=>{let r=t.pos[0];for(;r<e.lowerBoundX;)r+=o;for(;r>e.upperBoundX;)r-=o;n=Math.min(n,r),i=Math.max(i,r),t.pos[0]=r}));const r=i-n;o-r<r&&t.forEach((t=>{t.pos[0]<0&&(t.pos[0]+=o)}))}(this.vertices,function(t,e){const n=(0,Ut.C5)(t);return e===wa.JY.Global&&n?{supported:!0,lowerBoundX:n.valid[0],upperBoundX:n.valid[1]}:{supported:!1,lowerBoundX:null,upperBoundX:null}}(this._spatialReference,this._viewingMode))}updateVertexIndex(t,e){if(0===this.vertices.length)return;const n=this.vertices[0];let i=null,o=t,r=e;do{i=o,i.index=r++,o=i.rightEdge?i.rightEdge.rightVertex:null}while(null!=o&&o!==n);i.leftEdge&&i!==this.vertices[this.vertices.length-1]&&this.swapVertices(this.vertices.indexOf(i),this.vertices.length-1)}getFirstVertex(){return this.vertices.at(0)}getLastVertex(){return this.vertices.at(-1)}isClosed(){return this.vertices.length>2&&null!==this.vertices[0].leftEdge}swapVertices(t,e){const n=this.vertices[t];this.vertices[t]=this.vertices[e],this.vertices[e]=n}iterateVertices(t){if(0===this.vertices.length)return;const e=this.vertices[0];let n=e;do{t(n,n.index),n=null!=n.rightEdge?n.rightEdge.rightVertex:null}while(n!==e&&null!=n)}}class La extends ut.Z{constructor(t,e){super(),this.type=t,this.coordinateHelper=e,this._geometry=null,this._dirty=!0,this.components=[]}get geometry(){if(this._dirty){switch(this.type){case"point":this._geometry=this._toPoint();break;case"polyline":this._geometry=this._toPolyline();break;case"polygon":this._geometry=this._toPolygon();break;case"mesh":break;default:(0,Ia.Bg)(this.type)}this._dirty=!1}return this._geometry}get spatialReference(){return this.coordinateHelper.spatialReference}get allVertices(){return Array.from(this.iterateVertices())}*iterateVertices(){for(const t of this.components)for(const e of t.vertices)yield e}notifyChanges(t){this._dirty=!0,this.emit("change",t)}_toPoint(){return 0===this.components.length||0===this.components[0].vertices.length?null:this.coordinateHelper.vectorToPoint(this.components[0].vertices[0].pos)}_toPolyline(){const t=[],e=this.coordinateHelper.vectorToArray;for(const n of this.components){if(n.vertices.length<1)continue;const i=[];let o=n.vertices.find((t=>null==t.leftEdge));const r=o;do{i.push(e(o.pos)),o=o.rightEdge?o.rightEdge.rightVertex:null}while(o&&o!==r);t.push(i)}return new z.Z({paths:t,spatialReference:this.spatialReference,hasZ:this.coordinateHelper.hasZ(),hasM:this.coordinateHelper.hasM()})}_toPolygon(){const t=[],e=this.coordinateHelper.vectorToArray;for(const n of this.components){if(n.vertices.length<1)continue;const i=[],o=n.vertices[0];let r=o;const s=r;do{i.push(e(r.pos)),r=null!=r.rightEdge?r.rightEdge.rightVertex:null}while(r&&r!==s);n.isClosed()&&i.push(e(o.pos)),t.push(i)}return new St.Z({rings:t,spatialReference:this.spatialReference,hasZ:this.coordinateHelper.hasZ(),hasM:this.coordinateHelper.hasM()})}static fromGeometry(t,e){const n=t.spatialReference,i=ka(t.hasZ,t.hasM,n),o=new La(t.type,i);switch(t.type){case"polygon":!function(t,e,n){const i=e.spatialReference,o=t.coordinateHelper,r=e.rings;for(let s=0;s<r.length;++s){const e=r[s],a=new Za(i,n);a.index=s;const l=e.length>2&&(0,xt.fS)(e[0],e[e.length-1]),c=l?e.length-1:e.length;for(let t=0;t<c;++t){const n=o.arrayToVector(e[t]),i=new Oa(a);a.vertices.push(i),i.pos=n,i.index=t}const u=a.vertices.length-1;for(let t=0;t<u;++t){const e=a.vertices[t],n=a.vertices[t+1],i=new Ga(a,e,n);a.edges.push(i)}if(l){const t=new Ga(a,a.vertices[a.vertices.length-1],a.vertices[0]);a.edges.push(t)}t.components.push(a)}}(o,t,e);break;case"polyline":!function(t,e,n){const i=e.spatialReference,o=t.coordinateHelper,r=e.paths;for(let s=0;s<r.length;++s){const e=r[s],a=new Za(i,n);a.index=s;const l=e.length;for(let t=0;t<l;++t){const n=o.arrayToVector(e[t]),i=new Oa(a);a.vertices.push(i),i.pos=n,i.index=t}const c=a.vertices.length-1;for(let t=0;t<c;++t){const e=a.vertices[t],n=a.vertices[t+1],i=new Ga(a,e,n);a.edges.push(i)}t.components.push(a)}}(o,t,e);break;case"point":Da(o,t,e);break;case"mesh":Da(o,t.origin,e),o._geometry=t,o._dirty=!1}return o}}function Da(t,e,n){const i=e.spatialReference,o=t.coordinateHelper,r=new Za(i,n);r.index=0;const s=new Oa(r);s.index=0,s.pos=o.pointToVector(e),r.vertices.push(s),t.components.push(r)}function za(t){return"mesh"===t.type}!function(t){t[t.NEW_STEP=0]="NEW_STEP",t[t.ACCUMULATE_STEPS=1]="ACCUMULATE_STEPS"}(Ra||(Ra={}));class Ha{constructor(t,e,n){this._editGeometry=t,this._component=e,this._pos=n,this._addedVertex=null,this._originalEdge=null,this._left=null,this._right=null}apply(){let t="redo";null==this._addedVertex&&(t="apply",this._addedVertex=new Oa(this._component));const e=this._component.getLastVertex();if(null==e)this._component.vertices.push(this._addedVertex),this._addedVertex.pos=this._pos,this._addedVertex.index=0;else{let t=null;e.rightEdge&&(this._originalEdge=e.rightEdge,t=this._originalEdge.rightVertex,this._component.edges.splice(this._component.edges.indexOf(this._originalEdge),1)),this._component.vertices.push(this._addedVertex),this._addedVertex.pos=this._pos,null==this._left&&(this._left=new Ga(this._component,e,this._addedVertex)),this._component.edges.push(this._left),e.rightEdge=this._left,null!=this._originalEdge&&null!=t&&(null==this._right&&(this._right=new Ga(this._component,this._addedVertex,t)),this._component.edges.push(this._right),t.leftEdge=this._right),this._component.updateVertexIndex(this._addedVertex,e.index+1)}this._editGeometry.notifyChanges({operation:t,addedVertices:[this._addedVertex]})}undo(){null!=this._addedVertex&&(this._component.vertices.splice(this._component.vertices.indexOf(this._addedVertex),1),null!=this._left&&(this._component.edges.splice(this._component.edges.indexOf(this._left),1),this._left.leftVertex.rightEdge=null),null!=this._right&&(this._component.edges.splice(this._component.edges.indexOf(this._right),1),this._right.rightVertex.leftEdge=null),null!=this._originalEdge&&(this._component.edges.push(this._originalEdge),this._originalEdge.leftVertex.rightEdge=this._originalEdge,this._originalEdge.rightVertex.leftEdge=this._originalEdge),null!=this._left?this._component.updateVertexIndex(this._left.leftVertex,this._left.leftVertex.index):this._component.updateVertexIndex(this._addedVertex,0),this._editGeometry.notifyChanges({operation:"undo",removedVertices:[this._addedVertex]}))}accumulate(){return!1}}class Na{constructor(t,e,n){this._editGeometry=t,this._vertices=e,this.operation=n,this._undone=!1}apply(){this._vertices.forEach((t=>this.operation.apply(t))),this._editGeometry.components.forEach((t=>t.unnormalizeVertexPositions())),this._editGeometry.notifyChanges({operation:this._undone?"redo":"apply",updatedVertices:this._vertices})}undo(){this._vertices.forEach((t=>this.operation.undo(t))),this._editGeometry.notifyChanges({operation:"undo",updatedVertices:this._vertices}),this._undone=!0}canAccumulate(t){if(this._undone||t._vertices.length!==this._vertices.length)return!1;for(let e=0;e<t._vertices.length;++e)if(t._vertices[e]!==this._vertices[e])return!1;return this.operation.canAccumulate(t.operation)}accumulate(t){return!!(t instanceof Na&&this.canAccumulate(t))&&(this._vertices.forEach((e=>this.operation.accumulate(e,t.operation))),this.operation.accumulateParams(t.operation),this._editGeometry.components.forEach((t=>t.unnormalizeVertexPositions())),this._editGeometry.notifyChanges({operation:"apply",updatedVertices:this._vertices}),!0)}}!function(t){t[t.CUMULATIVE=0]="CUMULATIVE",t[t.REPLACE=1]="REPLACE"}(Aa||(Aa={}));class Fa{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this._editGeometry=t,this._vertices=e,this._minNumberOfVertices=n,this.removedVertices=null}apply(){let t="redo";if(null==this.removedVertices){const e=this.removedVertices=[];this._vertices.forEach((t=>{const n=this._removeVertex(t);null!=n&&e.push(n)})),t="apply"}else this.removedVertices.forEach((t=>{this._removeVertex(t.removedVertex)}));this._editGeometry.notifyChanges({operation:t,removedVertices:this._vertices})}undo(){var t;null!==(t=this.removedVertices)&&void 0!==t&&t.forEach((t=>{this._undoRemoveVertex(t)})),this._editGeometry.notifyChanges({operation:"undo",addedVertices:this._vertices})}accumulate(){return!1}_removeVertex(t){const e=t.component;if(e.vertices.length<=this._minNumberOfVertices)return null;const n={removedVertex:t,createdEdge:null},i=t.leftEdge,o=t.rightEdge;return e.vertices.splice(e.vertices.indexOf(t),1),i&&(e.edges.splice(e.edges.indexOf(i),1),i.leftVertex.rightEdge=null),o&&(e.edges.splice(e.edges.indexOf(o),1),o.rightVertex.leftEdge=null),0===t.index&&o&&this._vertices.length>0&&e.swapVertices(e.vertices.indexOf(o.rightVertex),0),i&&o&&(n.createdEdge=new Ga(e,i.leftVertex,o.rightVertex),e.edges.push(n.createdEdge)),o&&e.updateVertexIndex(o.rightVertex,o.rightVertex.index-1),n}_undoRemoveVertex(t){const e=t.removedVertex,n=t.removedVertex.component,i=e.leftEdge,o=e.rightEdge;t.createdEdge&&n.edges.splice(n.edges.indexOf(t.createdEdge),1),n.vertices.push(e),i&&(n.edges.push(i),i.leftVertex.rightEdge=i),o&&(n.edges.push(o),o.rightVertex.leftEdge=o),n.updateVertexIndex(e,e.index)}}class ja{constructor(t,e,n){this._editGeometry=t,this._edge=e,this._t=n,this.createdVertex=null,this._left=null,this._right=null}apply(){let t="redo";const e=this._edge,n=e.component,i=e.leftVertex,o=e.rightVertex;n.edges.splice(n.edges.indexOf(e),1),null==this.createdVertex&&(t="apply",this.createdVertex=new Oa(e.component)),n.vertices.push(this.createdVertex),this.createdVertex.pos=this._editGeometry.coordinateHelper.lerp(e.leftVertex.pos,e.rightVertex.pos,this._t,this._editGeometry.coordinateHelper.createVector()),null==this._left&&(this._left=new Ga(n,i,this.createdVertex)),this._left.leftVertex.leftEdge?n.edges.push(this._left):n.edges.unshift(this._left),i.rightEdge=this._left,null==this._right&&(this._right=new Ga(n,this.createdVertex,o)),n.edges.push(this._right),o.leftEdge=this._right,n.updateVertexIndex(this.createdVertex,i.index+1),this._editGeometry.notifyChanges({operation:t,addedVertices:[this.createdVertex]})}undo(){if(null==this.createdVertex||null==this._left||null==this._right)return null;const t=this._edge,e=t.component,n=this.createdVertex.leftEdge,i=this.createdVertex.rightEdge,o=null===n||void 0===n?void 0:n.leftVertex,r=null===i||void 0===i?void 0:i.rightVertex;e.vertices.splice(e.vertices.indexOf(this.createdVertex),1),e.edges.splice(e.edges.indexOf(this._left),1),e.edges.splice(e.edges.indexOf(this._right),1),this._edge.leftVertex.leftEdge?e.edges.push(this._edge):e.edges.unshift(this._edge),o&&(o.rightEdge=t),r&&(r.leftEdge=t),o&&e.updateVertexIndex(o,o.index),this._editGeometry.notifyChanges({operation:"undo",removedVertices:[this.createdVertex]})}accumulate(){return!1}}class Ya{constructor(t,e,n){this._editGeometry=t,this._vertex=e,this._pos=n}apply(){const t=null==this._originalPosition;t&&(this._originalPosition=this._vertex.pos),this._apply(t?"apply":"redo")}undo(){this._vertex.pos=this._originalPosition,this._editGeometry.notifyChanges({operation:"undo",updatedVertices:[this._vertex]})}accumulate(t){return t instanceof Ya&&t._vertex===this._vertex&&(this._pos=t._pos,this._apply("apply"),!0)}_apply(t){this._vertex.pos=this._pos,this._editGeometry.components.forEach((t=>t.unnormalizeVertexPositions())),this._editGeometry.notifyChanges({operation:t,updatedVertices:[this._vertex]})}}class Ba{constructor(t,e){this._editGeometry=t,this._component=e,this._createdEdge=null}apply(){let t="redo";if(null==this._createdEdge){t="apply";const e=this._component.getFirstVertex(),n=this._component.getLastVertex();if(this._component.isClosed()||this._component.vertices.length<3||null==e||null==n)return;this._createdEdge=new Ga(this._component,n,e)}this._createdEdge.leftVertex.rightEdge=this._createdEdge,this._createdEdge.rightVertex.leftEdge=this._createdEdge,this._component.edges.push(this._createdEdge),this._editGeometry.notifyChanges({operation:t})}undo(){null!=this._createdEdge&&((0,xt.Od)(this._component.edges,this._createdEdge),this._createdEdge.leftVertex.rightEdge=null,this._createdEdge.rightVertex.leftEdge=null,this._editGeometry.notifyChanges({operation:"undo"}))}accumulate(){return!1}}class Wa{constructor(t,e,n,i){this._editGeometry=t,this.dx=e,this.dy=n,this.dz=i,this._firstTime=!0}apply(){const t=this._firstTime?"apply":"redo";this._firstTime=!1,this._apply(t,this.dx,this.dy,this.dz)}undo(){this._apply("undo",-this.dx,-this.dy,-this.dz)}accumulate(t){const e=this._editGeometry.geometry;return t instanceof Wa&&t._editGeometry.geometry===e&&(this._apply("apply",t.dx,t.dy,t.dz),this.dx+=t.dx,this.dy+=t.dy,this.dz+=t.dz,!0)}_apply(t,e,n,i){const o=this._editGeometry.geometry;o.offset(e,n,i);const r=this._editGeometry.components[0].getFirstVertex();if(!r)return;const s=this._editGeometry.coordinateHelper;r.pos=s.pointToVector(o.origin),this._editGeometry.notifyChanges({operation:t,updatedVertices:[r]})}}class qa{constructor(t,e,n,i){this._helper=t,this.dx=e,this.dy=n,this.dz=i}_move(t,e,n,i){this._helper.addDelta(t.pos,e,n,i)}apply(t){this._move(t,this.dx,this.dy,this.dz)}undo(t){this._move(t,-this.dx,-this.dy,-this.dz)}canAccumulate(t){return t instanceof qa}accumulate(t,e){this._move(t,e.dx,e.dy,e.dz)}accumulateParams(t){this.dx+=t.dx,this.dy+=t.dy,this.dz+=t.dz}}var Xa=n(40927);class Ja{get plane(){return this._plane}get requiresSplitEdgeLeft(){return!this._left.isOriginalDirection}get requiresSplitEdgeRight(){return!this._right.isOriginalDirection}get edgeDirection(){return this._edgeDirection}constructor(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:tl.IMMEDIATE;this._helper=t,this._planeType=e,this._edge=n,this.distance=i,this._plane=(0,pe.Ue)(),this._offsetPlane=(0,pe.Ue)(),this._minDistance=-1/0,this._maxDistance=1/0,this._selectedArrow=1,o===tl.IMMEDIATE&&this._initialize()}_initialize(){this._initializeNeighbors(),this._initializePlane(),this._initializeDistanceConstraints()}_initializeNeighbors(){var t,e;const n=this._toXYZ(this._edge.leftVertex.pos),i=this._toXYZ(null===(t=this._edge.leftVertex.leftEdge)||void 0===t||null===(t=t.leftVertex)||void 0===t?void 0:t.pos),o=this._toXYZ(this._edge.rightVertex.pos),r=this._toXYZ(null===(e=this._edge.rightVertex.rightEdge)||void 0===e||null===(e=e.rightVertex)||void 0===e?void 0:e.pos);this._edgeDirection=(0,A.o)((0,g.Ue)(),n,o),i?(this._left=this._computeNeighbor(n,i,this._edgeDirection),this._right=this._computeNeighbor(o,r,this._edgeDirection,this._left)):(this._right=this._computeNeighbor(o,r,this._edgeDirection),this._left=this._computeNeighbor(n,i,this._edgeDirection,this._right))}_toXYZ(t){return null!=t?this._helper.toXYZ(t):null}_pointToXYZ(t){return this._toXYZ(this._helper.pointToVector(t))}_computeNeighbor(t,e,n,i){const o=(0,g.Ue)();if(e){(0,A.o)(o,t,e);const i=!this._passesBisectingAngleThreshold(o,n);return{start:t,end:e,direction:i?this._bisectVectorsPerpendicular(n,o):o,isOriginalDirection:!i}}return this._helper.hasZ()?i&&((0,A.e)(o,n,i.direction),(0,A.e)(o,o,n),(0,A.n)(o,o),Math.sign(o[1])!==Math.sign(n[0])&&(0,A.h)(o,o,-1)):(0,A.i)(o,-n[1],n[0],0),{start:t,end:e,direction:o,isOriginalDirection:!0}}_passesBisectingAngleThreshold(t,e){const n=Math.abs((0,Xa.EU)(e,t));return n>=Ka&&n<=Math.PI-Ka}_bisectVectorsPerpendicular(t,e){const n=(0,A.f)(t,e)<0?t:(0,A.v)((0,g.Ue)(),t),i=Math.abs((0,A.f)(n,e));if(!(i<Qa||i>1-Qa))return this._bisectDirection(n,e);const o=(0,A.e)((0,g.Ue)(),n,[0,0,1]);return(0,A.n)(o,o)}_bisectDirection(t,e){const n=(0,A.g)((0,g.Ue)(),t,e);return(0,A.n)(n,n)}_initializePlane(){const t=this._computeNormalDirection(this._left),e=this._computeNormalDirection(this._right);(0,A.f)(t,e)<0&&(0,A.v)(e,e),(0,pe.Yq)(this._left.start,this._bisectDirection(t,e),this._plane)}_computeNormalDirection(t){const e=(0,A.e)((0,g.Ue)(),t.direction,this._edgeDirection);(0,A.n)(e,e);const n=(0,A.e)((0,g.Ue)(),this._edgeDirection,e);return this._planeType===$a.XY&&(n[2]=0),(0,A.n)(n,n)}_initializeDistanceConstraints(){null==this._left.end||this.requiresSplitEdgeLeft||this._updateDistanceConstraint((0,pe.jH)(this._plane,this._left.end)),null==this._right.end||this.requiresSplitEdgeRight||this._updateDistanceConstraint((0,pe.jH)(this._plane,this._right.end)),this._updateIntersectDistanceConstraint(this._plane)}_updateDistanceConstraint(t){t<=0&&(this._minDistance=Math.max(this._minDistance,t)),t>=0&&(this._maxDistance=Math.min(this._maxDistance,t))}_updateIntersectDistanceConstraint(t){const e=(0,pe.st)(t),n=this._edgeDirection,i=(0,A.g)((0,g.Ue)(),this._left.start,this._left.direction),o=(0,A.g)((0,g.Ue)(),this._right.start,this._right.direction),r=this._pointInBasis2D((0,f.Ue)(),e,n,this._left.start),s=this._pointInBasis2D((0,f.Ue)(),e,n,i),a=this._pointInBasis2D((0,f.Ue)(),e,n,this._right.start),l=this._pointInBasis2D((0,f.Ue)(),e,n,o),[c]=function(t,e){const n=t.start,i=t.end,o=e.start,r=e.end,s=(0,v.$X)(me,i,n),a=(0,v.$X)(be,r,o),l=_e(s,a);if(Math.abs(l)<=ye)return[];const c=(0,v.$X)(xe,n,o),u=_e(a,c)/l,h=_e(s,c)/l;if(u>=0){if(h>=0||e.type===ae.LINE)return[(0,v.od)(we,n,s,u)]}else if(t.type===ae.LINE&&(h>=0||e.type===ae.LINE))return[(0,v.od)(we,n,s,u)];return[]}({start:s,end:r,type:ae.LINE},{start:l,end:a,type:ae.LINE});if(!c)return;const u=(0,v.$X)((0,f.Ue)(),r,s);(0,v.Fv)(u,u);const h=(0,v.$X)((0,f.Ue)(),c,s),d=(0,v.AK)(u,h),p=(0,A.g)((0,g.Ue)(),i,(0,A.h)((0,g.Ue)(),this._left.direction,-d)),_=(0,pe.jH)(t,p);this._updateDistanceConstraint(_)}_pointInBasis2D(t,e,n,i){return t[0]=(0,Xa.SR)(e,i),t[1]=(0,Xa.SR)(n,i),t}_offset(t,e){Number.isFinite(this._minDistance)&&(e=Math.max(this._minDistance,e)),Number.isFinite(this._maxDistance)&&(e=Math.min(this._maxDistance,e)),(0,pe.JG)(this._offsetPlane,this._plane),this._offsetPlane[3]-=e;const n=(t,e,n)=>null!=e&&(0,pe.fn)(this._offsetPlane,t,(0,A.g)((0,g.Ue)(),t,e),n),i=(0,g.Ue)();(t===this._edge.leftVertex?n(this._left.start,this._left.direction,i):n(this._right.start,this._right.direction,i))&&this._helper.copy(this._helper.fromXYZ(i,void 0,this._helper.getM(t.pos)),t.pos)}selectArrowFromStartPoint(t){this._selectedArrow=(0,pe.Ac)(this.plane,this._pointToXYZ(t))?1:-1}get selectedArrow(){return this._selectedArrow}signedDistanceToPoint(t){return(0,pe.jH)(this.plane,this._pointToXYZ(t))}clampedStartAndEnd(t){const e=this._helper.toXYZ(this._helper.pointToVector(t)),n=(0,pe.nF)(this._plane,e,(0,g.Ue)()),i=(0,pe.jH)(this._plane,e),o=(0,ce.uZ)(i,this._minDistance,this._maxDistance);return(0,A.m)(e,n,e,o/i),{start:n,end:e}}apply(t){this._offset(t,this.distance)}undo(t){this._offset(t,0)}canAccumulate(t){return t instanceof Ja&&this._edge.leftVertex.index===t._edge.leftVertex.index&&this._edge.rightVertex.index===t._edge.rightVertex.index&&this._edge.component===t._edge.component&&this._maybeEqualsVec3(this._left.direction,t._left.direction)&&this._maybeEqualsVec3(this._right.direction,t._right.direction)&&(0,A.H)((0,pe.st)(this._plane),(0,pe.st)(t._plane))}accumulate(t,e){const n=this._plane[3]-e._plane[3]+e.distance;this._offset(t,n)}accumulateParams(t){const e=t.distance-t._plane[3];this.distance=e+this._plane[3]}clone(){const t=new Ja(this._helper,this._planeType,this._edge,this.distance,tl.DEFERRED);return(0,pe.JG)(t._plane,this._plane),(0,pe.JG)(t._offsetPlane,this._offsetPlane),t._maxDistance=this._maxDistance,t._minDistance=this._minDistance,t._left=this._cloneNeighbor(this._left),t._right=this._cloneNeighbor(this._right),t._edgeDirection=(0,A.c)((0,g.Ue)(),this._edgeDirection),t}_maybeEqualsVec3(t,e){return null==t&&null==e||null!=t&&null!=e&&(0,A.H)(t,e)}_cloneNeighbor(t){let{start:e,end:n,direction:i,isOriginalDirection:o}=t;return{start:(0,A.c)((0,g.Ue)(),e),end:null!=n?(0,A.c)((0,g.Ue)(),n):null,direction:(0,A.c)((0,g.Ue)(),i),isOriginalDirection:o}}}const Ka=(0,ce.Vl)(15),Qa=.001;var $a,tl,el;!function(t){t[t.XYZ=0]="XYZ",t[t.XY=1]="XY"}($a||($a={})),function(t){t[t.IMMEDIATE=0]="IMMEDIATE",t[t.DEFERRED=1]="DEFERRED"}(tl||(tl={}));class nl{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Aa.CUMULATIVE;this.origin=t,this.angle=e,this._accumulationType=n}_rotate(t,e){(0,v.U1)(t.pos,t.pos,this.origin,e)}apply(t){this._rotate(t,this.angle)}undo(t){this._rotate(t,-this.angle)}canAccumulate(t){return t instanceof nl&&(0,xt.fS)(this.origin,t.origin)}accumulate(t,e){const n=e._accumulationType===Aa.REPLACE;this._rotate(t,n?e.angle-this.angle:e.angle)}accumulateParams(t){const e=t._accumulationType===Aa.REPLACE;this.angle=e?t.angle:this.angle+t.angle}}class il{constructor(t,e,n,i){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Aa.CUMULATIVE;this.origin=t,this.axis1=e,this.factor1=n,this.factor2=i,this._accumulationType=o,this.axis2=(0,f.al)(e[1],-e[0])}_scale(t,e,n){(0,v.LG)(t.pos,t.pos,this.origin,this.axis1,e),(0,v.LG)(t.pos,t.pos,this.origin,this.axis2,n)}apply(t){this._scale(t,this.factor1,this.factor2)}undo(t){this._scale(t,1/this.factor1,1/this.factor2)}canAccumulate(t){return t instanceof il&&(0,xt.fS)(this.origin,t.origin)&&(0,xt.fS)(this.axis1,t.axis1)}accumulate(t,e){e._accumulationType===Aa.REPLACE?this._scale(t,e.factor1/this.factor1,e.factor2/this.factor2):this._scale(t,e.factor1,e.factor2)}accumulateParams(t){const e=t._accumulationType===Aa.REPLACE;this.factor1=e?t.factor1:this.factor1*t.factor1,this.factor2=e?t.factor2:this.factor2*t.factor2}}class ol{constructor(t,e){this._editGeometry=t,this._newPositions=e}apply(){const t=null==this._originalPositions?"apply":"redo";if(!this._originalPositions){const t=this._editGeometry.coordinateHelper;this._originalPositions=this._editGeometry.allVertices.map((e=>t.clone(e.pos)))}this._apply(t,this._newPositions)}undo(){this._originalPositions&&this._apply("undo",this._originalPositions)}accumulate(t){return t instanceof ol&&(this._newPositions=t._newPositions,this._apply("apply",this._newPositions),!0)}_apply(t,e){const n=this._editGeometry.coordinateHelper,i=this._editGeometry.allVertices;for(let o=0;o<i.length;o++)n.copy(e[o],i[o].pos);this._editGeometry.components.forEach((t=>t.unnormalizeVertexPositions())),this._editGeometry.notifyChanges({operation:t,updatedVertices:i})}}const rl=Symbol();class sl{constructor(t){this._operations=[],this._closed=!1,this[el]=!0,t&&(this._operations=t,this._closed=!0)}close(){this._closed=!0}apply(){for(const t of this._operations)t.apply()}undo(){for(let t=this._operations.length-1;t>=0;t--)this._operations[t].undo()}accumulate(t){if(this._closed)return!1;const e=this._operations.length?this._operations[this._operations.length-1]:null;return e&&e.accumulate(t)||(this._operations.push(t),t.apply()),!0}}el=rl;class al extends ut.Z{constructor(t,e){super(),this.data=t,this.viewingMode=e,this._undoStack=[],this._redoStack=[],this._listener=this.data.on("change",(t=>{t.addedVertices&&this.emit("vertex-add",{type:"vertex-add",vertices:t.addedVertices,operation:t.operation}),t.removedVertices&&this.emit("vertex-remove",{type:"vertex-remove",vertices:t.removedVertices,operation:t.operation}),t.updatedVertices&&this.emit("vertex-update",{type:"vertex-update",vertices:t.updatedVertices,operation:t.operation})}))}destroy(){this._listener.remove()}splitEdge(t,e){return this._apply(new ja(this.data,t,e))}updateVertices(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ra.ACCUMULATE_STEPS;return this._apply(new Na(this.data,t,e),n)}move(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Ra.ACCUMULATE_STEPS;return za(this.data)?this._apply(new Wa(this.data,t,e,n),i):this.moveVertices(this.data.allVertices,t,e,n,i)}moveVertices(t,e,n,i){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Ra.ACCUMULATE_STEPS;return za(this.data)?this._apply(new Wa(this.data,e,n,i),o):this.updateVertices(t,new qa(this.data.coordinateHelper,e,n,i),o)}scale(t,e,n,i){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Ra.ACCUMULATE_STEPS,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Aa.CUMULATIVE;return this.scaleVertices(this.data.allVertices,t,e,n,i,o,r)}scaleVertices(t,e,n,i,o){let r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Ra.ACCUMULATE_STEPS,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Aa.CUMULATIVE;return this.updateVertices(t,new il(e,n,i,o,s),r)}rotate(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ra.ACCUMULATE_STEPS,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Aa.CUMULATIVE;return this.rotateVertices(this.data.allVertices,t,e,n,i)}rotateVertices(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Ra.ACCUMULATE_STEPS,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Aa.CUMULATIVE;return this.updateVertices(t,new nl(e,n,o),i)}removeVertices(t){return this._apply(new Fa(this.data,t,this._minNumVerticesPerType))}appendVertex(t){return 0===this.data.components.length?null:this._apply(new Ha(this.data,this.data.components[0],t))}setVertexPosition(t,e){return this._apply(new Ya(this.data,t,e))}offsetEdge(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Ra.ACCUMULATE_STEPS;return this.updateVertices([e.leftVertex,e.rightVertex],new Ja(this.data.coordinateHelper,t,e,n),i)}trySetGeometry(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ra.ACCUMULATE_STEPS;const{data:n}=this,{coordinateHelper:i}=n;if(n.type!==t.type||!n.spatialReference.equals(t.spatialReference)||i.hasZ()!==t.hasZ||i.hasM()!==t.hasM||!(0,Vt.Pt)(n.geometry,t)||za(n))return;const o=Array.from(La.fromGeometry(t,this.viewingMode).iterateVertices(),(t=>t.pos));return this.setVertexPositions(o,e)}setVertexPositions(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ra.ACCUMULATE_STEPS;return this._apply(new ol(this.data,t),e)}createResetState(){if(za(this.data))return this._createResetStateMesh();const t=this.data.geometry.clone();return(0,a.kB)((()=>this.trySetGeometry(t)))}closeComponent(t){return this.data.components.includes(t)?this._apply(new Ba(this.data,t)):null}canRemoveVertex(t){return t.vertices.length>this._minNumVerticesPerType}createUndoGroup(){const t=new sl;return this._apply(t),(0,a.kB)((()=>t.close()))}undo(){if(this._undoStack.length>0){const t=this._undoStack.pop();return t.undo(),this._redoStack.push(t),t}return null}redo(){if(this._redoStack.length>0){const t=this._redoStack.pop();return t.apply(),this._undoStack.push(t),t}return null}get canUndo(){return this._undoStack.length>0}get canRedo(){return this._redoStack.length>0}get lastOperation(){return this._undoStack.length>0?this._undoStack[this._undoStack.length-1]:null}get _minNumVerticesPerType(){switch(this.data.type){case"point":return 1;case"polyline":return 2;case"polygon":return 3;default:return 0}}_apply(t){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ra.ACCUMULATE_STEPS)!==Ra.NEW_STEP&&null!=this.lastOperation&&this.lastOperation.accumulate(t)||(t.apply(),this._undoStack.push(t),this._redoStack=[]),t}_createResetStateMesh(){if(!za(this.data))return(0,a.kB)();const t=this.data.geometry,{vertexSpace:e}=t;if(e.origin){const n=(0,g.d9)(e.origin);return(0,a.kB)((()=>{t.vertexSpace.origin=n}))}const n=t.vertexAttributes.clonePositional();return(0,a.kB)((()=>{t.vertexAttributes=n,t.vertexAttributesChanged()}))}static fromGeometry(t,e){return new al(La.fromGeometry(t,e),e)}}function ll(t,e){return t.events.on("drag",function(t,e){let n=null,i=null;return o=>{if("cancel"===o.action)return void(null!=i&&(i.execute({action:"cancel"}),n=null,i=null));const r={action:o.action,screenStart:o.start,screenEnd:o.screenPoint};"start"===o.action&&null==n&&(n=new hl,i=new hl,e(t,n,i,o.pointerType,r)),null!=n&&n.execute(r),"end"===o.action&&null!=n&&(n=null,i=null)}}(t,e))}function cl(t){var e;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2?arguments[2]:void 0,r=null;const s=null==n||null!==(e=t.spatialReference)&&void 0!==e&&e.equals(n)?t=>t:t=>null!=t?(0,Va.project)(t,n):t,a=(0,o.Z)({exclude:[]},i);return e=>{if("start"===e.action&&(r=s(t.toMap(e.screenStart,a))),null==r)return null;const n=s(t.toMap(e.screenEnd,a));return null!=n?(0,o.Z)((0,o.Z)({},e),{},{mapStart:r,mapEnd:n}):null}}const ul=()=>{};class hl{constructor(){this.execute=ul}next(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new hl;return null!=t&&(this.execute=n=>{const i=t(n);null!=i&&e.execute(i)}),e}}class dl{constructor(t){this.vertexHandle=null,this.excludeFeature=null,this.visualizer=null,this.selfSnappingZ=null,this.drawConstraints=null,this.editGeometryOperations=t.editGeometryOperations,this.elevationInfo=t.elevationInfo,this.pointer=t.pointer,this.vertexHandle=t.vertexHandle,this.excludeFeature=t.excludeFeature,this.feature=t.feature,this.visualizer=t.visualizer,this.selfSnappingZ=t.selfSnappingZ,this.drawConstraints=t.drawConstraints}get coordinateHelper(){return this.editGeometryOperations.data.coordinateHelper}get spatialReference(){return this.coordinateHelper.spatialReference}}var pl=n(96638);function vl(t){let{predicate:e=(()=>!0),snappingManager:n,snappingContext:i,updatingHandles:r,useZ:s=!0}=t;const a=new hl;if(null==n)return{snappingStep:[yl,a],cancelSnapping:yl};let u,h=null,d=null,p=null;const v=()=>{var t;h=(0,l.IM)(h),n.doneSnapping(),null!==(t=d)&&void 0!==t&&t.frameTask.remove(),d=null,u=(0,l.hw)(u),p=null},f=function(t,e,n){return(0,oo.Ds)((async(i,o)=>{let{frameTask:r,point:s,scenePoint:a,context:l,event:c,delta:u,getLastState:h}=i;const d=await r.schedule((()=>t.snap({point:s,scenePoint:a,context:l,signal:o})),o);if(d.valid){let i=await r.schedule((()=>d.apply()),o);const a=h();null!=a.point&&s!==a.point&&(i=t.update({point:a.point,scenePoint:a.scenePoint,context:l})),null!=a.updatePoint&&(0,yt.kg)(i,a.updatePoint)||(_l(c.mapEnd,i,u,e),n.execute(c))}}))}(n,s,a);let g=null,_=null,y=null;return{snappingStep:[t=>{if(!e(t))return t;const{action:a}=t;if("start"===a){const{info:e}=t,o=function(t){return"3d"===t.type?t.resourceController.scheduler.registerTask(pl.T8.SNAPPING):pl.sq}(n.view);if(d=function(t,e,n){return{context:new dl({editGeometryOperations:t.editGeometryOperations,elevationInfo:t.elevationInfo,pointer:t.pointer,vertexHandle:null!=e.info?e.info.handle:null,excludeFeature:t.excludeFeature,feature:t.feature,visualizer:t.visualizer}),originalPos:null!=e.snapOrigin?t.coordinateHelper.vectorToDehydratedPoint(e.snapOrigin):e.mapStart,originalScenePos:null!=e.scenePoints?e.scenePoints.sceneStart:null,frameTask:n}}(i,t,o),d.context.selfSnappingZ=null,!s&&null!=e){var l;const t=function(t,e){if(!t.hasZ())return null;const n=e.vertices;let i=null;for(const o of n){const e=t.getZ(o.pos);if(null!=i&&null!=e&&Math.abs(e-i)>1e-6)return null;null==i&&(i=e)}return i}(i.coordinateHelper,e.handle.component);null!=t&&(d.context.selfSnappingZ={value:t,elevationInfo:null!==(l=i.elevationInfo)&&void 0!==l?l:m.jG})}}if(null!=d){const{context:e,originalScenePos:i,originalPos:l}=d,{mapEnd:v,mapStart:m,scenePoints:b}=t,x=fl(l,gl(v,m)),w=gl(m,l),C=(0,o.Z)((0,o.Z)({},t),{},{action:"update"}),M=d.context,S=function(t,e){return null==t||null==e?null:fl(t,gl(e.sceneEnd,e.sceneStart))}(i,b),E=n.update({point:x,scenePoint:S,context:e});if(y=E,_l(v,E,w,s),g=x,_=S,"end"!==a){const{frameTask:t}=d;null==h&&(h=new AbortController),p=e=>{r.addPromise((0,oo.R8)(f({frameTask:t,event:C,context:M,point:x,scenePoint:S,delta:w,getLastState:()=>({point:g,scenePoint:_,updatePoint:e.forceUpdate?null:y})},h.signal)))},p({forceUpdate:!1}),null==u&&(u=(0,c.YP)((()=>n.options.effectiveEnabled),(()=>{var t;return null===(t=p)||void 0===t?void 0:t({forceUpdate:!0})})))}}return"end"===a&&v(),t},a],cancelSnapping:t=>(v(),t)}}function fl(t,e){let[n,i,o]=e;const r=(0,Ua.WG)(t);return r.x+=n,r.y+=i,r.hasZ&&(r.z+=o),r}function gl(t,e){const n=t.hasZ&&e.hasZ?t.z-e.z:0;return[t.x-e.x,t.y-e.y,n]}function _l(t,e,n,i){let[o,r,s]=n;t.x=e.x+o,t.y=e.y+r,i&&t.hasZ&&e.hasZ&&(t.z=e.z+s)}function yl(t){return t}let ml=class extends Q.Z{constructor(t){super(t),this.constrainResult=t=>t,this._snapPoints=null,this._frameTask=null,this._abortController=null,this._stagedPoint=null,this._snap=(0,oo.Ds)((async(t,e,n,i)=>{const r=this._frameTask;if(null==r)return;const s=await r.schedule((()=>e.snap((0,o.Z)((0,o.Z)({},t),{},{context:n,signal:i}))),i);s.valid&&await r.schedule((()=>{this.stagedPoint=s.apply(),t!==this._snapPoints&&null!=this._snapPoints&&(this.stagedPoint=e.update((0,o.Z)((0,o.Z)({},this._snapPoints),{},{context:n})))}),i)}))}get stagedPoint(){return this._stagedPoint}set stagedPoint(t){this._stagedPoint=this.constrainResult(t)}initialize(){var t;const e="3d"===this.view.type?null===(t=this.view)||void 0===t||null===(t=t.resourceController)||void 0===t?void 0:t.scheduler:null;this._frameTask=null!=e?e.registerTask(pl.T8.SNAPPING):pl.sq}destroy(){this._abortController=(0,l.IM)(this._abortController),this._frameTask=(0,l.hw)(this._frameTask)}update(t,e,n){this._snapPoints=t;const{point:i,scenePoint:o}=t,r=e.update({point:i,scenePoint:o,context:n});return this.stagedPoint=r,r}async snap(t,e,n){const{point:i,scenePoint:o}=t;return this.stagedPoint=e.update({point:i,scenePoint:o,context:n}),this._snapPoints=t,null==this._abortController&&(this._abortController=new AbortController),this._snap(t,e,n,this._abortController.signal)}async snapAgainNearPreviousMapPoint(t,e){null!=this._snapPoints&&await this.snap(this._snapPoints,t,e)}abort(){this._abortController=(0,l.IM)(this._abortController),this._snapPoints=null}};(0,r._)([(0,u.Cb)({constructOnly:!0})],ml.prototype,"view",void 0),(0,r._)([(0,u.Cb)()],ml.prototype,"stagedPoint",null),(0,r._)([(0,u.Cb)()],ml.prototype,"constrainResult",void 0),(0,r._)([(0,u.Cb)()],ml.prototype,"_stagedPoint",void 0),ml=(0,r._)([(0,h.j)("esri.views.interactive.snapping.SnappingOperation")],ml);n(86710),n(21149),n(3276);Symbol("grid-placement-graphic");var bl;!function(t){t[t.TARGET=0]="TARGET",t[t.REFERENCE=1]="REFERENCE",t[t.REFERENCE_EXTENSION=2]="REFERENCE_EXTENSION"}(bl||(bl={}));const xl=Symbol("snapping-toggle");const wl=Symbol(),Cl=Symbol();let Ml=class extends(ut.Z.EventedMixin(Q.Z)){constructor(t){super(t),this._createOperationCompleted=!1,this._hideDefaultCursor=!1,this._pointerDownStates=new ba.Z,this._stagedScreenPoint=null,this._stagedPointerType=null,this._updatingHandles=new tt.R,this._stagedPointerId=null,this.constraintsEnabled=!1,this.constraints=void 0,this._getPointConstraint=io(pi),this._getPolylineOrPolygonConstraint=io(vi),this.constraintZ=null,this.defaultZ=null,this.isDraped=!0,this.labelOptions=new na,this.cursor=null,this.loading=!1,this.snapToSceneEnabled=null,this.firstVertex=null,this.lastVertex=null,this.secondToLastVertex=null,null==t.elevationInfo&&(this.elevationInfo=(0,m.mF)(!!t.hasZ))}initialize(){const{geometryType:t,view:e}=this,n=e.spatialReference,i="viewingMode"in e.state?e.state.viewingMode:wa.JY.Local,r="segment"===t||"multipoint"===t?"polyline":t;this.coordinateHelper=ka(this.hasZ,this.hasM,n),this._editGeometryOperations=new al(new La(r,this.coordinateHelper),i),this._snappingOperation=new ml({view:e}),this.addHandles([(0,c.YP)((()=>({stagedPoint:this._snappingOperation.stagedPoint,constraint:this._constraint})),((t,e)=>{let{stagedPoint:n,constraint:i}=t;const{snappingOptions:o}=this;if(o&&(o.forceDisabled=null!=i&&Ln(i)),null!=e&&n===e.stagedPoint&&i!==e.constraint)return this._onKeyboardBasedChange();this._processCursor(null!==n&&void 0!==n?n:this._screenToMap(this._stagedScreenPoint))}),{equals:(t,e)=>t.stagedPoint===e.stagedPoint&&(0,l._W)(t.constraint,e.constraint)}),(0,c.YP)((()=>this.view.viewpoint),((t,e)=>{t&&e&&(0,xa.Hg)(t,e)&&this._onKeyboardBasedChange()}))]),this._activeComponent=new Za(n,i),this._editGeometryOperations.data.components.push(this._activeComponent);const s=this.segmentLabels;null!=s&&(s.context={view:e,editGeometryOperations:this._editGeometryOperations,elevationInfo:this.elevationInfo,labelOptions:this.labelOptions},this.addHandles((0,c.YP)((()=>this.labelOptions.enabled),(t=>{s.visible=t}),c.tX))),this.addHandles(this._editGeometryOperations.on(["vertex-add","vertex-update","vertex-remove"],(t=>{var e,n,i,r,s,a;const l=t.vertices.map((t=>({componentIndex:0,vertexIndex:t.index,coordinates:this.coordinateHelper.vectorToArray(t.pos)}))),c=l.map((t=>t.coordinates)),u=null!==(e=this.coordinateHelper.vectorToDehydratedPoint(null===(n=this._activeComponent.getFirstVertex())||void 0===n?void 0:n.pos))&&void 0!==e?e:null;(0,yt.kg)(u,this.firstVertex)||(this.firstVertex=u);const h=null!==(i=this.coordinateHelper.vectorToDehydratedPoint(null===(r=this._activeComponent.getLastVertex())||void 0===r?void 0:r.pos))&&void 0!==i?i:null;(0,yt.kg)(h,this.lastVertex)||(this.lastVertex=h);const d=null!==(s=this.coordinateHelper.vectorToDehydratedPoint(null===(a=this._activeComponent.edges.at(-1))||void 0===a||null===(a=a.leftVertex)||void 0===a?void 0:a.pos))&&void 0!==s?s:null;switch((0,yt.kg)(d,this.secondToLastVertex)||(this.secondToLastVertex=d),this._processCursor(this.cursorVertex),t.type){case"vertex-add":this.emit(t.type,(0,o.Z)((0,o.Z)({},t),{},{added:c,vertices:l}));break;case"vertex-update":this.emit(t.type,(0,o.Z)((0,o.Z)({},t),{},{updated:c,vertices:l}));break;case"vertex-remove":this.emit(t.type,(0,o.Z)((0,o.Z)({},t),{},{removed:c,vertices:l}))}})));const a=this._manipulator=new Ma({consumesClicks:!1,grabbableForEvent:t=>"click"!==this.drawingMode||"touch"===t.pointerType&&this._snappingEnabled&&1===this._pointerDownStates.size});this.manipulators.add(a),a.grabbable="point"!==t,this.addHandles([a.events.on("immediate-click",(t=>this._onImmediateClick(t))),a.events.on("immediate-double-click",(t=>this._onImmediateDoubleClick(t))),(0,c.YP)((()=>this.drawingMode),(()=>{this.removeHandles(wl),this.addHandles(this._createManipulatorDragPipeline(a),wl)}),c.tX),(0,c.YP)((()=>({effectiveCursor:this.effectiveCursor})),(t=>{let{effectiveCursor:e}=t;a.cursor=e}),c.tX)]),function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>{};const n=(0,c.YP)((()=>({view:t.view,snappingOptions:t.snappingOptions})),(n=>{let{view:i,snappingOptions:o}=n;if(t.removeHandles(xl),!i||!o)return;const r=Si.f.TOOL,s=[i.on("key-down",(t=>{t.key!==Ti||t.repeat||(o.enabledToggled=!0,e())}),r),i.on("key-up",(t=>{t.key===Ti&&(o.enabledToggled=!1,e())}),r),i.on("pointer-move",(t=>{const n=t.native.ctrlKey;o.enabledToggled!==n&&(o.enabledToggled=n,e())}),r)];t.addHandles(s,xl)}),c.tX);t.addHandles(n)}(this,(()=>{var t;const e=null!==(t=this.view.inputManager.latestPointerType)&&void 0!==t?t:"mouse",n=this._getSnappingContext(e);if(null!=this.snappingManager){const t=this._snappingOperation.snapAgainNearPreviousMapPoint(this.snappingManager,n);this._updatingHandles.addPromise((0,oo.R8)(t))}}))}destroy(){(0,l.SC)(this.segmentLabels),(0,l.SC)(this._snappingOperation),this._editGeometryOperations=(0,l.SC)(this._editGeometryOperations),this._updatingHandles.destroy()}get _isDragging(){const{_stagedPointerId:t,_manipulator:e}=this;return null!=t&&this._pointerDownStates.has(t)||e.grabbing||!e.interactive}get _snappingEnabled(){return null!=this.snappingManager&&this.snappingManager.options.effectiveEnabled}get _requiresScenePoint(){const t=this._updateAndGetEffectiveDrawSurface();return"3d"===this.view.type&&this.drawSurface!==t}get canRedo(){return this._editGeometryOperations.canRedo}get canUndo(){return this._editGeometryOperations.canUndo}get committedVertices(){return this._activeComponent.vertices.map((t=>this.coordinateHelper.vectorToArray(t.pos)))}get _constraint(){const{constraints:t,constraintsEnabled:e}=this;if(t&&e)switch(this.geometryType){case"point":return this._getPointConstraint(t);case"polygon":case"polyline":return this._getPolylineOrPolygonConstraint(this.lastVertex,this.secondToLastVertex,t)}}set drawingMode(t){this._set("drawingMode",null!==t&&void 0!==t?t:Ca)}get effectiveCursor(){return this.loading?"progress":this._hideDefaultCursor?null:this.cursor||"crosshair"}get interactive(){return this._manipulator.interactive}set interactive(t){this._manipulator.interactive=t}get isCompleted(){return this._createOperationCompleted}get numCommittedVertices(){return this._activeComponent.vertices.length}get snappingOptions(){return null!=this.snappingManager?this.snappingManager.options:null}get cursorVertex(){return this._get("cursorVertex")}get visualizationCursorVertex(){return"mouse"===this._stagedPointerType?this.cursorVertex:null}get committableVertex(){const{cursorVertex:t,lastVertex:e,firstVertex:n,geometryType:i}=this;return"polygon"===i&&(0,yt.Fz)(t,n)||(0,yt.Fz)(t,e)?null:t}get updating(){return this._updatingHandles.updating}get geometryIncludingUncommittedVertices(){const{committedVertices:t,committableVertex:e,coordinateHelper:n}=this,i=t.slice();return null!=e&&i.push(n.pointToArray(e)),i}cancel(){this.complete({aborted:!0})}commitStagedVertex(){this._snappingOperation.abort();const{committableVertex:t}=this;null!=t&&this._editGeometryOperations.appendVertex(this.coordinateHelper.pointToVector(t))}complete(t){var e;const n=(null===t||void 0===t?void 0:t.aborted)||!1;this._snappingOperation.abort(),null===(e=this.snappingManager)||void 0===e||e.doneSnapping();const{geometryType:i,numCommittedVertices:o}=this,r="multipoint"===i&&0===o||"polyline"===i&&o<2||"polygon"===i&&o<3;"segment"!==i&&"point"!==i||this.commitStagedVertex(),this._createOperationCompleted=!r,(this.isCompleted||n)&&(this._stagedScreenPoint=null,this._stagedPointerId=null,this._stagedPointerType=null,this._processCursor(null),this.emit("complete",{vertices:this.committedVertices.map(((t,e)=>({componentIndex:0,vertexIndex:e,coordinates:t}))),aborted:n,type:"complete"}))}onInputEvent(t){switch(t.type){case"pointer-down":this._pointerDownStates.add(t.pointerId);break;case"pointer-up":this._pointerDownStates.delete(t.pointerId)}switch(t.type){case"pointer-move":return this._onPointerMove(t);case"hold":return this._onHold(t)}}redo(){this._editGeometryOperations.redo()}undo(){null!=this.snappingManager&&this.snappingManager.doneSnapping(),this._editGeometryOperations.undo()}_processCursor(t){var e,n,i;const o=(0,wt.d9)(this.cursorVertex),r=(0,wt.d9)(t),s=r&&(null!==(e=null===(n=this._updateAndGetEffectiveDrawSurface())||void 0===n?void 0:n.constrainZ(r))&&void 0!==e?e:r),a=this._snapToClosingVertex(s),l=this._applyConstraints(a);(0,yt.Fz)(o,l)||(this._set("cursorVertex",l),null!==(i=this.segmentLabels)&&void 0!==i&&i.set("stagedVertex",null!=l?this.coordinateHelper.pointToVector(l):null),null==l||"mouse"!==this._stagedPointerType?this.emit("cursor-remove"):this.emit("cursor-update",{updated:null,vertices:[{componentIndex:0,vertexIndex:this._activeComponent.vertices.length,coordinates:this.coordinateHelper.pointToArray(l)}],operation:"apply",type:"vertex-update"}))}_snapToClosingVertex(t){if(null==t||this._isDragging||"polygon"!==this.geometryType||this.numCommittedVertices<=2)return t;const e=this._mapToScreen(t);if(!e)return t;const n=this._activeComponent;return this._vertexWithinPointerDistance(n.vertices[0].pos,e)?this.firstVertex:this._vertexWithinPointerDistance(n.vertices.at(-1).pos,e)?this.lastVertex:t}_createManipulatorDragPipeline(t){switch(this.drawingMode){case"click":return this._createManipulatorDragPipelineClick(t);case"freehand":return this._createManipulatorDragPipelineFreehand(t);case"hybrid":return this._createManipulatorDragPipelineHybrid(t)}}_createManipulatorDragPipelineClick(t){return ll(t,((t,e,n,i)=>{const r="touch"===i&&this._snappingEnabled;if(this.isCompleted||!r)return;const{snappingStep:s,cancelSnapping:a}=vl({predicate:()=>r,snappingManager:this.snappingManager,snappingContext:new dl({editGeometryOperations:this._editGeometryOperations,elevationInfo:this.elevationInfo,feature:this.graphic,pointer:i,visualizer:this.snappingVisualizer,drawConstraints:this.constraints}),updatingHandles:this._updatingHandles,useZ:!this._requiresScenePoint});n=n.next((t=>(r&&null!=this.snappingManager&&this.snappingManager.doneSnapping(),t))).next(a),e.next(this._screenToMapDragEventStep()).next((t=>("start"===t.action&&(this._processCursor(t.mapStart),("segment"===this.geometryType||r&&!this.numCommittedVertices)&&this.commitStagedVertex()),t))).next(function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if("2d"===t.type)return t=>t;let i=null;return r=>{"start"===r.action&&(i=t.toMap(r.screenStart,{exclude:n}),null!=i&&(i.z=(0,m.Ou)(i,t,e)));const s=t.toMap(r.screenEnd,{exclude:n});null!=s&&(s.z=(0,m.Ou)(s,t,e));const a=null!=i&&null!=s?{sceneStart:i,sceneEnd:s}:null;return(0,o.Z)((0,o.Z)({},r),{},{scenePoints:a})}}(this.view,this.elevationInfo)).next(...s).next((t=>(r&&(this._processCursor(t.mapEnd),"end"===t.action&&this.commitStagedVertex()),t))).next((t=>("end"===t.action&&("mouse"!==this._stagedPointerType&&this._snappingOperation.abort(),"segment"!==this.geometryType&&"point"!==this.geometryType||this.complete()),t)))}))}_createManipulatorDragPipelineFreehand(t){return ll(t,((t,e)=>{this.isCompleted||e.next(this._screenToMapDragEventStep()).next((t=>("start"===t.action&&(this._snappingOperation.abort(),null==this.committableVertex&&this._processCursor(t.mapStart),"segment"===this.geometryType&&this.commitStagedVertex()),t))).next((t=>{switch(t.action){case"start":case"update":this._processCursor(t.mapEnd),"polygon"!==this.geometryType&&"polyline"!==this.geometryType||this.commitStagedVertex();break;case"end":this.complete()}return t}))}))}_createManipulatorDragPipelineHybrid(t){return ll(t,((t,e)=>{this.isCompleted||e.next(this._screenToMapDragEventStep()).next((t=>("start"===t.action&&(this._snappingOperation.abort(),this.addHandles(this._editGeometryOperations.createUndoGroup(),Cl),this._processCursor(t.mapStart),this.commitStagedVertex()),t))).next((t=>{switch(t.action){case"start":case"update":this._processCursor(t.mapEnd),"polygon"!==this.geometryType&&"polyline"!==this.geometryType||this.commitStagedVertex();break;case"end":"mouse"!==this._stagedPointerType&&this._snappingOperation.abort(),this.removeHandles(Cl),"segment"!==this.geometryType&&"point"!==this.geometryType||this.complete()}return t}))}))}get _drawAtFixedElevation(){const{constraintsEnabled:t,constraintZ:e,geometryType:n,numCommittedVertices:i}=this;return t?null!=e||"segment"===n&&i>0:("segment"===n||"polygon"===n)&&i>0}_updateAndGetEffectiveDrawSurface(){var t;const{constraintsEnabled:e,coordinateHelper:n,drawSurface:i,elevationDrawSurface:o,snapToSceneEnabled:r}=this;if(null==o)return i;if(!this.hasZ)return o.defaultZ=null,o;const s=null===(t=this.elevationInfo)||void 0===t?void 0:t.mode;let a=this.defaultZ,l=e||"absolute-height"===s;var c;(null!=r&&(l=r),"on-the-ground"===s&&(l=!1),this._drawAtFixedElevation)&&(a=null!==(c=e?this.constraintZ:null)&&void 0!==c?c:n.getZ(this._activeComponent.vertices[0].pos),l=!1);return l?i:(o.defaultZ=a,o)}_mapToScreen(t){var e;return null===(e=this._updateAndGetEffectiveDrawSurface())||void 0===e?void 0:e.mapToScreen(t)}_onHold(t){this._snappingOperation.abort(),"click"===this.drawingMode&&"touch"===t.pointerType&&this._snappingEnabled&&this._processCursor(t.mapPoint),t.stopPropagation()}_onImmediateClick(t){if(!("mouse"===t.pointerType&&2===t.button||this._manipulator.dragging))try{const{drawingMode:e,geometryType:n}=this;this._stagedPointerType=t.pointerType,this._stagedScreenPoint=t.screenPoint;const i=this._screenToMap(t.screenPoint);if(null==i)return;if(null==i||"freehand"===e&&"point"!==n)return;if(this._snappingEnabled&&null!=this.cursorVertex||this._processCursor(i),null==this.committableVertex)return void this.complete();this.commitStagedVertex(),"mouse"!==t.pointerType&&this._processCursor(null),("freehand"===e||"point"===n||"segment"===n&&2===this.numCommittedVertices||"segment"===n&&"hybrid"===e&&1===this.numCommittedVertices)&&this.complete()}finally{t.stopPropagation()}}_onImmediateDoubleClick(t){this._manipulator.dragging||"point"===this.geometryType||(this.complete(),t.stopPropagation())}_onPointerMove(t){const e=(0,d.vW)(t.x,t.y);this._stagedScreenPoint=e,this._stagedPointerType=t.pointerType,this._stagedPointerId=t.pointerId,this._isDragging?this._snappingOperation.abort():(t.stopPropagation(),this._processCursorMovementRelativeToSurface(e,t.pointerType))}_onKeyboardBasedChange(){"mouse"===this._stagedPointerType&&this._stagedScreenPoint&&null!=this._stagedPointerId&&!this._isDragging?this._processCursorMovementRelativeToSurface(this._stagedScreenPoint,this._stagedPointerType):this._snappingOperation.abort()}_processCursorMovementRelativeToSurface(t,e){var n;const i=this._snappingOperation,o=this._screenToMap(t),r=this._requiresScenePoint?null===(n=this.drawSurface)||void 0===n?void 0:n.screenToMap(t):null;if(null==o)return this._hideDefaultCursor=!0,this._processCursor(null),void i.abort();this._hideDefaultCursor=!1;const s=this.snappingManager;if(null==s)return this._processCursor(o),void i.abort();const a=this._getSnappingContext(e);this._updatingHandles.addPromise((0,oo.R8)(i.snap({point:o,scenePoint:r},s,a)))}_applyConstraints(t){const{_constraint:e,constraints:n}=this;if(!t||!n||!e)return t;const{context:i}=n,o=gi(t,i),r=o?e.closestTo(o):void 0;if(!r)return t;const s=_i(r,t,i),a="2d"===this.view.type||"absolute-height"!==i.elevationInfo.mode;return null!=s&&a&&null!=this.constraintZ&&this.hasZ&&(s.z=this.constraintZ),s}_screenToMap(t){var e;return t?null===(e=this._updateAndGetEffectiveDrawSurface())||void 0===e?void 0:e.screenToMap(t):null}_screenToMapDragEventStep(){let t=null;return e=>{if("start"===e.action&&(t=this._screenToMap(e.screenStart)),null==t)return null;const n=this._screenToMap(e.screenEnd);return null!=n?(0,o.Z)((0,o.Z)({},e),{},{mapStart:t,mapEnd:n}):null}}_vertexWithinPointerDistance(t,e){const n=this._mapToScreen(this.coordinateHelper.vectorToDehydratedPoint(t));return null!=n&&function(t,e,n){const i=t.x-e.x,o=t.y-e.y;return i*i+o*o<=n}(n,e,25)}_getSnappingContext(t){var e;const n=this._drawAtFixedElevation?null===(e=this.elevationDrawSurface)||void 0===e?void 0:e.defaultZ:null;return new dl({editGeometryOperations:this._editGeometryOperations,elevationInfo:this.elevationInfo,pointer:t,feature:this.graphic,visualizer:this.snappingVisualizer,selfSnappingZ:null!=n?{value:n,elevationInfo:this.elevationInfo}:null,drawConstraints:this.constraints})}};(0,r._)([(0,u.Cb)()],Ml.prototype,"_hideDefaultCursor",void 0),(0,r._)([(0,u.Cb)()],Ml.prototype,"_stagedPointerId",void 0),(0,r._)([(0,u.Cb)()],Ml.prototype,"_isDragging",null),(0,r._)([(0,u.Cb)()],Ml.prototype,"_snappingOperation",void 0),(0,r._)([(0,u.Cb)()],Ml.prototype,"_snappingEnabled",null),(0,r._)([(0,u.Cb)({constructOnly:!0})],Ml.prototype,"graphic",void 0),(0,r._)([(0,u.Cb)()],Ml.prototype,"constraintsEnabled",void 0),(0,r._)([(0,u.Cb)()],Ml.prototype,"constraints",void 0),(0,r._)([(0,u.Cb)()],Ml.prototype,"_constraint",null),(0,r._)([(0,u.Cb)()],Ml.prototype,"constraintZ",void 0),(0,r._)([(0,u.Cb)()],Ml.prototype,"defaultZ",void 0),(0,r._)([(0,u.Cb)()],Ml.prototype,"isDraped",void 0),(0,r._)([(0,u.Cb)({value:Ca})],Ml.prototype,"drawingMode",null),(0,r._)([(0,u.Cb)({constructOnly:!0})],Ml.prototype,"elevationDrawSurface",void 0),(0,r._)([(0,u.Cb)({constructOnly:!0})],Ml.prototype,"elevationInfo",void 0),(0,r._)([(0,u.Cb)({constructOnly:!0,type:na})],Ml.prototype,"labelOptions",void 0),(0,r._)([(0,u.Cb)({constructOnly:!0})],Ml.prototype,"geometryType",void 0),(0,r._)([(0,u.Cb)({constructOnly:!0})],Ml.prototype,"hasM",void 0),(0,r._)([(0,u.Cb)({constructOnly:!0})],Ml.prototype,"hasZ",void 0),(0,r._)([(0,u.Cb)()],Ml.prototype,"cursor",void 0),(0,r._)([(0,u.Cb)()],Ml.prototype,"effectiveCursor",null),(0,r._)([(0,u.Cb)()],Ml.prototype,"loading",void 0),(0,r._)([(0,u.Cb)({constructOnly:!0})],Ml.prototype,"manipulators",void 0),(0,r._)([(0,u.Cb)({constructOnly:!0})],Ml.prototype,"drawSurface",void 0),(0,r._)([(0,u.Cb)({constructOnly:!0})],Ml.prototype,"segmentLabels",void 0),(0,r._)([(0,u.Cb)({constructOnly:!0})],Ml.prototype,"snappingManager",void 0),(0,r._)([(0,u.Cb)({constructOnly:!0})],Ml.prototype,"snappingVisualizer",void 0),(0,r._)([(0,u.Cb)()],Ml.prototype,"snapToSceneEnabled",void 0),(0,r._)([(0,u.Cb)({readOnly:!0})],Ml.prototype,"cursorVertex",null),(0,r._)([(0,u.Cb)({readOnly:!0})],Ml.prototype,"visualizationCursorVertex",null),(0,r._)([(0,u.Cb)()],Ml.prototype,"committableVertex",null),(0,r._)([(0,u.Cb)()],Ml.prototype,"firstVertex",void 0),(0,r._)([(0,u.Cb)()],Ml.prototype,"lastVertex",void 0),(0,r._)([(0,u.Cb)()],Ml.prototype,"secondToLastVertex",void 0),(0,r._)([(0,u.Cb)()],Ml.prototype,"updating",null),(0,r._)([(0,u.Cb)({constructOnly:!0})],Ml.prototype,"view",void 0),Ml=(0,r._)([(0,h.j)("esri.views.draw.DrawOperation")],Ml);class Sl{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.view=t,this.hasZ=e,this.defaultZ=n,this.mapToScreen=e=>t.toScreen(e),this.screenToMap=e?e=>{const i=t.toMap(e);return i.z=n,i}:e=>t.toMap(e)}constrainZ(t){const{defaultZ:e}=this;return this.hasZ&&t.z!==e&&((t=(0,Ua.WG)(t)).z=e),t}}class El{screenToMap(t){const{x:e,y:n}=t;return new D.Z({x:e,y:n,spatialReference:El.spatialReference})}mapToScreen(t){return(0,d.vW)(t.x,t.y)}constrainZ(t){return t}}El.spatialReference=new H.Z;let Tl=class extends fa{constructor(t){var e,n,i;super(t),this._visualElementGraphics={regularVertices:null,activeVertex:null,activeEdge:null},this.activeFillSymbol=null,this.type="draw-2d",this._visualElementSymbols={outline:null!==(e=t.activeLineSymbol)&&void 0!==e?e:W,regularVertices:null!==(n=t.regularVerticesSymbol)&&void 0!==n?n:q,activeVertex:null!==(i=t.activeVertexSymbol)&&void 0!==i?i:X,fill:t.activeFillSymbol},t.activeVertexSymbol||this.addHandles((0,c.YP)((()=>{var t;return null===(t=this.view)||void 0===t||null===(t=t.effectiveTheme)||void 0===t?void 0:t.accentColor}),(t=>{var e;if(!t)return;const n=this._visualElementSymbols.activeVertex.clone().set({color:t});null!==(e=this._visualElementGraphics.activeVertex)&&void 0!==e&&e.set("symbol",n),this._visualElementSymbols=(0,o.Z)((0,o.Z)({},this._visualElementSymbols),{},{activeVertex:n})}),c.nn))}normalizeCtorArgs(t){const e=(0,o.Z)({},t);return delete e.activeFillSymbol,delete e.activeVertexSymbol,delete e.regularVerticesSymbol,delete e.activeLineSymbol,e}initializeGraphic(t){return null!=this._visualElementSymbols.fill&&(t.symbol=this._visualElementSymbols.fill),this.internalGraphicsLayer.graphics.sort(Pl),(0,a.kB)()}makeDrawOperation(){const{defaultZ:t,hasZ:e,view:n}=this;return this._createOrUpdateGraphic(null),new Ml({view:n,manipulators:this.manipulators,geometryType:ya(this.geometryType),drawingMode:this.mode,hasZ:e,defaultZ:t,snapToSceneEnabled:this.snapToScene,drawSurface:new Sl(n,e,t),hasM:!1,snappingManager:this.snappingManager,snappingVisualizer:new Y(this.internalGraphicsLayer),graphic:this.graphic,cursor:this.cursor,constraintsEnabled:!0})}onActiveVertexChanged(t){if("point"===this.geometryType)return(0,a.kB)();const[e,n]=t,i=new D.Z({x:e,y:n,spatialReference:this.view.spatialReference});return null!=this._visualElementGraphics.activeVertex?(this._visualElementGraphics.activeVertex.geometry=i,(0,a.kB)()):(this._visualElementGraphics.activeVertex=new s.Z({geometry:i,symbol:this._visualElementSymbols.activeVertex,attributes:{displayOrder:2}}),this.internalGraphicsLayer.add(this._visualElementGraphics.activeVertex),this.internalGraphicsLayer.graphics.sort(Pl),(0,a.kB)((()=>{null!=this._visualElementGraphics.activeVertex&&(this.internalGraphicsLayer.remove(this._visualElementGraphics.activeVertex),this._visualElementGraphics.activeVertex=(0,l.SC)(this._visualElementGraphics.activeVertex))})))}onCursorEdgeChanged(t){return null!=this._visualElementGraphics.activeEdge?(this._visualElementGraphics.activeEdge.geometry=t,(0,a.kB)()):(this._visualElementGraphics.activeEdge=new s.Z({geometry:t,symbol:this._visualElementSymbols.outline,attributes:{displayOrder:0}}),this.internalGraphicsLayer.add(this._visualElementGraphics.activeEdge),this.internalGraphicsLayer.graphics.sort(Pl),(0,a.kB)((()=>{null!=this._visualElementGraphics.activeEdge&&(this.internalGraphicsLayer.remove(this._visualElementGraphics.activeEdge),this._visualElementGraphics.activeEdge=(0,l.SC)(this._visualElementGraphics.activeEdge))})))}onRegularVerticesChanged(t){const e=new jt.Z({points:t,spatialReference:this.view.spatialReference});return null!=this._visualElementGraphics.regularVertices?(this._visualElementGraphics.regularVertices.geometry=e,(0,a.kB)()):(this._visualElementGraphics.regularVertices=new s.Z({geometry:e,symbol:this._visualElementSymbols.regularVertices,attributes:{displayOrder:1}}),this.internalGraphicsLayer.add(this._visualElementGraphics.regularVertices),this.internalGraphicsLayer.graphics.sort(Pl),(0,a.kB)((()=>{null!=this._visualElementGraphics.regularVertices&&(this.internalGraphicsLayer.remove(this._visualElementGraphics.regularVertices),this._visualElementGraphics.regularVertices=(0,l.SC)(this._visualElementGraphics.regularVertices))})))}};function Pl(t,e){var n,i,o,r;return(null!==(n=null===(i=t.attributes)||void 0===i?void 0:i.displayOrder)&&void 0!==n?n:-1/0)-(null!==(o=null===(r=e.attributes)||void 0===r?void 0:r.displayOrder)&&void 0!==o?o:-1/0)}(0,r._)([(0,u.Cb)()],Tl.prototype,"activeFillSymbol",void 0),(0,r._)([(0,u.Cb)({readOnly:!0})],Tl.prototype,"type",void 0),(0,r._)([(0,u.Cb)({constructOnly:!0,nonNullable:!0})],Tl.prototype,"view",void 0),Tl=(0,r._)([(0,h.j)("esri.views.2d.interactive.editingTools.draw.DrawGraphicTool2D")],Tl);var kl,Rl=n(49729);class Al{get hovering(){return this.someManipulator((t=>t.hovering))}get grabbing(){return this.someManipulator((t=>t.grabbing))}get dragging(){return this.someManipulator((t=>t.dragging))}hasManipulator(t){return this.someManipulator((e=>e===t))}someManipulator(t){let e=!1;return this.forEachManipulator((n=>{!e&&t(n)&&(e=!0)})),e}}!function(t){t[t.TRANSLATE_XY=0]="TRANSLATE_XY",t[t.SCALE=1]="SCALE",t[t.ROTATE=2]="ROTATE"}(kl||(kl={}));var Vl=n(68859),Ul=n(61574),Il=n(64575);function Ol(t){let e=0,n=0,i=0;return t?("cim"===t.type&&t.data.symbol&&"symbolLayers"in t.data.symbol&&t.data.symbol.symbolLayers&&t.data.symbol.symbolLayers.map((t=>{"CIMVectorMarker"===t.type&&t.anchorPoint&&(Math.abs(t.anchorPoint.x)>e&&(e=t.anchorPoint.x),Math.abs(t.anchorPoint.y)>n&&(n=t.anchorPoint.y),null!=t.size&&t.size>i&&(i=t.size))})),e=(0,d.F2)(e),n=(0,d.F2)(n),i=(0,d.F2)(i),{offsetX:e,offsetY:n,size:i}):{offsetX:e,offsetY:n,size:i}}var Gl=n(45008);let Zl=class extends Q.Z{set graphic(t){this._circleCollisionCache=null,this._originalSymbol=t.symbol,this._set("graphic",t),this.attachSymbolChanged()}get elevationInfo(){const{layer:t}=this.graphic,e=t&&"elevationInfo"in t?t.elevationInfo:null,n=(0,m.vu)(this.graphic),i=e?e.offset:0;return new Il.Z({mode:n,offset:i})}set focusedSymbol(t){t!==this._get("focusedSymbol")&&(this._set("focusedSymbol",t),this._updateGraphicSymbol(),this._circleCollisionCache=null)}grabbableForEvent(){return!0}set grabbing(t){t!==this._get("grabbing")&&(this._set("grabbing",t),this._updateGraphicSymbol())}set hovering(t){t!==this._get("hovering")&&(this._set("hovering",t),this._updateGraphicSymbol())}set selected(t){t!==this._get("selected")&&(this._set("selected",t),this._updateGraphicSymbol(),this.events.emit("select-changed",{action:t?"select":"deselect"}))}get _focused(){return this._get("hovering")||this._get("grabbing")}constructor(t){super(t),this.layer=null,this.interactive=!0,this.selectable=!1,this.grabbable=!0,this.dragging=!1,this.cursor=null,this.consumesClicks=!0,this.events=new ut.Z.EventEmitter,this._circleCollisionCache=null,this._graphicSymbolChangedHandle=null,this._originalSymbol=null}destroy(){this.detachSymbolChanged(),this._resetGraphicSymbol(),this._set("view",null)}intersectionDistance(t){const e=this.graphic;if(!1===e.visible)return null;const n=e.geometry;if(null==n)return null;const i=this._get("focusedSymbol"),o=null!=i?i:e.symbol;return"2d"===this.view.type?this._intersectDistance2D(this.view,t,n,o):this._intersectDistance3D(this.view,t,e)}attach(){this.attachSymbolChanged(),null!=this.layer&&this.layer.add(this.graphic)}detach(){this.detachSymbolChanged(),this._resetGraphicSymbol(),null!=this.layer&&this.layer.remove(this.graphic)}attachSymbolChanged(){this.detachSymbolChanged(),this._graphicSymbolChangedHandle=(0,c.YP)((()=>{var t;return null===(t=this.graphic)||void 0===t?void 0:t.symbol}),(t=>{null!=t&&t!==this.focusedSymbol&&t!==this._originalSymbol&&(this._originalSymbol=t,this._focused&&null!=this.focusedSymbol&&(this.graphic.symbol=this.focusedSymbol))}),c.Z_)}detachSymbolChanged(){null!=this._graphicSymbolChangedHandle&&(this._graphicSymbolChangedHandle.remove(),this._graphicSymbolChangedHandle=null)}onElevationChange(){}onViewChange(){}_updateGraphicSymbol(){this.graphic.symbol=this._focused&&null!=this.focusedSymbol?this.focusedSymbol:this._originalSymbol}_resetGraphicSymbol(){this.graphic.symbol=this._originalSymbol}_intersectDistance2D(t,e,n,i){var o;if(null==(i=i||(0,Ul.js)(n)))return null;let r=this._circleCollisionCache;if("point"===n.type&&"cim"===i.type&&"CIMPointSymbol"===(null===(o=i.data.symbol)||void 0===o?void 0:o.type)&&i.data.symbol.symbolLayers){const{offsetX:o,offsetY:r,size:s}=Ol(i),a=(0,d.md)(e,Dl),l=s/2,c=t.toScreen(n),u=c.x+o,h=c.y+r;return(0,v.bI)(a,[u,h])<l*l?1:null}if("point"!==n.type||"simple-marker"!==i.type)return(0,Gl.D)(e,n,t)?1:null;if(null==r||!r.originalPoint.equals(n)){const e=n,o=t.spatialReference;if((0,Va.canProjectWithoutEngine)(e.spatialReference,o)){const t=(0,Va.project)(e,o);r={originalPoint:e.clone(),mapPoint:t,radiusPx:(0,d.F2)(i.size)},this._circleCollisionCache=r}}if(null!=r){var s;const n=(0,d.md)(e,Dl),o=null===(s=t.toScreen)||void 0===s?void 0:s.call(t,r.mapPoint);if(!o)return null;const a=r.radiusPx,l=o.x+(0,d.F2)(i.xoffset),c=o.y-(0,d.F2)(i.yoffset);return(0,v.bI)(n,[l,c])<a*a?1:null}return null}_intersectDistance3D(t,e,n){const i=t.toMap(e,{include:[n]});return i&&(0,Vl.K)(i,Ll,t.renderSpatialReference)?(0,A.j)(Ll,t.state.camera.eye):null}};(0,r._)([(0,u.Cb)({constructOnly:!0,nonNullable:!0})],Zl.prototype,"graphic",null),(0,r._)([(0,u.Cb)()],Zl.prototype,"elevationInfo",null),(0,r._)([(0,u.Cb)({constructOnly:!0,nonNullable:!0})],Zl.prototype,"view",void 0),(0,r._)([(0,u.Cb)({value:null})],Zl.prototype,"focusedSymbol",null),(0,r._)([(0,u.Cb)({constructOnly:!0})],Zl.prototype,"layer",void 0),(0,r._)([(0,u.Cb)()],Zl.prototype,"interactive",void 0),(0,r._)([(0,u.Cb)()],Zl.prototype,"selectable",void 0),(0,r._)([(0,u.Cb)()],Zl.prototype,"grabbable",void 0),(0,r._)([(0,u.Cb)({value:!1})],Zl.prototype,"grabbing",null),(0,r._)([(0,u.Cb)()],Zl.prototype,"dragging",void 0),(0,r._)([(0,u.Cb)()],Zl.prototype,"hovering",null),(0,r._)([(0,u.Cb)({value:!1})],Zl.prototype,"selected",null),(0,r._)([(0,u.Cb)()],Zl.prototype,"cursor",void 0),Zl=(0,r._)([(0,h.j)("esri.views.interactive.GraphicManipulator")],Zl);const Ll=(0,g.Ue)(),Dl=(0,d.s1)();class zl extends Al{constructor(t){super(),this._view=t.view,this._tool=t.tool,this._graphic=t.graphic,this._manipulator=this._createManipulator(),this.forEachManipulator((t=>this._tool.manipulators.add(t)))}destroy(){this.forEachManipulator((t=>{this._tool.manipulators.remove(t),t.destroy()})),this._tool=null,this._view=null,this._manipulator=null,this._graphic=null}forEachManipulator(t){t(this._manipulator,kl.TRANSLATE_XY)}createDragPipeline(t,e){let n=null,i=null,o=0,r=0,s=0;const{offsetX:a,offsetY:l,size:c}=Ol(this._graphic.symbol);return ll(this._manipulator,((u,h)=>{h.next((e=>{if("start"===e.action){const e=t();n=e.editGeometryOperations,i=e.constraints}return e})).next(cl(this._view)).next((t=>{const{x:u,y:h,z:d}=t.mapEnd;if(i&&(u+a<i.xmin||h+l-c<i.ymin||u+a>i.xmax||h+l-c>i.ymax))return t;("start"===t.action||0===o&&0===r&&0===s)&&(o=t.mapStart.x,r=t.mapStart.y,s=t.mapStart.z);const p=u-o,v=h-r,f=d-s;o=u,r=h,s=d;const g="start"===t.action?Ra.NEW_STEP:Ra.ACCUMULATE_STEPS,_=n.move(p,v,f,g);return e(t,_),t}))}))}_createManipulator(){const t=this._view,e=this._graphic;return new Zl({view:t,graphic:e,selectable:!0,cursor:"move"})}}const Hl="ArrowUp",Nl="ArrowDown",Fl="ArrowLeft",jl="ArrowRight",Yl="t",Bl="Shift",Wl=Ei.C,ql=new S.Z("#009af2");let Xl=class extends ta{constructor(t){super(t),this._isOpacityToggled=!1,this._isModifierActive=!1,this._factor=1,this._initialControlPoints=null,this._graphicsLayer=new _t.Z({internal:!0,listMode:"hide",visible:!1,effect:"drop-shadow(0px, 0px, 3px)"}),this._undoStack=[],this._redoStack=[],this._sharedUndoStack=[],this._sharedRedoStack=[],this._highlightHandle=null,this.activeHandle=0,this.type="reshape"}initialize(){this._initialize()}destroy(){const{map:t}=this.view;this._controlPointManipulations.forEach((t=>t.destroy())),this._controlPointEditGeometryOperations.forEach((t=>t.destroy())),t.removeMany([this._graphicsLayer]),this._graphicsLayer.removeAll(),this._graphicsLayer=(0,l.SC)(this._graphicsLayer),this._georeference=null,this._controlPointGraphics=null,this._controlPointManipulations=null,this._graphicsLayer=null,this._controlPointEditGeometryOperations=null,this._undoStack=null,this._redoStack=null,this._initialControlPoints=null,this._sharedUndoStack=null,this._sharedRedoStack=null}get _hasValidSpatialReference(){return(0,Ut.JY)(this.view.spatialReference)}onActivate(){this.visible=!0}onDeactivate(){this.visible=!1}onShow(){this._graphicsLayer.visible=!0}onHide(){this._graphicsLayer.visible=!1}canUndo(){const t=this._undoStack[this._undoStack.length-1];return null!=t&&this._controlPointEditGeometryOperations[t].canUndo}canRedo(){const t=this._redoStack[this._redoStack.length-1];return null!=t&&this._controlPointEditGeometryOperations[t].canRedo}undo(){if(this._undoStack.length>0){const t=this._undoStack.pop();this._controlPointEditGeometryOperations[t].undo(),this.updateGraphics(),this._redoStack.push(t)}}redo(){if(this._redoStack.length>0){const t=this._redoStack.pop();this._controlPointEditGeometryOperations[t].redo(),this.updateGraphics(),this._undoStack.push(t)}}refresh(){const{mediaElement:t}=this;if(null==t.georeference)return;const e=t.georeference;"control-points"===e.type&&null!=e.coords&&(this._georeference=e,this._georeference.controlPoints.forEach(((t,e)=>{let{mapPoint:n}=t;const i=this._controlPointEditGeometryOperations[e],o=i.data.components[0].vertices[0];i.setVertexPosition(o,i.data.coordinateHelper.pointToVector(n))})),this.updateGraphics())}reset(){this._georeference.controlPoints=this._initialControlPoints,this.refresh(),this._sharedUndoStack.length=0,this._sharedRedoStack.length=0}updateGraphics(){const t=this._georeference,e=t.controlPoints,n=e[0].mapPoint.spatialReference,i=this._hasValidSpatialReference;this._georeference.controlPoints=this._controlPointEditGeometryOperations.map(((o,r)=>{const s=o.data.geometry;return this._controlPointGraphics[r].geometry=s,{mapPoint:(0,Va.project)(s,n),sourcePoint:i?e[r].sourcePoint:t.toSource(s)}}))}updateActiveHandle(t){if(this.activeHandle===t)return;const e=this._controlPointGraphics[this.activeHandle].symbol.clone();(0,Rl.ZB)(e,this.view.effectiveTheme.accentColor),this._controlPointGraphics[this.activeHandle].symbol=e;const n=this._controlPointGraphics[t].symbol.clone();(0,Rl.ZB)(n,ql),this._controlPointGraphics[t].symbol=n,this.activeHandle=t,this.view.surface===document.activeElement&&this.highlightActiveHandle()}async highlightActiveHandle(){this.removeHighlightActiveHandle();const t=await this.view.whenLayerView(this._graphicsLayer);this._highlightHandle=t.highlight(this._controlPointGraphics[this.activeHandle])}removeHighlightActiveHandle(){this._highlightHandle&&this._highlightHandle.remove()}setSharedUndoStack(t){this._sharedUndoStack=t}setSharedRedoStack(t){this._sharedRedoStack=t}async _initialize(){const{view:t,mediaElement:e}=this;if(null==e.georeference)return;const n=e.georeference;"control-points"===n.type&&null!=n.coords&&(this._georeference=n,this._initialControlPoints=this._georeference.controlPoints,t.map.addMany([this._graphicsLayer]),t.focus(),this.visible=!1,this.finishToolCreation(),await this._loadProjectionEngine(),this._controlPointEditGeometryOperations=this._georeference.controlPoints.map((e=>{let{mapPoint:n}=e;return al.fromGeometry((0,Va.project)(n,t.spatialReference),wa.JY.Local)})),this._controlPointGraphics=this._controlPointEditGeometryOperations.map(((t,e)=>new s.Z({symbol:new N.Z({data:{type:"CIMSymbolReference",symbol:{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,colorLocked:!0,anchorPoint:{x:0,y:-15.75},anchorPointUnits:"Absolute",dominantSizeAxis3D:"Y",size:9,billboardMode3D:"FaceNearPlane",frame:{xmin:0,ymin:0,xmax:84.3,ymax:84.3},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{rings:[[[83.2,32.5],[84.3,40.7],[83.8,48.9],[81.7,56.9],[78.1,64.3],[73,70.9],[66.9,76.4],[59.7,80.5],[51.9,83.2],[43.7,84.3],[35.4,83.8],[27.4,81.7],[20,78],[13.4,73],[7.9,66.8],[3.8,59.7],[1.1,51.9],[0,43.7],[.5,35.4],[2.6,27.4],[6.3,20],[11.3,13.4],[17.5,7.9],[24.7,3.8],[32.5,1.1],[39.8,.1],[47.1,.3],[54.3,1.8],[61.1,4.5],[67.4,8.4],[72.9,13.3],[77.4,19.1],[80.9,25.5],[83.2,32.5]]]},symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:[255,255,255,255]}]}}],scaleSymbolsProportionally:!0,respectFrame:!0,clippingPath:{type:"CIMClippingPath",clippingType:"Intersect",path:{rings:[[[0,0],[84.3,0],[84.3,84.3],[0,84.3],[0,0]]]}},rotation:0},{type:"CIMVectorMarker",enable:!0,anchorPoint:{x:0,y:-11.25},anchorPointUnits:"Absolute",dominantSizeAxis3D:"Y",size:22.5,billboardMode3D:"FaceNearPlane",frame:{xmin:0,ymin:0,xmax:197.7,ymax:294.7},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{rings:[[[98.9,0],[119.4,23.2],[139.4,49.3],[156.8,75.2],[171.2,100.8],[182.4,125.3],[190.6,148.8],[195.7,171.4],[197.7,192.9],[197.7,195.8],[197.7,200.3],[197.6,202.5],[197.5,204.8],[197.3,207.1],[197,209.4],[196.7,211.7],[196.4,214.1],[196,216.4],[195.5,218.7],[195,221.1],[194.4,223.4],[193.7,225.8],[193,228.1],[192.2,230.5],[191.4,232.8],[190.5,235.1],[189.5,237.5],[188.5,239.7],[187.4,242],[186.2,244.3],[185,246.5],[183.7,248.7],[182.4,250.9],[181,253.1],[179.5,255.2],[178,257.3],[176.4,259.4],[174.7,261.4],[173.1,263.3],[171.3,265.3],[169.5,267.2],[167.7,269],[165.8,270.8],[163.9,272.5],[161.9,274.2],[159.9,275.8],[157.8,277.4],[155.7,278.9],[153.6,280.4],[151.4,281.7],[149.2,283.1],[147,284.4],[144.8,285.6],[142.5,286.7],[140.3,287.8],[138,288.8],[135.7,289.8],[133.4,290.7],[131,291.5],[128.7,292.3],[126.4,293],[124,293.6],[121.7,294.2],[119.4,294.7],[117,295.2],[114.7,295.6],[112.4,296],[110.1,296.3],[107.8,296.5],[105.5,296.7],[103.3,296.8],[101.1,296.9],[98.8,296.9],[83.1,295.7],[67.8,292],[53.3,285.9],[39.9,277.5],[28.1,267.2],[18,255.1],[10,241.5],[4.2,226.9],[.9,211.5],[0,195.8],[.1,192.9],[2.1,171.4],[7.2,148.8],[15.4,125.3],[26.6,100.8],[41,75.2],[58.4,49.3],[78.4,23.2],[98.9,0]]]},symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:e===this.activeHandle?ql.toArray():this.view.effectiveTheme.accentColor.toArray()}]}}],scaleSymbolsProportionally:!0,respectFrame:!0,clippingPath:{type:"CIMClippingPath",clippingType:"Intersect",path:{rings:[[[0,0],[197.7,0],[197.7,294.7],[0,294.7],[0,0]]]}},rotation:0}],haloSize:1,scaleX:1,angleAlignment:"Display",angle:0}}}),geometry:t.data.geometry}))),this._graphicsLayer.graphics.addMany([...this._controlPointGraphics]),this._controlPointManipulations=this._controlPointGraphics.map((e=>new zl({tool:this,view:t,graphic:e}))),this.addHandles([...this._controlPointManipulations.map(((t,e)=>t.createDragPipeline(this._getInfo.bind(this,e),((t,n)=>{"start"===t.action&&(this._undoStack.push(e),this._redoStack=[],this._sharedUndoStack.push({tool:this,operation:n}),this._sharedRedoStack.length=0),this.updateGraphics()})))),(0,c.YP)((()=>this.view.scale),(()=>this.active?this.updateGraphics():null))]),this._controlPointManipulations.forEach(((t,e)=>{t.forEachManipulator((t=>{this.addHandles([t.events.on(["click","grab-changed"],(t=>this.updateActiveHandle(e)))])}))})),this.addHandles([t.on("key-down",(n=>{t.activeTool===this&&(n.key!==Bl||n.repeat||(this._isModifierActive=!0,n.stopPropagation()),n.key!==Yl||n.repeat||(e.opacity*=this._isOpacityToggled?2:.5,this._isOpacityToggled=!this._isOpacityToggled,n.stopPropagation()),n.key!==Wl||n.repeat||(this._factor=10,n.stopPropagation()),this._isModifierActive&&(n.key===Hl&&(this._move(0,this._factor),n.stopPropagation()),n.key===Nl&&(this._move(0,-this._factor),n.stopPropagation()),n.key===Fl&&(this._move(-this._factor,0),n.stopPropagation()),n.key===jl&&(this._move(this._factor,0),n.stopPropagation())))})),t.on("key-up",(e=>{t.activeTool===this&&(e.key===Bl&&(this._isModifierActive=!1,e.stopPropagation()),e.key===Wl&&(this._factor=1,e.stopPropagation()))}))]))}async _loadProjectionEngine(){const t=this._georeference.controlPoints[0].mapPoint;return(0,Va.initializeProjection)(t.spatialReference,this.view.spatialReference)}_getInfo(t){return{editGeometryOperations:this._controlPointEditGeometryOperations[t],constraints:this._hasValidSpatialReference?null:{xmin:0,ymin:0,xmax:this._georeference.width,ymax:this._georeference.height}}}_move(t,e){const n=this._controlPointEditGeometryOperations[this.activeHandle].move(t*this.view.resolution,e*this.view.resolution,0,Ra.NEW_STEP);this._sharedUndoStack.push({tool:this,operation:n}),this._sharedRedoStack.length=0,this.updateGraphics()}};(0,r._)([(0,u.Cb)()],Xl.prototype,"_hasValidSpatialReference",null),(0,r._)([(0,u.Cb)()],Xl.prototype,"activeHandle",void 0),(0,r._)([(0,u.Cb)({constructOnly:!0,nonNullable:!0})],Xl.prototype,"mediaElement",void 0),(0,r._)([(0,u.Cb)({readOnly:!0})],Xl.prototype,"type",void 0),(0,r._)([(0,u.Cb)({constructOnly:!0})],Xl.prototype,"view",void 0),Xl=(0,r._)([(0,h.j)("esri.views.2d.interactive.editingTools.ControlPointsTransformTool")],Xl);var Jl=n(86950),Kl=n(82218),Ql=n(100);function $l(t,e){"start"===t.action?e.cursor="grabbing":e.cursor="grab"}class tc{constructor(){this._lastDragEvent=null,this.next=new hl,this._enabled=!1}get enabled(){return this._enabled}set enabled(t){if(this._enabled!==t&&null!=this._lastDragEvent){const e=(0,o.Z)((0,o.Z)({},this._lastDragEvent),{},{action:"update"});t&&this._adjustScaleFactors(e),this.next.execute(e)}this._enabled=t}createDragEventPipelineStep(){return this._lastDragEvent=null,t=>(this._lastDragEvent="end"!==t.action?(0,o.Z)({},t):null,this._enabled&&this._adjustScaleFactors(t),t)}_adjustScaleFactors(t){const e=0!==t.direction[0]&&0!==t.direction[1]?Math.max(Math.abs(t.factor1),Math.abs(t.factor2)):0===t.direction[0]?Math.abs(t.factor2):Math.abs(t.factor1);t.factor1=t.factor1<0?-e:e,t.factor2=t.factor2<0?-e:e}}class ec{constructor(){this._lastDragEvent=null,this.next=new hl,this._enabled=!1}get enabled(){return this._enabled}set enabled(t){if(this._enabled!==t&&null!=this._lastDragEvent){const e=(0,o.Z)((0,o.Z)({},this._lastDragEvent),{},{action:"update"});t&&this._adjustRotateAngle(e),this.next.execute(e)}this._enabled=t}createDragEventPipelineStep(){return this._lastDragEvent=null,t=>(this._lastDragEvent="end"!==t.action?(0,o.Z)({},t):null,this._enabled&&this._adjustRotateAngle(t),t)}_adjustRotateAngle(t){const e=(0,ce.BV)(t.rotateAngle);t.rotateAngle=(0,ce.Vl)(5*Math.round(e/5))}}n(65156),n(376);function nc(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const o=Math.atan2(e.y-n.y,e.x-n.x)-Math.atan2(t.y-n.y,t.x-n.x),r=Math.atan2(Math.sin(o),Math.cos(o));return i?r:(0,ce.BV)(r)}var ic=n(11185);function oc(t,e){return rc(t,e,!1)}function rc(t,e,n){if(t instanceof Na){if(t.operation instanceof qa)return function(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=n?-1:1,o=(0,g.al)(i*t.dx,i*t.dy,i*t.dz);(0,A.g)(e.origin,e.origin,o),(0,Kl.u)(e)}(t.operation,e,n),!0;if(t.operation instanceof nl)return function(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=n?-t.angle:t.angle;(0,A.K)(e.basis1,e.basis1,g.AG,i),(0,A.K)(e.basis2,e.basis2,g.AG,i),(0,Kl.u)(e)}(t.operation,e,n),!0;if(t.operation instanceof il)return function(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=n?1/t.factor1:t.factor1,o=n?1/t.factor2:t.factor2;(0,A.h)(e.basis1,e.basis1,i),(0,A.h)(e.basis2,e.basis2,o),(0,v.LG)(e.origin,e.origin,t.origin,t.axis1,i),(0,v.LG)(e.origin,e.origin,t.origin,t.axis2,o),(0,Kl.u)(e)}(t.operation,e,n),!0}return!1}class sc extends Al{constructor(t){super(),this._handles=new Ql.Z,this._originCache=(0,g.Ue)(),this._view=t.view,this._tool=t.tool,this._graphic=t.graphic,this._snapRotation=t.snapRotation,this._manipulator=this._createManipulator(),this._handles.add([this._manipulator.events.on("grab-changed",(t=>$l(t,this._manipulator)))]),this.forEachManipulator((t=>this._tool.manipulators.add(t)))}destroy(){this._handles.destroy(),this.forEachManipulator((t=>{this._tool.manipulators.remove(t),t.destroy()})),this._tool=null,this._view=null,this._manipulator=null,this._snapRotation=null,this._graphic=null,this._handles=null,this._originCache=null}forEachManipulator(t){t(this._manipulator,kl.ROTATE)}createDragPipeline(t,e){let n=null,i=null;return ll(this._manipulator,((r,s)=>{s.next((e=>{if("start"===e.action){r.cursor="grabbing";const e=t();n=e.plane,i=e.editGeometryOperations}return e})).next(cl(this._view)).next((t=>(0,o.Z)((0,o.Z)({},t),{},{rotateAngle:nc(t.mapStart,t.mapEnd,{x:n.origin[0],y:n.origin[1]},!0)}))).next(this._snapRotation.createDragEventPipelineStep(),this._snapRotation.next).next((t=>{const o=(0,A.c)(this._originCache,n.origin),r="start"===t.action?Ra.NEW_STEP:Ra.ACCUMULATE_STEPS,s=i.rotate(o,t.rotateAngle,r,Aa.REPLACE);return oc(s,n),e(t,s),t})).next((t=>("end"===t.action&&(r.cursor="grab"),t)))}))}_createManipulator(){const t=this._view,e=this._graphic;return new Zl({view:t,graphic:e,selectable:!0,cursor:"grab"})}}const ac=1e-6;function lc(t){const e=(0,A.l)(t.basis1),n=(0,A.l)(t.basis2);return.3*Math.min(e,n)}class cc extends Al{constructor(t){super(),this._handles=new Ql.Z,this._planeStart=(0,Kl.a)(),this._displayPlaneStart=(0,Kl.a)(),this._originCache=(0,g.Ue)(),this._axisCache=(0,f.Ue)(),this._renderStartCache=(0,g.Ue)(),this._renderEndCache=(0,g.Ue)(),this._resizeOriginCache=(0,g.Ue)(),this._view=t.view,this._tool=t.tool,this._graphic=t.graphic,this._direction=t.direction,this._preserveAspectRatio=t.preserveAspectRatio,this._manipulator=this._createManipulator(),this._handles.add([this._manipulator.events.on("grab-changed",(t=>$l(t,this._manipulator)))]),this.forEachManipulator((t=>this._tool.manipulators.add(t)))}destroy(){this._handles.destroy(),this.forEachManipulator((t=>{this._tool.manipulators.remove(t),t.destroy()})),this._tool=null,this._view=null,this._graphic=null,this._manipulator=null,this._direction=null,this._handles=null,this._planeStart=null,this._displayPlaneStart=null,this._originCache=null,this._axisCache=null,this._renderStartCache=null,this._renderEndCache=null,this._resizeOriginCache=null,this._preserveAspectRatio=null}forEachManipulator(t){t(this._manipulator,kl.SCALE)}createDragPipeline(t,e){let n=null,i=null,r=null,s=0,a=null,l=null;const c=this._planeStart,u=this._displayPlaneStart,h=this._direction;return ll(this._manipulator,((d,p)=>{p.next((e=>{if("start"===e.action){d.cursor="grabbing";const e=t();n=e.plane,i=e.displayPlane,r=e.editGeometryOperations,s=10*this._view.resolution,(0,Kl.c)(n,c),(0,Kl.c)(i,u);const o=(0,Ut.C5)(r.data.spatialReference);a=o?o.valid[1]-o.valid[0]-30*this._view.resolution:null}return e})).next(cl(this._view)).next((t=>{const e=(0,A.c)(this._renderStartCache,[t.mapStart.x,t.mapStart.y,0]),n=(0,A.c)(this._renderEndCache,[t.mapEnd.x,t.mapEnd.y,0]),r=(0,A.c)(this._resizeOriginCache,u.origin);(0,A.b)(r,r,u.basis1,-h[0]),(0,A.b)(r,r,u.basis2,-h[1]),(0,A.d)(n,n,r),(0,A.d)(e,e,r);const a=0!==h[0]&&0!==h[1],l=lc(u),c=lc(i)/l,d=(t,i)=>{if(0===t)return 1;let o=(0,A.l)(i),r=.5*t*(0,A.f)(i,n)/o;const l=r<0?-1:1;a&&(r+=(o-.5*t*(0,A.f)(i,e)/o)*l*c);const u=o<1.5*s?1:ac;return o=Math.max(o-s,ac),l>0&&(r-=10*this._view.resolution),l*Math.max(l*(r/o),u)},p=d(h[0],u.basis1),v=d(h[1],u.basis2);return(0,o.Z)((0,o.Z)({},t),{},{direction:h,factor1:p,factor2:v})})).next(this._preserveAspectRatio.createDragEventPipelineStep(),this._preserveAspectRatio.next).next((t=>{const i=(0,A.c)(this._originCache,c.origin);(0,A.b)(i,i,c.basis1,-h[0]),(0,A.b)(i,i,c.basis2,-h[1]);const o=(0,v.t8)(this._axisCache,c.basis1[0],c.basis1[1]);(0,v.Fv)(o,o);const s=r.data.allVertices,u="start"===t.action?Ra.NEW_STEP:Ra.ACCUMULATE_STEPS,d=r.scaleVertices(s,i,o,t.factor1,t.factor2,u,Aa.REPLACE);return a&&a<r.data.geometry.extent.width&&l?r.updateVertices(s,l):((0,Kl.c)(c,n),oc(d,n),l=d.operation,e(t,d)),t})).next((t=>("end"===t.action&&(d.cursor="grab"),t)))}))}_createManipulator(){return new Zl({view:this._view,graphic:this._graphic,selectable:!0,cursor:"grab"})}}function uc(t){return"graphic"===(null===t||void 0===t?void 0:t.type)}var hc=n(72612),dc=n(61459);Ei.C;const pc=[[1,1],[1,-1],[-1,-1],[-1,1],[1,0],[0,-1],[-1,0],[0,1]];let vc=class extends ta{constructor(t){super(t),this._initialControlPoints=null,this._initialGeometry=null,this._graphic=null,this._planeCache=(0,Kl.a)(),this._displayPlaneCache=(0,Kl.a)(),this._mainAxisCache=(0,f.Ue)(),this._rotationHandleCache=(0,g.Ue)(),this._cornerA=(0,g.Ue)(),this._cornerB=(0,g.Ue)(),this._cornerC=(0,g.Ue)(),this._cornerD=(0,g.Ue)(),this._avgAB=(0,g.Ue)(),this._avgBC=(0,g.Ue)(),this._avgCD=(0,g.Ue)(),this._avgDA=(0,g.Ue)(),this._preserveAspectRatio=new tc,this._snapRotation=new ec,this._graphicsLayer=new _t.Z({internal:!0,listMode:"hide",visible:!1}),this._sharedUndoStack=[],this._sharedRedoStack=[],this._isOpacityToggled=!1,this._factor=1,this.preserveAspectRatio=null,this.snapRotation=null,this.type="transform"}initialize(){this._initialize()}destroy(){const{map:t}=this.view;this._dragManipulation.destroy(),this._rotateManipulation.destroy(),this._scaleManipulations.forEach((t=>t.destroy())),this._editGeometryOperations.destroy(),t.removeMany([this._graphicsLayer]),this._graphicsLayer.removeAll(),this._graphicsLayer=(0,l.SC)(this._graphicsLayer),this._initialControlPoints=null,this._initialGeometry=null,this._graphic=null,this._preserveAspectRatio=null,this._snapRotation=null,this._planeCache=null,this._displayPlaneCache=null,this._rotationHandleCache=null,this._mainAxisCache=null,this._cornerA=null,this._cornerB=null,this._cornerC=null,this._cornerD=null,this._avgAB=null,this._avgBC=null,this._avgCD=null,this._avgDA=null,this._sharedUndoStack=null,this._sharedRedoStack=null}get _plane(){const t=this._graphic.geometry;if(null==t)return null;const e=this._editGeometryOperations.data,n=e.components[0].edges[0],i=(0,v.$X)(this._mainAxisCache,n.leftVertex.pos,n.rightVertex.pos);(0,v.Fv)(i,i);let o=80*this.view.resolution;const r=this.view.spatialReference;return(0,Ut.fS)(r,t.spatialReference)&&(o*=(0,Ct.c9)(r)/(0,Ct.c9)(t.spatialReference)),function(t,e,n,i){i||(i=(0,Kl.a)());const o=(0,v.t8)(ic.qW.get(),t[1],-t[0]),r=(0,v.t8)(ic.qW.get(),Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),s=(0,v.t8)(ic.qW.get(),Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY),a=ic.qW.get();e.components.forEach((e=>e.vertices.forEach((e=>{let{pos:n}=e;(0,v.t8)(a,(0,v.AK)(t,n),(0,v.AK)(o,n)),(0,v.VV)(r,r,a),(0,v.Fp)(s,s,a)}))));const l=1e-6,c=(0,v.t8)(ic.qW.get(),s[0]-r[0]<l?n/2:0,s[1]-r[1]<l?n/2:0);return(0,v.$X)(r,r,c),(0,v.IH)(s,s,c),(0,v.bA)(i.basis1,t,(s[0]-r[0])/2),(0,v.bA)(i.basis2,o,(s[1]-r[1])/2),(0,v.t8)(i.origin,r[0]*t[0]+r[1]*o[0],r[0]*t[1]+r[1]*o[1]),(0,v.IH)(i.origin,i.origin,i.basis1),(0,v.IH)(i.origin,i.origin,i.basis2),(0,Kl.u)(i),i}(i,e,o,this._planeCache)}get _displayPlane(){const t=this._plane;if(!t)return null;const e=this._displayPlaneCache;(0,Kl.c)(t,e);const n=10*this.view.resolution;return(0,A.h)(e.basis1,e.basis1,1+n/(0,A.l)(e.basis1)),(0,A.h)(e.basis2,e.basis2,1+n/(0,A.l)(e.basis2)),e}get _backgroundGraphicGeometry(){const t=this._displayPlane;if(!t)return null;const e=this.view.spatialReference;return this._updateDisplayPlaneConrers(t),new St.Z({spatialReference:e,rings:[[this._cornerA,this._cornerB,this._cornerC,this._cornerD,this._cornerA]]})}get _rotateGraphicGeometry(){const t=this._plane;if(!t)return null;const e=this._rotationHandleCache;return(0,A.n)(e,t.basis1),(0,A.h)(e,e,30*this.view.resolution),(0,A.g)(e,e,t.origin),(0,A.g)(e,e,t.basis1),new D.Z({x:e[0],y:e[1],spatialReference:this.view.spatialReference})}get _scaleGraphicGeometries(){const t=this._displayPlane;if(!t)return[];const e=this.view.spatialReference;this._updateDisplayPlaneConrers(t);const{_cornerA:n,_cornerB:i,_cornerC:o,_cornerD:r}=this,s=(0,A.m)(this._avgAB,n,i,.5),a=(0,A.m)(this._avgBC,i,o,.5),l=(0,A.m)(this._avgCD,o,r,.5),c=(0,A.m)(this._avgDA,r,n,.5);return[new D.Z({x:n[0],y:n[1],spatialReference:e}),new D.Z({x:i[0],y:i[1],spatialReference:e}),new D.Z({x:o[0],y:o[1],spatialReference:e}),new D.Z({x:r[0],y:r[1],spatialReference:e}),new D.Z({x:s[0],y:s[1],spatialReference:e}),new D.Z({x:a[0],y:a[1],spatialReference:e}),new D.Z({x:l[0],y:l[1],spatialReference:e}),new D.Z({x:c[0],y:c[1],spatialReference:e})]}onActivate(){this.visible=!0}onDeactivate(){this.visible=!1}onShow(){this._graphicsLayer.visible=!0}onHide(){this._graphicsLayer.visible=!1}canUndo(){return this._editGeometryOperations.canUndo}canRedo(){return this._editGeometryOperations.canRedo}undo(){this._editGeometryOperations.undo(),this.updateGraphics()}redo(){this._editGeometryOperations.redo(),this.updateGraphics()}refresh(){const{view:t,target:e}=this,n="georeference"in e?e.georeference.coords:e.geometry,i=this._editGeometryOperations,o=i.data.components[0].vertices,r=La.fromGeometry((0,Va.project)(n,t.spatialReference),wa.JY.Local).components[0].vertices;o.forEach(((t,e)=>{i.setVertexPosition(t,r[e].pos)})),this.updateGraphics()}reset(){const{target:t}=this;if("georeference"in t){const e=t.georeference;"control-points"===e.type&&(e.controlPoints=this._initialControlPoints)}else t.geometry=this._initialGeometry;this.refresh(),this._sharedUndoStack.length=0,this._sharedRedoStack.length=0}updateGraphics(){const t=this._editGeometryOperations.data.geometry;"georeference"in this.target&&(this.target.georeference.coords=t),this._graphic.geometry=t,this._backgroundGraphic.geometry=this._backgroundGraphicGeometry,this._rotateGraphic.geometry=this._rotateGraphicGeometry,this._scaleGraphicGeometries.forEach(((t,e)=>{this._scaleGraphics[e].geometry=t}))}setSharedUndoStack(t){this._sharedUndoStack=t}setSharedRedoStack(t){this._sharedRedoStack=t}async _initialize(){const{view:t,target:e}=this;if("georeference"in e){const t=e.georeference;this._graphic=new s.Z({geometry:t.coords}),this._initialControlPoints="control-points"===t.type?t.controlPoints:null}else this._graphic=e,this._initialGeometry=e.geometry;t.map.addMany([this._graphicsLayer]),t.focus(),this.visible=!1,this.finishToolCreation(),await this._loadProjectionEngine(),this._editGeometryOperations=al.fromGeometry((0,Va.project)(this._graphic.geometry,t.spatialReference),wa.JY.Local),this._backgroundGraphic=new s.Z({symbol:new dc.Z({color:"transparent",outline:{type:"simple-line",color:t.effectiveTheme.accentColor,width:2}}),geometry:this._backgroundGraphicGeometry}),this._rotateGraphic=new s.Z({symbol:new F.Z({color:(0,Jl.mj)(t.effectiveTheme.accentColor),outline:{type:"simple-line",color:t.effectiveTheme.accentColor,width:1}}),geometry:this._rotateGraphicGeometry}),this._scaleGraphics=this._scaleGraphicGeometries.map((e=>new s.Z({symbol:new F.Z({size:6,style:"square",color:(0,Jl.mj)(t.effectiveTheme.accentColor),outline:{type:"simple-line",color:t.effectiveTheme.accentColor,width:1}}),geometry:e}))),this._graphicsLayer.graphics.addMany([this._backgroundGraphic,this._rotateGraphic,...this._scaleGraphics]),this._dragManipulation=new zl({tool:this,view:t,graphic:this._graphic}),this._rotateManipulation=new sc({tool:this,view:t,graphic:this._rotateGraphic,snapRotation:this._snapRotation}),this._scaleManipulations=this._scaleGraphics.map(((e,n)=>new cc({tool:this,view:t,graphic:e,direction:pc[n],preserveAspectRatio:this._preserveAspectRatio}))),this.addHandles([this._dragManipulation.createDragPipeline(this._getInfo.bind(this),this._updateGraphics.bind(this)),this._rotateManipulation.createDragPipeline(this._getInfo.bind(this),this._updateGraphics.bind(this)),...this._scaleManipulations.map((t=>t.createDragPipeline(this._getInfo.bind(this),this._updateGraphics.bind(this)))),(0,c.YP)((()=>this.view.scale),(()=>this.active?this.updateGraphics():null)),t.on("click",(async n=>{if(null!=t.activeTool&&t.activeTool!==this)return;const i=(0,hc.vT)(n),o=[];t.map.allLayers.forEach((t=>{"vector-tile"!==t.type&&"imagery"!==t.type||o.push(t)}));const r=await this.view.hitTest(i,{exclude:o}),s=r.results;if(0===s.length)t.activeTool=null;else{const n=function(t){var e;return null!==(e=t.find(uc))&&void 0!==e?e:null}(r.results),i="georeference"in e,o=s.map((t=>"media"===t.type?t.element:null)).filter(Boolean),a=new Set([...this._graphicsLayer.graphics,i?null:e].filter(Boolean));i&&o.includes(e)||null!=n&&a.has(n.graphic)?null==t.activeTool&&(t.activeTool=this):t.activeTool=null}}))]);const n=t=>{this.addHandles(t.events.on("grab-changed",(t=>{"georeference"in e&&("start"===t.action?e.opacity*=.5:"end"===t.action&&(e.opacity*=2))})))};this._dragManipulation.forEachManipulator(n),this._rotateManipulation.forEachManipulator(n),this._scaleManipulations.forEach((t=>t.forEachManipulator(n)));const i=new Ui;i.addToggle(Vi.preserveAspectRatio,(()=>{null==this.preserveAspectRatio&&(this._preserveAspectRatio.enabled=!this._preserveAspectRatio.enabled)})),i.addToggle(Vi.rotateIncrements,(()=>{null==this.snapRotation&&(this._snapRotation.enabled=!this._snapRotation.enabled)})),i.add(Vi.toggleOpacity,(()=>{"georeference"in e&&(e.opacity*=this._isOpacityToggled?2:.5,this._isOpacityToggled=!this._isOpacityToggled)})),i.addToggle(Vi.factorModifier,(t=>this._factor="key-down"===t.type?10:1)),i.add(Vi.scaleUp,(()=>this._scale(this._factor))),i.add(Vi.scaleDown,(()=>this._scale(-this._factor))),i.add(Vi.moveUp,(()=>this._move(0,this._factor))),i.add(Vi.moveDown,(()=>this._move(0,-this._factor))),i.add(Vi.moveLeft,(()=>this._move(-this._factor,0))),i.add(Vi.moveRight,(()=>this._move(this._factor,0))),this.addHandles([t.on("key-down",(e=>{t.activeTool===this&&i.dispatch(t.inputManager,e)})),t.on("key-up",(e=>{t.activeTool===this&&i.dispatch(t.inputManager,e)}))])}async _loadProjectionEngine(){const t=this._graphic.geometry;return(0,Va.initializeProjection)(t.spatialReference,this.view.spatialReference)}_updateDisplayPlaneConrers(t){const{basis1:e,basis2:n,origin:i}=t,o=this._cornerA;(0,A.g)(o,i,e),(0,A.g)(o,o,n);const r=this._cornerB;(0,A.g)(r,i,e),(0,A.d)(r,r,n);const s=this._cornerC;(0,A.d)(s,i,e),(0,A.d)(s,s,n);const a=this._cornerD;(0,A.d)(a,i,e),(0,A.g)(a,a,n)}_getInfo(){return{editGeometryOperations:this._editGeometryOperations,plane:this._plane,displayPlane:this._displayPlane}}_updateGraphics(t,e){"start"===t.action&&(this._sharedUndoStack.push({tool:this,operation:e}),this._sharedRedoStack.length=0),this.updateGraphics()}_scale(t){var e;const n=this._editGeometryOperations,i=null===(e=n.data.geometry.extent)||void 0===e?void 0:e.width,o=(i+t*this.view.resolution)/i,r=n.scale(this._plane.origin,f.E9,o,o,Ra.NEW_STEP,Aa.REPLACE);this._sharedUndoStack.push({tool:this,operation:r}),this._sharedRedoStack.length=0,this.updateGraphics()}_move(t,e){const n=this._editGeometryOperations.move(t*this.view.resolution,e*this.view.resolution,0,Ra.NEW_STEP);this._sharedUndoStack.push({tool:this,operation:n}),this._sharedRedoStack.length=0,this.updateGraphics()}};(0,r._)([(0,u.Cb)()],vc.prototype,"_plane",null),(0,r._)([(0,u.Cb)()],vc.prototype,"_backgroundGraphicGeometry",null),(0,r._)([(0,u.Cb)()],vc.prototype,"_rotateGraphicGeometry",null),(0,r._)([(0,u.Cb)()],vc.prototype,"_scaleGraphicGeometries",null),(0,r._)([(0,u.Cb)()],vc.prototype,"preserveAspectRatio",void 0),(0,r._)([(0,u.Cb)()],vc.prototype,"snapRotation",void 0),(0,r._)([(0,u.Cb)({constructOnly:!0,nonNullable:!0})],vc.prototype,"target",void 0),(0,r._)([(0,u.Cb)({readOnly:!0})],vc.prototype,"type",void 0),(0,r._)([(0,u.Cb)({constructOnly:!0})],vc.prototype,"view",void 0),vc=(0,r._)([(0,h.j)("esri.views.2d.interactive.editingTools.TransformTool")],vc);const fc="r",gc="z";let _c=class extends Q.Z{constructor(t){super(t),this._transformTool=null,this._controlPointsTransformTool=null,this._advancedModeTransformTool=null,this._activeTool=null,this._sharedUndoStack=[],this._sharedRedoStack=[],this._originalOpacity=null,this.activeHandle=0}initialize(){const{view:t,mediaElement:e,preserveAspectRatio:n,snapRotation:i,advancedMode:o}=this;this._originalOpacity=e.opacity,this._transformTool=new vc({target:e,view:t,preserveAspectRatio:n,snapRotation:i}),this._controlPointsTransformTool=new Xl({mediaElement:e,view:t}),this._advancedModeTransformTool=new Xl({mediaElement:o.mediaElement,view:o.view}),this._transformTool.setSharedUndoStack(this._sharedUndoStack),this._transformTool.setSharedRedoStack(this._sharedRedoStack),this._controlPointsTransformTool.setSharedUndoStack(this._sharedUndoStack),this._controlPointsTransformTool.setSharedRedoStack(this._sharedRedoStack),this._advancedModeTransformTool.setSharedUndoStack(this._sharedUndoStack),this._advancedModeTransformTool.setSharedRedoStack(this._sharedRedoStack);const r=e.georeference,s=o.mediaElement.georeference;o.view.tools.addMany([this._advancedModeTransformTool]),"controlPoints"in s&&"controlPoints"in r&&this.addHandles([o.view.on("key-down",(t=>{t.key===gc&&this.canUndo()&&(this.undo(),t.stopPropagation()),t.key===fc&&this.canRedo()&&(this.redo(),t.stopPropagation())})),o.view.on("focus",(async t=>{this._controlPointsTransformTool.removeHighlightActiveHandle(),this._advancedModeTransformTool.highlightActiveHandle()})),(0,c.YP)((()=>s.controlPoints),(t=>{var e;r.controlPoints=t.map(((t,e)=>{let{sourcePoint:n}=t;return{sourcePoint:n,mapPoint:r.controlPoints[e].mapPoint}})),null===(e=this._activeTool)||void 0===e||e.refresh()})),(0,c.YP)((()=>this._controlPointsTransformTool.activeHandle),(t=>{this._advancedModeTransformTool.updateActiveHandle(t),this.activeHandle=t})),(0,c.YP)((()=>this._advancedModeTransformTool.activeHandle),(t=>{this._controlPointsTransformTool.updateActiveHandle(t),this.activeHandle=t}))]),this.addHandles([t.on("key-down",(t=>{t.key===gc&&this.canUndo()&&(this.undo(),t.stopPropagation()),t.key===fc&&this.canRedo()&&(this.redo(),t.stopPropagation())})),t.on("focus",(async t=>{this._advancedModeTransformTool.removeHighlightActiveHandle(),this._controlPointsTransformTool.highlightActiveHandle()}))]),t.tools.addMany([this._transformTool,this._controlPointsTransformTool]),t.activeTool=this._transformTool,this._activeTool=this._transformTool,t.focus()}destroy(){var t,e;null!==(t=this._transformTool)&&void 0!==t&&t.destroy(),null!==(e=this._controlPointsTransformTool)&&void 0!==e&&e.destroy(),this._transformTool=null,this._controlPointsTransformTool=null,this._advancedModeTransformTool=null,this._activeTool=null,this._sharedUndoStack=null,this._sharedRedoStack=null}canUndo(){return this._sharedUndoStack.length>0}canRedo(){return this._sharedRedoStack.length>0}undo(){if(this._sharedUndoStack.length>0){var t;const{tool:e,operation:n}=this._sharedUndoStack.pop();e!==this._activeTool&&e.refresh(),n.undo(),e.updateGraphics(),this._sharedRedoStack.push({tool:e,operation:n}),this._activeTool!==e&&(null===(t=this._activeTool)||void 0===t||t.refresh())}}redo(){if(this._sharedRedoStack.length>0){var t;const{tool:e,operation:n}=this._sharedRedoStack.pop();e!==this._activeTool&&e.refresh(),n.apply(),e.updateGraphics(),this._sharedUndoStack.push({tool:e,operation:n}),this._activeTool!==e&&(null===(t=this._activeTool)||void 0===t||t.refresh())}}refresh(){this._activeTool.refresh()}reset(){this._activeTool.reset(),this._advancedModeTransformTool.reset()}async enableAdvancedMode(){this.view.activeTool=this._controlPointsTransformTool,this._activeTool=this._controlPointsTransformTool,this._activeTool.refresh(),await this.advancedMode.view.when(),this.advancedMode.view.activeTool=this._advancedModeTransformTool,this._originalOpacity=this._controlPointsTransformTool.mediaElement.opacity,this._controlPointsTransformTool.mediaElement.opacity=.25*this._originalOpacity}disableAdvancedMode(){this.view.activeTool=this._transformTool,this._activeTool=this._transformTool,this._activeTool.refresh(),this.advancedMode.view.activeTool=null,this._controlPointsTransformTool.mediaElement.opacity=this._originalOpacity}};(0,r._)([(0,u.Cb)()],_c.prototype,"activeHandle",void 0),(0,r._)([(0,u.Cb)({constructOnly:!0})],_c.prototype,"advancedMode",void 0),(0,r._)([(0,u.Cb)()],_c.prototype,"preserveAspectRatio",void 0),(0,r._)([(0,u.Cb)()],_c.prototype,"snapRotation",void 0),(0,r._)([(0,u.Cb)({constructOnly:!0,nonNullable:!0})],_c.prototype,"mediaElement",void 0),(0,r._)([(0,u.Cb)({constructOnly:!0})],_c.prototype,"view",void 0),_c=(0,r._)([(0,h.j)("esri.views.2d.interactive.editingTools.MediaTransformToolsWrapper")],_c)},45008:(t,e,n)=>{n.d(e,{D:()=>a,K:()=>s});n(59486);var i=n(68860),o=n(96669),r=n(53866);function s(t,e,n){var o;let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new r.Z,a=0;if("2d"===n.type)a=e*(null!==(o=n.resolution)&&void 0!==o?o:0);else if("3d"===n.type){const o=n.overlayPixelSizeInMapUnits(t),r=n.basemapSpatialReference;a=null==r||r.equals(n.spatialReference)?e*o:(0,i.c9)(r)/(0,i.c9)(n.spatialReference)}const l=t.x-a,c=t.y-a,u=t.x+a,h=t.y+a,{spatialReference:d}=n;return s.xmin=Math.min(l,u),s.ymin=Math.min(c,h),s.xmax=Math.max(l,u),s.ymax=Math.max(c,h),s.spatialReference=d,s}function a(t,e,n){const i=n.toMap(t);return null!=i&&s(i,(0,o.k)(),n,l).intersects(e)}const l=new r.Z}}]);
//# sourceMappingURL=2354.9bdca42a.chunk.js.map