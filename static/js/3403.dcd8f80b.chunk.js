"use strict";(self.webpackChunkn2_trees=self.webpackChunkn2_trees||[]).push([[3403],{48035:(t,e,n)=>{n.d(e,{b:()=>l,j:()=>c});var r=n(65905),i=n(93169);const s=128e3;let o=null,a=null;async function c(){return o||(o=async function(){const t=(0,i.Z)("esri-csp-restrictions")?await n.e(5948).then(n.bind(n,5948)).then((t=>t.l)):await n.e(7069).then(n.bind(n,97069)).then((t=>t.l));a=await t.default({locateFile:t=>(0,r.V)("esri/core/libs/libtess/".concat(t))})}()),o}function l(t,e){const n=Math.max(t.length,s);return a.triangulate(t,e,n)}},51750:(t,e,n)=>{n.d(e,{L:()=>i,v:()=>r});const r=15.5,i=1024},95954:(t,e,n)=>{n.d(e,{j:()=>c});var r=n(23895),i=n(41116),s=n(35747),o=n(82653),a=n(78915);class c{static executeEffects(t,e,n,r){const i=(0,a.Tg)(t);let c=new s.z(e);for(const s of t){const t=(0,o.h)(s);t&&(c=t.execute(c,s,1.3333333333333333,n,r,i))}return c}static applyEffects(t,e,n){if(!t)return e;const c=(0,a.Tg)(t);let l,u=new s.z(r.z.fromJSONCIM(e));for(const r of t){const t=(0,o.h)(r);t&&(u=t.execute(u,r,1,null,n,c))}const h=[];let d=null;for(;l=u.next();)h.push(...(0,i.M)(l)),d=l.geometryType;return 0===h.length||null===d?null:"esriGeometryPolygon"===d?{rings:h}:{paths:h}}}},84328:(t,e,n)=>{n.d(e,{Ht:()=>r,QS:()=>o,jL:()=>s});const r=8388607,i=8388608,s=t=>t&r;function o(t,e){return((e?i:0)|t)>>>0}},82010:(t,e,n)=>{n.d(e,{z:()=>y});var r=n(48202),i=n(94109);function s(t,e){return t.x===e.x&&t.y===e.y}function o(t){if(!t)return;const e=t.length;if(e<=1)return;let n=0;for(let r=1;r<e;r++)s(t[r],t[n])||++n===r||(t[n]=t[r]);t.length=n+1}function a(t,e){return t.x=e.y,t.y=-e.x,t}function c(t,e){return t.x=-e.y,t.y=e.x,t}function l(t,e){return t.x=e.x,t.y=e.y,t}function u(t,e){return t.x=-e.x,t.y=-e.y,t}function h(t){return Math.sqrt(t.x*t.x+t.y*t.y)}function d(t,e){return t.x*e.y-t.y*e.x}function p(t,e){return t.x*e.x+t.y*e.y}function f(t,e,n,r){return t.x=e.x*n+e.y*r,t.y=e.x*r-e.y*n,t}class y{constructor(t,e,n){this._writeVertex=t,this._writeTriangle=e,this._canUseThinTessellation=n,this._prevNormal={x:void 0,y:void 0},this._nextNormal={x:void 0,y:void 0},this._textureNormalLeft={x:0,y:1},this._textureNormalRight={x:0,y:-1},this._textureNormal={x:void 0,y:void 0},this._joinNormal={x:void 0,y:void 0},this._inner={x:void 0,y:void 0},this._outer={x:void 0,y:void 0},this._roundStart={x:void 0,y:void 0},this._roundEnd={x:void 0,y:void 0},this._startBreak={x:void 0,y:void 0},this._endBreak={x:void 0,y:void 0},this._innerPrev={x:void 0,y:void 0},this._innerNext={x:void 0,y:void 0},this._bevelStart={x:void 0,y:void 0},this._bevelEnd={x:void 0,y:void 0},this._bevelMiddle={x:void 0,y:void 0}}tessellate(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this._canUseThinTessellation;o(t),n&&e.halfWidth<i.do&&!e.offset?this._tessellateThin(t,e):this._tessellate(t,e)}_tessellateThin(t,e){if(t.length<2)return;const n=e.wrapDistance||65535;let r=e.initialDistance||0,i=!1,s=t[0].x,o=t[0].y;const a=t.length;for(let c=1;c<a;++c){i&&(i=!1,r=0);let e=t[c].x,a=t[c].y,l=e-s,u=a-o,h=Math.sqrt(l*l+u*u);if(l/=h,u/=h,r+h>n){i=!0;const t=(n-r)/h;h=n-r,e=(1-t)*s+t*e,a=(1-t)*o+t*a,--c}const d=this._writeVertex(s,o,0,0,l,u,u,-l,0,-1,r),p=this._writeVertex(s,o,0,0,l,u,-u,l,0,1,r);r+=h;const f=this._writeVertex(e,a,0,0,l,u,u,-l,0,-1,r),y=this._writeVertex(e,a,0,0,l,u,-u,l,0,1,r);this._writeTriangle(d,p,f),this._writeTriangle(p,f,y),s=e,o=a}}_tessellate(t,e){const n=t[0],i=t[t.length-1],o=s(n,i),y=o?3:2;if(t.length<y)return;const x=e.pixelCoordRatio,m=null!=e.capType?e.capType:r.RL.BUTT,g=null!=e.joinType?e.joinType:r.AH.MITER,v=null!=e.miterLimit?Math.min(e.miterLimit,4):2,_=null!=e.roundLimit?Math.min(e.roundLimit,1.05):1.05,b=null!=e.halfWidth?e.halfWidth:2,w=!!e.textured;let S,T,P,k=null;const I=this._prevNormal,M=this._nextNormal;let V=-1,N=-1;const z=this._joinNormal;let E,D;const F=this._textureNormalLeft,U=this._textureNormalRight,O=this._textureNormal;let R=-1,C=-1;const A=e.wrapDistance||65535;let B=e.initialDistance||0;const L=this._writeVertex,W=this._writeTriangle,G=(t,e,n,r,i,s)=>{const o=L(T,P,E,D,n,r,t,e,i,s,B);return R>=0&&C>=0&&o>=0&&W(R,C,o),R=C,C=o,o};o&&(S=t[t.length-2],M.x=i.x-S.x,M.y=i.y-S.y,N=h(M),M.x/=N,M.y/=N);let H=!1;for(let s=0;s<t.length;++s){if(H&&(H=!1,B=0),S&&(I.x=-M.x,I.y=-M.y,V=N,B+V>A&&(H=!0)),H){const e=(A-B)/V;V=A-B,S={x:(1-e)*S.x+e*t[s].x,y:(1-e)*S.y+e*t[s].y},--s}else S=t[s];T=S.x,P=S.y;const e=s<=0&&!H,n=s===t.length-1;if(e||(B+=V),k=n?o?t[1]:null:t[s+1],k?(M.x=k.x-T,M.y=k.y-P,N=h(M),M.x/=N,M.y/=N):(M.x=void 0,M.y=void 0),!o){if(e){c(z,M),E=z.x,D=z.y,m===r.RL.SQUARE&&(G(-M.y-M.x,M.x-M.y,M.x,M.y,0,-1),G(M.y-M.x,-M.x-M.y,M.x,M.y,0,1)),m===r.RL.ROUND&&(G(-M.y-M.x,M.x-M.y,M.x,M.y,-1,-1),G(M.y-M.x,-M.x-M.y,M.x,M.y,-1,1)),m!==r.RL.ROUND&&m!==r.RL.BUTT||(G(-M.y,M.x,M.x,M.y,0,-1),G(M.y,-M.x,M.x,M.y,0,1));continue}if(n){a(z,I),E=z.x,D=z.y,m!==r.RL.ROUND&&m!==r.RL.BUTT||(G(I.y,-I.x,-I.x,-I.y,0,-1),G(-I.y,I.x,-I.x,-I.y,0,1)),m===r.RL.SQUARE&&(G(I.y-I.x,-I.x-I.y,-I.x,-I.y,0,-1),G(-I.y-I.x,I.x-I.y,-I.x,-I.y,0,1)),m===r.RL.ROUND&&(G(I.y-I.x,-I.x-I.y,-I.x,-I.y,1,-1),G(-I.y-I.x,I.x-I.y,-I.x,-I.y,1,1));continue}}let i,y,L=-d(I,M);if(Math.abs(L)<.01)p(I,M)>0?(z.x=I.x,z.y=I.y,L=1,i=Number.MAX_VALUE,y=!0):(c(z,M),L=1,i=1,y=!1);else{z.x=(I.x+M.x)/L,z.y=(I.y+M.y)/L,i=h(z);const t=(i-1)*b*x;y=i>4||t>V&&t>N}E=z.x,D=z.y;let W=g;switch(g){case r.AH.BEVEL:i<1.05&&(W=r.AH.MITER);break;case r.AH.ROUND:i<_&&(W=r.AH.MITER);break;case r.AH.MITER:i>v&&(W=r.AH.BEVEL)}switch(W){case r.AH.MITER:if(G(z.x,z.y,-I.x,-I.y,0,-1),G(-z.x,-z.y,-I.x,-I.y,0,1),n)break;if(w){const t=H?0:B;R=this._writeVertex(T,P,E,D,M.x,M.y,z.x,z.y,0,-1,t),C=this._writeVertex(T,P,E,D,M.x,M.y,-z.x,-z.y,0,1,t)}break;case r.AH.BEVEL:{const t=L<0;let e,r,i,s;if(t){const t=R;R=C,C=t,e=F,r=U}else e=U,r=F;if(y)i=t?c(this._innerPrev,I):a(this._innerPrev,I),s=t?a(this._innerNext,M):c(this._innerNext,M);else{const e=t?u(this._inner,z):l(this._inner,z);i=e,s=e}const o=t?a(this._bevelStart,I):c(this._bevelStart,I);G(i.x,i.y,-I.x,-I.y,e.x,e.y);const h=G(o.x,o.y,-I.x,-I.y,r.x,r.y);if(n)break;const d=t?c(this._bevelEnd,M):a(this._bevelEnd,M);if(y){const t=this._writeVertex(T,P,E,D,-I.x,-I.y,0,0,0,0,B);R=this._writeVertex(T,P,E,D,M.x,M.y,s.x,s.y,e.x,e.y,B),C=this._writeVertex(T,P,E,D,M.x,M.y,d.x,d.y,r.x,r.y,B),this._writeTriangle(h,t,C)}else{if(w){const t=this._bevelMiddle;t.x=(o.x+d.x)/2,t.y=(o.y+d.y)/2,f(O,t,-I.x,-I.y),G(t.x,t.y,-I.x,-I.y,O.x,O.y),f(O,t,M.x,M.y),R=this._writeVertex(T,P,E,D,M.x,M.y,t.x,t.y,O.x,O.y,B),C=this._writeVertex(T,P,E,D,M.x,M.y,s.x,s.y,e.x,e.y,B)}else{const t=R;R=C,C=t}G(d.x,d.y,M.x,M.y,r.x,r.y)}if(t){const t=R;R=C,C=t}break}case r.AH.ROUND:{const t=L<0;let e,r;if(t){const t=R;R=C,C=t,e=F,r=U}else e=U,r=F;const s=t?u(this._inner,z):l(this._inner,z);let o,h;y?(o=t?c(this._innerPrev,I):a(this._innerPrev,I),h=t?a(this._innerNext,M):c(this._innerNext,M)):(o=s,h=s);const d=t?a(this._roundStart,I):c(this._roundStart,I),x=t?c(this._roundEnd,M):a(this._roundEnd,M),m=G(o.x,o.y,-I.x,-I.y,e.x,e.y),g=G(d.x,d.y,-I.x,-I.y,r.x,r.y);if(n)break;const v=this._writeVertex(T,P,E,D,-I.x,-I.y,0,0,0,0,B);y||this._writeTriangle(R,C,v);const _=u(this._outer,s),b=this._writeVertex(T,P,E,D,M.x,M.y,x.x,x.y,r.x,r.y,B);let S,k;const V=i>2;if(V){let e;i!==Number.MAX_VALUE?(_.x/=i,_.y/=i,e=p(I,_),e=(i*(e*e-1)+1)/e):e=-1,S=t?a(this._startBreak,I):c(this._startBreak,I),S.x+=I.x*e,S.y+=I.y*e,k=t?c(this._endBreak,M):a(this._endBreak,M),k.x+=M.x*e,k.y+=M.y*e}f(O,_,-I.x,-I.y);const N=this._writeVertex(T,P,E,D,-I.x,-I.y,_.x,_.y,O.x,O.y,B);f(O,_,M.x,M.y);const A=w?this._writeVertex(T,P,E,D,M.x,M.y,_.x,_.y,O.x,O.y,B):N,W=v,H=w?this._writeVertex(T,P,E,D,M.x,M.y,0,0,0,0,B):v;let Y=-1,K=-1;if(V&&(f(O,S,-I.x,-I.y),Y=this._writeVertex(T,P,E,D,-I.x,-I.y,S.x,S.y,O.x,O.y,B),f(O,k,M.x,M.y),K=this._writeVertex(T,P,E,D,M.x,M.y,k.x,k.y,O.x,O.y,B)),w?V?(this._writeTriangle(W,g,Y),this._writeTriangle(W,Y,N),this._writeTriangle(H,A,K),this._writeTriangle(H,K,b)):(this._writeTriangle(W,g,N),this._writeTriangle(H,A,b)):V?(this._writeTriangle(v,g,Y),this._writeTriangle(v,Y,K),this._writeTriangle(v,K,b)):(this._writeTriangle(v,g,N),this._writeTriangle(v,A,b)),y?(R=this._writeVertex(T,P,E,D,M.x,M.y,h.x,h.y,e.x,e.y,B),C=b):(R=w?this._writeVertex(T,P,E,D,M.x,M.y,h.x,h.y,e.x,e.y,B):m,this._writeTriangle(R,H,b),C=b),t){const t=R;R=C,C=t}break}}}}}},73325:(t,e,n)=>{n.d(e,{yu:()=>C,XB:()=>A,Qt:()=>B,ri:()=>W,oo:()=>L,Pz:()=>R,Ou:()=>U,qH:()=>E,xh:()=>z,Kw:()=>F,e5:()=>D});var r=n(27366),i=n(63780),s=n(32718),o=n(643),a=n(10064),c=n(99340),l=n(97731);const u=()=>s.Z.getLogger("esri.views.3d.webgl-engine.core.shaderModules.shaderBuilder");class h{constructor(){this._includedModules=new Map}include(t,e){if(this._includedModules.has(t)){const n=this._includedModules.get(t);if(n!==e){u().error("Trying to include shader module multiple times with different sets of options.");const e=new Set;for(const r of Object.keys(n))n[r]!==t[r]&&e.add(r);for(const r of Object.keys(t))n[r]!==t[r]&&e.add(r);e.forEach((e=>console.error("  ".concat(e,": current ").concat(n[e]," new ").concat(t[e]))))}}else this._includedModules.set(t,e),t(this.builder,e)}}class d extends h{constructor(){super(...arguments),this.vertex=new y,this.fragment=new y,this.attributes=new x,this.varyings=new m,this.extensions=new g,this.constants=new v}get fragmentUniforms(){return this.fragment.uniforms.entries}get builder(){return this}generate(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=this.extensions.generateSource(t),r=this.attributes.generateSource(t),i=this.varyings.generateSource(t),s="vertex"===t?this.vertex:this.fragment,o=s.uniforms.generateSource(),a=s.code.generateSource(),c="vertex"===t?_:function(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return"#ifdef GL_FRAGMENT_PRECISION_HIGH\n  precision highp float;\n  precision highp sampler2D;\n#else\n  precision mediump float;\n  precision mediump sampler2D;\n#endif\n".concat(t?"out vec4 fragColor;":"","\n")}(e),l=this.constants.generateSource().concat(s.constants.generateSource());return"".concat(e?"#version 300 es":"","\n").concat(n.join("\n"),"\n").concat(c,"\n").concat(l.join("\n"),"\n").concat(o.join("\n"),"\n").concat(r.join("\n"),"\n").concat(i.join("\n"),"\n").concat(a.join("\n"))}generateBindPass(t){const e=new Map;this.vertex.uniforms.entries.forEach((t=>{const n=t.bind[c.P.Pass];n&&e.set(t.name,n)})),this.fragment.uniforms.entries.forEach((t=>{const n=t.bind[c.P.Pass];n&&e.set(t.name,n)}));const n=Array.from(e.values()),r=n.length;return(e,i)=>{for(let s=0;s<r;++s)n[s](t,e,i)}}generateBindDraw(t){const e=new Map;this.vertex.uniforms.entries.forEach((t=>{const n=t.bind[c.P.Draw];n&&e.set(t.name,n)})),this.fragment.uniforms.entries.forEach((t=>{const n=t.bind[c.P.Draw];n&&e.set(t.name,n)}));const n=Array.from(e.values()),r=n.length;return(e,i,s)=>{for(let o=0;o<r;++o)n[o](t,e,i,s)}}}class p{constructor(){this._entries=new Map}add(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(const r of e)this._add(r)}get(t){return this._entries.get(t)}_add(t){if(null!=t){if(this._entries.has(t.name)&&!this._entries.get(t.name).equals(t))throw new a.Z("Duplicate uniform name ".concat(t.name," for different uniform type"));this._entries.set(t.name,t)}else u().error("Trying to add null Uniform from ".concat((new Error).stack,"."))}generateSource(){return Array.from(this._entries.values()).map((t=>null!=t.arraySize?"uniform ".concat(t.type," ").concat(t.name,"[").concat(t.arraySize,"];"):"uniform ".concat(t.type," ").concat(t.name,";")))}get entries(){return Array.from(this._entries.values())}}class f{constructor(){this._entries=new Array}add(t){this._entries.push(t)}generateSource(){return this._entries}}class y extends h{constructor(){super(...arguments),this.uniforms=new p,this.code=new f,this.constants=new v}get builder(){return this}}class x{constructor(){this._entries=new Array}add(t,e){this._entries.push([t,e])}generateSource(t){return"fragment"===t?[]:this._entries.map((t=>"in ".concat(t[1]," ").concat(t[0],";")))}}class m{constructor(){this._entries=new Map}add(t,e){this._entries.has(t)&&(0,l.hu)(this._entries.get(t)===e),this._entries.set(t,e)}generateSource(t){const e=new Array;return this._entries.forEach(((n,r)=>e.push("vertex"===t?"out ".concat(n," ").concat(r,";"):"in ".concat(n," ").concat(r,";")))),e}}class g{constructor(){this._entries=new Set}add(t){this._entries.add(t)}generateSource(t){const e="vertex"===t?g.ALLOWLIST_VERTEX:g.ALLOWLIST_FRAGMENT;return Array.from(this._entries).filter((t=>e.includes(t))).map((t=>"#extension ".concat(t," : enable")))}}g.ALLOWLIST_FRAGMENT=["GL_EXT_shader_texture_lod","GL_OES_standard_derivatives"],g.ALLOWLIST_VERTEX=[];class v{constructor(){this._entries=new Set}add(t,e,n){let r="ERROR_CONSTRUCTOR_STRING";switch(e){case"float":r=v._numberToFloatStr(n);break;case"int":r=v._numberToIntStr(n);break;case"bool":r=n.toString();break;case"vec2":r="vec2(".concat(v._numberToFloatStr(n[0]),",                            ").concat(v._numberToFloatStr(n[1]),")");break;case"vec3":r="vec3(".concat(v._numberToFloatStr(n[0]),",                            ").concat(v._numberToFloatStr(n[1]),",                            ").concat(v._numberToFloatStr(n[2]),")");break;case"vec4":r="vec4(".concat(v._numberToFloatStr(n[0]),",                            ").concat(v._numberToFloatStr(n[1]),",                            ").concat(v._numberToFloatStr(n[2]),",                            ").concat(v._numberToFloatStr(n[3]),")");break;case"ivec2":r="ivec2(".concat(v._numberToIntStr(n[0]),",                             ").concat(v._numberToIntStr(n[1]),")");break;case"ivec3":r="ivec3(".concat(v._numberToIntStr(n[0]),",                             ").concat(v._numberToIntStr(n[1]),",                             ").concat(v._numberToIntStr(n[2]),")");break;case"ivec4":r="ivec4(".concat(v._numberToIntStr(n[0]),",                             ").concat(v._numberToIntStr(n[1]),",                             ").concat(v._numberToIntStr(n[2]),",                             ").concat(v._numberToIntStr(n[3]),")");break;case"mat2":case"mat3":case"mat4":r="".concat(e,"(").concat(Array.prototype.map.call(n,(t=>v._numberToFloatStr(t))).join(", "),")")}return this._entries.add("const ".concat(e," ").concat(t," = ").concat(r,";")),this}static _numberToIntStr(t){return t.toFixed(0)}static _numberToFloatStr(t){return Number.isInteger(t)?t.toFixed(1):t.toString()}generateSource(){return Array.from(this._entries)}}const _="precision highp float;\nprecision highp sampler2D;";var b=n(52995);function w(t,e,n){const r=e.split("\n");for(const i of r)if(i.trim().length){{let e="";null!=n&&(e+="/*id:".concat(null!==n&&void 0!==n?n:"000","*/   ")),t.body+=e.padEnd(14)}t.body+=" ".repeat(t.indent)+i+"\n"}}class S{write(t){for(const e of t.rootOutputNodes())t.shouldPruneOutputNode(e)||(e.variableName=this._write(t,e.node));return t}_createVarName(t,e){let n="";return"boolean"!=typeof e&&"number"!=typeof e&&e.debugInfo.name&&(n="".concat(e.debugInfo.name,"_")),"".concat(n,"v").concat(t.varCount++)}_write(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("number"==typeof e)return e.toString();if("boolean"==typeof e)return e.toString();let r=t.getEmit(e);if(r)return r;switch(e.shaderType){case"scope-node":r=this._writeScopeNode(t,e);break;case"primitive-node":r=this._writePrimitveNode(t,e,n);break;case"function-node":r=this._writeFunctionNode(t,e);break;case"property-access-node":r=this._writePropertyAccessNode(t,e);break;case"text-node":r=e.text;break;case"block-node":r=this._writeBlockNode(t,e);break;case"condition-node":r=this._writeConditionNode(t,e)}return t.setEmit(e,r),r}_writeScopeNode(t,e){const n=new e.child.constructor;n.setDebugName(e.debugInfo.name);const r=this._write(t,n,!0);return w(t,"{ /*ScopeStart: ".concat(e.uid," ").concat(e.debugInfo.name,"*/")),t.indent+=2,w(t,"".concat(r," = ").concat(this._write(t,e.child),";")),t.indent-=2,w(t,"} /*ScopeEnd: ".concat(e.uid," ").concat(e.debugInfo.name,"*/")),r}_writeConditionNode(t,e){const n=new e.ifTrue.constructor,r=this._write(t,n,!0);w(t,"if (".concat(this._write(t,e.condition),") {")),t.indent+=2;const i=t.createSubgraphContext(),s=this._write(i,e.ifTrue);if(t.body+=i.body,s&&w(t,"".concat(r," = ").concat(s,";")),t.indent-=2,w(t,"}"),e.ifFalse){w(t,"else {"),t.indent+=2;const n=t.createSubgraphContext(),i=this._write(n,e.ifFalse);t.body+=n.body,i&&w(t,"".concat(r," = ").concat(i,";")),t.indent-=2,w(t,"}")}return r}_writeBlockNode(t,e){const{captureList:n,generator:r,returnType:i}=e,s={};for(const l in n){if(!n[l])continue;const e=this._write(t,n[l]);s[l]=e}const o=new i,a=this._write(t,o,!0);if(s.out=a,e.subgraph){const n=t.createSubgraphContext(),r=this._write(n,e.subgraph.child),i=n.body;s.subgraph={varName:r,body:i}}const c=r(s);return w(t,"{\n"),t.indent+=2,w(t,c),t.indent-=2,w(t,"}\n"),a}_writePropertyAccessNode(t,e){const n=this._write(t,e.target);return"string"==typeof e.property&&e.property.includes("[")?"".concat(n).concat(e.property):"string"!=typeof e.property?"".concat(n,"[").concat(this._write(t,e.property),"]"):"".concat(n,".").concat(e.property)}_writeFunctionNode(t,e){const n=e.returnType.type;if(e.isInfix){const[r,i]=e.children.map((e=>this._write(t,e))),s=this._createVarName(t,e);return w(t,"".concat(n.padEnd(5)," ").concat(s," = ").concat(r," ").concat(e.token," ").concat(i,";"),e.uid),s}const r=e.children.map((e=>this._write(t,e))).join(", "),i=this._createVarName(t,e);return w(t,"".concat(n.padEnd(5)," ").concat(i," = ").concat(e.token,"(").concat(r,");"),e.uid),i}_writePrimitveNode(t,e){var n;let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=t.getInput(e);if(i)return i.isUsed=!0,i.variableName;const s=1===e.children.length&&(null===(n=e.children[0])||void 0===n?void 0:n.type)===e.type;if(e.isImplicit||s)return this._write(t,e.children[0]);const o=this._createVarName(t,e);if(r)return w(t,"".concat(e.type.padEnd(5)," ").concat(o,";"),e.uid),o;const a=!e.debugInfo.name&&!e.isMutable;if(a&&"float"===e.type&&"number"==typeof e.children[0])return Number.isInteger(e.children[0])?e.children[0].toFixed(1):e.children[0].toString();if(a&&"int"===e.type&&"number"==typeof e.children[0]&&Number.isInteger(e.children[0]))return e.children[0].toString();const c=e.children.map((e=>this._write(t,e))).join(", ");return"array"===e.type?(w(t,"".concat(e.type.padEnd(5)," ").concat(o," = [").concat(c,"];"),e.uid),o):a?"".concat(e.type,"(").concat(c,")"):(w(t,"".concat(e.type.padEnd(5)," ").concat(o," = ").concat(e.type,"(").concat(c,");"),e.uid),o)}}var T=n(23105);class P{constructor(t,e,n){this.variableName=t,this.variableInputType=e,this.node=n,this.type="shader-input",this.isUsed=!1}clone(){return new P(this.variableName,this.variableInputType,(0,T.UV)(this.node))}}class k{constructor(t,e,n){this.outVariableName=t,this.outVariableType=e,this.node=n,this.type="shader-output"}clone(){const t=new k(this.outVariableName,this.outVariableType,(0,T.UV)(this.node));return t.variableName=this.variableName,t}}class I{static createVertex(t,e,n,r,i,s){const o=[];for(const c in t){const e=t[c],r=n.get(c);r?o.push(new P(r,"builtin",e)):o.push(new P("a_"+c,"attribute",e))}for(const c of r){const t=c.uniformHydrated;o.push(new P(c.uniformName,"uniform",t))}const a=[];for(const c in e){const t=e[c];"glPosition"===c?a.push(new k("gl_Position","builtin",t)):"glPointSize"===c?a.push(new k("gl_PointSize","builtin",t)):a.push(new k("v_"+c,"varying",t))}return new I(o,a,i,s)}static createFragment(t,e,n,r,i,s){const o=[],a=Array.from(i.rootOutputNodes());for(const l in t){const e=t[l],r=n.get(l);if(r){o.push(new P(r,"builtin",e));continue}const i=a.find((t=>t.node===e));i&&o.push(new P(i.outVariableName,i.outVariableType,e))}for(const l of r){const t=l.uniformHydrated;o.push(new P(l.uniformName,"uniform",t))}const c=[];for(const l in e){const t=e[l],r=n.get(l);if("discard"===l)c.push(new k(null,"discard",t));else{if(!r)throw new Error("Member ".concat(l," in shader fragment output shoule be tagged as builtin"));c.push(new k(r,"builtin",t))}}return new I(o,c,s)}constructor(t,e,n,r){this.type="shader-graph-context",this.indent=0,this.body="",this.varCount=0,this._inputShaderTypesByNodeUid=new Map,this._nodeEmitMap=new Map;for(const i of t)this._inputShaderTypesByNodeUid.set(i.node.uid,i);this._outputShaderTypes=e,this._transformFeedbackBindings=n,this._transformFeedbackNames=new Set(n.map((t=>"v_"+t.propertyKey))),this._usedInFragmentShader=r}shouldPruneOutputNode(t){return!!this._usedInFragmentShader&&"builtin"!==t.outVariableType&&!this._transformFeedbackNames.has(t.outVariableName)&&!this._usedInFragmentShader.has(t.node.uid)}setEmit(t,e){this._nodeEmitMap.set(t.uid,e)}getEmit(t){return this._nodeEmitMap.get(t.uid)}inputs(){return this._inputShaderTypesByNodeUid.values()}getInput(t){return this._inputShaderTypesByNodeUid.get(t.uid)}*rootOutputNodes(){for(const t of this._outputShaderTypes)yield t}*nodes(){const t=[];for(const e of this._outputShaderTypes.values())t.push(e.node);for(;t.length;){const e=t.pop();"number"!=typeof e&&"boolean"!=typeof e&&t.push(...e.children.filter(Boolean)),yield e}}*nodesOfTypeOrFunction(){for(const t of this.nodes())"number"!=typeof t&&"boolean"!=typeof t&&(yield t)}createSubgraphContext(){const t=this.clone();return t.body="",t.indent=this.indent+2,t._nodeEmitMap=new Map(this._nodeEmitMap),t}clone(){const t=new I([],this._outputShaderTypes,this._transformFeedbackBindings,this._usedInFragmentShader);return t._inputShaderTypesByNodeUid=this._inputShaderTypesByNodeUid,t.indent=this.indent,t.body=this.body,t.varCount=this.varCount,t._nodeEmitMap=this._nodeEmitMap,t}insertVertexShader(t){t.vertex.code.add(""),this._insertInputs(t,"vertex"),t.vertex.code.add(""),t.vertex.code.add("// OUTPUTS: "),t.vertex.code.add("// --------------------------------------------------------- ");for(const e of this.rootOutputNodes()){const n="builtin"===e.outVariableType;this.shouldPruneOutputNode(e)||(n?t.vertex.code.add("// ".concat(e.outVariableType.padEnd(7)," ").concat(e.node.type.padEnd(9)," ").concat(e.outVariableName,";")):t.vertex.code.add("".concat(e.outVariableType.padEnd(10)," ").concat(e.node.type.padEnd(9)," ").concat(e.outVariableName,";")))}t.vertex.code.add(""),t.vertex.code.add("void main() {"),t.vertex.code.add("  "+this.body.split("\n").join("\n  "));for(const e of this.rootOutputNodes())this.shouldPruneOutputNode(e)||t.vertex.code.add("  ".concat(e.outVariableName," = ").concat(e.variableName,";"));t.vertex.code.add("}")}insertFragmentShader(t){this._insertInputs(t,"fragment"),t.fragment.code.add(""),t.fragment.code.add("void main() {"),t.fragment.code.add("  "+this.body.split("\n").join("\n  "));for(const e of this.rootOutputNodes())"discard"===e.outVariableType?(t.fragment.code.add("  // TODO: Should ensure codegen for discard appears first in fragment shader"),t.fragment.code.add("  if (".concat(e.variableName,") {")),t.fragment.code.add("    discard;"),t.fragment.code.add("  }"),t.fragment.code.add("  ")):t.fragment.code.add("  ".concat(e.outVariableName," = ").concat(e.variableName,";"));t.fragment.code.add("}")}_insertInputs(t,e){t[e].code.add("// INPUTS: "),t[e].code.add("// --------------------------------------------------------- ");for(const n of this.inputs())n.isUsed&&"builtin"!==n.variableInputType&&("array"===n.node.type?t[e].code.add("".concat(n.variableInputType.padEnd(10)," ").concat(n.node.elementType.type.padEnd(9)," ").concat(n.variableName,"[").concat(n.node.size,"];")):t[e].code.add("".concat(n.variableInputType.padEnd(10)," ").concat(n.node.type.padEnd(9)," ").concat(n.variableName,";")))}}var M=n(19407);function V(t){return new t}function N(t,e,n){var r;const i=null!==(r=t.constructor[e])&&void 0!==r?r:[];t.constructor.hasOwnProperty(e)||Object.defineProperty(t.constructor,e,{value:i.slice()}),t.constructor[e].push(n)}function z(t,e){return(n,r)=>{N(n,"locations",{typeCtor:e,propertyKey:r,parameterIndex:null,index:t})}}const E=t=>(e,n,r)=>{N(e,"inputs",{inputCtor:t,propertyKey:n,parameterIndex:r})},D=t=>(e,n)=>{N(e,"uniforms",{typeCtor:t,propertyKey:n})},F=t=>(e,n)=>{N(e,"options",{typeCtor:t,propertyKey:n})},U=(t,e)=>{N(t,"defines",{propertyKey:e})};const O=(t,e)=>(n,r)=>{n.constructor.builtins.push({builtin:t,propertyKey:r,typeCtor:e})};class R{}R.builtins=[],(0,r._)([O("gl_VertexID",b.J7)],R.prototype,"glVertexID",void 0);class C{}class A{}A.builtins=[],(0,r._)([O("gl_FragCoord",b.T8)],A.prototype,"glFragCoord",void 0),(0,r._)([O("gl_PointCoord",b.Sg)],A.prototype,"glPointCoord",void 0);class B{}(0,r._)([(t=>(e,n)=>{N(e,"builtins",{builtin:t,propertyKey:n})})("gl_FragColor")],B.prototype,"glFragColor",void 0);class L{constructor(){this.type="uniform-group"}get _uniforms(){var t;return null!==(t=this.constructor.uniforms)&&void 0!==t?t:[]}}class W{constructor(){this.logShader=!1,this.computeAttributes={}}get vertexInput(){const t=(0,i.dF)(this._shaderModuleClass.inputs,(t=>"vertex"===t.propertyKey&&0===t.parameterIndex));if(!t)throw new Error("Unable to find vertex input parameter");return t}get computeInput(){return(0,i.dF)(this._shaderModuleClass.inputs,(t=>"vertex"===t.propertyKey&&1===t.parameterIndex))}get fragmentInput(){const t=(0,i.dF)(this._shaderModuleClass.inputs,(t=>"fragment"===t.propertyKey));if(!t)throw new Error("Unable to find fragment input parameter");return t}get transformFeedbackBindings(){var t;return null!==(t=this.fragmentInput.inputCtor.transformFeedbackBindings)&&void 0!==t?t:[]}get locations(){var t,e;return[...this.vertexInput.inputCtor.locations,...null!==(t=null===(e=this.computeInput)||void 0===e?void 0:e.inputCtor.locations)&&void 0!==t?t:[]]}get locationsMap(){const t=new Map,e=new Set;for(const n of this.locations)e.has(n.index)?s.Z.getLogger("esri.views.2d.engine.webgl.shaderGraph.GraphShaderModule").warnOnce("mapview-rendering","Unable to assigned attribute ".concat(n.propertyKey," to ").concat(n.index,". Index already in use"),{locationsMap:t}):(t.set(n.propertyKey,n.index),e.add(n.index));return t}get locationInfo(){if(!this._locationInfo){const t=this.locationsMap,e=Array.from(t.entries()).map((t=>{let[e,n]=t;return"".concat(e,".").concat(n)})).join("."),n=(0,o.hP)(e);this._locationInfo={hash:n,locations:t}}return this._locationInfo}get renamedLocationsMap(){const t=new Map;for(const e of this.locations)t.set("a_"+e.propertyKey,e.index);return t}get optionPropertyKeys(){if(!this._optionPropertyKeys){const t=new Set;for(const e of this._options)t.add(e.propertyKey);this._optionPropertyKeys=t}return this._optionPropertyKeys}get _shaderModuleClass(){return this.constructor}get _defines(){var t;return null!==(t=this._shaderModuleClass.defines)&&void 0!==t?t:[]}get _options(){var t;return null!==(t=this._shaderModuleClass.options)&&void 0!==t?t:[]}get _uniforms(){var t;return null!==(t=this._shaderModuleClass.uniforms)&&void 0!==t?t:[]}getProgram(t,e,n,r){try{const{vertex:i,fragment:s,uniformBindings:o}=this._generateShaders(t,e,n,r);return new M.X(i,s,this.renamedLocationsMap,this.locationInfo,o,this.transformFeedbackBindings)}catch(k){return console.error("Failed to create program",{error:k}),new M.X("","",this.renamedLocationsMap,this.locationInfo,[],this.transformFeedbackBindings)}}getDebugUniformClassInfo(t){const e=this._options.find((e=>e.propertyKey===t));if(e)return{type:"option",className:e.typeCtor};const n=this._uniforms.find((e=>e.propertyKey===t));if(!n)throw new Error("Unable to find uniform class type for property: ".concat(t));return{type:"required",className:n.typeCtor}}getShaderKey(t,e,n,r){const i=Object.keys(n).map((t=>"".concat(t,".").concat(n[t]))).join("."),s=Object.keys(r).map((t=>"".concat(t,".").concat(r[t]))).join("."),o=Object.keys(e).filter((t=>this.optionPropertyKeys.has(t)&&e[t])).join(".");return"".concat(this.constructor.name,".").concat(t.hash,".").concat(i,".").concat(s,".").concat(o)}_generateShaders(t,e,n,r){const i=[];this._setDefines(n),this._setOptionalUniforms(i,e),this._setRequiredUniforms(i);const s=this._hydrateVertexInput(r),o=this._injectPackPrecisionFactor(s,t),a=this._hydrateComputeInput(),c=a&&this._injectPackPrecisionFactor(a,t),l=this.vertex(o,c),u=this._hydrateFragmentInput(l),h=this.fragment(u),d=new Set;for(const _ in h){const t=h[_];(0,T.Q0)(d,t)}const p=this._getVertexInputBuiltins(),f=I.createVertex({...s,...a},l,p,i,this.transformFeedbackBindings,d);(new S).write(f);const y=this._getFragmentInputBuiltins(h);y.set("glPointCoord","gl_PointCoord");const x=I.createFragment(u,h,y,i,f,this.transformFeedbackBindings);(new S).write(x);const m=this._createShaderBuilder(f,x),g=m.generate("vertex",!1),v=m.generate("fragment",!1);return this.logShader&&(console.log(g),console.log(v)),{vertex:g,fragment:v,uniformBindings:i}}_setDefines(t){for(const e in t)this[e]=t[e]}_setOptionalUniforms(t,e){for(const n of this._options)e[n.propertyKey]?this[n.propertyKey]=this._hydrateUniformGroup(t,n):this[n.propertyKey]=null}_setRequiredUniforms(t){for(const e of this._uniforms)this[e.propertyKey]=this._hydrateUniformGroup(t,e)}_hydrateUniformGroup(t,e){const n=new(0,e.typeCtor);for(const i of null!==(r=n._uniforms)&&void 0!==r?r:[]){var r;const s=V(i.typeCtor),o="u_".concat(e.propertyKey,"_").concat(i.propertyKey),a=s.type,c=[e.propertyKey,i.propertyKey].join(".");if("type"in i.typeCtor&&"array"===i.typeCtor.type){const e=s;t.push({shaderModulePath:c,uniformName:o,uniformType:a,uniformArrayLength:e.size,uniformArrayElementType:e.elementType.type,uniformHydrated:s})}else t.push({shaderModulePath:c,uniformName:o,uniformType:a,uniformHydrated:s});n[i.propertyKey]=s}return n}_hydrateVertexInput(t){const e=this.vertexInput.inputCtor,n=e.locations.reduce(((e,n)=>!1===t[n.propertyKey]?e:{...e,[n.propertyKey]:V(n.typeCtor)}),{});for(const{propertyKey:r,typeCtor:i}of e.builtins){const t=V(i);n[r]=t}return n}_hydrateComputeInput(){return null==this.computeInput?null:this.computeInput.inputCtor.locations.reduce(((t,e)=>({...t,[e.propertyKey]:V(e.typeCtor)})),{})}_injectPackPrecisionFactor(t,e){const n={};for(const r in t){const i=t[r],s=e.attributes.find((t=>t.name===r));if(null!==s&&void 0!==s&&s.packPrecisionFactor){if("float"!==i.type&&"vec2"!==i.type&&"vec3"!==i.type&&"vec4"!==i.type)throw new Error("InternalError: packPrecisionFactor requires GenType, but found ".concat(i.type));n[r]=i.divide(new b.bv(s.packPrecisionFactor))}else n[r]=i}return n}_hydrateFragmentInput(t){const e={};for(const n in t)e[n]=t[n];for(const{propertyKey:n,typeCtor:r}of A.builtins){const t=V(r);e[n]=t}return e}_getVertexInputBuiltins(){const t=this.vertexInput.inputCtor,e=new Map;for(const{builtin:n,propertyKey:r}of t.builtins)e.set(r,n);return e}_getFragmentInputBuiltins(t){const e=t.constructor,n=new Map;for(const i of null!==(r=e.builtins)&&void 0!==r?r:[]){var r;n.set(i.propertyKey,i.builtin)}return n}_createShaderBuilder(t,e){const n=new d;return this._insertDebugInfo(n),t.insertVertexShader(n),e.insertFragmentShader(n),n}_insertDebugInfo(t){t.vertex.code.add("// DEFINES: "),t.vertex.code.add("// --------------------------------------------------------- ");for(const e of this._defines)this[e.propertyKey]?t.vertex.code.add("//   ".concat(e.propertyKey,": true")):t.vertex.code.add("//   ".concat(e.propertyKey,": false"));t.vertex.code.add(""),t.vertex.code.add("// OPTIONS: "),t.vertex.code.add("// --------------------------------------------------------- ");for(const e of this._options)this[e.propertyKey]?t.vertex.code.add("//   ".concat(e.propertyKey,": true")):t.vertex.code.add("//   ".concat(e.propertyKey,": false"))}}},23105:(t,e,n)=>{function r(t,e){const n=[];for(n.push(e);n.length;){const e=n.pop();if("object"==typeof e&&!t.has(e.uid)){t.add(e.uid);for(const t of e.children)n.push(t)}}}n.d(e,{Q0:()=>r,UV:()=>s,Yo:()=>l,Ys:()=>h,h9:()=>o,lJ:()=>u,rK:()=>c});class i{constructor(){this.uid=i.NodeCount++,this._debugName=null,this._isMutable=!1,this.isImplicit=!1}get isMutable(){return this._isMutable}setMutable(){return this._isMutable=!0,this}setDebugName(t){return t=function(t){return t.split(" ").map(((t,e)=>e>0?t.charAt(0).toUpperCase()+t.slice(1):t)).join("")}(t),this._debugName=t,this.isImplicit&&this.children[0]instanceof i&&this.children[0].setDebugName(t),this}get debugInfo(){var t;return{name:null!==(t=this._debugName)&&void 0!==t?t:""}}cloneInto(t){t._debugName=this._debugName,t._isMutable=this._isMutable,t.isImplicit=this.isImplicit,t.uid=this.uid}}function s(t){return"object"==typeof t?t.clone():t}i.NodeCount=0;class o extends i{constructor(){super(...arguments),this.shaderType="primitive-node"}}class a extends i{constructor(t){super(),this.child=t,this.shaderType="scope-node"}get children(){return[this.child]}clone(){const t=new a(s(this.child));return this.cloneInto(t),t}}class c extends i{constructor(t,e,n){super(),this.property=t,this.target=e,this.returnType=n,this.shaderType="property-access-node"}get children(){const t=[this.target];return"string"!=typeof this.property&&t.push(this.property),t}clone(){const t=new c(this.property,s(this.target),this.returnType);return this.cloneInto(t),t}}class l extends i{constructor(t,e,n){super(),this.condition=t,this.ifTrue=e,this.ifFalse=n,this.shaderType="condition-node"}get children(){return[this.condition,this.ifTrue,this.ifFalse]}clone(){const t=s(this.ifTrue),e=this.ifFalse?s(this.ifFalse):null,n=new l(this.condition,t,e);return this.cloneInto(n),n}}class u extends i{constructor(t,e,n,r){super(),this.captureList=t,this.returnType=e,this.generator=r,this.shaderType="block-node",n&&(this.subgraph=new a(n))}get children(){var t;return Object.keys(this.captureList).map((t=>this.captureList[t])).concat(null!==(t=this.subgraph)&&void 0!==t?t:[])}clone(){const t={};for(const n in this.captureList)t[n]=s(this.captureList[n]);const e=new u(t,this.returnType,this.subgraph?s(this.subgraph.child):this.subgraph,this.generator);return this.cloneInto(e),e}}class h extends i{constructor(t,e,n,r,i){let s=arguments.length>5&&void 0!==arguments[5]&&arguments[5];super(),this.token=t,this._children=e,this.isInfix=n,this.isPropertyAccess=r,this.returnType=i,this.isTernary=s,this.shaderType="function-node"}get children(){return this._children}clone(){const t=new h(this.token,this._children.map(s),this.isInfix,this.isPropertyAccess,this.returnType,this.isTernary);return this.cloneInto(t),t}}},52995:(t,e,n)=>{n.d(e,{AK:()=>kt,AO:()=>k,CD:()=>Et,CW:()=>Rt,Dg:()=>ut,Eg:()=>S,Fp:()=>Nt,Fv:()=>Ft,GW:()=>It,Iz:()=>ft,J7:()=>R,K4:()=>Z,KJ:()=>it,Nb:()=>Ct,O$:()=>Ot,Qj:()=>pt,R3:()=>q,Sg:()=>P,T8:()=>I,TE:()=>Pt,Tu:()=>W,VV:()=>zt,Wn:()=>vt,ZI:()=>Mt,bv:()=>T,e$:()=>Y,ff:()=>Ut,fz:()=>K,hx:()=>ht,ig:()=>At,kE:()=>Vt,ln:()=>dt,mC:()=>Tt,mD:()=>wt,or:()=>mt,r7:()=>xt,tS:()=>yt,tW:()=>E,tk:()=>nt,uZ:()=>St,v8:()=>w,vh:()=>X,wO:()=>j,wQ:()=>Dt,wV:()=>st,xD:()=>gt,yb:()=>G});var r,i,s,o,a,c,l,u,h,d,p,f,y,x,m=n(27366),g=n(23105);function v(t){return new Proxy(t,{get(e,n){if("constructor"===n)return new Proxy(e.constructor,{construct:(t,e,n)=>v(new t(...e))});if(n in e)return e[n];if("string"==typeof n){const e=function(t){const e=[["float","vec2","vec3","vec4"],["int","ivec2","ivec3","ivec4"],["uint","uvec2","uvec3","uvec4"],["bool","bvec2","bvec3","bvec4"]];for(const n of e)if(n.includes(t))return n.map((t=>H[t]));throw new Error("Unable to find type family")}(t.type);return Q(t,n,e[n.length-1])}}})}function _(t){return new Proxy(t,{construct:(t,e,n)=>v(new t(...e))})}class b extends Error{}let w=r=class extends g.h9{constructor(t,e){super(),this.elementType=t,this.size=e,this.children=[],this.type="array"}clone(){const t=new r(this.elementType,this.size);return super.cloneInto(t),t}get(t){if("number"==typeof t){const e=new R(t);return e.isImplicit=!0,Q(this,e,this.elementType.constructor)}return Q(this,t,this.elementType.constructor)}last(){return this.get(this.size-1)}first(){return this.get(0)}findIndex(t,e,n){return function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.size;const i=new R(n).setMutable().setDebugName("FindIndexIterator"),s=e(t.get(i)).setDebugName("FindIndexPredicate"),o=rt({iter:i},R,s,(t=>{let{out:e,iter:n,subgraph:i}=t;return"\n".concat(e," = -1;\n\nfor (; ").concat(n," < ").concat(r,"; ").concat(n,"++) {\n\n").concat(i.body,"\n\n  if (").concat(i.varName,") {\n    ").concat(e," = ").concat(n,";\n    break;\n  }\n\n}\n")})).setDebugName("FindIndexBlock");return o}(this,t,e,n)}glslFindIndex(t,e,n){return function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.size;const i=rt({array:t},R,null,(t=>{let{out:i,array:s}=t;return"\n".concat(i," = -1;\nfor (int i = ").concat(n,"; i < ").concat(r,"; i++) {\n  bool condition;\n  ").concat(e({array:s,i:"i",out:"condition"}),"\n  if (condition) {\n    ").concat(i," = i;\n    break;\n  }\n}\n")})).setDebugName("GlslFindIndexBlock");return i}(this,t,e,n)}static ofType(t,e){const n={construct:(n,i)=>new r(new t,e)};return new Proxy(r,n)}};w.type="array",w=r=(0,m._)([function(t){return new Proxy(t,{construct:(t,e,n)=>function(t){return new Proxy(t,{get(e,n){if(n in e)return e[n];if("string"==typeof n){const e=parseInt(n,10);if(!isNaN(e))return Q(t,"[".concat(e,"]"),t.elementType.constructor)}}})}(new t(...e))})}],w);class S extends g.h9{constructor(){super(...arguments),this.type="sampler2D",this.children=[]}clone(){const t=new S;return t.children=this.children.map(g.UV),super.cloneInto(t),t}}S.type="sampler2D";class T extends g.h9{constructor(t){super(),this.type="float",this.children=[t]}clone(){const t=new T((0,g.UV)(this.children[0]));return super.cloneInto(t),t}multiply(t){return ot(this,"number"==typeof t?U(t,T):t)}divide(t){return at(this,"number"==typeof t?U(t,T):t)}add(t){return ct(this,"number"==typeof t?U(t,T):t)}subtract(t){return lt(this,"number"==typeof t?U(t,T):t)}}T.type="float";let P=i=class extends g.h9{constructor(t,e){super(),this.type="vec2",this.children=[t,e].filter((t=>null!=t))}clone(){const t=new i((0,g.UV)(this.children[0]),(0,g.UV)(this.children[1]));return super.cloneInto(t),t}get 0(){return Q(this,"[0]",T)}get 1(){return Q(this,"[1]",T)}get 2(){throw new b}get 3(){throw new b}multiply(t){return ot(this,"number"==typeof t?U(t,T):t)}divide(t){return at(this,"number"==typeof t?U(t,T):t)}add(t){return ct(this,"number"==typeof t?U(t,T):t)}subtract(t){return lt(this,"number"==typeof t?U(t,T):t)}};P.type="vec2",P=i=(0,m._)([_],P);let k=s=class extends g.h9{constructor(t,e,n){super(),this.type="vec3",this.children=[t,e,n].filter((t=>null!=t))}get 0(){return Q(this,"[0]",T)}get 1(){return Q(this,"[1]",T)}get 2(){return Q(this,"[2]",T)}get 3(){throw new b}clone(){const t=new s((0,g.UV)(this.children[0]),(0,g.UV)(this.children[1]),(0,g.UV)(this.children[2]));return super.cloneInto(t),t}multiply(t){return ot(this,"number"==typeof t?U(t,T):t)}divide(t){return at(this,"number"==typeof t?U(t,T):t)}add(t){return ct(this,"number"==typeof t?U(t,T):t)}subtract(t){return lt(this,"number"==typeof t?U(t,T):t)}};k.type="vec3",k=s=(0,m._)([_],k);let I=o=class extends g.h9{constructor(t,e,n,r){super(),this.type="vec4",this.children=[t,e,n,r].filter((t=>null!=t))}clone(){const t=new o((0,g.UV)(this.children[0]),(0,g.UV)(this.children[1]),(0,g.UV)(this.children[2]),(0,g.UV)(this.children[3]));return super.cloneInto(t),t}get 0(){return Q(this,"[0]",T)}get 1(){return Q(this,"[1]",T)}get 2(){return Q(this,"[2]",T)}get 3(){return Q(this,"[3]",T)}multiply(t){return ot(this,"number"==typeof t?U(t,T):t)}divide(t){return at(this,"number"==typeof t?U(t,T):t)}add(t){return ct(this,"number"==typeof t?U(t,T):t)}subtract(t){return lt(this,"number"==typeof t?U(t,T):t)}};I.type="vec4",I=o=(0,m._)([_],I);let M=a=class extends g.h9{constructor(t){super(),this.type="uint",this.children=[t]}clone(){const t=new a((0,g.UV)(this.children[0]));return super.cloneInto(t),t}};M.type="uint",M=a=(0,m._)([_],M);let V=c=class extends g.h9{constructor(t,e){super(),this.type="uvec2",this.children=[t,e].filter((t=>null!=t))}clone(){const t=new c((0,g.UV)(this.children[0]),(0,g.UV)(this.children[1]));return super.cloneInto(t),t}};V.type="uvec2",V=c=(0,m._)([_],V);let N=l=class extends g.h9{constructor(t,e,n){super(),this.type="uvec3",this.children=[t,e,n].filter((t=>null!=t))}clone(){const t=new l((0,g.UV)(this.children[0]),(0,g.UV)(this.children[1]),(0,g.UV)(this.children[2]));return super.cloneInto(t),t}};N.type="uvec3",N=l=(0,m._)([_],N);let z=u=class extends g.h9{constructor(t,e,n,r){super(),this.type="uvec4",this.children=[t,e,n,r].filter((t=>null!=t))}clone(){const t=new u((0,g.UV)(this.children[0]),(0,g.UV)(this.children[1]),(0,g.UV)(this.children[2]),(0,g.UV)(this.children[3]));return super.cloneInto(t),t}};z.type="uvec4",z=u=(0,m._)([_],z);class E extends g.h9{constructor(t){super(),this.type="bool",this.children=[t]}and(t){return gt(this,t)}or(t){return mt(this,t)}clone(){const t=new E((0,g.UV)(this.children[0]));return super.cloneInto(t),t}}E.type="bool";let D=h=class extends g.h9{constructor(t,e){super(),this.type="bvec2",this.children=[t,e].filter((t=>null!=t))}all(){return _t(this)}any(){return bt(this)}clone(){const t=new h((0,g.UV)(this.children[0]),(0,g.UV)(this.children[1]));return super.cloneInto(t),t}};D.type="bvec2",D=h=(0,m._)([_],D);let F=d=class extends g.h9{constructor(t,e,n){super(),this.type="bvec3",this.children=[t,e,n].filter((t=>null!=t))}all(){return _t(this)}any(){return bt(this)}clone(){const t=new d((0,g.UV)(this.children[0]),(0,g.UV)(this.children[1]),(0,g.UV)(this.children[2]));return super.cloneInto(t),t}};function U(t,e){return"number"==typeof t?new e(t):t}F.type="bvec3",F=d=(0,m._)([_],F);let O=p=class extends g.h9{constructor(t,e,n,r){super(),this.type="bvec4",this.children=[t,e,n,r].filter((t=>null!=t))}all(){return _t(this)}any(){return bt(this)}clone(){const t=new p((0,g.UV)(this.children[0]),(0,g.UV)(this.children[1]),(0,g.UV)(this.children[2]),(0,g.UV)(this.children[3]));return super.cloneInto(t),t}};O.type="bvec4",O=p=(0,m._)([_],O);class R extends g.h9{constructor(t){super(),this.type="int",this.children=[t]}multiply(t){return ot(this,U(t,R))}add(t){return ct(this,U(t,R))}subtract(t){return lt(this,U(t,R))}divide(t){return at(this,U(t,R))}clone(){const t=new R((0,g.UV)(this.children[0]));return super.cloneInto(t),t}}R.type="int";let C=f=class extends g.h9{constructor(t,e){super(),this.type="ivec2",this.children=[t,e].filter((t=>null!=t))}clone(){const t=new f((0,g.UV)(this.children[0]),(0,g.UV)(this.children[1]));return super.cloneInto(t),t}};C.type="ivec2",C=f=(0,m._)([_],C);let A=y=class extends g.h9{constructor(t,e,n){super(),this.type="ivec3",this.children=[t,e,n].filter((t=>null!=t))}clone(){const t=new y((0,g.UV)(this.children[0]),(0,g.UV)(this.children[1]),(0,g.UV)(this.children[2]));return super.cloneInto(t),t}};A.type="ivec3",A=y=(0,m._)([_],A);let B=x=class extends g.h9{constructor(t,e,n,r){super(),this.type="ivec4",this.children=[t,e,n,r].filter((t=>null!=t))}clone(){const t=new x((0,g.UV)(this.children[0]),(0,g.UV)(this.children[1]),(0,g.UV)(this.children[2]),(0,g.UV)(this.children[3]));return super.cloneInto(t),t}};B.type="ivec4",B=x=(0,m._)([_],B);class L extends g.h9{constructor(t,e,n,r){super(),this.type="mat2",this.children=[t,e,n,r]}clone(){const t=new L((0,g.UV)(this.children[0]),(0,g.UV)(this.children[1]),(0,g.UV)(this.children[2]),(0,g.UV)(this.children[3]));return super.cloneInto(t),t}}L.type="mat2";class W extends g.h9{static identity(){return new W(1,0,0,0,1,0,0,0,1)}static fromRotation(t){const e=Ot(t),n=Tt(t);return new W(n,e,0,nt(e),n,0,0,0,1)}constructor(t,e,n,r,i,s,o,a,c){super(),this.type="mat3",this.children=[t,e,n,r,i,s,o,a,c]}add(t){return ct(this,t)}multiply(t){return ot(this,t)}clone(){const t=new W((0,g.UV)(this.children[0]),(0,g.UV)(this.children[1]),(0,g.UV)(this.children[2]),(0,g.UV)(this.children[3]),(0,g.UV)(this.children[4]),(0,g.UV)(this.children[5]),(0,g.UV)(this.children[6]),(0,g.UV)(this.children[7]),(0,g.UV)(this.children[8]));return super.cloneInto(t),t}}W.type="mat3";class G extends g.h9{static identity(){return new G(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)}constructor(t,e,n,r,i,s,o,a,c,l,u,h,d,p,f,y){super(),this.type="mat4",this.children=[t,e,n,r,i,s,o,a,c,l,u,h,d,p,f,y]}static fromColumns(t,e,n,r){return new G(t.x,t.y,t.z,t.w,e.x,e.y,e.z,e.w,n.x,n.y,n.z,n.w,r.x,r.y,r.z,r.w)}multiply(t){return ot(this,t)}clone(){const t=new G((0,g.UV)(this.children[0]),(0,g.UV)(this.children[1]),(0,g.UV)(this.children[2]),(0,g.UV)(this.children[3]),(0,g.UV)(this.children[4]),(0,g.UV)(this.children[5]),(0,g.UV)(this.children[6]),(0,g.UV)(this.children[7]),(0,g.UV)(this.children[8]),(0,g.UV)(this.children[9]),(0,g.UV)(this.children[10]),(0,g.UV)(this.children[11]),(0,g.UV)(this.children[12]),(0,g.UV)(this.children[13]),(0,g.UV)(this.children[14]),(0,g.UV)(this.children[15]));return super.cloneInto(t),t}}G.type="mat4";const H={float:T,vec2:P,vec3:k,vec4:I,int:R,ivec2:C,ivec3:A,ivec4:B,uint:M,uvec2:V,uvec3:N,uvec4:z,bool:E,bvec2:D,bvec3:F,bvec4:O},Y=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new R(...e)},K=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new T(...e)},Z=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new P(...e)},q=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new k(...e)},X=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new I(...e)},j=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new W(...e)};function Q(t,e,n){const r=new n(new g.rK(e,t,n));return r.isImplicit=!0,r}function J(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(r){const i=new r,s=new r(new g.Ys(t,[e,n],!0,!1,i));return s.isImplicit=!0,s}if("float"===e.type||"int"===e.type){const r=new n.constructor(new g.Ys(t,[e,n],!0,!1,n.constructor));return r.isImplicit=!0,r}if(("mat2"===e.type||"mat3"===e.type||"mat4"===e.type)&&"float"!==n.type){const r=new n.constructor(new g.Ys(t,[e,n],!0,!1,n.constructor));return r.isImplicit=!0,r}const i=new e.constructor(new g.Ys(t,[e,n],!0,!1,e.constructor));return i.isImplicit=!0,i}function $(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.constructor;const r=new n(new g.Ys(t,[e],!1,!1,n));return r.isImplicit=!0,r}function tt(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.constructor;const i=new r(new g.Ys(t,[e,n],!1,!1,r));return i.isImplicit=!0,i}function et(t,e,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:e.constructor;const s=new i(new g.Ys(t,[e,n,r],!1,!1,i));return s.isImplicit=!0,s}function nt(t){return ot(t,K(-1))}function rt(t,e,n,r){return new e(new g.lJ(t,e,n,r))}function it(t,e,n){const r="function"==typeof e?e():e,i="function"==typeof n?n():n,s=new r.constructor(new g.Yo(t,r,i));return s.isImplicit=!0,s}function st(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const r=e.map((t=>{let[e,n]=t;return"function"==typeof n?[e,n()]:[e,n]})),i=r[0][1].constructor,s=r.findIndex((t=>!0===t[0]));if(-1===s)throw new Error("A cond must have a fallthrough case with `true`/; ");const o=r.slice(0,s),a=r[s][1],c=new i(o.reduceRight(((t,e)=>it(e[0],e[1],t)),a));return c.isImplicit=!0,c}function ot(t,e){return J("*",t,e)}function at(t,e){return J("/",t,e)}function ct(t,e){return J("+",t,e)}function lt(t,e){return J("-",t,e)}function ut(t,e){return J(">>",t,e)}function ht(t,e){return J("&",t,e)}function dt(t,e){return J("==",t,e,E)}function pt(t,e){return J("<",t,e,E)}function ft(t,e){return J("<=",t,e,E)}function yt(t,e){return J(">",t,e,E)}function xt(t,e){return J(">=",t,e,E)}function mt(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.length<=1?e[0]:e.slice(1).reduce(((t,e)=>function(t,e){return J("||",t,e,E)}(t,e)),e[0])}function gt(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.length<=1?e[0]:e.slice(1).reduce(((t,e)=>function(t,e){return J("&&",t,e,E)}(t,e)),e[0])}function vt(t){return $("abs",t)}function _t(t){return $("all",t,E)}function bt(t){return $("any",t,E)}function wt(t){return $("ceil",t)}function St(t,e,n){return et("clamp",t,e,n,t.constructor)}function Tt(t){return $("cos",t)}function Pt(t,e){return tt("distance",t,e,T)}function kt(t,e){return tt("dot",t,e,T)}function It(t){return $("floor",t)}function Mt(t){return $("fract",t)}function Vt(t){return $("length",t,T)}function Nt(t,e){return tt("max",t,e)}function zt(t,e){return tt("min",t,e)}function Et(t,e,n){return et("mix",t,e,n)}function Dt(t,e){return tt("mod",t,e)}function Ft(t){return $("normalize",t)}function Ut(t){return"bool"===t.type?$("!",t):$("not",t)}function Ot(t){return $("sin",t)}function Rt(t,e,n){return et("smoothstep",t,e,n)}function Ct(t,e){return tt("step",t,e,e.constructor)}function At(t,e){return tt("texture2D",t,e,I)}},70467:(t,e,n)=>{n.d(e,{m:()=>r});const r={bitset:{isSDF:0,isMapAligned:1,scaleSymbolsProportionally:2,overrideOutlineColor:3,colorLocked:4}}},61040:(t,e,n)=>{n.d(e,{U:()=>Oe});var r=n(93169),i=n(48035),s=(n(79347),n(40316)),o=n(80457),a=n(94109);function c(t,e,n,r,i,s,o){D=0;const a=(r-n)*s,c=i&&i.length,u=c?(i[0]-n)*s:a;let d,p,f,y,x,g=l(e,n,r,0,u,s,!0);if(g&&g.next!==g.prev){if(c&&(g=m(e,n,r,i,g,s)),a>80*s){d=f=e[0+n*s],p=y=e[1+n*s];for(let t=s;t<u;t+=s){const r=e[t+n*s],i=e[t+1+n*s];d=Math.min(d,r),p=Math.min(p,i),f=Math.max(f,r),y=Math.max(y,i)}x=Math.max(f-d,y-p),x=0!==x?1/x:0}h(g,t,s,d,p,x,o,0)}}function l(t,e,n,r,i,s,o){let a;if(o===function(t,e,n,r,i,s){let o=0;for(let a=r,c=i-s;a<i;a+=s)o+=(t[c+e*s]-t[a+e*s])*(t[a+1+e*s]+t[c+1+e*s]),c=a;return o}(t,e,0,r,i,s)>0)for(let c=r;c<i;c+=s)a=f(c+e*s,t[c+e*s],t[c+1+e*s],a);else for(let c=i-s;c>=r;c-=s)a=f(c+e*s,t[c+e*s],t[c+1+e*s],a);return a&&P(a,a.next)&&(y(a),a=a.next),a}function u(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;if(!t)return t;let n,r=t;do{if(n=!1,r.steiner||!P(r,r.next)&&0!==_(r.prev,r,r.next))r=r.next;else{if(y(r),r=e=r.prev,r===r.next)break;n=!0}}while(n||r!==e);return e}function h(t,e,n,r,i,s,o,a){if(!t)return;!a&&s&&(t=v(t,r,i,s));let c=t;for(;t.prev!==t.next;){const l=t.prev,f=t.next;if(s?p(t,r,i,s):d(t))e.push(l.index/n+o),e.push(t.index/n+o),e.push(f.index/n+o),y(t),t=f.next,c=f.next;else if((t=f)===c){a?1===a?h(t=I(t,e,n,o),e,n,r,i,s,o,2):2===a&&M(t,e,n,r,i,s,o):h(u(t),e,n,r,i,s,o,1);break}}}function d(t){const e=t.prev,n=t,r=t.next;if(_(e,n,r)>=0)return!1;let i=t.next.next;const s=i;let o=0;for(;i!==t.prev&&(0===o||i!==s);){if(o++,w(e.x,e.y,n.x,n.y,r.x,r.y,i.x,i.y)&&_(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function p(t,e,n,r){const i=t.prev,s=t,o=t.next;if(_(i,s,o)>=0)return!1;const a=i.x<s.x?i.x<o.x?i.x:o.x:s.x<o.x?s.x:o.x,c=i.y<s.y?i.y<o.y?i.y:o.y:s.y<o.y?s.y:o.y,l=i.x>s.x?i.x>o.x?i.x:o.x:s.x>o.x?s.x:o.x,u=i.y>s.y?i.y>o.y?i.y:o.y:s.y>o.y?s.y:o.y,h=T(a,c,e,n,r),d=T(l,u,e,n,r);let p=t.prevZ,f=t.nextZ;for(;p&&p.z>=h&&f&&f.z<=d;){if(p!==t.prev&&p!==t.next&&w(i.x,i.y,s.x,s.y,o.x,o.y,p.x,p.y)&&_(p.prev,p,p.next)>=0)return!1;if(p=p.prevZ,f!==t.prev&&f!==t.next&&w(i.x,i.y,s.x,s.y,o.x,o.y,f.x,f.y)&&_(f.prev,f,f.next)>=0)return!1;f=f.nextZ}for(;p&&p.z>=h;){if(p!==t.prev&&p!==t.next&&w(i.x,i.y,s.x,s.y,o.x,o.y,p.x,p.y)&&_(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;f&&f.z<=d;){if(f!==t.prev&&f!==t.next&&w(i.x,i.y,s.x,s.y,o.x,o.y,f.x,f.y)&&_(f.prev,f,f.next)>=0)return!1;f=f.nextZ}return!0}function f(t,e,n,r){const i=z.create(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function y(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function x(t){let e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function m(t,e,n,r,i,s){const o=new Array;for(let a=0,c=r.length;a<c;a++){const i=l(t,e,0,r[a]*s,a<c-1?r[a+1]*s:n*s,s,!1);i===i.next&&(i.steiner=!0),o.push(x(i))}o.sort(k);for(const a of o)i=g(a,i);return i}function g(t,e){const n=function(t,e){let n=e;const r=t.x,i=t.y;let s,o=-1/0;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){const t=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(t<=r&&t>o){if(o=t,t===r){if(i===n.y)return n;if(i===n.next.y)return n.next}s=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!s)return null;if(r===o)return s.prev;const a=s,c=s.x,l=s.y;let u,h=1/0;for(n=s.next;n!==a;)r>=n.x&&n.x>=c&&r!==n.x&&w(i<l?r:o,i,c,l,i<l?o:r,i,n.x,n.y)&&(u=Math.abs(i-n.y)/(r-n.x),(u<h||u===h&&n.x>s.x)&&S(n,t)&&(s=n,h=u)),n=n.next;return s}(t,e);if(!n)return e;const r=N(n,t);return u(r,r.next),u(n,n.next)}function v(t,e,n,r){let i;for(;i!==t;i=i.next){if(i=i||t,null===i.z&&(i.z=T(i.x,i.y,e,n,r)),i.prev.next!==i||i.next.prev!==i)return i.prev.next=i,i.next.prev=i,v(t,e,n,r);i.prevZ=i.prev,i.nextZ=i.next}return t.prevZ.nextZ=null,t.prevZ=null,function(t){let e,n=1;for(;;){let r,i=t;t=null,e=null;let s=0;for(;i;){s++,r=i;let o=0;for(;o<n&&r;o++)r=r.nextZ;let a=n;for(;o>0||a>0&&r;){let n;0===o?(n=r,r=r.nextZ,a--):0!==a&&r?i.z<=r.z?(n=i,i=i.nextZ,o--):(n=r,r=r.nextZ,a--):(n=i,i=i.nextZ,o--),e?e.nextZ=n:t=n,n.prevZ=e,e=n}i=r}if(e.nextZ=null,n*=2,s<2)return t}}(t)}function _(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function b(t,e,n,r){return!!(P(t,e)&&P(n,r)||P(t,r)&&P(n,e))||_(t,e,n)>0!=_(t,e,r)>0&&_(n,r,t)>0!=_(n,r,e)>0}function w(t,e,n,r,i,s,o,a){return(i-o)*(e-a)-(t-o)*(s-a)>=0&&(t-o)*(r-a)-(n-o)*(e-a)>=0&&(n-o)*(s-a)-(i-o)*(r-a)>=0}function S(t,e){return _(t.prev,t,t.next)<0?_(t,e,t.next)>=0&&_(t,t.prev,e)>=0:_(t,e,t.prev)<0||_(t,t.next,e)<0}function T(t,e,n,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function P(t,e){return t.x===e.x&&t.y===e.y}function k(t,e){return t.x-e.x}function I(t,e,n,r){let i=t;do{const s=i.prev,o=i.next.next;!P(s,o)&&b(s,i,i.next,o)&&S(s,o)&&S(o,s)&&(e.push(s.index/n+r),e.push(i.index/n+r),e.push(o.index/n+r),y(i),y(i.next),i=t=o),i=i.next}while(i!==t);return i}function M(t,e,n,r,i,s,o){let a=t;do{let t=a.next.next;for(;t!==a.prev;){if(a.index!==t.index&&V(a,t)){let c=N(a,t);return a=u(a,a.next),c=u(c,c.next),h(a,e,n,r,i,s,o,0),void h(c,e,n,r,i,s,o,0)}t=t.next}a=a.next}while(a!==t)}function V(t,e){return t.next.index!==e.index&&t.prev.index!==e.index&&!function(t,e){let n=t;do{if(n.index!==t.index&&n.next.index!==t.index&&n.index!==e.index&&n.next.index!==e.index&&b(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&S(t,e)&&S(e,t)&&function(t,e){let n=t,r=!1;const i=(t.x+e.x)/2,s=(t.y+e.y)/2;do{n.y>s!=n.next.y>s&&n.next.y!==n.y&&i<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)}function N(t,e){const n=z.create(t.index,t.x,t.y),r=z.create(e.index,e.x,e.y),i=t.next,s=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,s.next=r,r.prev=s,r}class z{constructor(){this.index=0,this.x=0,this.y=0,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}static create(t,e,n){const r=D<E.length?E[D++]:new z;return r.index=t,r.x=e,r.y=n,r.prev=null,r.next=null,r.z=null,r.prevZ=null,r.nextZ=null,r.steiner=!1,r}}const E=[];let D=0;for(let Re=0;Re<8096;Re++)E.push(new z);const F=new s.bN(0,0,0,1,0),U=new s.bN(0,0,0,1,0);function O(t,e,n){let r=0;for(let i=1;i<n;i++){const n=t[2*(e+i-1)],s=t[2*(e+i-1)+1];r+=(t[2*(e+i)]-n)*(t[2*(e+i)+1]+s)}return r}function R(t,e,n,r,i){let s=0;for(let o=n;o<r;o+=3){const n=2*(t[o]-i),r=2*(t[o+1]-i),a=2*(t[o+2]-i);s+=Math.abs((e[n]-e[a])*(e[r+1]-e[n+1])-(e[n]-e[r])*(e[a+1]-e[n+1]))}return s}function C(t,e){if(null==t)return null;if(!function(t,e,n){let r=0;for(let i=0;i<t.lengths.length;i++){const s=t.lengths[i];for(let i=0;i<s;i++){const s=t.coords[2*(i+r)],o=t.coords[2*(i+r)+1];if(s<e||s>n||o<e||o>n)return!0}r+=s}return!1}(t,-128,a.i9+128))return t;F.setPixelMargin(e),F.reset(s.Vl.Polygon);let n=0;for(let s=0;s<t.lengths.length;s++){const e=t.lengths[s];let r=t.coords[2*(0+n)],i=t.coords[2*(0+n)+1];F.moveTo(r,i);for(let s=1;s<e;s++)r=t.coords[2*(s+n)],i=t.coords[2*(s+n)+1],F.lineTo(r,i);F.close(),n+=e}const r=F.result(!1);if(!r)return null;const i=[],c=[];for(const s of r){let t=0;for(const e of s)c.push(e.x),c.push(e.y),t++;i.push(t)}return new o.Z(i,c)}F.setExtent(a.i9),U.setExtent(a.i9);var A=n(23895),B=n(95954);let L=null;function W(){return L}var G=n(73271),H=n(89226),Y=n(8548);function K(t){switch(t){case Y.g.BYTE:case Y.g.UNSIGNED_BYTE:return 1;case Y.g.SHORT:case Y.g.UNSIGNED_SHORT:return 2;case Y.g.FLOAT:case Y.g.INT:case Y.g.UNSIGNED_INT:return 4}}class Z{static fromVertexSpec(t,e){let n,r,i,{attributes:s}=t;const o=[];for(const p in s){const t=s[p];!1!==(null===e||void 0===e?void 0:e[p])&&("position"===t.pack?n={...t,name:p,offset:0}:"id"===t.pack?r={...t,name:p,offset:4}:"bitset"===p?i={...t,name:p,offset:7}:o.push({...t,name:p}))}const a=function(t){const e=[],n=[],r=[];for(const i of t){const t=K(i.type)*i.count;switch(t%2||t%4||4){case 4:e.push(i);continue;case 2:n.push(i);continue;case 1:r.push(i);continue;default:throw new Error("Found unexpected dataType byte count")}}return e.push(...n),e.push(...r),e}(o),c=[];let l=8,u=1;for(const p of a)c.push({...p,offset:l}),l+=K(p.type)*p.count,p.packAlternating&&(u=Math.max(p.packAlternating.count,u));const h=Uint32Array.BYTES_PER_ELEMENT,d=l%h;return new Z(n,r,i,c,l+(d?h-d:0),u)}constructor(t,e,n,r,i,s){this.position=t,this.id=e,this.bitset=n,this.standardAttributes=r,this.stride=i,this.packVertexCount=s,r.push(n),this._attributes=[t,e,n,...r]}get attributeLayout(){if(!this._attributeLayout){const t=(0,H.ig)(this._attributes),e=this._attributes.map((t=>{var e;return{name:t.name,count:t.count,offset:t.offset,type:t.type,packPrecisionFactor:t.packPrecisionFactor,normalized:null!==(e=t.normalized)&&void 0!==e&&e}}));this._attributeLayout={attributes:e,hash:t,stride:this.stride}}return this._attributeLayout}}var q=n(70966);class X{static fromVertexSpec(t,e){const n=Z.fromVertexSpec(t,e);return new X(n)}constructor(t){this._spec=t,this._packed=new Uint8Array(this._spec.stride*this._spec.packVertexCount),this._packedU32View=new Uint32Array(this._packed.buffer),this._dataView=new DataView(this._packed.buffer)}get attributeLayout(){return this._spec.attributeLayout}get stride(){return this._spec.stride}writeVertex(t,e,n,r,i,s){for(let a=0;a<this._spec.packVertexCount;a++){const t=a*this._spec.stride;this._packPosition(n,r,t),this._packId(e,t);const c=this._spec.bitset;if(s){if(c.packTessellation){const e=c.packTessellation(s,i);this._pack(e,c,t)}for(const e of this._spec.standardAttributes){var o;if(null!=e.packTessellation){const n=e.packTessellation(s,i);this._pack(n,e,t)}else if(null!==(o=e.packAlternating)&&void 0!==o&&o.packTessellation){const t=e.packAlternating.packTessellation(s,i);for(let n=0;n<this._spec.packVertexCount;n++){const r=t[n];this._pack(r,e,n*this._spec.stride)}}}}}t.vertexWriteRegion(this._packedU32View)}pack(t,e){for(const r of this._spec.standardAttributes){var n;if(r.pack&&"string"!=typeof r.pack){const n=r.pack(t,e);for(let t=0;t<this._spec.packVertexCount;t++)this._pack(n,r,t*this._spec.stride)}else if(null!==(n=r.packAlternating)&&void 0!==n&&n.pack){const n=r.packAlternating.pack(t,e);for(let t=0;t<this._spec.packVertexCount;t++){const e=n[t];this._pack(e,r,t*this._spec.stride)}}}}_packPosition(t,e,n){var r;const{offset:i}=this._spec.position,s=null!==(r=this._spec.position.packPrecisionFactor)&&void 0!==r?r:1,o=(0,G.UJ)(t*s,e*s);this._dataView.setUint32(n+i,o,!0)}_packId(t,e){var n;const r=t*(null!==(n=this._spec.id.packPrecisionFactor)&&void 0!==n?n:1),i=4278190080&this._dataView.getUint32(e+this._spec.id.offset,!0);this._dataView.setUint32(e+this._spec.id.offset,r|i,!0)}_pack(t,e,n){(0,q.G)(this._dataView,t,e,n)}}class j{constructor(t,e,n,r){this._instanceId=t,this._evaluator=e,this._viewParams=n,this._optionalAttributes=r,this._evaluator.evaluator=t=>this.vertexSpec.createComputedParams(t)}get _vertexPack(){if(!this._cachedVertexPack){const t=X.fromVertexSpec(this.vertexSpec,this._optionalAttributes);this._evaluator.hasDynamicProperties||t.pack(this._evaluator.evaluatedMeshParams,this._viewParams),this._cachedVertexPack=t}return this._cachedVertexPack}get evaluatedMeshParams(){return this._evaluator.evaluatedMeshParams}get hasEffects(){return!!this.evaluatedMeshParams.effects}get instanceId(){return this._instanceId}get attributeLayout(){return this._vertexPack.attributeLayout}setReferences(t){this._references=t}getBoundsInfo(){return null}getTileInfo(){return this._viewParams.tileInfo}async loadDependencies(){var t;(function(t){if(!t)return!1;for(const e of t)switch(e.effect.type){case"CIMGeometricEffectBuffer":case"CIMGeometricEffectOffset":case"CIMGeometricEffectDonut":return!0}return!1})(null===(t=this._evaluator.inputMeshParams.params.effects)||void 0===t?void 0:t.effectInfos)&&await async function(){L=await Promise.all([n.e(9058),n.e(309)]).then(n.bind(n,50309))}()}enqueueRequest(t,e,n){this._evaluator.hasDynamicProperties&&this._evaluator.enqueueRequest(t,e,n)}write(t,e,n,r,i){var s;this.ensurePacked(e,n,r);const o=this.evaluatedMeshParams.effects;if(!o||0===o.length)return void this._write(t,n,void 0,i);const a=null===(s=n.readGeometryForDisplay())||void 0===s?void 0:s.clone();if(!a)return;const c=A.z.fromOptimizedCIM(a,n.geometryType),l=W();c.invertY();const u=t.id||"",h=B.j.executeEffects(o,c,u,l);let d;for(;d=h.next();)d.invertY(),this._write(t,n,d,i)}ensurePacked(t,e,n){if(!this._evaluator.hasDynamicProperties)return;const r=this._evaluator.evaluateMeshParams(t,e,n);this._vertexPack.pack(r,this._viewParams)}_writeVertex(t,e,n,r,i){const s=this.evaluatedMeshParams;this._vertexPack.writeVertex(t,e,n,r,s,i)}}const Q=(0,r.Z)("featurelayer-fast-triangulation-enabled");class J extends j{async loadDependencies(){await Promise.all([super.loadDependencies(),(0,i.j)()])}_write(t,e,n){var r;const i=null!==(r=null===n||void 0===n?void 0:n.asOptimized())&&void 0!==r?r:e.readGeometryForDisplay(),s=this._clip(i);s&&(t.recordStart(this.instanceId,this.attributeLayout),this._writeGeometry(t,e,s),t.recordEnd())}_clip(t){if(!t)return null;return C(t,this.hasEffects?256:8)}_writeGeometry(t,e,n){const r=n.maxLength>100,s=[],o=this.createTesselationParams(e);if(!r&&Q&&function(t,e){const{coords:n,lengths:r,hasIndeterminateRingOrder:i}=e,s=t;if(i)return!1;let o=0;for(let a=0;a<r.length;){let t=a,e=r[a],i=O(n,o,e);const l=[];for(;++t<r.length;){const s=r[t],a=O(n,o+e,s);if(!(a>0))break;i+=a,l.push(o+e),e+=s}const u=s.length;c(s,n,o,o+e,l,2,0);const h=R(s,n,u,s.length,0),d=Math.abs(i);if(Math.abs((h-d)/Math.max(1e-7,d))>1e-5)return s.length=0,!1;a=t,o+=e}return!0}(s,n))return void(s.length&&this._writeVertices(t,e,n.coords,o,s));const a=function(t){const{coords:e,lengths:n}=t,{buffer:r}=(0,i.b)(e,n);return r}(n);this._writeVertices(t,e,a,o)}_writeVertices(t,e,n,r,i){const s=e.getDisplayId(),o=t.vertexCount(),a=this.hasEffects;let c=0;if(i)for(const l of i){const e=n[2*l],i=n[2*l+1];a&&t.recordBounds(e,i,0,0),this._writeVertex(t,s,e,i,r),c++}else for(let l=0;l<n.length;l+=2){const e=Math.round(n[l]),i=Math.round(n[l+1]);a&&t.recordBounds(e,i,0,0),this._writeVertex(t,s,e,i,r),c++}t.indexEnsureSize(c);for(let l=0;l<c;l++)t.indexWrite(l+o)}}const $={createComputedParams:t=>t,attributes:{id:{type:Y.g.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:Y.g.UNSIGNED_BYTE,count:1},pos:{type:Y.g.SHORT,count:2,pack:"position",packPrecisionFactor:10},inverseArea:{type:Y.g.FLOAT,count:1,packTessellation:t=>{let{inverseArea:e}=t;return e}}}};var tt=n(17842),et=n(99201),nt=n(51995),rt=n(10064),it=n(32718),st=n(48202);function ot(t,e){return[!(null===t||void 0===t||!t.minScale)&&e.scaleToZoom(t.minScale)||0,!(null===t||void 0===t||!t.maxScale)&&e.scaleToZoom(t.maxScale)||100]}function at(t){return 1<<t}function ct(t){let e=0;for(const[n,r]of t)r&&(e|=1<<n);return e}function lt(t){let e;if(!t)return[0,0,0,0];if("string"==typeof t){const n=nt.Z.fromString(t);if(!n)return it.Z.getLogger("esri.views.2d.engine.webgl.shaderGraph.techniques.meshWriterUtils").errorOnce(new rt.Z("mapview:mesh-processing","Unable to parse string into color",{color:t})),[0,0,0,0];e=n.toArray()}else e=t;const[n,r,i,s]=e;return[n*(s/255),r*(s/255),i*(s/255),s]}function ut(t,e){return Math.round(Math.min(Math.sqrt(t*e),255))}function ht(t,e){return Math.round(t*e)/e}function dt(t,e){return Math.ceil(t*e)/e}const pt={createComputedParams:t=>t,attributes:{id:{type:Y.g.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:Y.g.UNSIGNED_BYTE,count:1},pos:{type:Y.g.SHORT,count:2,pack:"position",packPrecisionFactor:10},zoomRange:{type:Y.g.SHORT,count:2,packPrecisionFactor:a.JS,pack:(t,e)=>{let{scaleInfo:n}=t,{tileInfo:r}=e;return ot(n,r)}},color:{type:Y.g.UNSIGNED_BYTE,count:4,normalized:!0,pack:t=>{let{color:e}=t;return lt(e)}}}};class ft extends J{constructor(){super(...arguments),this.vertexSpec=pt}createTesselationParams(t){return null}}const yt={createComputedParams:t=>t,attributes:{...pt.attributes,tlbr:{count:4,type:Y.g.UNSIGNED_SHORT,pack:t=>{let{sprite:e}=t;const{rect:n,width:r,height:i}=e,s=n.x+a.s4,o=n.y+a.s4;return[s,o,s+r,o+i]}},inverseRasterizationScale:{count:1,type:Y.g.BYTE,packPrecisionFactor:16,pack:t=>{let{sprite:e}=t;return 1/e.rasterizationScale}}}};class xt extends ft{constructor(){super(...arguments),this.vertexSpec=yt}_write(t,e,n){var r,i;const s=null!==(r=null===n||void 0===n?void 0:n.asOptimized())&&void 0!==r?r:e.readGeometryForDisplay(),o=this._clip(s);if(!o)return;const a=null===(i=this.evaluatedMeshParams.sprite)||void 0===i?void 0:i.textureBinding;t.recordStart(this.instanceId,this.attributeLayout,a),this._writeGeometry(t,e,o),t.recordEnd()}}var mt=n(17326);function gt(t){const{sprite:e,aspectRatio:n,scaleProportionally:r}=t,i=(0,tt.F2)(t.height),s=i>0?i:e.height;let o=i*n;return o<=0?o=e.width:r&&(o*=e.width/e.height),{width:o,height:s}}function vt(t){const{applyRandomOffset:e,sampleAlphaOnly:n}=t,{width:r,height:i}=gt(t);return ct([[mt.Ux,e],[mt.GS,n],[mt.i6,r<a.oh],[mt.oy,i<a.oh]])}function _t(t){const{width:e}=gt(t);return Math.round(e<a.oh?e*a.Kg:e)}function bt(t){const{height:e}=gt(t);return Math.round(e<a.oh?e*a.Kg:e)}const wt={createComputedParams:t=>t,attributes:{...yt.attributes,bitset:{count:1,type:Y.g.UNSIGNED_BYTE,pack:vt},width:{count:1,type:Y.g.UNSIGNED_SHORT,pack:_t},height:{count:1,type:Y.g.UNSIGNED_SHORT,pack:bt},offset:{count:2,type:Y.g.SHORT,pack:t=>{let{offsetX:e,offsetY:n}=t;return[(0,tt.F2)(e),-(0,tt.F2)(n)]}},scale:{count:2,type:Y.g.UNSIGNED_BYTE,packPrecisionFactor:16,pack:t=>{let{scaleX:e,scaleY:n}=t;return[e,n]}},angle:{count:1,type:Y.g.UNSIGNED_BYTE,pack:t=>{let{angle:e}=t;return(0,et.s5)(e)}}}};var St=n(82010);class Tt{constructor(){this.extrusionOffsetX=0,this.extrusionOffsetY=0,this.normalX=0,this.normalY=0,this.directionX=0,this.directionY=0,this.distance=0}}const Pt={createComputedParams:t=>t,attributes:{id:{type:Y.g.UNSIGNED_BYTE,count:3,pack:"id"},pos:{type:Y.g.SHORT,count:2,pack:"position",packPrecisionFactor:10},bitset:{type:Y.g.UNSIGNED_BYTE,count:1},zoomRange:{type:Y.g.SHORT,count:2,packPrecisionFactor:a.JS,pack:(t,e)=>{let{scaleInfo:n}=t,{tileInfo:r}=e;return ot(n,r)}},color:{type:Y.g.UNSIGNED_BYTE,count:4,normalized:!0,pack:t=>{let{color:e}=t;return lt(e)}},offset:{type:Y.g.BYTE,count:2,packPrecisionFactor:16,packTessellation:t=>{let{extrusionOffsetX:e,extrusionOffsetY:n}=t;return[ht(e,16),ht(n,16)]}},normal:{type:Y.g.BYTE,count:2,packPrecisionFactor:16,packTessellation:t=>{let{normalX:e,normalY:n}=t;return[ht(e,16),ht(n,16)]}},halfWidth:{type:Y.g.UNSIGNED_SHORT,count:1,packPrecisionFactor:16,pack:t=>{let{width:e}=t;return dt((0,tt.F2)(.5*e),16)}},referenceHalfWidth:{type:Y.g.UNSIGNED_SHORT,count:1,packPrecisionFactor:16,pack:t=>{let{referenceWidth:e}=t;return dt((0,tt.F2)(.5*e),16)}}}};class kt{constructor(){this.id=0,this.bitset=0,this.indexCount=0,this.vertexCount=0,this.vertexFrom=0,this.vertexBounds=0}}class It extends j{constructor(t,e,n,r){super(t,e,n,r),this.vertexSpec=Pt,this._currentWrite=new kt,this._tessellationOptions={halfWidth:0,pixelCoordRatio:1,offset:0,wrapDistance:65535,textured:!1},this._tessParams=new Tt,this._initializeTessellator()}writeLineVertices(t,e,n){const r=this._getLines(e);null!=r&&this._writeVertices(t,n,r)}_initializeTessellator(){this._lineTessellator=new St.z(this._writeTesselatedVertex.bind(this),this._writeTriangle.bind(this),!0)}_write(t,e,n){const r=null!==n&&void 0!==n?n:A.z.fromFeatureSetReaderCIM(e);r&&this._writeGeometry(t,e,r)}_writeGeometry(t,e,n,r){t.recordStart(this.instanceId,this.attributeLayout,r),this.writeLineVertices(t,n,e),t.recordEnd()}_getLines(t){return function(t,e){U.setPixelMargin(e);const n=U,r=-e,i=a.i9+e;let o=[],c=!1;if(!t.nextPath())return null;let l=!0;for(;l;){t.seekPathStart();const e=[];if(!t.pathSize)return null;n.reset(s.Vl.LineString),t.nextPoint();let a=t.x,u=t.y;if(c)n.moveTo(a,u);else{if(a<r||a>i||u<r||u>i){c=!0;continue}e.push({x:a,y:u})}let h=!1;for(;t.nextPoint();)if(a=t.x,u=t.y,c)n.lineTo(a,u);else{if(a<r||a>i||u<r||u>i){h=!0;break}e.push({x:a,y:u})}if(h)c=!0;else{if(c){const t=n.resultWithStarts();if(t)for(const e of t)o.push(e)}else o.push({line:e,start:0});l=t.nextPath(),c=!1}}return o=o.filter((t=>t.line.length>1)),0===o.length?null:o}(t,(0,H.b8)(this.evaluatedMeshParams))}_writeVertices(t,e,n){const{_currentWrite:r,_tessellationOptions:i,evaluatedMeshParams:s}=this,{width:o,capType:c,joinType:l,miterLimit:u,hasSizeVV:h}=s,d=(0,tt.F2)(.5*o);i.halfWidth=d,i.capType=function(t){switch(t){case"butt":case st.kP.Butt:return st.RL.BUTT;case"round":case st.kP.Round:return st.RL.ROUND;case"square":case st.kP.Square:return st.RL.SQUARE}}(c),i.joinType=function(t){switch(t){case"bevel":case st.r4.Bevel:return st.AH.BEVEL;case"miter":case st.r4.Miter:return st.AH.MITER;case"round":case st.r4.Round:return st.AH.ROUND}}(l),i.miterLimit=u;const p=!h;r.out=t,r.id=e.getDisplayId(),r.vertexCount=0,r.indexCount=0,r.vertexFrom=t.vertexCount(),r.vertexBounds=p&&d<a.do?0:1;for(const{line:a,start:f}of n)i.initialDistance=f%65535,this._lineTessellator.tessellate(a,i,p)}_writeTesselatedVertex(t,e,n,r,i,s,o,a,c,l,u){const{out:h,id:d,vertexBounds:p}=this._currentWrite;return this.hasEffects&&h.recordBounds(t,e,p,p),this._tessParams.extrusionOffsetX=o,this._tessParams.extrusionOffsetY=a,this._tessParams.normalX=c,this._tessParams.normalY=l,this._tessParams.directionX=i,this._tessParams.directionY=s,this._tessParams.distance=u,this._writeVertex(h,d,t,e,this._tessParams),this._currentWrite.vertexFrom+this._currentWrite.vertexCount++}_writeTriangle(t,e,n){const{out:r}=this._currentWrite;r.indexEnsureSize(3),r.indexWrite(t),r.indexWrite(e),r.indexWrite(n),this._currentWrite.indexCount+=3}}const Mt={createComputedParams:t=>t,attributes:{...Pt.attributes,bitset:{type:Y.g.UNSIGNED_BYTE,count:1,pack:t=>0},color:{type:Y.g.UNSIGNED_BYTE,count:4,normalized:!0,pack:t=>{let{color:e}=t;return lt(e)}}}},Vt={createComputedParams:t=>t,attributes:{...Pt.attributes,bitset:{type:Y.g.UNSIGNED_BYTE,count:1,pack:t=>ct([[mt.WD,!0]])},color:{type:Y.g.UNSIGNED_BYTE,count:4,normalized:!0,pack:t=>{let{outlineColor:e}=t;return lt(e)}}}};class Nt extends It{constructor(){super(...arguments),this.vertexSpec=Vt}}class zt extends ft{constructor(t,e,n,r){super(t,e,n,r),this.vertexSpec=Mt,this._lineMeshWriter=this._createOutlineWriter(t,e,n,r)}_createOutlineWriter(t,e,n,r){return new Nt(t,e,n,r)}_write(t,e,n){var r;const i=null!==(r=null===n||void 0===n?void 0:n.asOptimized())&&void 0!==r?r:e.readGeometryForDisplay(),s=this._clip(i);s&&(t.recordStart(this.instanceId,this.attributeLayout),this._writeGeometry(t,e,s),this._lineMeshWriter.writeLineVertices(t,A.z.fromOptimizedCIM(s,"esriGeometryPolyline"),e),t.recordEnd())}_clip(t){return t?C(t,(0,H.b8)(this.evaluatedMeshParams)):null}ensurePacked(t,e,n){super.ensurePacked(t,e,n),this._lineMeshWriter.ensurePacked(t,e,n)}enqueueRequest(t,e,n){super.enqueueRequest(t,e,n),this._lineMeshWriter.enqueueRequest(t,e,n)}async loadDependencies(){await Promise.all([super.loadDependencies(),this._lineMeshWriter.loadDependencies()])}}var Et=n(78825);const Dt=wt.attributes,Ft=Vt.attributes,Ut={createComputedParams:t=>t,attributes:{id:Dt.id,pos:Dt.pos,zoomRange:Dt.zoomRange,tlbr:Dt.tlbr,angle:Dt.angle,color:Dt.color,bitset:{type:Y.g.UNSIGNED_BYTE,count:1,pack:t=>vt(t)},aux1:{count:1,type:Y.g.UNSIGNED_SHORT,pack:t=>_t(t)},aux2:{count:1,type:Y.g.UNSIGNED_SHORT,pack:t=>bt(t)},aux3:{count:2,type:Y.g.SHORT,pack:t=>{let{offsetX:e,offsetY:n}=t;return[(0,tt.F2)(e),(0,tt.F2)(n)]}},aux4:{count:2,type:Y.g.UNSIGNED_BYTE,pack:t=>{let{scaleX:e,scaleY:n}=t;return[e*Et.$1,n*Et.$1]}}}},Ot={createComputedParams:t=>t,attributes:{id:Dt.id,pos:Dt.pos,zoomRange:Dt.zoomRange,tlbr:Dt.tlbr,angle:Dt.angle,color:Ft.color,bitset:{type:Y.g.UNSIGNED_BYTE,count:1,pack:t=>ct([[mt.WD,!0]])},aux1:{count:1,type:Y.g.UNSIGNED_SHORT,pack:t=>(0,tt.F2)(.5*t.width)*Et.$1},aux2:{count:1,type:Y.g.UNSIGNED_SHORT,pack:t=>(0,tt.F2)(.5*t.referenceWidth)*Et.$1},aux3:{count:2,type:Y.g.SHORT,packTessellation:t=>{let{extrusionOffsetX:e,extrusionOffsetY:n}=t;return[e*Et.$1,n*Et.$1]}},aux4:{count:2,type:Y.g.UNSIGNED_BYTE,packTessellation:t=>{let{normalX:e,normalY:n}=t;return[e*Et.$1+Et.NS,n*Et.$1+Et.NS]}}}};class Rt extends Nt{constructor(){super(...arguments),this.vertexSpec=Ot}}const Ct={createComputedParams:t=>t,attributes:{...yt.attributes,...Mt.attributes}},At={createComputedParams:t=>t,attributes:{...yt.attributes,...Vt.attributes}};class Bt extends Nt{constructor(){super(...arguments),this.vertexSpec=At}}const Lt={createComputedParams:t=>t,attributes:{pos:{type:Y.g.SHORT,count:2,pack:"position",packPrecisionFactor:10},id:{type:Y.g.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:Y.g.UNSIGNED_BYTE,count:1},offset:{type:Y.g.BYTE,count:2,packAlternating:{count:4,pack:()=>[[-1,-1],[1,-1],[-1,1],[1,1]]}}}};var Wt=n(77427),Gt=n(50264),Ht=n(35609),Yt=n(38999),Kt=n(84328),Zt=n(28289),qt=n(86001),Xt=n(51750);function jt(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function Qt(t,e){return Math.sqrt(t*t+e*e)}function Jt(t){const e=Qt(t[0],t[1]);t[0]/=e,t[1]/=e}function $t(t,e){return Qt(t[0]-e[0],t[1]-e[1])}function te(t){return t.length-1}function ee(t){let e=0;for(let n=0;n<te(t);n++)e+=ne(t,n);return e}function ne(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,[r,i]=function(t,e){return t[e+1]}(t,e);return[r,i]=[Math.round(r),Math.round(i)],Math.sqrt(r*r+i*i)*n}class re{constructor(t,e,n,r,i){this._segments=t,this._index=e,this._distance=n,this._xStart=r,this._yStart=i,this._done=!1}static create(t){return new re(t,0,0,t[0][0],t[0][1])}clone(){return new re(this._segments,this._index,this._distance,this.xStart,this.yStart)}equals(t){return this._index===t._index||t._index===this._index-1&&(0===this._distance||1===t._distance)||t._index===this._index+1&&(1===this._distance||0===t._distance)}leq(t){return this._index<t._index||this._index===t._index&&this._distance<=t._distance}geq(t){return this._index>t._index||this._index===t._index&&this._distance>=t._distance}get _segment(){return this._segments[this._index+1]}get angle(){const t=this.dy,e=(0*t+-1*-this.dx)/(1*this.length);let n=Math.acos(e);return t>0&&(n=2*Math.PI-n),n}get xStart(){return this._xStart}get yStart(){return this._yStart}get x(){return this.xStart+this.distance*this.dx}get y(){return this.yStart+this.distance*this.dy}get dx(){return this._segment[0]}get dy(){return this._segment[1]}get xMidpoint(){return this.xStart+.5*this.dx}get yMidpoint(){return this.yStart+.5*this.dy}get xEnd(){return this.xStart+this.dx}get yEnd(){return this.yStart+this.dy}get length(){const{dx:t,dy:e}=this;return Math.sqrt(t*t+e*e)}get remainingLength(){return this.length*(1-this._distance)}get backwardLength(){return this.length*this._distance}get distance(){return this._distance}get done(){return this._done}hasPrev(){return this._index-1>=0}hasNext(){return this._index+1<te(this._segments)}next(){return this.hasNext()?(this._xStart+=this.dx,this._yStart+=this.dy,this._distance=0,this._index+=1,this):null}prev(){return this.hasPrev()?(this._index-=1,this._xStart-=this.dx,this._yStart-=this.dy,this._distance=1,this):(this._done=!0,null)}_seekBackwards(t,e){const n=this.backwardLength;if(t<=n)return this._distance=(n-t)/this.length,this;let r=this.backwardLength;for(;this.prev();){if(r+this.length>t)return this._seekBackwards(t-r);r+=this.length}return this._distance=0,e?this:null}seek(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t<0)return this._seekBackwards(Math.abs(t),e);if(t<=this.remainingLength)return this._distance=(this.backwardLength+t)/this.length,this;let n=this.remainingLength;for(;this.next();){if(n+this.length>t)return this.seek(t-n,e);n+=this.length}return this._distance=1,e?this:null}}function ie(t,e,n){let r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const i=ee(t),s=re.create(t),o=i/2;if(!r)return s.seek(o),void(Math.abs(s.x)<Xt.L&&Math.abs(s.y)<Xt.L&&n(s.clone(),0,o+0*e,i));const a=Math.max((i-e)/2,0),c=Math.floor(a/e),l=o-c*e;s.seek(l);for(let u=-c;u<=c;u++)Math.abs(s.x)<Xt.L&&Math.abs(s.y)<Xt.L&&n(s.clone(),u,o+u*e,i),s.seek(e)}function se(t,e){const n=1e-6;if(e<=0)return;const r=t.length;if(r<3)return;const i=[];let s=0;i.push(0);for(let h=1;h<r;h++)s+=$t(t[h],t[h-1]),i.push(s);e=Math.min(e,.2*s);const o=[];o.push(t[0][0]),o.push(t[0][1]);const a=t[r-1][0],c=t[r-1][1],l=jt([0,0],t[0],t[1]);Jt(l),t[0][0]+=e*l[0],t[0][1]+=e*l[1],jt(l,t[r-1],t[r-2]),Jt(l),t[r-1][0]+=e*l[0],t[r-1][1]+=e*l[1];for(let h=1;h<r;h++)i[h]+=e;i[r-1]+=e;const u=.5*e;for(let h=1;h<r-1;h++){let s=0,a=0,c=0;for(let r=h-1;r>=0&&!(i[r+1]<i[h]-u);r--){const o=u+i[r+1]-i[h],l=i[r+1]-i[r],d=i[h]-i[r]<u?1:o/l;if(Math.abs(d)<n)break;const p=d*d,f=d*o-.5*p*l,y=d*l/e,x=t[r+1],m=t[r][0]-x[0],g=t[r][1]-x[1];s+=y/f*(x[0]*d*o+.5*p*(o*m-l*x[0])-p*d*l*m/3),a+=y/f*(x[1]*d*o+.5*p*(o*g-l*x[1])-p*d*l*g/3),c+=y}for(let o=h+1;o<r&&!(i[o-1]>i[h]+u);o++){const r=u-i[o-1]+i[h],l=i[o]-i[o-1],d=i[o]-i[h]<u?1:r/l;if(Math.abs(d)<n)break;const p=d*d,f=d*r-.5*p*l,y=d*l/e,x=t[o-1],m=t[o][0]-x[0],g=t[o][1]-x[1];s+=y/f*(x[0]*d*r+.5*p*(r*m-l*x[0])-p*d*l*m/3),a+=y/f*(x[1]*d*r+.5*p*(r*g-l*x[1])-p*d*l*g/3),c+=y}o.push(s/c),o.push(a/c)}o.push(a),o.push(c);for(let h=0,d=0;h<r;h++)t[h][0]=o[d++],t[h][1]=o[d++]}var oe=n(16889),ae=n(82653);class ce{static getPlacement(t,e,n,r,i,s){const o=(0,ae.W)(n);return o?(-1===e&&t.invertY(),o.execute(t,n,r,i,s)):null}}var le=n(62106),ue=n(31027);class he{constructor(t){const{offsetX:e,offsetY:n,postAngle:r,fontSize:i,scaleFactor:s,transforms:o}=t;if(this.offsetX=e,this.offsetY=n,this.postAngle=r,this.fontSize=Math.min(i,96),this.transforms=o,o&&o.infos.length>1){const t=(0,ue.yl)(i,r,!1,e,n,o);this.fontSize=Math.min(t.size,96),this.postAngle=t.rotation,this.offsetX=t.offsetX,this.offsetY=t.offsetY}s&&(this.fontSize*=s,this.offsetX*=s,this.offsetY*=s)}}const de=[4,4],pe=[16,4],fe={topLeft:pe,topRight:pe,bottomLeft:pe,bottomRight:pe},ye=[4,2],xe=[4,6],me={topLeft:ye,topRight:ye,bottomLeft:xe,bottomRight:xe},ge={topLeft:ye,topRight:xe,bottomLeft:ye,bottomRight:xe},ve={topLeft:xe,topRight:xe,bottomLeft:de,bottomRight:de},_e={topLeft:de,topRight:de,bottomLeft:xe,bottomRight:xe},be={topLeft:xe,topRight:de,bottomLeft:xe,bottomRight:de},we={topLeft:de,topRight:xe,bottomLeft:de,bottomRight:xe},Se={createComputedParams:t=>t,attributes:{pos:{type:Y.g.SHORT,count:2,pack:"position",packPrecisionFactor:10},id:{type:Y.g.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:Y.g.UNSIGNED_BYTE,count:1,packTessellation:t=>{let{isBackground:e,mapAligned:n}=t;return ct([[mt.mL,e],[mt.$r,!!n]])}},zoomRange:{type:Y.g.UNSIGNED_SHORT,count:2,packPrecisionFactor:a.JS,packTessellation:t=>{let{minZoom:e,maxZoom:n}=t;return[e||0,n||28]}},offset:{type:Y.g.SHORT,count:2,packPrecisionFactor:8,packAlternating:{count:4,packTessellation:t=>{let{offsets:e}=t;const{bottomLeft:n,bottomRight:r,topLeft:i,topRight:s}=e;return[i,s,n,r]}}},textureUV:{type:Y.g.SHORT,count:2,packPrecisionFactor:4,packAlternating:{count:4,packTessellation:t=>{let{texcoords:e}=t;const{bottomLeft:n,bottomRight:r,topLeft:i,topRight:s}=e;return[i,s,n,r]}}},color:{type:Y.g.UNSIGNED_BYTE,count:4,normalized:!0,packTessellation:t=>{let{color:e}=t;return e}},fontSize:{type:Y.g.UNSIGNED_SHORT,count:1,packPrecisionFactor:4,packTessellation:t=>{let{fontSize:e}=t;return(0,tt.F2)(e)}},referenceSize:{type:Y.g.UNSIGNED_BYTE,count:1,packPrecisionFactor:4,packTessellation:(t,e)=>{let{fontSize:n}=t,{referenceSize:r}=e;return(0,tt.F2)(null!==r&&void 0!==r?r:n)}},haloColor:{type:Y.g.UNSIGNED_BYTE,count:4,normalized:!0,pack:t=>{let{haloColor:e}=t;return lt(e)}},haloFontSize:{type:Y.g.UNSIGNED_SHORT,count:1,packPrecisionFactor:4,pack:t=>{let{haloFontSize:e}=t;return(0,tt.F2)(e)}},clipAngle:{type:Y.g.UNSIGNED_BYTE,count:1,packTessellation:t=>{let{clipAngle:e}=t;return Pe(e||0)}},referenceSymbol:{type:Y.g.BYTE,count:4,packPrecisionFactor:1,packTessellation:(t,e)=>{if(!t.referenceBounds)return[0,0,0,0];const n=(0,Yt.g)(e.horizontalAlignment),r=(0,Yt.tf)(e.verticalAlignment),{offsetX:i,offsetY:s,size:o}=t.referenceBounds;return[(0,tt.F2)(i),-(0,tt.F2)(s),(0,tt.F2)(o),n+1<<2|r+1]}}}};class Te extends j{constructor(){super(...arguments),this.vertexSpec=Se,this._textMeshParamsPropsInitialized=!1}ensurePacked(t,e,n){super.ensurePacked(t,e,n),this._textMeshParamsPropsInitialized&&!this._evaluator.hasDynamicProperties||(this._textMeshTransformProps=new he(this.evaluatedMeshParams),this._textMeshParamsPropsInitialized=!0)}_write(t,e,n){const r=this._getShaping();if(!r)return;const i=e.getDisplayId();if(null!=this.evaluatedMeshParams.placement)return this._writePlacedTextMarkers(t,e,r,n);if(n&&n.nextPath())return n.nextPoint(),this._writeGlyphs(t,i,n.x,n.y,r,0);if("esriGeometryPolygon"===e.geometryType){const n=e.readCentroidForDisplay();if(!n)return;const[s,o]=n.coords;return this._writeGlyphs(t,i,s,o,r,0)}if("esriGeometryMultipoint"===e.geometryType){const n=e.readGeometryForDisplay();return void(null===n||void 0===n||n.forEachVertex(((e,n)=>this._writeGlyphs(t,i,e,n,r,0))))}const s=e.readXForDisplay(),o=e.readYForDisplay();return this._writeGlyphs(t,i,s,o,r,0)}_writePlacedTextMarkers(t,e,n,r){const i=null!==r&&void 0!==r?r:A.z.fromFeatureSetReaderCIM(e);if(!i)return;const s=ce.getPlacement(i,-1,this.evaluatedMeshParams.placement,(0,tt.F2)(1),t.id,W());if(!s)return;const o=e.getDisplayId();let a=s.next();for(;null!=a;){const e=a.tx,r=-a.ty,i=-a.getAngle();this._writeGlyphs(t,o,e,r,n,i),a=s.next()}}_getShaping(){var t;const e=this._textMeshTransformProps,n=this.evaluatedMeshParams;if(null===(t=n.glyphs)||void 0===t||!t.glyphs.length)return null;const r=Math.round((0,tt.F2)(e.fontSize)),i=(0,tt.F2)(e.offsetX),s=(0,tt.F2)(e.offsetY),o=(0,oe.uZ)((0,tt.F2)(n.lineWidth),32,512),c=a.uk*(0,oe.uZ)(n.lineHeightRatio,.25,4);return(0,le.Nr)(n.glyphs,{scale:r/a.iD,angle:e.postAngle,xOffset:i,yOffset:s,horizontalAlignment:n.horizontalAlignment,verticalAlignment:n.verticalAlignment,maxLineWidth:o,lineHeight:c,decoration:n.decoration,borderLineSizePx:(0,tt.F2)(n.boxBorderLineSize),hasBackground:!!n.boxBackgroundColor,useCIMAngleBehavior:n.useCIMAngleBehavior})}_writeGlyphs(t,e,n,r,i,s,o,a){const c=this.evaluatedMeshParams,l=this._textMeshTransformProps,u=l.fontSize,h=(0,tt.F2)(l.offsetX),d=(0,tt.F2)(l.offsetY),[p,f]=ot(c.scaleInfo,this.getTileInfo());0!==s&&i.setRotation(s);const y=i.bounds,x=n+y.x+h,m=r+y.y-d,g=2*(c.minPixelBuffer?c.minPixelBuffer/u:1),v=Math.max(y.width,y.height)*g;i.textBox&&(t.recordStart(this.instanceId,this.attributeLayout,i.glyphs[0].textureBinding),t.recordBounds(x,m,v,v),this._writeTextBox(t,e,n,r,i.textBox,o,a),t.recordEnd());for(const _ of i.glyphs){t.recordStart(this.instanceId,this.attributeLayout,_.textureBinding),t.recordBounds(x,m,v,v);const{texcoords:i,offsets:s}=_;this._writeQuad(t,e,n,r,{texcoords:i,offsets:s,fontSize:u,color:lt(c.color),isBackground:!1,referenceBounds:o,minZoom:p,maxZoom:f,...a}),t.recordEnd()}0!==s&&i.setRotation(-s)}_writeTextBox(t,e,n,r,i,s,o){const a=this.evaluatedMeshParams,{fontSize:c}=this._textMeshTransformProps,{boxBackgroundColor:l,boxBorderLineColor:u}=a,h={isBackground:!0,fontSize:c,referenceBounds:s,...o};l&&(this._writeQuad(t,e,n,r,{texcoords:fe,offsets:i.main,color:lt(l),...h}),u||(this._writeQuad(t,e,n,r,{texcoords:ve,offsets:i.top,color:lt(l),...h}),this._writeQuad(t,e,n,r,{texcoords:_e,offsets:i.bot,color:lt(l),...h}),this._writeQuad(t,e,n,r,{texcoords:be,offsets:i.left,color:lt(l),...h}),this._writeQuad(t,e,n,r,{texcoords:we,offsets:i.right,color:lt(l),...h}))),u&&(this._writeQuad(t,e,n,r,{texcoords:me,offsets:i.top,color:lt(u),...h}),this._writeQuad(t,e,n,r,{texcoords:me,offsets:i.bot,color:lt(u),...h}),this._writeQuad(t,e,n,r,{texcoords:ge,offsets:i.left,color:lt(u),...h}),this._writeQuad(t,e,n,r,{texcoords:ge,offsets:i.right,color:lt(u),...h}))}_writeQuad(t,e,n,r,i){const s=t.vertexCount();this._writeVertex(t,e,n,r,i),t.indexWrite(s+0),t.indexWrite(s+1),t.indexWrite(s+2),t.indexWrite(s+1),t.indexWrite(s+3),t.indexWrite(s+2)}}const Pe=t=>Math.round(t*(254/360)),ke=(0,Wt.HP)((t=>{let e=0;if(0===t)return 1/0;for(;!(t%2);)e++,t/=2;return e}));const Ie={createComputedParams:t=>t,attributes:{...Pt.attributes,bitset:{type:Y.g.UNSIGNED_BYTE,count:1,pack:t=>{let{shouldSampleAlphaOnly:e,shouldScaleDash:n,isSDF:r}=t;return ct([[mt.GS,e],[mt.Wq,n],[mt.B7,r]])}},tlbr:{type:Y.g.UNSIGNED_SHORT,count:4,pack:t=>{let{sprite:e}=t;const{rect:n,width:r,height:i}=e,s=n.x+a.s4,o=n.y+a.s4;return[s,o,s+r,o+i]}},accumulatedDistance:{type:Y.g.UNSIGNED_SHORT,count:1,packTessellation:t=>{let{distance:e}=t;return e}},segmentDirection:{type:Y.g.BYTE,count:2,packPrecisionFactor:16,packTessellation:t=>{let{directionX:e,directionY:n}=t;return[e,n]}}}};var Me=n(13611);class Ve{static from(t){return"width"in t?this.fromSimpleMeshParams(t):this.fromComplexMeshParams(t)}static fromSimpleMeshParams(t){const e=new Ve(t.sprite,t.color,t.outlineColor,t.minPixelBuffer,t.placement,t.scaleInfo,t.effects),{type:n,width:r,height:i,angle:s,alignment:o,outlineSize:a,referenceSize:c,sprite:l,overrideOutlineColor:u}=t;e.rawWidth=(0,tt.F2)(r),e.rawHeight=(0,tt.F2)(i),e.angle=s,e.alignment=o,e.outlineSize=(0,tt.F2)(a),e.referenceSize=(0,tt.F2)(c),e.overrideOutlineColor=u,e.offsetX=(0,tt.F2)(t.offsetX),e.offsetY=(0,tt.F2)(t.offsetY),"simple"!==n||l.sdf||(e.rawWidth=l.width,e.rawHeight=l.height);return e.sizeRatio=l.sdf?2:1,e._computeSize(t,!1),e}static fromComplexMeshParams(t){const e=new Ve(t.sprite,t.color,t.outlineColor,t.minPixelBuffer,t.placement,t.scaleInfo,t.effects);let{alignment:n,transforms:r,size:i,scaleX:s,anchorX:o,anchorY:a,angle:c,colorLocked:l,frameHeight:u,widthRatio:h,offsetX:d,offsetY:p,outlineSize:f,referenceSize:y,scaleFactor:x,sizeRatio:m,isAbsoluteAnchorPoint:g,rotateClockwise:v,scaleSymbolsProportionally:_,sprite:b}=t;if(r&&r.infos.length>0){const t=(0,ue.yl)(i,c,v,d,p,r);i=t.size,c=t.rotation,d=t.offsetX,p=t.offsetY,v=!1}x&&(i*=x,d*=x,p*=x);const w=s*(b.width/b.height);e.alignment=n,e.rawHeight=(0,tt.F2)(i),e.rawWidth=e.rawHeight*w,e.referenceSize=(0,tt.F2)(y),e.sizeRatio=m,e.angle=c,e.rotateClockwise=v,e.anchorX=o,e.anchorY=a,e.offsetX=(0,tt.F2)(d),e.offsetY=(0,tt.F2)(p),g&&i&&(b.sdf?e.anchorX=o/(i*h):e.anchorX=o/(i*w),e.anchorY=a/i);const S=_&&u?i/u:1;return e.outlineSize=0===f||isNaN(f)?0:(0,tt.F2)(f)*S,e.scaleSymbolsProportionally=_,e.colorLocked=l,e._computeSize(t,!0),e}constructor(t,e,n,r,i,s,o){this.sprite=t,this.color=e,this.outlineColor=n,this.minPixelBuffer=r,this.placement=i,this.scaleInfo=s,this.effects=o,this.rawWidth=0,this.rawHeight=0,this.angle=0,this.outlineSize=0,this.referenceSize=0,this.sizeRatio=1,this.alignment=st.v2.SCREEN,this.scaleSymbolsProportionally=!1,this.overrideOutlineColor=!1,this.colorLocked=!1,this.anchorX=0,this.anchorY=0,this.computedWidth=0,this.computedHeight=0,this.texXmin=0,this.texYmin=0,this.texXmax=0,this.texYmax=0,this.offsetX=0,this.offsetY=0,this.rotateClockwise=!0}get boundsInfo(){return{size:Math.max(this.computedHeight,this.computedWidth),offsetX:this.offsetX,offsetY:this.offsetY}}_computeSize(t,e){const{sprite:n,hasSizeVV:r}=t,i=!!n.sdf,{rawWidth:s,rawHeight:o,sizeRatio:c,outlineSize:l}=this,u=s*c,h=o*c;if(i&&!r){const t=e&&s>o?u:s,n=o,r=l+2;this.computedWidth=Math.min(t+r,u),this.computedHeight=Math.min(n+r,h)}else this.computedWidth=u,this.computedHeight=h;const d=i?a.qu/Math.max(u,h):1,p=.5*(u-this.computedWidth)*d,f=.5*(h-this.computedHeight)*d,y=n.rect.x+a.s4+p,x=n.rect.y+a.s4+f,m=y+n.width-2*p,g=x+n.height-2*f;this.texXmin=Math.floor(y),this.texYmin=Math.floor(x),this.texXmax=Math.ceil(m),this.texYmax=Math.ceil(g),this.computedWidth*=(this.texXmax-this.texXmin)/(m-y),this.computedHeight*=(this.texYmax-this.texYmin)/(g-x),this.anchorX*=u/this.computedWidth,this.anchorY*=h/this.computedHeight}}var Ne=n(70467);const ze=3.14159265359/180,Ee=128/Math.PI;function De(t){return function(t,e){return t%=e,Math.abs(t>=0?t:t+e)}(t*Ee,256)}const Fe={createComputedParams:t=>Ve.from(t),attributes:{pos:{type:Y.g.SHORT,count:2,pack:"position",packPrecisionFactor:10},id:{type:Y.g.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:Y.g.UNSIGNED_BYTE,count:1,pack:t=>{let{sprite:e,alignment:n,scaleSymbolsProportionally:r,overrideOutlineColor:i,colorLocked:s}=t,o=0;return e.sdf&&(o|=at(Ne.m.bitset.isSDF)),n===st.v2.MAP&&(o|=at(Ne.m.bitset.isMapAligned)),r&&(o|=at(Ne.m.bitset.scaleSymbolsProportionally)),i&&(o|=at(Ne.m.bitset.overrideOutlineColor)),s&&(o|=at(Ne.m.bitset.colorLocked)),o}},zoomRange:{type:Y.g.SHORT,count:2,packPrecisionFactor:a.JS,pack:(t,e)=>{let{scaleInfo:n}=t,{tileInfo:r}=e;return ot(n,r)}},offset:{type:Y.g.SHORT,count:2,packPrecisionFactor:4,packAlternating:{count:4,pack:t=>{let{angle:e,computedWidth:n,computedHeight:r,anchorX:i,anchorY:s,offsetX:o,offsetY:a,rotateClockwise:c}=t;const l=function(t,e,n,r){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const s=(0,Ht.Ue)(),o=i?1:-1;return t?(0,Gt.Us)(s,o*ze*t):(0,Gt.yR)(s),(e||n)&&(0,Gt.Iu)(s,s,[e,-n]),r&&(0,Gt.U1)(s,s,o*ze*-r),s}(0,o,a,-e,c),u=-(.5+i)*n,h=-(.5-s)*r,d=[u,h],p=[u+n,h],f=[u,h+r],y=[u+n,h+r];return(0,Me.iu)(d,d,l),(0,Me.iu)(p,p,l),(0,Me.iu)(f,f,l),(0,Me.iu)(y,y,l),[d,p,f,y]}}},textureUV:{type:Y.g.SHORT,count:2,packPrecisionFactor:4,packAlternating:{count:4,pack:t=>{let{texXmax:e,texXmin:n,texYmax:r,texYmin:i}=t;return[[n,i],[e,i],[n,r],[e,r]]}}},color:{type:Y.g.UNSIGNED_BYTE,count:4,normalized:!0,pack:t=>{let{color:e}=t;return lt(e)}},outlineColor:{type:Y.g.UNSIGNED_BYTE,count:4,normalized:!0,pack:t=>{let{outlineColor:e}=t;return lt(e)}},sizing:{type:Y.g.UNSIGNED_BYTE,count:4,pack:t=>{let{rawWidth:e,rawHeight:n,outlineSize:r,referenceSize:i}=t;return[ut(Math.max(e,n),128),ut(r,128),ut(i,128),0]}},placementAngle:{type:Y.g.UNSIGNED_BYTE,count:1,packTessellation:t=>{let{placementAngle:e}=t;return De(e)}},sizeRatio:{type:Y.g.UNSIGNED_SHORT,count:1,packPrecisionFactor:64,pack:t=>{let{sizeRatio:e}=t;return e}}}};const Ue={createComputedParams:t=>t,attributes:{pos:{type:Y.g.SHORT,count:2,packPrecisionFactor:10,pack:"position"},id:{type:Y.g.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:Y.g.UNSIGNED_BYTE,count:1,pack:t=>0},offset:{type:Y.g.SHORT,count:2,packPrecisionFactor:16,packAlternating:{count:4,pack:t=>{let{size:e}=t;const n=(0,tt.F2)(e),r=-n/2,i=-n/2;return[[r,i],[r+n,i],[r,i+n],[r+n,i+n]]}}},texCoords:{type:Y.g.SHORT,count:2,packPrecisionFactor:4,packAlternating:{count:4,pack:()=>[[0,1],[1,1],[0,0],[1,0]]}},size:{type:Y.g.UNSIGNED_BYTE,count:2,pack:t=>{let{size:e}=t;return[e,e]}},referenceSize:{type:Y.g.UNSIGNED_BYTE,count:1,pack:t=>{let{size:e}=t;return(0,tt.F2)(e)}},zoomRange:{type:Y.g.UNSIGNED_BYTE,count:2,pack:(t,e)=>{let{scaleInfo:n}=t,{tileInfo:r}=e;return ot(n,r)}}}};const Oe=function(t){const e={};for(const n in t){const r={name:n,constructor:t[n]};e[n]=r}return e}({FillMeshWriter:ft,DotDensityMeshWriter:class extends J{constructor(){super(...arguments),this.vertexSpec=$}createTesselationParams(t){return{inverseArea:1/t.readGeometryArea()}}},ComplexFillMeshWriter:class extends xt{constructor(){super(...arguments),this.vertexSpec=wt}},PatternFillMeshWriter:xt,OutlineFillMeshWriter:zt,PatternOutlineFillMeshWriter:class extends zt{constructor(){super(...arguments),this.vertexSpec=Ct}_createOutlineWriter(t,e,n,r){return new Bt(t,e,n,r)}_write(t,e,n){var r,i;const s=null!==(r=null===n||void 0===n?void 0:n.asOptimized())&&void 0!==r?r:e.readGeometryForDisplay(),o=this._clip(s);if(!o)return;const a=null===(i=this.evaluatedMeshParams.sprite)||void 0===i?void 0:i.textureBinding;t.recordStart(this.instanceId,this.attributeLayout,a),this._writeGeometry(t,e,o),this._lineMeshWriter.writeLineVertices(t,A.z.fromOptimizedCIM(o,"esriGeometryPolyline"),e),t.recordEnd()}ensurePacked(t,e,n){super.ensurePacked(t,e,n),this._lineMeshWriter.ensurePacked(t,e,n)}enqueueRequest(t,e,n){super.enqueueRequest(t,e,n),this._lineMeshWriter.enqueueRequest(t,e,n)}async loadDependencies(){await Promise.all([super.loadDependencies(),this._lineMeshWriter.loadDependencies()])}},ComplexOutlineFillMeshWriter:class extends zt{constructor(){super(...arguments),this.vertexSpec=Ut}_createOutlineWriter(t,e,n,r){return new Rt(t,e,n,r)}_write(t,e,n){var r,i;const s=null!==(r=null===n||void 0===n?void 0:n.asOptimized())&&void 0!==r?r:e.readGeometryForDisplay(),o=this._clip(s);if(!o)return;const a=null===(i=this.evaluatedMeshParams.sprite)||void 0===i?void 0:i.textureBinding;t.recordStart(this.instanceId,this.attributeLayout,a),this._writeGeometry(t,e,o),this._lineMeshWriter.writeLineVertices(t,A.z.fromOptimizedCIM(o,"esriGeometryPolyline"),e),t.recordEnd()}ensurePacked(t,e,n){super.ensurePacked(t,e,n),this._lineMeshWriter.ensurePacked(t,e,n)}enqueueRequest(t,e,n){super.enqueueRequest(t,e,n),this._lineMeshWriter.enqueueRequest(t,e,n)}async loadDependencies(){await Promise.all([super.loadDependencies(),this._lineMeshWriter.loadDependencies()])}},MarkerMeshWriter:class extends j{constructor(){super(...arguments),this.vertexSpec=Fe}getBoundsInfo(){return this.evaluatedMeshParams.boundsInfo}_write(t,e,n){var r;const i=null===(r=this.evaluatedMeshParams.sprite)||void 0===r?void 0:r.textureBinding,s=e.getDisplayId();t.recordStart(this.instanceId,this.attributeLayout,i);const o=this.evaluatedMeshParams.minPixelBuffer,a=Math.max(this.evaluatedMeshParams.computedWidth,o),c=Math.max(this.evaluatedMeshParams.computedHeight,o),l=this.evaluatedMeshParams.offsetX,u=-this.evaluatedMeshParams.offsetY;if(null!=this.evaluatedMeshParams.placement)this._writePlacedMarkers(t,e,n,a,c);else if(n&&n.nextPath()){n.nextPoint();const e=n.x,r=n.y;t.recordBounds(e+l,r+u,a,c),this._writeQuad(t,s,e,r)}else if("esriGeometryPolygon"===e.geometryType){const n=e.readCentroidForDisplay();if(!n)return;const[r,i]=n.coords;t.recordBounds(r+l,i+u,a,c),this._writeQuad(t,s,r,i)}else if("esriGeometryPoint"===e.geometryType){const n=e.readXForDisplay(),r=e.readYForDisplay();t.recordBounds(n+l,r+u,a,c),this._writeQuad(t,s,n,r)}else{const n=e.readGeometryForDisplay();null===n||void 0===n||n.forEachVertex(((e,n)=>{t.recordBounds(e+l,n+u,a,c),Math.abs(e)>Xt.L||Math.abs(n)>Xt.L||this._writeQuad(t,s,e,n)}))}t.recordEnd()}_writePlacedMarkers(t,e,n,r,i){var s;const o=null!==n&&void 0!==n?n:null===(s=A.z.fromFeatureSetReaderCIM(e))||void 0===s?void 0:s.clone();if(!o)return;const a=ce.getPlacement(o,-1,this.evaluatedMeshParams.placement,(0,tt.F2)(1),t.id,W());if(!a)return;const c=e.getDisplayId();let l=a.next();const u=this.evaluatedMeshParams.offsetX,h=-this.evaluatedMeshParams.offsetY;for(;null!=l;){const e=l.tx,n=-l.ty;if(Math.abs(e)>Xt.L||Math.abs(n)>Xt.L){l=a.next();continue}const s=-l.getAngle();t.recordBounds(e+u,n+h,r,i),this._writeQuad(t,c,e,n,s),l=a.next()}}_writeQuad(t,e,n,r,i){const s=t.vertexCount(),o=null==i?null:{placementAngle:i};this._writeVertex(t,e,n,r,o),t.indexWrite(s+0),t.indexWrite(s+1),t.indexWrite(s+2),t.indexWrite(s+1),t.indexWrite(s+3),t.indexWrite(s+2)}},PieChartMeshWriter:class extends j{constructor(){super(...arguments),this.vertexSpec=Ue}_write(t,e){const n=e.getDisplayId(),r=this.evaluatedMeshParams.minPixelBuffer,i=Math.max((0,tt.F2)(this.evaluatedMeshParams.size),r);let s,o;if("esriGeometryPoint"===e.geometryType)s=e.readXForDisplay(),o=e.readYForDisplay();else{const t=e.readCentroidForDisplay();if(!t)return;s=null===t||void 0===t?void 0:t.coords[0],o=null===t||void 0===t?void 0:t.coords[1]}t.recordStart(this.instanceId,this.attributeLayout),t.recordBounds(s,o,i,i);const a=t.vertexCount();this._writeVertex(t,n,s,o),t.indexWrite(a+0),t.indexWrite(a+1),t.indexWrite(a+2),t.indexWrite(a+1),t.indexWrite(a+3),t.indexWrite(a+2),t.recordEnd()}},TextMeshWriter:Te,LineMeshWriter:It,TexturedLineMeshWriter:class extends It{constructor(t,e,n,r){super(t,e,n,r),this.vertexSpec=Ie,this._tessellationOptions.textured=!0}_write(t,e,n){const r=null!==n&&void 0!==n?n:A.z.fromFeatureSetReaderCIM(e);if(!r)return;const{sprite:i}=this.evaluatedMeshParams;this._writeGeometry(t,e,r,null===i||void 0===i?void 0:i.textureBinding)}},HeatmapMeshWriter:class extends j{constructor(){super(...arguments),this.vertexSpec=Lt}_write(t,e){t.recordStart(this.instanceId,this.attributeLayout);const n=e.getDisplayId();if("esriGeometryPoint"===e.geometryType){const r=e.readXForDisplay(),i=e.readYForDisplay();this._writeQuad(t,n,r,i)}else if("esriGeometryMultipoint"===e.geometryType){const r=e.readGeometryForDisplay();null===r||void 0===r||r.forEachVertex(((e,r)=>{e>=0&&e<=512&&r>=0&&r<=512&&this._writeQuad(t,n,e,r)}))}t.recordEnd()}_writeQuad(t,e,n,r){const i=t.vertexCount();this._writeVertex(t,e,n,r),t.indexWrite(i+0),t.indexWrite(i+1),t.indexWrite(i+2),t.indexWrite(i+1),t.indexWrite(i+3),t.indexWrite(i+2)}},LabelMeshWriter:class extends Te{constructor(){super(...arguments),this._zoomLevel=0}_write(t,e,n,r){if(this._zoomLevel=r||0,null!=n)throw new Error("InternalError: EffectGeometry not support for LabelMeshWriter");switch(e.geometryType){case"esriGeometryPoint":{const n=e.readXForDisplay(),r=e.readYForDisplay();return this._writePoint(t,n,r,e)}case"esriGeometryEnvelope":case"esriGeometryPolygon":case"esriGeometryMultipoint":{const n=e.readCentroidForDisplay();if(!n)return;const[r,i]=n.coords;return this._writePoint(t,r,i,e)}case"esriGeometryPolyline":{const n=e.readLegacyGeometryForDisplay();this._writeLines(t,e,n)}}}_writePoint(t,e,n,r){var i,s,o,a;const c=this._getShaping();if(!c)return;let l=this._getPointReferenceBounds();l||(l={offsetX:0,offsetY:0,size:0});const u=c.boundsT,h=(0,Yt.kH)(this.evaluatedMeshParams.horizontalAlignment),d=(0,Yt.b7)(this.evaluatedMeshParams.verticalAlignment),p=null!==(i=null===(s=this.evaluatedMeshParams.scaleInfo)||void 0===s?void 0:s.maxScale)&&void 0!==i?i:0,f=null!==(o=null===(a=this.evaluatedMeshParams.scaleInfo)||void 0===a?void 0:a.minScale)&&void 0!==o?o:0,y=(0,Kt.jL)(r.getDisplayId());t.metricStart(new qt.O(y,e,n,h,d,p,f,l)),t.metricBoxWrite(u),this._writeGlyphs(t,r.getDisplayId(),e,n,c,0,l),t.metricEnd()}_getPointReferenceBounds(){if(!this._references)return null;for(const t of this._references){const e=t.getBoundsInfo();if(e)return e}return null}_writeLines(t,e,n){const{repeatLabel:r,scaleInfo:i}=this.evaluatedMeshParams,s=this.evaluatedMeshParams.repeatLabelDistance||128,o=this._getShaping();if(!o)return;this._current={out:t,id:e.getDisplayId(),shaping:o,zoomRange:ot(i,this.getTileInfo()),referenceBounds:this._getPointReferenceBounds()||{offsetX:0,offsetY:0,size:0}};const a=function(t,e){const n=e;for(let r=0;r<t.length;r++){let e=t[r];se(e,n);const i=[];i.push(e[0]);for(let t=1;t<e.length;t++){const[n,r]=e[t-1],[s,o]=e[t],a=s-n,c=o-r;i.push([a,c])}t[r]=i,e=i}return t}(n.paths,o.bounds.width),c=this._placeSubdivGlyphs.bind(this),l=(o.bounds.width+s)/2;for(const u of a)ie(u,l,c,!!r)}_placeSubdivGlyphs(t,e,n,r){const{allowOverrun:i,labelPosition:s,repeatLabelDistance:o}=this.evaluatedMeshParams,a=this._current.zoomRange[0],c=ke(e),l=this._current.shaping.bounds.width/2,u=Math.sqrt(o||128)/2,h=Math.min(n,r-n),d=this._current.shaping.isMultiline?28:Math.log2(h/(u+l/2)),p=0===e?d:Math.min(c,d),f=Math.max(a,this._zoomLevel+1-p),y=this._zoomLevel-f,x=this._current.shaping.bounds.width/2*2**y;this._current.shaping.isMultiline?0===e&&this._placeStraight(t,f):i&&y<0?this._placeStraightAlong(t,a):"parallel"===s?this._placeStraightAlong(t,f):"curved"===s&&this._placeCurved(t,f,x)}_placeStraight(t,e){var n,r,i,s;const{out:o,id:a,shaping:c,referenceBounds:l}=this._current,{x:u,y:h}=t,d=(0,Kt.jL)(a),p=null!==(n=null===(r=this.evaluatedMeshParams.scaleInfo)||void 0===r?void 0:r.maxScale)&&void 0!==n?n:0,f=null!==(i=null===(s=this.evaluatedMeshParams.scaleInfo)||void 0===s?void 0:s.minScale)&&void 0!==i?i:0;o.metricStart(new qt.O(d,t.x,t.y,0,0,p,f,null)),o.metricBoxWrite(c.boundsT);const y=t.angle*(180/Math.PI)%360,x=(t.angle*(180/Math.PI)+180)%360;this._writeGlyphs(o,a,u,h,c,0,l,{clipAngle:y,mapAligned:!0,isLineLabel:!0,minZoom:e}),this._writeGlyphs(o,a,u,h,c,0,l,{clipAngle:x,mapAligned:!0,isLineLabel:!0,minZoom:e}),o.metricEnd()}_placeCurved(t,e,n){var r,i,s,o;const{out:a,id:c}=this._current,l=t.clone(),u=t.angle*(180/Math.PI)%360,h=(t.angle*(180/Math.PI)+180)%360,d=(0,Kt.jL)(c),p=null!==(r=null===(i=this.evaluatedMeshParams.scaleInfo)||void 0===i?void 0:i.maxScale)&&void 0!==r?r:0,f=null!==(s=null===(o=this.evaluatedMeshParams.scaleInfo)||void 0===o?void 0:o.minScale)&&void 0!==s?s:0;a.metricStart(new qt.O(d,t.x,t.y,0,0,p,f,null)),this._placeFirst(l,e,1,u),this._placeBack(t,l,e,n,1,u),this._placeForward(t,l,e,n,1,u),this._placeFirst(l,e,0,h),this._placeBack(t,l,e,n,0,h),this._placeForward(t,l,e,n,0,h),a.metricEnd()}_placeStraightAlong(t,e){var n,r,i,s;const{out:o,id:a,shaping:c,zoomRange:l,referenceBounds:u}=this._current,{boxBorderLineColor:h,boxBackgroundColor:d}=this.evaluatedMeshParams,p=t.clone(),f=t.angle*(180/Math.PI)%360,y=(t.angle*(180/Math.PI)+180)%360;if(c.glyphs.length>0&&(h||d)){const n=Math.max(e,l[0],0),r=Math.min(28,l[1]),i=(0,Gt.Us)((0,Ht.Ue)(),-t.angle),[s,h]=c.shapeBackground(i),d={minZoom:n,maxZoom:r,clipAngle:f,mapAligned:!0,isLineLabel:!0};o.recordStart(this.instanceId,this.attributeLayout,c.glyphs[0].textureBinding),this._writeTextBox(o,a,t.x,t.y,h,u,d),o.recordEnd(),d.clipAngle=y,o.recordStart(this.instanceId,this.attributeLayout,c.glyphs[0].textureBinding),this._writeTextBox(o,a,t.x,t.y,h,u,d),o.recordEnd()}const x=(0,Kt.jL)(a),m=null!==(n=null===(r=this.evaluatedMeshParams.scaleInfo)||void 0===r?void 0:r.maxScale)&&void 0!==n?n:0,g=null!==(i=null===(s=this.evaluatedMeshParams.scaleInfo)||void 0===s?void 0:s.minScale)&&void 0!==i?i:0;o.metricStart(new qt.O(x,t.x,t.y,0,0,m,g,null)),this._placeFirst(p,e,1,f,!0),this._placeFirst(p,e,0,y,!0),o.metricEnd()}_placeBack(t,e,n,r,i,s){const o=t.clone();let a=t.backwardLength+0;for(;o.prev()&&!(a>=r);)this._placeOnSegment(o,e,a,n,-1,i,s),a+=o.length+0}_placeForward(t,e,n,r,i,s){const o=t.clone();let a=t.remainingLength+0;for(;o.next()&&!(a>=r);)this._placeOnSegment(o,e,a,n,1,i,s),a+=o.length+0}_placeFirst(t,e,n,r){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const s=t,{out:o,id:a,shaping:c,zoomRange:l,referenceBounds:u}=this._current,h=c.glyphs;for(const d of h){const h=d.x>c.bounds.x?n:1-n,p=h*t.remainingLength+(1-h)*t.backwardLength,f=Math.abs(d.x+d.width/2-c.bounds.x),y=Math.max(0,this._zoomLevel+Math.log2(f/(p+0))),x=Math.max(e,i?0:y);d.maxZoom=Math.min(l[1],28),d.angle=t.angle+(1-n)*Math.PI,d.minZoom=Math.max(l[0],x),this._writeLineGlyph(o,a,s.x,s.y,c.bounds,d,r,u,!0),n&&this._isVisible(d.minZoom,d.maxZoom)&&o.metricBoxWrite(d.bounds)}}_placeOnSegment(t,e,n,r,i,s,o){const{out:a,id:c,shaping:l,referenceBounds:u}=this._current,h=l.glyphs,d=t.dx/t.length,p=t.dy/t.length,f={x:t.x+n*-i*d,y:t.y+n*-i*p};for(const y of h){const h=y.x>l.bounds.x?s:1-s;if(!(h&&1===i||!h&&-1===i))continue;const d=Math.abs(y.x+y.width/2-l.bounds.x),p=Math.max(0,this._zoomLevel+Math.log2(d/n)-.1),x=Math.max(r,this._zoomLevel+Math.log2(d/(n+t.length+0)));if(0!==p&&(y.angle=t.angle+(1-s)*Math.PI,y.minZoom=x,y.maxZoom=p,this._writeLineGlyph(a,c,f.x,f.y,l.bounds,y,o,u,!0),s&&this._isVisible(y.minZoom,y.maxZoom))){const n=y.bounds,r=t.x-e.x,i=t.y-e.y,s=new Zt.Z(n.center[0]+r,n.center[1]+i,n.width,n.height);a.metricBoxWrite(s)}}}_writeLineGlyph(t,e,n,r,i,s,o,a,c){const l=n+i.x,u=r+i.y,h=2*(this.evaluatedMeshParams.minPixelBuffer?this.evaluatedMeshParams.minPixelBuffer/this._textMeshTransformProps.fontSize:1),d=Math.max(i.width,i.height)*h;t.recordStart(this.instanceId,this.attributeLayout,s.textureBinding),t.recordBounds(l,u,d,d);const{texcoords:p,offsets:f}=s,y=this._textMeshTransformProps.fontSize;this._writeQuad(t,e,n,r,{texcoords:p,offsets:f,fontSize:y,color:lt(this.evaluatedMeshParams.color),isBackground:!1,referenceBounds:a,minZoom:Math.max(this._current.zoomRange[0],s.minZoom),maxZoom:Math.min(this._current.zoomRange[1],s.maxZoom),clipAngle:o,mapAligned:c,isLineLabel:!0}),t.recordEnd()}_isVisible(t,e){const n=this._zoomLevel;return t<=n&&n<=e}}})},66759:(t,e,n)=>{function r(t){return t}function i(t){return t}n.d(e,{G:()=>r,W:()=>i})},15135:(t,e,n)=>{n.d(e,{Ie:()=>x,RS:()=>f,fz:()=>y,HN:()=>p});var r=n(27366),i=n(8841),s=n(73325),o=n(52995),a=n(93169),c=n(34130);class l extends s.oo{getVisualVariableData(t){if(!this._vvData){const e=this.getAttributeDataCoords(t);this._vvData=(0,o.ig)(this.visualVariableData,e).setDebugName("storage2")}return this._vvData}getAttributeDataCoords(t){if(!this._uv){const e=(0,c.Wv)(t),n=this.size,r=(0,o.e$)(e.x),i=(0,o.e$)(e.y).multiply((0,o.e$)(256)),s=(0,o.e$)(e.z).multiply((0,o.e$)(256)).multiply((0,o.e$)(256)),a=(0,o.fz)(r.add(i).add(s)),l=(0,o.wQ)(a,n),u=a.subtract(l).divide(n);this._uv=new o.Sg(l,u).add(.5).divide(n)}return this._uv}getFilterData(t){const e=this.getAttributeDataCoords(t);return(0,o.ig)(this.filterFlags,e).setDebugName("storage0")}getAnimationData(t){const e=this.getAttributeDataCoords(t);return(0,o.ig)(this.animation,e).setDebugName("storage1")}getVVData(t){return this.getVisualVariableData(t)}getDataDrivenData0(t){const e=this.getAttributeDataCoords(t);return(0,o.ig)(this.dataDriven0,e).setDebugName("storage30")}getDataDrivenData1(t){const e=this.getAttributeDataCoords(t);return(0,o.ig)(this.dataDriven1,e).setDebugName("storage31")}getDataDrivenData2(t){const e=this.getAttributeDataCoords(t);return(0,o.ig)(this.dataDriven2,e).setDebugName("storage32")}getGPGPUData(t){const e=this.getAttributeDataCoords(t);return(0,o.ig)(this.gpgpu,e).setDebugName("storage4")}getFilterFlags(t){return(0,a.Z)("webgl-ignores-sampler-precision")?(0,o.mD)(this.getFilterData(t).x.multiply((0,o.fz)(255))):this.getFilterData(t).x.multiply((0,o.fz)(255))}getAnimationValue(t){return this.getAnimationData(t).x}getSizeValue(t){return this.getVisualVariableData(t).x}getColorValue(t){return this.getVisualVariableData(t).y}getOpacityValue(t){return this.getVisualVariableData(t).z}getRotationValue(t){return this.getVisualVariableData(t).w}}(0,r._)([(0,s.e5)(o.Eg)],l.prototype,"filterFlags",void 0),(0,r._)([(0,s.e5)(o.Eg)],l.prototype,"animation",void 0),(0,r._)([(0,s.e5)(o.Eg)],l.prototype,"gpgpu",void 0),(0,r._)([(0,s.e5)(o.Eg)],l.prototype,"visualVariableData",void 0),(0,r._)([(0,s.e5)(o.Eg)],l.prototype,"dataDriven0",void 0),(0,r._)([(0,s.e5)(o.Eg)],l.prototype,"dataDriven1",void 0),(0,r._)([(0,s.e5)(o.Eg)],l.prototype,"dataDriven2",void 0),(0,r._)([(0,s.e5)(o.bv)],l.prototype,"size",void 0);class u extends s.oo{}(0,r._)([(0,s.e5)(o.bv)],u.prototype,"activeReasons",void 0),(0,r._)([(0,s.e5)(o.bv)],u.prototype,"highlightAll",void 0);class h extends s.oo{}(0,r._)([(0,s.e5)(o.Sg)],h.prototype,"position",void 0),(0,r._)([(0,s.e5)(o.bv)],h.prototype,"distance",void 0),(0,r._)([(0,s.e5)(o.bv)],h.prototype,"smallSymbolDistance",void 0),(0,r._)([(0,s.e5)(o.bv)],h.prototype,"smallSymbolSizeThreshold",void 0);var d=n(31060);class p extends s.Pz{}(0,r._)([(0,s.xh)(0,o.AO)],p.prototype,"id",void 0),(0,r._)([(0,s.xh)(1,o.bv)],p.prototype,"bitset",void 0),(0,r._)([(0,s.xh)(2,o.Sg)],p.prototype,"pos",void 0);class f extends s.yu{}(0,r._)([(0,s.xh)(14,o.Sg)],f.prototype,"nextPos1",void 0),(0,r._)([(0,s.xh)(15,o.Sg)],f.prototype,"nextPos2",void 0);class y extends s.XB{}class x extends s.ri{clip(t,e){let n=new o.bv(0);const r=this.storage.getFilterFlags(t);if(n=n.add((0,o.fz)(2).multiply((0,o.fz)(1).subtract((0,c.bG)(r,0)))),this.inside?n=n.add((0,o.fz)(2).multiply((0,o.fz)(1).subtract((0,c.bG)(r,1)))):this.outside?n=n.add((0,o.fz)(2).multiply((0,c.bG)(r,1))):this.highlight&&(n=n.add((0,o.fz)(2).multiply((0,o.fz)(1).subtract(this._checkHighlight(r))))),null!=e){const t=new o.bv(1).subtract((0,o.Nb)(e.x,this.view.currentZoom)),r=(0,o.Nb)(e.y,this.view.currentZoom);n=n.add(new o.bv(2).multiply(t.add(r)))}return n}getFragmentOutput(t,e){var n,r;let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new o.bv(1/255);const a=new s.Qt;return a.glFragColor=null!==(n=null!==(r=this._maybeWriteHittest(e))&&void 0!==r?r:this._maybeHighlight(t,i))&&void 0!==n?n:t,a}_maybeHighlight(t,e){return this.highlight?new o.T8(t.rgb,(0,o.Nb)(e,t.a)):null}_checkHighlight(t){let e=this._checkHighlightBit(t,0);for(let n=1;n<i.Oo.length;n++)e=e.add(this._checkHighlightBit(t,n));return(0,o.Nb)(new o.bv(.1),e.add(this.highlight.highlightAll))}_checkHighlightBit(t,e){return(0,c.hG)(t,e).multiply((0,c.qD)(this.highlight.activeReasons,e))}maybeRunHittest(t,e,n){if(null==this.hittestRequest)return null;const r=this.hittest(t,e,n);let i=(0,o.KJ)((0,o.tS)(r,this.hittestRequest.distance),new o.bv(2),new o.bv(0));const s=this.storage.getAttributeDataCoords(t.id),a=(0,c.pK)(s);i=i.add(this.clip(t.id,t.zoomRange));const l=new o.T8(new o.bv(1/255),0,0,0);return{glPointSize:new o.bv(1),glPosition:new o.T8(a,i,1),color:l}}_maybeWriteHittest(t){return null!=this.hittestRequest?t.color:null}}(0,r._)([s.Ou],x.prototype,"inside",void 0),(0,r._)([s.Ou],x.prototype,"outside",void 0),(0,r._)([(0,s.Kw)(u)],x.prototype,"highlight",void 0),(0,r._)([(0,s.e5)(l)],x.prototype,"storage",void 0),(0,r._)([(0,s.e5)(d.C)],x.prototype,"view",void 0),(0,r._)([(0,s.Kw)(h)],x.prototype,"hittestRequest",void 0)},26837:(t,e,n)=>{n.d(e,{LU:()=>m,Oh:()=>x,YW:()=>y});var r=n(27366),i=n(94109),s=n(73325),o=n(52995),a=n(15135),c=n(17326),l=n(93787),u=n(23058),h=n(31571),d=n(34130);class p extends l.F{}(0,r._)([(0,s.xh)(5,o.T8)],p.prototype,"tlbr",void 0),(0,r._)([(0,s.xh)(6,o.bv)],p.prototype,"width",void 0),(0,r._)([(0,s.xh)(7,o.bv)],p.prototype,"height",void 0),(0,r._)([(0,s.xh)(8,o.Sg)],p.prototype,"offset",void 0),(0,r._)([(0,s.xh)(9,o.Sg)],p.prototype,"scale",void 0),(0,r._)([(0,s.xh)(10,o.bv)],p.prototype,"angle",void 0);class f extends a.fz{}function y(t,e){const n=(0,o.CD)(new o.Sg(1),new o.Sg(1/i.Kg),new o.Sg((0,d.qD)(e.bitset,c.i6),(0,d.qD)(e.bitset,c.oy))),r=t.view.requiredZoomFactor,s=new o.Sg(e.width,e.height).multiply(n),a=s.multiply(e.scale).multiply(r),l=e.angle.multiply(c.e4),u=(0,o.O$)(l),h=(0,o.mC)(l),p=function(t,e,n,r,i){const s=(0,o.ln)((0,d.qD)(i,c.Ux),(0,o.fz)(1)),a=(0,d.JH)(new o.T8(t,0));return(0,o.KJ)(s,(0,o.wO)(r.divide(e.x),n.divide(e.y),0,(0,o.tk)(n.divide(e.x)),r.divide(e.y),0,(0,d.TN)((0,o.K4)(a,0)),(0,d.TN)((0,o.K4)(0,a)),1),(0,o.wO)(r.divide(e.x),n.divide(e.y),0,(0,o.tk)(n.divide(e.x)),r.divide(e.y),0,0,0,1))}(e.id,a,u,h,e.bitset),f=t.localTileOffset.getPatternOffsetAtTileOrigin(s,u,h),y=r.multiply(e.scale).multiply(e.offset.subtract(f)).divide(a),x=new o.AO(e.pos,1),m=p.multiply(x).xy.subtract(y),g=e.tlbr.divide(t.mosaicInfo.size.xyxy);let v=(0,d.qD)(e.bitset,c.GS);return null!=t.visualVariableColor&&(v=(0,o.KJ)((0,d.In)(t.storage.getColorValue(e.id)),new o.bv(0),v)),{tileTextureCoord:m,tlbr:g,sampleAlphaOnly:v}}function x(t,e){const n=(0,o.wQ)(e.tileTextureCoord,new o.bv(1)),r=(0,o.CD)(e.tlbr.xy,e.tlbr.zw,n);let i=(0,o.ig)(t.mosaicInfo.texture,r);return i=(0,o.KJ)((0,o.tS)(e.sampleAlphaOnly,new o.bv(.5)),i.aaaa,i),e.color.multiply(i)}class m extends l.C{vertex(t,e){return{...super.vertex(t,e),...y(this,t)}}fragment(t){const e=x(this,t);return this.getFragmentOutput(e,t,new o.bv(0))}}(0,r._)([(0,s.e5)(h.N)],m.prototype,"mosaicInfo",void 0),(0,r._)([(0,s.e5)(u.H)],m.prototype,"localTileOffset",void 0),(0,r._)([(0,r.a)(0,(0,s.qH)(p)),(0,r.a)(1,(0,s.qH)(a.RS))],m.prototype,"vertex",null),(0,r._)([(0,r.a)(0,(0,s.qH)(f))],m.prototype,"fragment",null)},78825:(t,e,n)=>{n.d(e,{$1:()=>f,NS:()=>x,Nz:()=>v});var r=n(27366),i=n(73325),s=n(52995),o=n(15135),a=n(26837),c=n(19812),l=n(16661),u=n(23058),h=n(31571),d=n(48156),p=n(44461);const f=16,y=1/f,x=128;class m extends o.HN{}(0,r._)([(0,i.xh)(3,s.T8)],m.prototype,"color",void 0),(0,r._)([(0,i.xh)(4,s.T8)],m.prototype,"tlbr",void 0),(0,r._)([(0,i.xh)(5,s.bv)],m.prototype,"angle",void 0),(0,r._)([(0,i.xh)(6,s.bv)],m.prototype,"aux1",void 0),(0,r._)([(0,i.xh)(7,s.bv)],m.prototype,"aux2",void 0),(0,r._)([(0,i.xh)(8,s.Sg)],m.prototype,"aux3",void 0),(0,r._)([(0,i.xh)(9,s.Sg)],m.prototype,"aux4",void 0),(0,r._)([(0,i.xh)(10,s.Sg)],m.prototype,"zoomRange",void 0);class g extends p.K7{}class v extends d.VV{vertex(t,e){const{aux1:n,aux2:r,aux3:i,aux4:o}=t,c={...t,width:n,height:r,offset:i,scale:o.multiply(y)},l={...t,halfWidth:n.multiply(y),referenceHalfWidth:r.multiply(y),offset:i.multiply(y),normal:o.subtract(x).multiply(y)},u=(0,d.R0)(this,l),h=(0,a.YW)(this,c),p=(0,s.tS)(u.isOutline,new s.bv(.5));return{...u,...h,...this.maybeRunHittest(t,e,p)}}fragment(t){const{isOutline:e}=t,n=(0,s.tS)(e,new s.bv(.5)),r=(0,l.zj)(t,this.antialiasingControls.blur),i=(0,a.Oh)(this,t),o=(0,s.KJ)(n,r,i),c=(0,s.KJ)(n,new s.bv(1/255),new s.bv(0));return this.getFragmentOutput(o,t,c)}hittest(t,e,n){return(0,s.KJ)(n,(0,c.Oz)(this.hittestRequest),(0,c.CC)(this,t,e))}}(0,r._)([(0,i.e5)(h.N)],v.prototype,"mosaicInfo",void 0),(0,r._)([(0,i.e5)(u.H)],v.prototype,"localTileOffset",void 0),(0,r._)([(0,r.a)(0,(0,i.qH)(m)),(0,r.a)(1,(0,i.qH)(o.RS))],v.prototype,"vertex",null),(0,r._)([(0,r.a)(0,(0,i.qH)(g))],v.prototype,"fragment",null)},93787:(t,e,n)=>{n.d(e,{C:()=>d,F:()=>h});var r=n(27366),i=n(73325),s=n(52995),o=n(15135),a=n(19812),c=n(14294),l=n(72328),u=n(10750);class h extends o.HN{}(0,r._)([(0,i.xh)(3,s.T8)],h.prototype,"color",void 0),(0,r._)([(0,i.xh)(4,s.Sg)],h.prototype,"zoomRange",void 0);class d extends o.Ie{constructor(){super(...arguments),this.computeAttributes={pos:["nextPos1","nextPos2"]}}vertex(t,e){const n=(0,u.sY)(this,t.id),r=(0,u.Zt)(this,t.id,t.color).multiply(n),i=this.view.displayViewScreenMat3.multiply(new s.AO(t.pos.xy,1)),o=this.clip(t.id,t.zoomRange);return{glPosition:new s.T8(i.xy,o,1),color:r,...this.maybeRunHittest(t,e,null)}}fragment(t){return this.getFragmentOutput(t.color,t,new s.bv(0))}hittest(t,e){return(0,a.CC)(this,t,e)}}(0,r._)([(0,i.Kw)(c.W)],d.prototype,"visualVariableColor",void 0),(0,r._)([(0,i.Kw)(l.V)],d.prototype,"visualVariableOpacity",void 0),(0,r._)([(0,r.a)(0,(0,i.qH)(h)),(0,r.a)(1,(0,i.qH)(o.RS))],d.prototype,"vertex",null),(0,r._)([(0,r.a)(0,(0,i.qH)(o.fz))],d.prototype,"fragment",null)},16661:(t,e,n)=>{n.d(e,{Pf:()=>S,Wc:()=>_,b$:()=>g,fc:()=>m,tp:()=>x,uY:()=>b,zj:()=>w});var r=n(27366),i=n(73325),s=n(52995),o=n(15135),a=n(17326),c=n(19812),l=n(14294),u=n(72328),h=n(48684),d=n(60064),p=n(9830),f=n(38694),y=n(10750);class x extends o.HN{}(0,r._)([(0,i.xh)(3,s.T8)],x.prototype,"color",void 0),(0,r._)([(0,i.xh)(4,s.Sg)],x.prototype,"offset",void 0),(0,r._)([(0,i.xh)(5,s.Sg)],x.prototype,"normal",void 0),(0,r._)([(0,i.xh)(6,s.bv)],x.prototype,"halfWidth",void 0),(0,r._)([(0,i.xh)(7,s.bv)],x.prototype,"referenceHalfWidth",void 0),(0,r._)([(0,i.xh)(8,s.Sg)],x.prototype,"zoomRange",void 0);class m extends o.fz{}class g extends i.oo{}function v(t){return(0,s.Fp)(new s.bv(a.Ay).multiply((0,s.Nb)(t,new s.bv(a.xp))),new s.bv(1))}function _(t,e){const{halfWidth:n,normal:r}=t,i=v(n),o=(0,s.kE)(r).multiply(n);return(0,s.uZ)(i.multiply(n.subtract(o)).divide(e.add(i).subtract(new s.bv(1))),new s.bv(0),new s.bv(1))}function b(t,e){const{id:n,offset:r,pos:i,normal:o,zoomRange:c}=e,{displayViewScreenMat3:l,displayViewMat3:u}=t.view,h=(0,y.Zt)(t,n,e.color),d=(0,y.sY)(t,n),p=function(t,e){const{id:n,halfWidth:r,referenceHalfWidth:i}=e;if((0,y.lA)(t)){const e=new s.bv(2).multiply(i),o=(0,y.Vm)(t,n,e);return new s.bv(.5).multiply(r.divide((0,s.Fp)(i,new s.bv(a.Ho)))).multiply(o)}return r}(t,e),f=new s.bv(.5).multiply(t.antialiasingControls.antialiasing),x=(0,s.Fp)(p.add(f),new s.bv(.45)).add(new s.bv(.1).multiply(f)),m=v(x).multiply(x).multiply(r),g=u.multiply(new s.AO(m,new s.bv(0))),_=l.multiply(new s.AO(i,new s.bv(1))).add(g),b=new s.bv(2).multiply((0,s.Nb)(p,new s.bv(0))).add(t.clip(n,c)),w=new s.T8(_.xy,b,1);return{color:h,opacity:d,halfWidth:x,normal:o,scaledOffset:m,scaledHalfWidth:p,glPosition:new s.T8(w.xy,b,1)}}function w(t,e){const{opacity:n,color:r}=t,i=_(t,e);return n.multiply(r).multiply(i)}(0,r._)([(0,i.e5)(s.bv)],g.prototype,"antialiasing",void 0),(0,r._)([(0,i.e5)(s.bv)],g.prototype,"blur",void 0);class S extends o.Ie{constructor(){super(...arguments),this.computeAttributes={pos:["nextPos1","nextPos2"]}}vertex(t,e){const n=b(this,t);return{...n,...this.maybeRunHittest(t,e,n.halfWidth)}}fragment(t){const e=w(t,this.antialiasingControls.blur);return this.getFragmentOutput(e,t)}hittest(t,e,n){const{viewMat3:r,tileMat3:i}=this.view,o=r.multiply(i),a=o.multiply(new s.AO(t.pos,1)),l=o.multiply(new s.AO(e.nextPos1,1)),u=o.multiply(new s.AO(e.nextPos2,1)),{distance:h,smallSymbolDistance:d,smallSymbolSizeThreshold:p}=this.hittestRequest,f=(0,s.Nb)(n,p.multiply(.5)).multiply(h.subtract(d)),y=this.hittestRequest.position;return(0,s.VV)((0,c.bA)(y,a.xy,l.xy),(0,c.bA)(y,a.xy,u.xy)).subtract(n).add(f)}}(0,r._)([(0,i.e5)(g)],S.prototype,"antialiasingControls",void 0),(0,r._)([(0,i.Kw)(l.W)],S.prototype,"visualVariableColor",void 0),(0,r._)([(0,i.Kw)(u.V)],S.prototype,"visualVariableOpacity",void 0),(0,r._)([(0,i.Kw)(h.k)],S.prototype,"visualVariableSizeMinMaxValue",void 0),(0,r._)([(0,i.Kw)(d.U)],S.prototype,"visualVariableSizeScaleStops",void 0),(0,r._)([(0,i.Kw)(p.W)],S.prototype,"visualVariableSizeStops",void 0),(0,r._)([(0,i.Kw)(f.V)],S.prototype,"visualVariableSizeUnitValue",void 0),(0,r._)([(0,r.a)(0,(0,i.qH)(x)),(0,r.a)(1,(0,i.qH)(o.RS))],S.prototype,"vertex",null),(0,r._)([(0,r.a)(0,(0,i.qH)(m))],S.prototype,"fragment",null)},23058:(t,e,n)=>{n.d(e,{H:()=>a});var r=n(27366),i=n(73325),s=n(52995),o=n(17326);class a extends i.oo{getPatternOffsetAtTileOrigin(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new s.bv(0),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new s.bv(1);const r=new s.Sg(o.ad).divide(t);let i=t.multiply((0,s.ZI)(this.maxIntsToLocalOrigin.multiply(r))).add(this.tileOffsetFromLocalOrigin).subtract(new s.bv(.5).multiply(t));return i=new s.Sg(i.x.multiply(n).subtract(i.y.multiply(e)),i.x.multiply(e).add(i.y.multiply(n))),(0,s.wQ)(i,t)}}(0,r._)([(0,i.e5)(s.Sg)],a.prototype,"tileOffsetFromLocalOrigin",void 0),(0,r._)([(0,i.e5)(s.Sg)],a.prototype,"maxIntsToLocalOrigin",void 0)},31571:(t,e,n)=>{n.d(e,{N:()=>o});var r=n(27366),i=n(73325),s=n(52995);class o extends i.oo{}(0,r._)([(0,i.e5)(s.Sg)],o.prototype,"size",void 0),(0,r._)([(0,i.e5)(s.Eg)],o.prototype,"texture",void 0)},48156:(t,e,n)=>{n.d(e,{N8:()=>g,R0:()=>_,VV:()=>b,jt:()=>v,py:()=>w});var r=n(27366),i=n(73325),s=n(52995),o=n(15135),a=n(17326),c=n(19812),l=n(16661),u=n(34130),h=n(14294),d=n(72328),p=n(48684),f=n(60064),y=n(9830),x=n(38694),m=n(10750);class g extends o.HN{}(0,r._)([(0,i.xh)(3,s.Sg)],g.prototype,"offset",void 0),(0,r._)([(0,i.xh)(4,s.T8)],g.prototype,"color",void 0),(0,r._)([(0,i.xh)(5,s.Sg)],g.prototype,"normal",void 0),(0,r._)([(0,i.xh)(6,s.bv)],g.prototype,"halfWidth",void 0),(0,r._)([(0,i.xh)(7,s.bv)],g.prototype,"referenceHalfWidth",void 0),(0,r._)([(0,i.xh)(8,s.Sg)],g.prototype,"zoomRange",void 0);class v extends l.fc{}function _(t,e,n){const{id:r,bitset:i}=e,o=(0,u.qD)(i,a.WD),c=(0,s.tS)(o,new s.bv(.5)),h=(0,l.uY)(t,e),d=(0,s.KJ)(c,h.halfWidth,new s.bv(0)),p=(0,m.sY)(t,r),f=(0,m.Zt)(t,r,e.color),y=(0,s.KJ)(c,e.color,f.multiply(p)),x=t.view.displayViewScreenMat3.multiply(new s.AO(e.pos.xy,1)),g=t.clip(e.id),v=new s.T8(x.xy,g,1),_=(0,s.KJ)(c,h.glPosition,v),b=n&&t.maybeRunHittest(e,n,c);return{isOutline:o,color:y,opacity:new s.bv(1),halfWidth:d,normal:h.normal,glPosition:_,...b}}class b extends o.Ie{constructor(){super(...arguments),this.computeAttributes={pos:["nextPos1","nextPos2"]}}}(0,r._)([(0,i.e5)(l.b$)],b.prototype,"antialiasingControls",void 0),(0,r._)([(0,i.Kw)(h.W)],b.prototype,"visualVariableColor",void 0),(0,r._)([(0,i.Kw)(d.V)],b.prototype,"visualVariableOpacity",void 0),(0,r._)([(0,i.Kw)(p.k)],b.prototype,"visualVariableSizeMinMaxValue",void 0),(0,r._)([(0,i.Kw)(f.U)],b.prototype,"visualVariableSizeScaleStops",void 0),(0,r._)([(0,i.Kw)(y.W)],b.prototype,"visualVariableSizeStops",void 0),(0,r._)([(0,i.Kw)(x.V)],b.prototype,"visualVariableSizeUnitValue",void 0);class w extends b{vertex(t,e){return _(this,t,e)}fragment(t){const{color:e,isOutline:n}=t,r=(0,s.tS)(n,new s.bv(.5)),i=(0,l.zj)(t,this.antialiasingControls.blur),o=(0,s.KJ)(r,i,e),a=(0,s.KJ)(r,new s.bv(1/255),new s.bv(0));return this.getFragmentOutput(o,t,a)}hittest(t,e,n){return(0,s.KJ)(n,(0,c.Oz)(this.hittestRequest),(0,c.CC)(this,t,e))}}(0,r._)([(0,r.a)(0,(0,i.qH)(g)),(0,r.a)(1,(0,i.qH)(o.RS))],w.prototype,"vertex",null),(0,r._)([(0,r.a)(0,(0,i.qH)(v))],w.prototype,"fragment",null)},44405:(t,e,n)=>{n.d(e,{DS:()=>p,Qp:()=>d,lA:()=>f});var r=n(27366),i=n(73325),s=n(52995),o=n(15135),a=n(93787),c=n(23058),l=n(31571);class u extends a.F{}(0,r._)([(0,i.xh)(5,s.T8)],u.prototype,"tlbr",void 0),(0,r._)([(0,i.xh)(6,s.bv)],u.prototype,"inverseRasterizationScale",void 0);class h extends o.fz{}function d(t,e){const n=e.tlbr.xy,r=e.tlbr.zw,i=r.x.subtract(n.x),o=n.y.subtract(r.y),a=new s.Sg(i,o).multiply(e.inverseRasterizationScale),c=a.multiply(t.view.requiredZoomFactor),l=function(t){const e=new s.bv(1),n=new s.bv(0);return new s.Tu(e.divide(t.x),n.divide(t.y),0,(0,s.tk)(n.divide(t.x)),e.divide(t.y),0,0,0,1)}(c),u=t.localTileOffset.getPatternOffsetAtTileOrigin(a).divide(c),h=new s.AO(e.pos,1);return{tileTextureCoord:l.multiply(h).xy.subtract(u),tlbr:e.tlbr.divide(t.mosaicInfo.size.xyxy)}}function p(t,e){const n=(0,s.wQ)(t.tileTextureCoord,new s.bv(1)),r=(0,s.CD)(t.tlbr.xy,t.tlbr.zw,n),i=(0,s.ig)(e.texture,r);return t.color.multiply(i)}class f extends a.C{vertex(t,e){return{...super.vertex(t,e),...d(this,t)}}fragment(t){const e=p(t,this.mosaicInfo);return this.getFragmentOutput(e,t,new s.bv(0))}}(0,r._)([(0,i.e5)(l.N)],f.prototype,"mosaicInfo",void 0),(0,r._)([(0,i.e5)(c.H)],f.prototype,"localTileOffset",void 0),(0,r._)([(0,r.a)(0,(0,i.qH)(u)),(0,r.a)(1,(0,i.qH)(o.RS))],f.prototype,"vertex",null),(0,r._)([(0,r.a)(0,(0,i.qH)(h))],f.prototype,"fragment",null)},44461:(t,e,n)=>{n.d(e,{K7:()=>p,Zd:()=>f});var r=n(27366),i=n(73325),s=n(52995),o=n(15135),a=n(16661),c=n(23058),l=n(31571),u=n(48156),h=n(44405);class d extends u.N8{}(0,r._)([(0,i.xh)(9,s.T8)],d.prototype,"tlbr",void 0),(0,r._)([(0,i.xh)(10,s.bv)],d.prototype,"inverseRasterizationScale",void 0);class p extends u.jt{}class f extends u.py{vertex(t,e){return{...(0,u.R0)(this,t,e),...(0,h.Qp)(this,t)}}fragment(t){const{isOutline:e}=t,n=(0,s.tS)(e,new s.bv(.5)),r=(0,a.zj)(t,this.antialiasingControls.blur),i=(0,h.DS)(t,this.mosaicInfo),o=(0,s.KJ)(n,r,i),c=(0,s.KJ)(n,new s.bv(1/255),new s.bv(0));return this.getFragmentOutput(o,t,c)}}(0,r._)([(0,i.e5)(l.N)],f.prototype,"mosaicInfo",void 0),(0,r._)([(0,i.e5)(c.H)],f.prototype,"localTileOffset",void 0),(0,r._)([(0,r.a)(0,(0,i.qH)(d)),(0,r.a)(1,(0,i.qH)(o.RS))],f.prototype,"vertex",null),(0,r._)([(0,r.a)(0,(0,i.qH)(p))],f.prototype,"fragment",null)},31060:(t,e,n)=>{n.d(e,{C:()=>o});var r=n(27366),i=n(73325),s=n(52995);class o extends i.oo{}(0,r._)([(0,i.e5)(s.Tu)],o.prototype,"displayViewScreenMat3",void 0),(0,r._)([(0,i.e5)(s.Tu)],o.prototype,"displayViewMat3",void 0),(0,r._)([(0,i.e5)(s.Tu)],o.prototype,"displayMat3",void 0),(0,r._)([(0,i.e5)(s.Tu)],o.prototype,"viewMat3",void 0),(0,r._)([(0,i.e5)(s.Tu)],o.prototype,"tileMat3",void 0),(0,r._)([(0,i.e5)(s.bv)],o.prototype,"displayZoomFactor",void 0),(0,r._)([(0,i.e5)(s.bv)],o.prototype,"requiredZoomFactor",void 0),(0,r._)([(0,i.e5)(s.Sg)],o.prototype,"tileOffset",void 0),(0,r._)([(0,i.e5)(s.bv)],o.prototype,"currentScale",void 0),(0,r._)([(0,i.e5)(s.bv)],o.prototype,"currentZoom",void 0),(0,r._)([(0,i.e5)(s.bv)],o.prototype,"metersPerSRUnit",void 0),(0,r._)([(0,i.e5)(s.bv)],o.prototype,"rotation",void 0),(0,r._)([(0,i.e5)(s.bv)],o.prototype,"pixelRatio",void 0)},14294:(t,e,n)=>{n.d(e,{W:()=>a});var r=n(27366),i=n(73325),s=n(52995),o=n(34130);class a extends i.oo{getColor(t,e,n){return(0,s.wV)([(0,s.or)((0,o.In)(t),n),e],[(0,s.Iz)(t,this.values.first()),this.colors.first()],[(0,s.r7)(t,this.values.last()),this.colors.last()],[!0,()=>{const e=this.values.findIndex((e=>(0,s.tS)(e,t))),n=this.values.get(e),r=e.subtract(1),i=this.values.get(r),o=t.subtract(i).divide(n.subtract(i));return(0,s.CD)(this.colors.get(r),this.colors.get(e),o)}])}}(0,r._)([(0,i.e5)(s.v8.ofType(s.T8,8))],a.prototype,"colors",void 0),(0,r._)([(0,i.e5)(s.v8.ofType(s.bv,8))],a.prototype,"values",void 0)},72328:(t,e,n)=>{n.d(e,{V:()=>a});var r=n(27366),i=n(73325),s=n(52995),o=n(34130);class a extends i.oo{getOpacity(t){return(0,s.wV)([(0,o.In)(t),new s.bv(1)],[(0,s.Iz)(t,this.opacityValues.first()),this.opacities.first()],[(0,s.r7)(t,this.opacityValues.last()),this.opacities.last()],[!0,()=>{const e=this.opacityValues.findIndex((e=>(0,s.tS)(e,t))),n=this.opacityValues.get(e),r=e.subtract(1),i=this.opacityValues.get(r),o=t.subtract(i).divide(n.subtract(i));return(0,s.CD)(this.opacities.get(r),this.opacities.get(e),o)}])}}(0,r._)([(0,i.e5)(s.v8.ofType(s.bv,8))],a.prototype,"opacities",void 0),(0,r._)([(0,i.e5)(s.v8.ofType(s.bv,8))],a.prototype,"opacityValues",void 0)},48684:(t,e,n)=>{n.d(e,{k:()=>a});var r=n(27366),i=n(73325),s=n(52995),o=n(34130);class a extends i.oo{getSize(t,e){const n=this.minMaxValueAndSize.xy,r=this.minMaxValueAndSize.zw;return(0,s.KJ)((0,o.In)(t),e,(()=>{const e=t.subtract(n.x).divide(n.y.subtract(n.x)),i=(0,s.uZ)(e,new s.bv(0),new s.bv(1));return r.x.add(i.multiply(r.y.subtract(r.x)))}))}}(0,r._)([(0,i.e5)(s.T8)],a.prototype,"minMaxValueAndSize",void 0)},60064:(t,e,n)=>{n.d(e,{U:()=>o});var r=n(27366),i=n(73325),s=n(52995);class o extends i.oo{getSizeForViewScale(t){return(0,s.wV)([(0,s.Iz)(t,this.values.first()),this.sizes.first()],[(0,s.r7)(t,this.values.last()),this.sizes.last()],[!0,()=>{const e=this.values.findIndex((e=>(0,s.tS)(e,t))),n=this.values.get(e),r=e.subtract(1),i=this.values.get(r),o=t.subtract(i).divide(n.subtract(i));return(0,s.CD)(this.sizes.get(r),this.sizes.get(e),o)}])}}(0,r._)([(0,i.e5)(s.v8.ofType(s.bv,8))],o.prototype,"sizes",void 0),(0,r._)([(0,i.e5)(s.v8.ofType(s.bv,8))],o.prototype,"values",void 0)},9830:(t,e,n)=>{n.d(e,{W:()=>a});var r=n(27366),i=n(73325),s=n(52995),o=n(34130);class a extends i.oo{getSize(t,e){const n=(0,s.wV)([(0,o.In)(t),e],[(0,s.Iz)(t,this.values.first()),this.sizes.first()],[(0,s.r7)(t,this.values.last()),this.sizes.last()],[!0,()=>{const e=this.values.findIndex((e=>(0,s.tS)(e,t))),n=this.values.get(e),r=e.subtract(1),i=this.values.get(r),o=t.subtract(i).divide(n.subtract(i));return(0,s.CD)(this.sizes.get(r),this.sizes.get(e),o)}]);return(0,s.KJ)((0,o.In)(n),e,n)}}(0,r._)([(0,i.e5)(s.v8.ofType(s.bv,8))],a.prototype,"sizes",void 0),(0,r._)([(0,i.e5)(s.v8.ofType(s.bv,8))],a.prototype,"values",void 0)},38694:(t,e,n)=>{n.d(e,{V:()=>a});var r=n(27366),i=n(73325),s=n(52995),o=n(34130);class a extends i.oo{getSize(t,e){return(0,s.KJ)((0,o.In)(t),e,t.multiply(this.unitValueToPixelsRatio))}}(0,r._)([(0,i.e5)(s.bv)],a.prototype,"unitValueToPixelsRatio",void 0)},17326:(t,e,n)=>{var r;n.d(e,{$r:()=>w,Ay:()=>a,B7:()=>_,GS:()=>f,Ho:()=>h,Ke:()=>u,MO:()=>r,T5:()=>d,Ux:()=>x,V_:()=>l,WD:()=>y,Wq:()=>v,ad:()=>S,e4:()=>s,i6:()=>g,k9:()=>p,mL:()=>b,nF:()=>i,nU:()=>o,oy:()=>m,xp:()=>c}),function(t){t[t.Geographic=0]="Geographic",t[t.Arithmatic=1]="Arithmatic"}(r||(r={}));const i=3.14159265359/180,s=3.14159265359/128,o=1,a=1.1,c=1,l=24,u=8,h=1e-5,d=.05,p=1e-30,f=4,y=0,x=2,m=5,g=6,v=2,_=3,b=0,w=3,S=16777216},19812:(t,e,n)=>{n.d(e,{CC:()=>d,Oz:()=>h,P0:()=>u,XM:()=>p,bA:()=>o,hF:()=>c,lD:()=>a});var r=n(52995),i=n(17326),s=n(34130);function o(t,e,n){const i=n.subtract(e),s=function(t,e){return(0,r.AK)(t,(0,r.Fv)(e))}(t.subtract(e),i),o=(0,r.uZ)(s.divide((0,r.kE)(i)),new r.bv(0),new r.bv(1));return(0,r.TE)(t,e.add(o.multiply(n.subtract(e))))}function a(t){const e=(0,r.Wn)(t);return(0,r.Nb)(e.x.add(e.y).add(e.z),new r.bv(1.05))}function c(t,e,n,i){const s=new r.Tu(n.x.multiply(i.y).subtract(i.x.multiply(n.y)),i.x.multiply(e.y).subtract(e.x.multiply(i.y)),e.x.multiply(n.y).subtract(n.x.multiply(e.y)),n.y.subtract(i.y),i.y.subtract(e.y),e.y.subtract(n.y),i.x.subtract(n.x),e.x.subtract(i.x),n.x.subtract(e.x)),o=e.x.multiply(n.y.subtract(i.y)),a=n.x.multiply(i.y.subtract(e.y)),c=i.x.multiply(e.y.subtract(n.y)),l=o.add(a).add(c);return new r.bv(1).divide(l).multiply(s.multiply(new r.AO(1,t)))}function l(t,e,n,i){return(0,r.ln)(a(c(t,e,n,i)),new r.bv(1))}function u(t,e,n,a){const c=n.subtract(e),u=a.subtract(e),h=(0,s.xQ)(c,u),d=(0,r.xD)((0,r.Qj)(h,new r.bv(i.T5)),(0,r.tS)(h,new r.bv(-i.T5)));return(0,r.wV)([(0,r.xD)((0,r.ff)(d),l(t.xy,e,n,a)),new r.bv(-1)],[!0,()=>{const i=o(t,e,n),s=o(t,n,a),c=o(t,a,e);return(0,r.VV)((0,r.VV)(i,s),c)}])}function h(t){return t.distance.add(1)}function d(t,e,n){const{viewMat3:i,tileMat3:s}=t.view,o=i.multiply(s),a=o.multiply(new r.AO(e.pos,1)),c=o.multiply(new r.AO(n.nextPos1,1)),l=o.multiply(new r.AO(n.nextPos2,1));return u(t.hittestRequest.position,a.xy,c.xy,l.xy)}function p(t,e,n){return(0,r.TE)(t,n).subtract(e)}},34130:(t,e,n)=>{n.d(e,{In:()=>a,JH:()=>y,TN:()=>o,Wv:()=>f,X3:()=>x,bG:()=>d,h7:()=>h,hG:()=>p,pK:()=>l,qD:()=>u,xQ:()=>c});var r=n(8841),i=n(52995),s=n(17326);function o(t){const e=(0,i.fz)(12.9898),n=(0,i.fz)(78.233),r=(0,i.fz)(43758.5453),s=(0,i.AK)(t,(0,i.K4)(e,n)),o=(0,i.wQ)(s,(0,i.fz)(3.14));return(0,i.ZI)((0,i.O$)(o).multiply(r))}function a(t){return(0,i.ln)(t,(0,i.fz)(s.k9))}function c(t,e){return t.x.multiply(e.y).subtract(e.x.multiply(t.y))}function l(t){return t.multiply(2).subtract(1)}function u(t,e){const n=(0,i.fz)(2**e);return(0,i.wQ)((0,i.GW)(t.divide(n)),(0,i.fz)(2))}function h(t,e){return(0,i.tS)(u(t,e),(0,i.fz)(.5))}function d(t,e){return u(t,e+r.Oo.length)}function p(t,e){return u(t,e)}function f(t){const e=u(t.z,7),n=(0,i.fz)(1).subtract(e),r=t.xyz.subtract((0,i.R3)(0,0,(0,i.fz)(128)));return n.multiply(t).add(e.multiply(r))}function y(t){const e=(0,i.vh)(255/256,255/65536,255/16777216,255/4294967296);return(0,i.AK)(t,e)}function x(t){return(0,i.Fp)((0,i.Fp)((0,i.Fp)(t.x,t.y),t.z),t.w)}},10750:(t,e,n)=>{n.d(e,{H8:()=>c,Vm:()=>s,Zt:()=>o,lA:()=>i,sY:()=>a});var r=n(52995);function i(t){return null!=t.visualVariableSizeMinMaxValue||null!=t.visualVariableSizeScaleStops||null!=t.visualVariableSizeStops||null!=t.visualVariableSizeUnitValue}function s(t,e,n){if(i(t)){var r,s,o,a,c,l,u;const i=t.storage.getSizeValue(e);return null!==(r=null!==(s=null!==(o=null===(a=t.visualVariableSizeMinMaxValue)||void 0===a?void 0:a.getSize(i,n))&&void 0!==o?o:null===(c=t.visualVariableSizeScaleStops)||void 0===c?void 0:c.getSizeForViewScale(t.view.currentScale))&&void 0!==s?s:null===(l=t.visualVariableSizeStops)||void 0===l?void 0:l.getSize(i,n))&&void 0!==r?r:null===(u=t.visualVariableSizeUnitValue)||void 0===u?void 0:u.getSize(i,n)}return n}function o(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new r.tW(!1);if(null==t.visualVariableColor)return n;const s=t.storage.getColorValue(e);return t.visualVariableColor.getColor(s,n,i)}function a(t,e){if(null==t.visualVariableOpacity)return new r.bv(1);const n=t.storage.getOpacityValue(e);return t.visualVariableOpacity.getOpacity(n)}function c(t,e){if(null==t.visualVariableRotation)return r.Tu.identity();const n=t.storage.getRotationValue(e);return t.visualVariableRotation.getVVRotationMat3(n)}},19407:(t,e,n)=>{n.d(e,{X:()=>l});var r=n(10064),i=n(32718),s=n(18202),o=(n(84936),n(93169),n(37825),n(8548),n(53634),n(47428)),a=(n(46888),n(57808),n(84319));function c(t,e,n){const s=e.length;if(s!==n){const o=new r.Z("Invalid Uniform","Invalid length, expected ".concat(n," but got ").concat(s),{uniformName:t,values:e});i.Z.getLogger("esri.views.2d.engine.webgl.shaderGraph.typed.TypedShaderProgram").errorOnce(o)}}class l{constructor(t,e,n,r,i,s){this._program=null,this._vao=null,this._temporaryTextures=[],this.vertexShader=t,this.fragmentShader=e,this._locations=n,this._locationInfo=r,this._uniformBindings=i,this._transformFeedbackBindings=s}destroy(){this._program&&this._program.dispose(),this.cleanupTemporaryTextures()}get locations(){return this._locations}get locationInfo(){return this._locationInfo}setUniforms(t){this._uniforms=t}cleanupTemporaryTextures(){for(const t of this._temporaryTextures)t.dispose();this._temporaryTextures=[]}bind(t){const e=this._uniforms;if(!this._program){const e=new Map;for(const[t,n]of this._locations)e.set(t,n);const r=[];for(const t of null!==(n=this._transformFeedbackBindings)&&void 0!==n?n:[]){var n;const{index:e,propertyKey:i}=t;r[e]="v_".concat(i)}this._program=new o.$(t,this.vertexShader,this.fragmentShader,e,new Map,r)}const r=this._program;t.useProgram(r);for(const i of this._uniformBindings){const{shaderModulePath:n,uniformName:o,uniformType:l,uniformArrayLength:u}=i,h=(0,s.hS)(n,e);if(null==h){if("sampler2D"===l)continue;throw new Error("Failed to find uniform value for ".concat(n))}switch("array"===l?i.uniformArrayElementType:l){case"sampler2D":{const{unit:e,texture:n}=h;if(r.setUniform1i(o,e),"type"in n)t.bindTexture(n,e);else{const r=(0,a.cU)(t,n.descriptor,n.data);t.bindTexture(r,e)}break}case"int":if(!u){r.setUniform1i(o,h);break}c(i.uniformName,h,u),r.setUniform1iv(o,h);break;case"float":if(!u){r.setUniform1f(o,h);break}c(i.uniformName,h,u),r.setUniform1fv(o,h);break;case"vec2":if(!u){r.setUniform2f(o,h[0],h[1]);break}c(i.uniformName,h,u),r.setUniform2fv(o,h.flat());break;case"vec3":if(!u){r.setUniform3f(o,h[0],h[1],h[2]);break}c(i.uniformName,h,u),r.setUniform3fv(o,h.flat());break;case"vec4":if(!u){r.setUniform4f(o,h[0],h[1],h[2],h[3]);break}c(i.uniformName,h,u),r.setUniform4fv(o,h.flat());break;case"mat3":r.setUniformMatrix3fv(o,h.flat());break;case"mat4":r.setUniformMatrix4fv(o,h.flat());break;default:throw new Error("Unable to set uniform for type ".concat(l))}}}}},79004:(t,e,n)=>{n.d(e,{x:()=>h});var r=n(27366),i=n(7138),s=n(93169),o=n(18442),a=n(94172),c=n(49861),l=(n(32718),n(84936),n(69912)),u=n(46634);let h=class extends i.Z{constructor(t){super(t),this.debugName="",this._updatingHandles=new u.R,this._idToUpdatingState=new o.Z}get updating(){const t=this._updatingHandles.updating||Array.from(this._idToUpdatingState.values()).some((t=>t));if((0,s.Z)("esri-2d-log-updating")){const e=Array.from(this._idToUpdatingState.entries()).map((t=>{let[e,n]=t;return"-> ".concat(e,": ").concat(n)})).join("\n");console.log("".concat(this.debugName,": Updating: ").concat(t,"\n-> Handles: ").concat(this._updatingHandles.updating,"\n").concat(e))}return t}addUpdateTracking(t,e){const n=(0,a.YP)((()=>e.updating),(e=>this._idToUpdatingState.set(t,e)),{sync:!0});this.addHandles(n)}addPromise(t){return this._updatingHandles.addPromise(t)}};(0,r._)([(0,c.Cb)({constructOnly:!0})],h.prototype,"debugName",void 0),(0,r._)([(0,c.Cb)({readOnly:!0})],h.prototype,"updating",null),h=(0,r._)([(0,l.j)("esri.view.2d.layers.support.UpdateTracking2D")],h)},99340:(t,e,n)=>{var r;n.d(e,{P:()=>r}),function(t){t[t.Pass=0]="Pass",t[t.Draw=1]="Draw"}(r||(r={}))}}]);
//# sourceMappingURL=3403.dcd8f80b.chunk.js.map