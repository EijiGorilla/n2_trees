"use strict";(self.webpackChunkn2_trees=self.webpackChunkn2_trees||[]).push([[1181],{43244:(t,e,i)=>{i.d(e,{Z:()=>r});class r{constructor(t){this.size=0,this._start=0,this.maxSize=t,this._buffer=new Array(t)}get entries(){return this._buffer}enqueue(t){if(this.size===this.maxSize){const e=this._buffer[this._start];return this._buffer[this._start]=t,this._start=(this._start+1)%this.maxSize,e}return this._buffer[(this._start+this.size++)%this.maxSize]=t,null}dequeue(){if(0===this.size)return null;const t=this._buffer[this._start];return this._buffer[this._start]=null,this.size--,this._start=(this._start+1)%this.maxSize,t}peek(){return 0===this.size?null:this._buffer[this._start]}peekLast(){return 0===this.size?null:this._buffer[(this._start+(this.size-1))%this.maxSize]}find(t){if(0===this.size)return null;for(const e of this._buffer)if(null!=e&&t(e))return e;return null}clear(t){let e=this.dequeue();for(;null!=e;)t&&t(e),e=this.dequeue()}}},48035:(t,e,i)=>{i.d(e,{b:()=>l,j:()=>c});var r=i(65905),s=i(93169);const n=128e3;let o=null,a=null;async function c(){return o||(o=async function(){const t=(0,s.Z)("esri-csp-restrictions")?await i.e(5948).then(i.bind(i,5948)).then((t=>t.l)):await i.e(7069).then(i.bind(i,97069)).then((t=>t.l));a=await t.default({locateFile:t=>(0,r.V)("esri/core/libs/libtess/".concat(t))})}()),o}function l(t,e){const i=Math.max(t.length,n);return a.triangulate(t,e,i)}},95954:(t,e,i)=>{i.d(e,{j:()=>c});var r=i(23895),s=i(41116),n=i(35747),o=i(82653),a=i(78915);class c{static executeEffects(t,e,i,r){const s=(0,a.Tg)(t);let c=new n.z(e);for(const n of t){const t=(0,o.h)(n);t&&(c=t.execute(c,n,1.3333333333333333,i,r,s))}return c}static applyEffects(t,e,i){if(!t)return e;const c=(0,a.Tg)(t);let l,u=new n.z(r.z.fromJSONCIM(e));for(const r of t){const t=(0,o.h)(r);t&&(u=t.execute(u,r,1,null,i,c))}const h=[];let d=null;for(;l=u.next();)h.push(...(0,s.M)(l)),d=l.geometryType;return 0===h.length||null===d?null:"esriGeometryPolygon"===d?{rings:h}:{paths:h}}}},8827:(t,e,i)=>{i.d(e,{i:()=>s});var r=i(82653);class s{static getPlacement(t,e,i,s,n,o){const a=(0,r.W)(i);return a?(-1===e&&t.invertY(),a.execute(t,i,s,n,o)):null}}},82010:(t,e,i)=>{i.d(e,{z:()=>f});var r=i(48202),s=i(94109);function n(t,e){return t.x===e.x&&t.y===e.y}function o(t){if(!t)return;const e=t.length;if(e<=1)return;let i=0;for(let r=1;r<e;r++)n(t[r],t[i])||++i===r||(t[i]=t[r]);t.length=i+1}function a(t,e){return t.x=e.y,t.y=-e.x,t}function c(t,e){return t.x=-e.y,t.y=e.x,t}function l(t,e){return t.x=e.x,t.y=e.y,t}function u(t,e){return t.x=-e.x,t.y=-e.y,t}function h(t){return Math.sqrt(t.x*t.x+t.y*t.y)}function d(t,e){return t.x*e.y-t.y*e.x}function p(t,e){return t.x*e.x+t.y*e.y}function x(t,e,i,r){return t.x=e.x*i+e.y*r,t.y=e.x*r-e.y*i,t}class f{constructor(t,e,i){this._writeVertex=t,this._writeTriangle=e,this._canUseThinTessellation=i,this._prevNormal={x:void 0,y:void 0},this._nextNormal={x:void 0,y:void 0},this._textureNormalLeft={x:0,y:1},this._textureNormalRight={x:0,y:-1},this._textureNormal={x:void 0,y:void 0},this._joinNormal={x:void 0,y:void 0},this._inner={x:void 0,y:void 0},this._outer={x:void 0,y:void 0},this._roundStart={x:void 0,y:void 0},this._roundEnd={x:void 0,y:void 0},this._startBreak={x:void 0,y:void 0},this._endBreak={x:void 0,y:void 0},this._innerPrev={x:void 0,y:void 0},this._innerNext={x:void 0,y:void 0},this._bevelStart={x:void 0,y:void 0},this._bevelEnd={x:void 0,y:void 0},this._bevelMiddle={x:void 0,y:void 0}}tessellate(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this._canUseThinTessellation;o(t),i&&e.halfWidth<s.do&&!e.offset?this._tessellateThin(t,e):this._tessellate(t,e)}_tessellateThin(t,e){if(t.length<2)return;const i=e.wrapDistance||65535;let r=e.initialDistance||0,s=!1,n=t[0].x,o=t[0].y;const a=t.length;for(let c=1;c<a;++c){s&&(s=!1,r=0);let e=t[c].x,a=t[c].y,l=e-n,u=a-o,h=Math.sqrt(l*l+u*u);if(l/=h,u/=h,r+h>i){s=!0;const t=(i-r)/h;h=i-r,e=(1-t)*n+t*e,a=(1-t)*o+t*a,--c}const d=this._writeVertex(n,o,0,0,l,u,u,-l,0,-1,r),p=this._writeVertex(n,o,0,0,l,u,-u,l,0,1,r);r+=h;const x=this._writeVertex(e,a,0,0,l,u,u,-l,0,-1,r),f=this._writeVertex(e,a,0,0,l,u,-u,l,0,1,r);this._writeTriangle(d,p,x),this._writeTriangle(p,x,f),n=e,o=a}}_tessellate(t,e){const i=t[0],s=t[t.length-1],o=n(i,s),f=o?3:2;if(t.length<f)return;const y=e.pixelCoordRatio,m=null!=e.capType?e.capType:r.RL.BUTT,_=null!=e.joinType?e.joinType:r.AH.MITER,g=null!=e.miterLimit?Math.min(e.miterLimit,4):2,v=null!=e.roundLimit?Math.min(e.roundLimit,1.05):1.05,k=null!=e.halfWidth?e.halfWidth:2,w=!!e.textured;let S,b,T,P=null;const E=this._prevNormal,M=this._nextNormal;let N=-1,z=-1;const F=this._joinNormal;let A,L;const D=this._textureNormalLeft,I=this._textureNormalRight,B=this._textureNormal;let R=-1,G=-1;const Y=e.wrapDistance||65535;let U=e.initialDistance||0;const W=this._writeVertex,Z=this._writeTriangle,O=(t,e,i,r,s,n)=>{const o=W(b,T,A,L,i,r,t,e,s,n,U);return R>=0&&G>=0&&o>=0&&Z(R,G,o),R=G,G=o,o};o&&(S=t[t.length-2],M.x=s.x-S.x,M.y=s.y-S.y,z=h(M),M.x/=z,M.y/=z);let C=!1;for(let n=0;n<t.length;++n){if(C&&(C=!1,U=0),S&&(E.x=-M.x,E.y=-M.y,N=z,U+N>Y&&(C=!0)),C){const e=(Y-U)/N;N=Y-U,S={x:(1-e)*S.x+e*t[n].x,y:(1-e)*S.y+e*t[n].y},--n}else S=t[n];b=S.x,T=S.y;const e=n<=0&&!C,i=n===t.length-1;if(e||(U+=N),P=i?o?t[1]:null:t[n+1],P?(M.x=P.x-b,M.y=P.y-T,z=h(M),M.x/=z,M.y/=z):(M.x=void 0,M.y=void 0),!o){if(e){c(F,M),A=F.x,L=F.y,m===r.RL.SQUARE&&(O(-M.y-M.x,M.x-M.y,M.x,M.y,0,-1),O(M.y-M.x,-M.x-M.y,M.x,M.y,0,1)),m===r.RL.ROUND&&(O(-M.y-M.x,M.x-M.y,M.x,M.y,-1,-1),O(M.y-M.x,-M.x-M.y,M.x,M.y,-1,1)),m!==r.RL.ROUND&&m!==r.RL.BUTT||(O(-M.y,M.x,M.x,M.y,0,-1),O(M.y,-M.x,M.x,M.y,0,1));continue}if(i){a(F,E),A=F.x,L=F.y,m!==r.RL.ROUND&&m!==r.RL.BUTT||(O(E.y,-E.x,-E.x,-E.y,0,-1),O(-E.y,E.x,-E.x,-E.y,0,1)),m===r.RL.SQUARE&&(O(E.y-E.x,-E.x-E.y,-E.x,-E.y,0,-1),O(-E.y-E.x,E.x-E.y,-E.x,-E.y,0,1)),m===r.RL.ROUND&&(O(E.y-E.x,-E.x-E.y,-E.x,-E.y,1,-1),O(-E.y-E.x,E.x-E.y,-E.x,-E.y,1,1));continue}}let s,f,W=-d(E,M);if(Math.abs(W)<.01)p(E,M)>0?(F.x=E.x,F.y=E.y,W=1,s=Number.MAX_VALUE,f=!0):(c(F,M),W=1,s=1,f=!1);else{F.x=(E.x+M.x)/W,F.y=(E.y+M.y)/W,s=h(F);const t=(s-1)*k*y;f=s>4||t>N&&t>z}A=F.x,L=F.y;let Z=_;switch(_){case r.AH.BEVEL:s<1.05&&(Z=r.AH.MITER);break;case r.AH.ROUND:s<v&&(Z=r.AH.MITER);break;case r.AH.MITER:s>g&&(Z=r.AH.BEVEL)}switch(Z){case r.AH.MITER:if(O(F.x,F.y,-E.x,-E.y,0,-1),O(-F.x,-F.y,-E.x,-E.y,0,1),i)break;if(w){const t=C?0:U;R=this._writeVertex(b,T,A,L,M.x,M.y,F.x,F.y,0,-1,t),G=this._writeVertex(b,T,A,L,M.x,M.y,-F.x,-F.y,0,1,t)}break;case r.AH.BEVEL:{const t=W<0;let e,r,s,n;if(t){const t=R;R=G,G=t,e=D,r=I}else e=I,r=D;if(f)s=t?c(this._innerPrev,E):a(this._innerPrev,E),n=t?a(this._innerNext,M):c(this._innerNext,M);else{const e=t?u(this._inner,F):l(this._inner,F);s=e,n=e}const o=t?a(this._bevelStart,E):c(this._bevelStart,E);O(s.x,s.y,-E.x,-E.y,e.x,e.y);const h=O(o.x,o.y,-E.x,-E.y,r.x,r.y);if(i)break;const d=t?c(this._bevelEnd,M):a(this._bevelEnd,M);if(f){const t=this._writeVertex(b,T,A,L,-E.x,-E.y,0,0,0,0,U);R=this._writeVertex(b,T,A,L,M.x,M.y,n.x,n.y,e.x,e.y,U),G=this._writeVertex(b,T,A,L,M.x,M.y,d.x,d.y,r.x,r.y,U),this._writeTriangle(h,t,G)}else{if(w){const t=this._bevelMiddle;t.x=(o.x+d.x)/2,t.y=(o.y+d.y)/2,x(B,t,-E.x,-E.y),O(t.x,t.y,-E.x,-E.y,B.x,B.y),x(B,t,M.x,M.y),R=this._writeVertex(b,T,A,L,M.x,M.y,t.x,t.y,B.x,B.y,U),G=this._writeVertex(b,T,A,L,M.x,M.y,n.x,n.y,e.x,e.y,U)}else{const t=R;R=G,G=t}O(d.x,d.y,M.x,M.y,r.x,r.y)}if(t){const t=R;R=G,G=t}break}case r.AH.ROUND:{const t=W<0;let e,r;if(t){const t=R;R=G,G=t,e=D,r=I}else e=I,r=D;const n=t?u(this._inner,F):l(this._inner,F);let o,h;f?(o=t?c(this._innerPrev,E):a(this._innerPrev,E),h=t?a(this._innerNext,M):c(this._innerNext,M)):(o=n,h=n);const d=t?a(this._roundStart,E):c(this._roundStart,E),y=t?c(this._roundEnd,M):a(this._roundEnd,M),m=O(o.x,o.y,-E.x,-E.y,e.x,e.y),_=O(d.x,d.y,-E.x,-E.y,r.x,r.y);if(i)break;const g=this._writeVertex(b,T,A,L,-E.x,-E.y,0,0,0,0,U);f||this._writeTriangle(R,G,g);const v=u(this._outer,n),k=this._writeVertex(b,T,A,L,M.x,M.y,y.x,y.y,r.x,r.y,U);let S,P;const N=s>2;if(N){let e;s!==Number.MAX_VALUE?(v.x/=s,v.y/=s,e=p(E,v),e=(s*(e*e-1)+1)/e):e=-1,S=t?a(this._startBreak,E):c(this._startBreak,E),S.x+=E.x*e,S.y+=E.y*e,P=t?c(this._endBreak,M):a(this._endBreak,M),P.x+=M.x*e,P.y+=M.y*e}x(B,v,-E.x,-E.y);const z=this._writeVertex(b,T,A,L,-E.x,-E.y,v.x,v.y,B.x,B.y,U);x(B,v,M.x,M.y);const Y=w?this._writeVertex(b,T,A,L,M.x,M.y,v.x,v.y,B.x,B.y,U):z,Z=g,C=w?this._writeVertex(b,T,A,L,M.x,M.y,0,0,0,0,U):g;let V=-1,H=-1;if(N&&(x(B,S,-E.x,-E.y),V=this._writeVertex(b,T,A,L,-E.x,-E.y,S.x,S.y,B.x,B.y,U),x(B,P,M.x,M.y),H=this._writeVertex(b,T,A,L,M.x,M.y,P.x,P.y,B.x,B.y,U)),w?N?(this._writeTriangle(Z,_,V),this._writeTriangle(Z,V,z),this._writeTriangle(C,Y,H),this._writeTriangle(C,H,k)):(this._writeTriangle(Z,_,z),this._writeTriangle(C,Y,k)):N?(this._writeTriangle(g,_,V),this._writeTriangle(g,V,H),this._writeTriangle(g,H,k)):(this._writeTriangle(g,_,z),this._writeTriangle(g,Y,k)),f?(R=this._writeVertex(b,T,A,L,M.x,M.y,h.x,h.y,e.x,e.y,U),G=k):(R=w?this._writeVertex(b,T,A,L,M.x,M.y,h.x,h.y,e.x,e.y,U):m,this._writeTriangle(R,C,k),G=k),t){const t=R;R=G,G=t}break}}}}}},86419:(t,e,i)=>{i.d(e,{dx:()=>W,tZ:()=>U,bT:()=>G,so:()=>Y});i(79347);var r=i(48035),s=i(40316),n=i(80457),o=i(94109);i(93169);function a(t,e,i,r,s,n,o){A=0;const a=(r-i)*n,l=s&&s.length,h=l?(s[0]-i)*n:a;let d,p,x,f,m,_=c(e,i,r,0,h,n,!0);if(_&&_.next!==_.prev){if(l&&(_=y(e,i,r,s,_,n)),a>80*n){d=x=e[0+i*n],p=f=e[1+i*n];for(let t=n;t<h;t+=n){const r=e[t+i*n],s=e[t+1+i*n];d=Math.min(d,r),p=Math.min(p,s),x=Math.max(x,r),f=Math.max(f,s)}m=Math.max(x-d,f-p),m=0!==m?1/m:0}u(_,t,n,d,p,m,o,0)}}function c(t,e,i,r,s,n,o){let a;if(o===function(t,e,i,r,s,n){let o=0;for(let a=r,c=s-n;a<s;a+=n)o+=(t[c+e*n]-t[a+e*n])*(t[a+1+e*n]+t[c+1+e*n]),c=a;return o}(t,e,0,r,s,n)>0)for(let c=r;c<s;c+=n)a=p(c+e*n,t[c+e*n],t[c+1+e*n],a);else for(let c=s-n;c>=r;c-=n)a=p(c+e*n,t[c+e*n],t[c+1+e*n],a);return a&&b(a,a.next)&&(x(a),a=a.next),a}function l(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;if(!t)return t;let i,r=t;do{if(i=!1,r.steiner||!b(r,r.next)&&0!==g(r.prev,r,r.next))r=r.next;else{if(x(r),r=e=r.prev,r===r.next)break;i=!0}}while(i||r!==e);return e}function u(t,e,i,r,s,n,o,a){if(!t)return;!a&&n&&(t=_(t,r,s,n));let c=t;for(;t.prev!==t.next;){const p=t.prev,f=t.next;if(n?d(t,r,s,n):h(t))e.push(p.index/i+o),e.push(t.index/i+o),e.push(f.index/i+o),x(t),t=f.next,c=f.next;else if((t=f)===c){a?1===a?u(t=P(t,e,i,o),e,i,r,s,n,o,2):2===a&&E(t,e,i,r,s,n,o):u(l(t),e,i,r,s,n,o,1);break}}}function h(t){const e=t.prev,i=t,r=t.next;if(g(e,i,r)>=0)return!1;let s=t.next.next;const n=s;let o=0;for(;s!==t.prev&&(0===o||s!==n);){if(o++,k(e.x,e.y,i.x,i.y,r.x,r.y,s.x,s.y)&&g(s.prev,s,s.next)>=0)return!1;s=s.next}return!0}function d(t,e,i,r){const s=t.prev,n=t,o=t.next;if(g(s,n,o)>=0)return!1;const a=s.x<n.x?s.x<o.x?s.x:o.x:n.x<o.x?n.x:o.x,c=s.y<n.y?s.y<o.y?s.y:o.y:n.y<o.y?n.y:o.y,l=s.x>n.x?s.x>o.x?s.x:o.x:n.x>o.x?n.x:o.x,u=s.y>n.y?s.y>o.y?s.y:o.y:n.y>o.y?n.y:o.y,h=S(a,c,e,i,r),d=S(l,u,e,i,r);let p=t.prevZ,x=t.nextZ;for(;p&&p.z>=h&&x&&x.z<=d;){if(p!==t.prev&&p!==t.next&&k(s.x,s.y,n.x,n.y,o.x,o.y,p.x,p.y)&&g(p.prev,p,p.next)>=0)return!1;if(p=p.prevZ,x!==t.prev&&x!==t.next&&k(s.x,s.y,n.x,n.y,o.x,o.y,x.x,x.y)&&g(x.prev,x,x.next)>=0)return!1;x=x.nextZ}for(;p&&p.z>=h;){if(p!==t.prev&&p!==t.next&&k(s.x,s.y,n.x,n.y,o.x,o.y,p.x,p.y)&&g(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;x&&x.z<=d;){if(x!==t.prev&&x!==t.next&&k(s.x,s.y,n.x,n.y,o.x,o.y,x.x,x.y)&&g(x.prev,x,x.next)>=0)return!1;x=x.nextZ}return!0}function p(t,e,i,r){const s=z.create(t,e,i);return r?(s.next=r.next,s.prev=r,r.next.prev=s,r.next=s):(s.prev=s,s.next=s),s}function x(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function f(t){let e=t,i=t;do{(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next}while(e!==t);return i}function y(t,e,i,r,s,n){const o=new Array;for(let a=0,l=r.length;a<l;a++){const s=c(t,e,0,r[a]*n,a<l-1?r[a+1]*n:i*n,n,!1);s===s.next&&(s.steiner=!0),o.push(f(s))}o.sort(T);for(const a of o)s=m(a,s);return s}function m(t,e){const i=function(t,e){let i=e;const r=t.x,s=t.y;let n,o=-1/0;do{if(s<=i.y&&s>=i.next.y&&i.next.y!==i.y){const t=i.x+(s-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(t<=r&&t>o){if(o=t,t===r){if(s===i.y)return i;if(s===i.next.y)return i.next}n=i.x<i.next.x?i:i.next}}i=i.next}while(i!==e);if(!n)return null;if(r===o)return n.prev;const a=n,c=n.x,l=n.y;let u,h=1/0;for(i=n.next;i!==a;)r>=i.x&&i.x>=c&&r!==i.x&&k(s<l?r:o,s,c,l,s<l?o:r,s,i.x,i.y)&&(u=Math.abs(s-i.y)/(r-i.x),(u<h||u===h&&i.x>n.x)&&w(i,t)&&(n=i,h=u)),i=i.next;return n}(t,e);if(!i)return e;const r=N(i,t);return l(r,r.next),l(i,i.next)}function _(t,e,i,r){let s;for(;s!==t;s=s.next){if(s=s||t,null===s.z&&(s.z=S(s.x,s.y,e,i,r)),s.prev.next!==s||s.next.prev!==s)return s.prev.next=s,s.next.prev=s,_(t,e,i,r);s.prevZ=s.prev,s.nextZ=s.next}return t.prevZ.nextZ=null,t.prevZ=null,function(t){let e,i=1;for(;;){let r,s=t;t=null,e=null;let n=0;for(;s;){n++,r=s;let o=0;for(;o<i&&r;o++)r=r.nextZ;let a=i;for(;o>0||a>0&&r;){let i;0===o?(i=r,r=r.nextZ,a--):0!==a&&r?s.z<=r.z?(i=s,s=s.nextZ,o--):(i=r,r=r.nextZ,a--):(i=s,s=s.nextZ,o--),e?e.nextZ=i:t=i,i.prevZ=e,e=i}s=r}if(e.nextZ=null,i*=2,n<2)return t}}(t)}function g(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function v(t,e,i,r){return!!(b(t,e)&&b(i,r)||b(t,r)&&b(i,e))||g(t,e,i)>0!=g(t,e,r)>0&&g(i,r,t)>0!=g(i,r,e)>0}function k(t,e,i,r,s,n,o,a){return(s-o)*(e-a)-(t-o)*(n-a)>=0&&(t-o)*(r-a)-(i-o)*(e-a)>=0&&(i-o)*(n-a)-(s-o)*(r-a)>=0}function w(t,e){return g(t.prev,t,t.next)<0?g(t,e,t.next)>=0&&g(t,t.prev,e)>=0:g(t,e,t.prev)<0||g(t,t.next,e)<0}function S(t,e,i,r,s){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*s)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*s)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function b(t,e){return t.x===e.x&&t.y===e.y}function T(t,e){return t.x-e.x}function P(t,e,i,r){let s=t;do{const n=s.prev,o=s.next.next;!b(n,o)&&v(n,s,s.next,o)&&w(n,o)&&w(o,n)&&(e.push(n.index/i+r),e.push(s.index/i+r),e.push(o.index/i+r),x(s),x(s.next),s=t=o),s=s.next}while(s!==t);return s}function E(t,e,i,r,s,n,o){let a=t;do{let t=a.next.next;for(;t!==a.prev;){if(a.index!==t.index&&M(a,t)){let c=N(a,t);return a=l(a,a.next),c=l(c,c.next),u(a,e,i,r,s,n,o,0),void u(c,e,i,r,s,n,o,0)}t=t.next}a=a.next}while(a!==t)}function M(t,e){return t.next.index!==e.index&&t.prev.index!==e.index&&!function(t,e){let i=t;do{if(i.index!==t.index&&i.next.index!==t.index&&i.index!==e.index&&i.next.index!==e.index&&v(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}(t,e)&&w(t,e)&&w(e,t)&&function(t,e){let i=t,r=!1;const s=(t.x+e.x)/2,n=(t.y+e.y)/2;do{i.y>n!=i.next.y>n&&i.next.y!==i.y&&s<(i.next.x-i.x)*(n-i.y)/(i.next.y-i.y)+i.x&&(r=!r),i=i.next}while(i!==t);return r}(t,e)}function N(t,e){const i=z.create(t.index,t.x,t.y),r=z.create(e.index,e.x,e.y),s=t.next,n=e.prev;return t.next=e,e.prev=t,i.next=s,s.prev=i,r.next=i,i.prev=r,n.next=r,r.prev=n,r}class z{constructor(){this.index=0,this.x=0,this.y=0,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}static create(t,e,i){const r=A<F.length?F[A++]:new z;return r.index=t,r.x=e,r.y=i,r.prev=null,r.next=null,r.z=null,r.prevZ=null,r.nextZ=null,r.steiner=!1,r}}const F=[];let A=0;for(let Z=0;Z<8096;Z++)F.push(new z);const L=1e-5,D=new s.bN(0,0,0,1,0),I=new s.bN(0,0,0,1,0);function B(t,e,i){let r=0;for(let s=1;s<i;s++){const i=t[2*(e+s-1)],n=t[2*(e+s-1)+1];r+=(t[2*(e+s)]-i)*(t[2*(e+s)+1]+n)}return r}function R(t,e,i,r,s){let n=0;for(let o=i;o<r;o+=3){const i=2*(t[o]-s),r=2*(t[o+1]-s),a=2*(t[o+2]-s);n+=Math.abs((e[i]-e[a])*(e[r+1]-e[i+1])-(e[i]-e[r])*(e[a+1]-e[i+1]))}return n}function G(t,e){const{coords:i,lengths:r}=e,s=t;let n=0;for(let o=0;o<r.length;){let t=o,e=r[o],c=B(i,n,e);const l=[];for(;++t<r.length;){const s=r[t],o=B(i,n+e,s);if(!(o>0))break;c+=o,l.push(n+e),e+=s}const u=s.length;a(s,i,n,n+e,l,2,0);const h=R(s,i,u,s.length,0),d=Math.abs(c);if(Math.abs((h-d)/Math.max(1e-7,d))>L)return s.length=0,!1;o=t,n+=e}return!0}function Y(t){const{coords:e,lengths:i}=t,{buffer:s}=(0,r.b)(e,i);return s}function U(t,e){if(null==t)return null;if(!function(t,e,i){let r=0;for(let s=0;s<t.lengths.length;s++){const n=t.lengths[s];for(let s=0;s<n;s++){const n=t.coords[2*(s+r)],o=t.coords[2*(s+r)+1];if(n<e||n>i||o<e||o>i)return!0}r+=n}return!1}(t,-128,o.i9+128))return t;D.setPixelMargin(e),D.reset(s.Vl.Polygon);let i=0;for(let s=0;s<t.lengths.length;s++){const e=t.lengths[s];let r=t.coords[2*(0+i)],n=t.coords[2*(0+i)+1];D.moveTo(r,n);for(let s=1;s<e;s++)r=t.coords[2*(s+i)],n=t.coords[2*(s+i)+1],D.lineTo(r,n);D.close(),i+=e}const r=D.result(!1);if(!r)return null;const a=[],c=[];for(const s of r){let t=0;for(const e of s)c.push(e.x),c.push(e.y),t++;a.push(t)}return new n.Z(a,c)}function W(t,e){I.setPixelMargin(e);const i=I,r=-e,n=o.i9+e;let a=[],c=!1;if(!t.nextPath())return null;let l=!0;for(;l;){t.seekPathStart();const e=[];if(!t.pathSize)return null;i.reset(s.Vl.LineString),t.nextPoint();let o=t.x,u=t.y;if(c)i.moveTo(o,u);else{if(o<r||o>n||u<r||u>n){c=!0;continue}e.push({x:o,y:u})}let h=!1;for(;t.nextPoint();)if(o=t.x,u=t.y,c)i.lineTo(o,u);else{if(o<r||o>n||u<r||u>n){h=!0;break}e.push({x:o,y:u})}if(h)c=!0;else{if(c){const t=i.resultWithStarts();if(t)for(const e of t)a.push(e)}else a.push({line:e,start:0});l=t.nextPath(),c=!1}}return a=a.filter((t=>t.line.length>1)),0===a.length?null:a}D.setExtent(o.i9),I.setExtent(o.i9)},755:(t,e,i)=>{i.d(e,{Z:()=>o});var r=i(53352),s=i(8548);const n={createComputedParams:t=>t,optionalAttributes:{},attributes:{id:{type:s.g.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:s.g.UNSIGNED_BYTE,count:1},pos:{type:s.g.SHORT,count:2,pack:"position",packPrecisionFactor:10},inverseArea:{type:s.g.FLOAT,count:1,packTessellation:t=>{let{inverseArea:e}=t;return e}}}};class o extends r.r{constructor(){super(...arguments),this.vertexSpec=n}createTesselationParams(t){return{inverseArea:1/t.readGeometryArea()}}}},53352:(t,e,i)=>{i.d(e,{r:()=>c});var r=i(93169),s=i(48035),n=i(86419),o=i(2744);const a=(0,r.Z)("featurelayer-fast-triangulation-enabled");class c extends o.c{async loadDependencies(){await Promise.all([super.loadDependencies(),(0,s.j)()])}_write(t,e,i){var r;const s=null!==(r=null===i||void 0===i?void 0:i.asOptimized())&&void 0!==r?r:e.readGeometryForDisplay(),n=this._clip(s);n&&(t.recordStart(this.instanceId,this.attributeLayout),this._writeGeometry(t,e,n),t.recordEnd())}_clip(t){if(!t)return null;const e=this.hasEffects;return(0,n.tZ)(t,e?256:8)}_writeGeometry(t,e,i){const r=i.maxLength>100,s=[],o=this.createTesselationParams(e);if(!r&&a&&(0,n.bT)(s,i))return void(s.length&&this._writeVertices(t,e,i.coords,o,s));const c=(0,n.so)(i);this._writeVertices(t,e,c,o)}_writeVertices(t,e,i,r,s){const n=e.getDisplayId(),o=t.vertexCount(),a=this.hasEffects;let c=0;if(s)for(const l of s){const e=i[2*l],s=i[2*l+1];a&&t.recordBounds(e,s,0,0),this._writeVertex(t,n,e,s,r),c++}else for(let l=0;l<i.length;l+=2){const e=Math.round(i[l]),s=Math.round(i[l+1]);a&&t.recordBounds(e,s,0,0),this._writeVertex(t,n,e,s,r),c++}t.indexEnsureSize(c);for(let l=0;l<c;l++)t.indexWrite(l+o)}}},94538:(t,e,i)=>{i.d(e,{MG:()=>h,MW:()=>u,Mb:()=>d,h5:()=>p});var r=i(1413),s=i(17842),n=i(99201),o=i(81308),a=i(72516),c=i(17326),l=i(8548);function u(t){const{sprite:e,aspectRatio:i,scaleProportionally:r}=t,n=(0,s.F2)(t.height),o=n>0?n:e.height;let a=n*i;return a<=0?a=e.width:r&&(a*=e.width/e.height),{width:a,height:o}}function h(t){const{applyRandomOffset:e,sampleAlphaOnly:i}=t;return(0,o.u)([[c.Ux,e],[c.GS,i]])}const d={createComputedParams:t=>t,optionalAttributes:a.w.optionalAttributes,attributes:(0,r.Z)((0,r.Z)({},a.w.attributes),{},{bitset:{count:1,type:l.g.UNSIGNED_BYTE,pack:h},width:{count:1,type:l.g.HALF_FLOAT,pack:t=>u(t).width},height:{count:1,type:l.g.HALF_FLOAT,pack:t=>u(t).height},offset:{count:2,type:l.g.HALF_FLOAT,pack:t=>{let{offsetX:e,offsetY:i}=t;return[(0,s.F2)(e),-(0,s.F2)(i)]}},scale:{count:2,type:l.g.UNSIGNED_BYTE,packPrecisionFactor:16,pack:t=>{let{scaleX:e,scaleY:i}=t;return[e,i]}},angle:{count:1,type:l.g.UNSIGNED_BYTE,pack:t=>{let{angle:e}=t;return(0,n.s5)(e)}}})};class p extends a.H{constructor(){super(...arguments),this.vertexSpec=d}}},61669:(t,e,i)=>{i.d(e,{f:()=>m});var r=i(1413),s=i(17842),n=i(23895),o=i(94538),a=i(81308),c=i(35783),l=i(78825),u=i(17326),h=i(8548);const d=o.Mb,p=c.OQ,x={createComputedParams:t=>t,optionalAttributes:d.optionalAttributes,attributes:(0,r.Z)((0,r.Z)({},d.attributes),{},{bitset:{type:h.g.UNSIGNED_BYTE,count:1,pack:t=>(0,o.MG)(t)},aux1:{count:1,type:h.g.HALF_FLOAT,pack:t=>(0,o.MW)(t).width},aux2:{count:1,type:h.g.HALF_FLOAT,pack:t=>(0,o.MW)(t).height},aux3:{count:2,type:h.g.HALF_FLOAT,pack:t=>{let{offsetX:e,offsetY:i}=t;return[(0,s.F2)(e),(0,s.F2)(i)]}},aux4:{count:2,type:h.g.UNSIGNED_BYTE,pack:t=>{let{scaleX:e,scaleY:i}=t;return[e*l.$1,i*l.$1]}}})},f={createComputedParams:t=>t,optionalAttributes:d.optionalAttributes,attributes:(0,r.Z)((0,r.Z)({},d.attributes),{},{color:p.attributes.color,bitset:{type:h.g.UNSIGNED_BYTE,count:1,pack:t=>(0,a.u)([[u.WD,!0]])},aux1:{count:1,type:h.g.HALF_FLOAT,pack:t=>(0,s.F2)(.5*t.width)},aux2:{count:1,type:h.g.HALF_FLOAT,pack:t=>(0,s.F2)(.5*t.referenceWidth)},aux3:{count:2,type:h.g.HALF_FLOAT,packTessellation:t=>{let{extrusionOffsetX:e,extrusionOffsetY:i}=t;return[e,i]}},aux4:{count:2,type:h.g.UNSIGNED_BYTE,packTessellation:t=>{let{normalX:e,normalY:i}=t;return[e*l.$1+l.NS,i*l.$1+l.NS]}}})};class y extends c.B2{constructor(){super(...arguments),this.vertexSpec=f}}class m extends c.nT{constructor(){super(...arguments),this.vertexSpec=x}_createOutlineWriter(t,e,i,r){return new y(t,e,i,r)}_write(t,e,i){var r,s;const o=null!==(r=null===i||void 0===i?void 0:i.asOptimized())&&void 0!==r?r:e.readGeometryForDisplay(),a=this._clip(o);if(!a)return;const c=null===(s=this.evaluatedMeshParams.sprite)||void 0===s?void 0:s.textureBinding;t.recordStart(this.instanceId,this.attributeLayout,c),this._writeGeometry(t,e,a),this._lineMeshWriter.writeLineVertices(t,n.z.fromOptimizedCIM(a,"esriGeometryPolyline"),e),t.recordEnd()}ensurePacked(t,e,i){super.ensurePacked(t,e,i),this._lineMeshWriter.ensurePacked(t,e,i)}enqueueRequest(t,e,i){super.enqueueRequest(t,e,i),this._lineMeshWriter.enqueueRequest(t,e,i)}async loadDependencies(){await Promise.all([super.loadDependencies(),this._lineMeshWriter.loadDependencies()])}}},11486:(t,e,i)=>{i.d(e,{Q:()=>c,a:()=>a});var r=i(94109),s=i(53352),n=i(81308),o=i(8548);const a={createComputedParams:t=>t,optionalAttributes:{zoomRange:{type:o.g.SHORT,count:2,packPrecisionFactor:r.JS,pack:(t,e)=>{let{scaleInfo:i}=t,{tileInfo:r}=e;return(0,n._f)(i,r)}}},attributes:{id:{type:o.g.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:o.g.UNSIGNED_BYTE,count:1},pos:{type:o.g.SHORT,count:2,pack:"position",packPrecisionFactor:10},color:{type:o.g.UNSIGNED_BYTE,count:4,normalized:!0,pack:t=>{let{color:e}=t;return(0,n.G7)(e)}}}};class c extends s.r{constructor(){super(...arguments),this.vertexSpec=a}createTesselationParams(t){return null}}},35783:(t,e,i)=>{i.d(e,{B2:()=>x,OQ:()=>p,nT:()=>f,s9:()=>d});var r=i(1413),s=i(23895),n=i(86419),o=i(11486),a=i(81308),c=i(7467),l=i(89226),u=i(17326),h=i(8548);const d={createComputedParams:t=>t,optionalAttributes:c.bT.optionalAttributes,attributes:(0,r.Z)((0,r.Z)({},c.bT.attributes),{},{bitset:{type:h.g.UNSIGNED_BYTE,count:1,pack:t=>0},color:{type:h.g.UNSIGNED_BYTE,count:4,normalized:!0,pack:t=>{let{color:e}=t;return(0,a.G7)(e)}}})},p={createComputedParams:t=>t,optionalAttributes:c.bT.optionalAttributes,attributes:(0,r.Z)((0,r.Z)({},c.bT.attributes),{},{bitset:{type:h.g.UNSIGNED_BYTE,count:1,pack:t=>(0,a.u)([[u.WD,!0]])},color:{type:h.g.UNSIGNED_BYTE,count:4,normalized:!0,pack:t=>{let{outlineColor:e}=t;return(0,a.G7)(e)}}})};class x extends c.ti{constructor(){super(...arguments),this.vertexSpec=p}}class f extends o.Q{constructor(t,e,i,r){super(t,e,i,r),this.vertexSpec=d,this._lineMeshWriter=this._createOutlineWriter(t,e,i,r)}_createOutlineWriter(t,e,i,r){return new x(t,e,i,r)}_write(t,e,i){var r;const n=null!==(r=null===i||void 0===i?void 0:i.asOptimized())&&void 0!==r?r:e.readGeometryForDisplay(),o=this._clip(n);o&&(t.recordStart(this.instanceId,this.attributeLayout),this._writeGeometry(t,e,o),this._lineMeshWriter.writeLineVertices(t,s.z.fromOptimizedCIM(o,"esriGeometryPolyline"),e),t.recordEnd())}_clip(t){return t?(0,n.tZ)(t,(0,l.b8)(this.evaluatedMeshParams)):null}ensurePacked(t,e,i){super.ensurePacked(t,e,i),this._lineMeshWriter.ensurePacked(t,e,i)}enqueueRequest(t,e,i){super.enqueueRequest(t,e,i),this._lineMeshWriter.enqueueRequest(t,e,i)}async loadDependencies(){await Promise.all([super.loadDependencies(),this._lineMeshWriter.loadDependencies()])}}},72516:(t,e,i)=>{i.d(e,{H:()=>c,w:()=>a});var r=i(1413),s=i(94109),n=i(11486),o=i(8548);const a={createComputedParams:t=>t,optionalAttributes:n.a.optionalAttributes,attributes:(0,r.Z)((0,r.Z)({},n.a.attributes),{},{tlbr:{count:4,type:o.g.UNSIGNED_SHORT,pack:t=>{let{sprite:e}=t;const{rect:i,width:r,height:n}=e,o=i.x+s.s4,a=i.y+s.s4;return[o,a,o+r,a+n]}},inverseRasterizationScale:{count:1,type:o.g.BYTE,packPrecisionFactor:16,pack:t=>{let{sprite:e}=t;return 1/e.rasterizationScale}}})};class c extends n.Q{constructor(){super(...arguments),this.vertexSpec=a}_write(t,e,i){var r,s;const n=null!==(r=null===i||void 0===i?void 0:i.asOptimized())&&void 0!==r?r:e.readGeometryForDisplay(),o=this._clip(n);if(!o)return;const a=null===(s=this.evaluatedMeshParams.sprite)||void 0===s?void 0:s.textureBinding;t.recordStart(this.instanceId,this.attributeLayout,a),this._writeGeometry(t,e,o),t.recordEnd()}}},5964:(t,e,i)=>{i.d(e,{i:()=>u});var r=i(1413),s=i(23895),n=i(35783),o=i(72516);const a={optionalAttributes:o.w.optionalAttributes,createComputedParams:t=>t,attributes:(0,r.Z)((0,r.Z)({},o.w.attributes),n.s9.attributes)},c={optionalAttributes:o.w.optionalAttributes,createComputedParams:t=>t,attributes:(0,r.Z)((0,r.Z)({},o.w.attributes),n.OQ.attributes)};class l extends n.B2{constructor(){super(...arguments),this.vertexSpec=c}}class u extends n.nT{constructor(){super(...arguments),this.vertexSpec=a}_createOutlineWriter(t,e,i,r){return new l(t,e,i,r)}_write(t,e,i){var r,n;const o=null!==(r=null===i||void 0===i?void 0:i.asOptimized())&&void 0!==r?r:e.readGeometryForDisplay(),a=this._clip(o);if(!a)return;const c=null===(n=this.evaluatedMeshParams.sprite)||void 0===n?void 0:n.textureBinding;t.recordStart(this.instanceId,this.attributeLayout,c),this._writeGeometry(t,e,a),this._lineMeshWriter.writeLineVertices(t,s.z.fromOptimizedCIM(a,"esriGeometryPolyline"),e),t.recordEnd()}ensurePacked(t,e,i){super.ensurePacked(t,e,i),this._lineMeshWriter.ensurePacked(t,e,i)}enqueueRequest(t,e,i){super.enqueueRequest(t,e,i),this._lineMeshWriter.enqueueRequest(t,e,i)}async loadDependencies(){await Promise.all([super.loadDependencies(),this._lineMeshWriter.loadDependencies()])}}},81308:(t,e,i)=>{i.d(e,{G7:()=>p,L:()=>x,Lq:()=>f,NF:()=>h,QS:()=>y,_f:()=>u,kU:()=>m,u:()=>d});var r=i(51995),s=i(10064),n=i(32718),o=i(48202);const a=()=>n.Z.getLogger("esri.views.2d.engine.webgl.shaderGraph.techniques.meshWriterUtils"),c=0,l=100;function u(t,e){return[!(null===t||void 0===t||!t.minScale)&&e.scaleToZoom(t.minScale)||c,!(null===t||void 0===t||!t.maxScale)&&e.scaleToZoom(t.maxScale)||l]}function h(t){return 1<<t}function d(t){let e=0;for(const[i,r]of t)r&&(e|=1<<i);return e}function p(t){let e;if(!t)return[0,0,0,0];if("string"==typeof t){const i=r.Z.fromString(t);if(!i)return a().errorOnce(new s.Z("mapview:mesh-processing","Unable to parse string into color",{color:t})),[0,0,0,0];e=i.toArray()}else e=t;const[i,n,o,c]=e;return[i*(c/255),n*(c/255),o*(c/255),c]}function x(t){switch(t){case"butt":case o.kP.Butt:return o.RL.BUTT;case"round":case o.kP.Round:return o.RL.ROUND;case"square":case o.kP.Square:return o.RL.SQUARE}}function f(t){switch(t){case"bevel":case o.r4.Bevel:return o.AH.BEVEL;case"miter":case o.r4.Miter:return o.AH.MITER;case"round":case o.r4.Round:return o.AH.ROUND}}function y(t,e){return Math.round(Math.min(Math.sqrt(t*e),255))}function m(t,e){return Math.round(t*e)/e}},69986:(t,e,i)=>{i.d(e,{E:()=>o});var r=i(2744),s=i(8548);const n={createComputedParams:t=>t,optionalAttributes:{},attributes:{pos:{type:s.g.SHORT,count:2,pack:"position",packPrecisionFactor:10},id:{type:s.g.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:s.g.UNSIGNED_BYTE,count:1},offset:{type:s.g.BYTE,count:2,packAlternating:{count:4,pack:()=>[[-1,-1],[1,-1],[-1,1],[1,1]]}}}};class o extends r.c{constructor(){super(...arguments),this.vertexSpec=n}_write(t,e){t.recordStart(this.instanceId,this.attributeLayout);const i=e.getDisplayId();if("esriGeometryPoint"===e.geometryType){const r=e.readXForDisplay(),s=e.readYForDisplay();this._writeQuad(t,i,r,s)}else if("esriGeometryMultipoint"===e.geometryType){const r=e.readGeometryForDisplay();null===r||void 0===r||r.forEachVertex(((e,r)=>{e>=0&&e<=512&&r>=0&&r<=512&&this._writeQuad(t,i,e,r)}))}t.recordEnd()}_writeQuad(t,e,i,r){const s=t.vertexCount();this._writeVertex(t,e,i,r),t.indexWrite(s+0),t.indexWrite(s+1),t.indexWrite(s+2),t.indexWrite(s+1),t.indexWrite(s+3),t.indexWrite(s+2)}}},7467:(t,e,i)=>{i.d(e,{bT:()=>p,ti:()=>f});var r=i(17842),s=i(23895),n=i(94109),o=i(82010),a=i(86419),c=i(81308),l=i(2744),u=i(89226),h=i(8548);class d{constructor(){this.extrusionOffsetX=0,this.extrusionOffsetY=0,this.normalX=0,this.normalY=0,this.directionX=0,this.directionY=0,this.distance=0}}const p={createComputedParams:t=>t,optionalAttributes:{zoomRange:{type:h.g.SHORT,count:2,packPrecisionFactor:n.JS,pack:(t,e)=>{let{scaleInfo:i}=t,{tileInfo:r}=e;return(0,c._f)(i,r)}}},attributes:{id:{type:h.g.UNSIGNED_BYTE,count:3,pack:"id"},pos:{type:h.g.SHORT,count:2,pack:"position",packPrecisionFactor:10},bitset:{type:h.g.UNSIGNED_BYTE,count:1},color:{type:h.g.UNSIGNED_BYTE,count:4,normalized:!0,pack:t=>{let{color:e}=t;return(0,c.G7)(e)}},offset:{type:h.g.BYTE,count:2,packPrecisionFactor:16,packTessellation:t=>{let{extrusionOffsetX:e,extrusionOffsetY:i}=t;return[(0,c.kU)(e,16),(0,c.kU)(i,16)]}},normal:{type:h.g.BYTE,count:2,packPrecisionFactor:16,packTessellation:t=>{let{normalX:e,normalY:i}=t;return[(0,c.kU)(e,16),(0,c.kU)(i,16)]}},halfWidth:{type:h.g.HALF_FLOAT,count:1,pack:t=>{let{width:e}=t;return(0,r.F2)(.5*e)}},referenceHalfWidth:{type:h.g.HALF_FLOAT,count:1,pack:t=>{let{referenceWidth:e}=t;return(0,r.F2)(.5*e)}}}};class x{constructor(){this.id=0,this.bitset=0,this.indexCount=0,this.vertexCount=0,this.vertexFrom=0,this.vertexBounds=0}}class f extends l.c{constructor(t,e,i,r){super(t,e,i,r),this.vertexSpec=p,this._currentWrite=new x,this._tessellationOptions={halfWidth:0,pixelCoordRatio:1,offset:0,wrapDistance:65535,textured:!1},this._tessParams=new d,this._initializeTessellator()}writeLineVertices(t,e,i){const r=this._getLines(e);null!=r&&this._writeVertices(t,i,r)}_initializeTessellator(){this._lineTessellator=new o.z(this._writeTesselatedVertex.bind(this),this._writeTriangle.bind(this),!0)}_write(t,e,i){const r=null!==i&&void 0!==i?i:s.z.fromFeatureSetReaderCIM(e);r&&this._writeGeometry(t,e,r)}_writeGeometry(t,e,i,r){t.recordStart(this.instanceId,this.attributeLayout,r),this.writeLineVertices(t,i,e),t.recordEnd()}_getLines(t){return(0,a.dx)(t,(0,u.b8)(this.evaluatedMeshParams))}_writeVertices(t,e,i){const{_currentWrite:s,_tessellationOptions:o,evaluatedMeshParams:a}=this,{width:l,capType:u,joinType:h,miterLimit:d,hasSizeVV:p}=a,x=(0,r.F2)(.5*l);o.halfWidth=x,o.capType=(0,c.L)(u),o.joinType=(0,c.Lq)(h),o.miterLimit=d;const f=!p;s.out=t,s.id=e.getDisplayId(),s.vertexCount=0,s.indexCount=0,s.vertexFrom=t.vertexCount(),s.vertexBounds=f&&x<n.do?0:1;for(const{line:r,start:n}of i)o.initialDistance=n%65535,this._lineTessellator.tessellate(r,o,f)}_writeTesselatedVertex(t,e,i,r,s,n,o,a,c,l,u){const{out:h,id:d,vertexBounds:p}=this._currentWrite;return this.hasEffects&&h.recordBounds(t,e,p,p),this._tessParams.extrusionOffsetX=o,this._tessParams.extrusionOffsetY=a,this._tessParams.normalX=c,this._tessParams.normalY=l,this._tessParams.directionX=s,this._tessParams.directionY=n,this._tessParams.distance=u,this._writeVertex(h,d,t,e,this._tessParams),this._currentWrite.vertexFrom+this._currentWrite.vertexCount++}_writeTriangle(t,e,i){const{out:r}=this._currentWrite;r.indexEnsureSize(3),r.indexWrite(t),r.indexWrite(e),r.indexWrite(i),this._currentWrite.indexCount+=3}}},4297:(t,e,i)=>{i.d(e,{I:()=>p});var r=i(1413),s=i(17842),n=i(23895),o=i(48202),a=i(94109),c=i(81308),l=i(7467),u=i(17326),h=i(8548);const d={createComputedParams:t=>t,optionalAttributes:l.bT.optionalAttributes,attributes:(0,r.Z)((0,r.Z)({},l.bT.attributes),{},{bitset:{type:h.g.UNSIGNED_BYTE,count:1,pack:t=>{let{shouldSampleAlphaOnly:e,shouldScaleDash:i,isSDF:r}=t;return(0,c.u)([[u.GS,e],[u.Wq,i],[u.B7,r]])}},tlbr:{type:h.g.UNSIGNED_SHORT,count:4,pack:t=>{let{sprite:e}=t;const{rect:i,width:r,height:s}=e,n=i.x+a.s4,o=i.y+a.s4;return[n,o,n+r,o+s]}},accumulatedDistance:{type:h.g.UNSIGNED_SHORT,count:1,packTessellation:t=>{let{distance:e}=t;return e}},segmentDirection:{type:h.g.BYTE,count:2,packPrecisionFactor:16,packTessellation:t=>{let{directionX:e,directionY:i}=t;return[e,i]}},offsetAlongLine:{type:h.g.HALF_FLOAT,count:1,pack:t=>{let{offsetAlongLine:e}=t;return(0,s.F2)(e)}},capType:{type:h.g.UNSIGNED_BYTE,count:1,pack:t=>{let{capType:e}=t;switch(e){case o.kP.Butt:case"butt":return 0;case o.kP.Square:case"square":return 1;case o.kP.Round:case"round":return 2;default:return 0}}}})};class p extends l.ti{constructor(t,e,i,r){super(t,e,i,r),this.vertexSpec=d,this._tessellationOptions.textured=!0}_write(t,e,i){const r=null!==i&&void 0!==i?i:n.z.fromFeatureSetReaderCIM(e);if(!r)return;const{sprite:s}=this.evaluatedMeshParams;this._writeGeometry(t,e,r,null===s||void 0===s?void 0:s.textureBinding)}}},99536:(t,e,i)=>{i.d(e,{A:()=>w});var r=i(17842),s=i(50264),n=i(35609),o=i(13611),a=i(23895),c=i(51750),l=i(48202),u=i(8827),h=i(94109),d=i(81308),p=i(31027);class x{static from(t){return"width"in t?this.fromSimpleMeshParams(t):this.fromComplexMeshParams(t)}static fromSimpleMeshParams(t){const e=new x(t.sprite,t.color,t.outlineColor,t.minPixelBuffer,t.placement,t.scaleInfo,t.effects),{type:i,width:s,height:n,angle:o,alignment:a,outlineSize:c,referenceSize:l,sprite:u,overrideOutlineColor:h}=t;return e.rawWidth=(0,r.F2)(s),e.rawHeight=(0,r.F2)(n),e.angle=o,e.alignment=a,e.outlineSize=(0,r.F2)(c),e.referenceSize=(0,r.F2)(l),e.overrideOutlineColor=h,e.offsetX=(0,r.F2)(t.offsetX),e.offsetY=(0,r.F2)(t.offsetY),"simple"!==i||u.sdf||(e.rawWidth=u.width,e.rawHeight=u.height),e._computeSize(t,!1),e}static fromComplexMeshParams(t){var e;const i=new x(t.sprite,t.color,t.outlineColor,t.minPixelBuffer,t.placement,t.scaleInfo,t.effects);let{alignment:s,transforms:n,size:o,scaleX:a,anchorX:c,anchorY:l,angle:u,colorLocked:h,frameHeight:d,widthRatio:f,offsetX:y,offsetY:m,outlineSize:_,referenceSize:g,scaleFactor:v,sizeRatio:k,isAbsoluteAnchorPoint:w,rotateClockwise:S,scaleSymbolsProportionally:b,sprite:T}=t;if(n&&n.infos.length>0){const t=(0,p.yl)(o,u,S,y,m,n);o=t.size,u=t.rotation,y=t.offsetX,m=t.offsetY,S=!1}v&&(o*=v,y*=v,m*=v);const P=a*(T.width/T.height);i.alignment=s,i.rawHeight=(0,r.F2)(o),i.rawWidth=i.rawHeight*P,i.referenceSize=(0,r.F2)(g),i.sizeRatio=k,i.sdfDecodeCoeff=(null!==(e=T.sdfDecodeCoeff)&&void 0!==e?e:1)*k,i.angle=u,i.rotateClockwise=S,i.anchorX=c,i.anchorY=l,i.offsetX=(0,r.F2)(y),i.offsetY=(0,r.F2)(m),w&&o&&(T.sdf?i.anchorX=c/(o*f):i.anchorX=c/(o*P),i.anchorY=l/o);const E=b&&d?o/d:1;return i.outlineSize=0===_||isNaN(_)?0:(0,r.F2)(_)*E,i.scaleSymbolsProportionally=b,i.colorLocked=h,i._computeSize(t,!0),i}constructor(t,e,i,r,s,n,o){this.sprite=t,this.color=e,this.outlineColor=i,this.minPixelBuffer=r,this.placement=s,this.scaleInfo=n,this.effects=o,this.rawWidth=0,this.rawHeight=0,this.angle=0,this.outlineSize=0,this.referenceSize=0,this.sizeRatio=1,this.sdfDecodeCoeff=1,this.alignment=l.v2.SCREEN,this.scaleSymbolsProportionally=!1,this.overrideOutlineColor=!1,this.colorLocked=!1,this.anchorX=0,this.anchorY=0,this.computedWidth=0,this.computedHeight=0,this.texXmin=0,this.texYmin=0,this.texXmax=0,this.texYmax=0,this.offsetX=0,this.offsetY=0,this.rotateClockwise=!0}get boundsInfo(){return{size:Math.max(this.computedHeight,this.computedWidth),offsetX:this.offsetX,offsetY:this.offsetY}}_computeSize(t,e){var i;const{sprite:r,hasSizeVV:s}=t,n=!!r.sdf,o=null!==(i=r.sdfPaddingRatio)&&void 0!==i?i:.5,{rawWidth:a,rawHeight:c,sizeRatio:l,outlineSize:u}=this,d=l*(n?1/(1-o):1),p=a*d,x=c*d;if(n&&!s){const t=e&&a>c?p:a,i=c,r=u+2;this.computedWidth=Math.min(t+r,p),this.computedHeight=Math.min(i+r,x)}else this.computedWidth=p,this.computedHeight=x;const f=n?Math.max(r.width,r.height)/Math.max(p,x):1,y=.5*(p-this.computedWidth)*f,m=.5*(x-this.computedHeight)*f,_=r.rect.x+h.s4+y,g=r.rect.y+h.s4+m,v=_+r.width-2*y,k=g+r.height-2*m;this.texXmin=Math.floor(_),this.texYmin=Math.floor(g),this.texXmax=Math.ceil(v),this.texYmax=Math.ceil(k),this.computedWidth*=(this.texXmax-this.texXmin)/(v-_),this.computedHeight*=(this.texYmax-this.texYmin)/(k-g),this.anchorX*=p/this.computedWidth,this.anchorY*=x/this.computedHeight}}var f=i(70467),y=i(12914),m=i(2744),_=i(8548);const g=128/Math.PI;function v(t){return function(t,e){return t%=e,Math.abs(t>=0?t:t+e)}(t*g,256)}const k={createComputedParams:t=>x.from(t),optionalAttributes:{zoomRange:{type:_.g.SHORT,count:2,packPrecisionFactor:h.JS,pack:(t,e)=>{let{scaleInfo:i}=t,{tileInfo:r}=e;return(0,d._f)(i,r)}}},attributes:{pos:{type:_.g.SHORT,count:2,pack:"position",packPrecisionFactor:10},id:{type:_.g.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:_.g.UNSIGNED_BYTE,count:1,pack:t=>{let{sprite:e,alignment:i,scaleSymbolsProportionally:r,overrideOutlineColor:s,colorLocked:n}=t,o=0;return e.sdf&&(o|=(0,d.NF)(f.m.bitset.isSDF)),i===l.v2.MAP&&(o|=(0,d.NF)(f.m.bitset.isMapAligned)),r&&(o|=(0,d.NF)(f.m.bitset.scaleSymbolsProportionally)),s&&(o|=(0,d.NF)(f.m.bitset.overrideOutlineColor)),n&&(o|=(0,d.NF)(f.m.bitset.colorLocked)),o}},offset:{type:_.g.SHORT,count:2,packPrecisionFactor:4,packAlternating:{count:4,pack:t=>{let{angle:e,computedWidth:i,computedHeight:r,anchorX:a,anchorY:c,offsetX:l,offsetY:u,rotateClockwise:h}=t;const d=function(t,e,i,r){let o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const a=(0,n.Ue)(),c=o?1:-1;return(0,s.yR)(a),(e||i)&&(0,s.Iu)(a,a,[e,-i]),r&&(0,s.U1)(a,a,.017453292519944444*c*-r),a}(0,l,u,-e,h),p=-(.5+a)*i,x=-(.5-c)*r,f=[p,x],y=[p+i,x],m=[p,x+r],_=[p+i,x+r];return(0,o.iu)(f,f,d),(0,o.iu)(y,y,d),(0,o.iu)(m,m,d),(0,o.iu)(_,_,d),[f,y,m,_]}}},textureUV:{type:_.g.SHORT,count:2,packPrecisionFactor:4,packAlternating:{count:4,pack:t=>{let{texXmax:e,texXmin:i,texYmax:r,texYmin:s}=t;return[[i,s],[e,s],[i,r],[e,r]]}}},color:{type:_.g.UNSIGNED_BYTE,count:4,normalized:!0,pack:t=>{let{color:e}=t;return(0,d.G7)(e)}},outlineColor:{type:_.g.UNSIGNED_BYTE,count:4,normalized:!0,pack:t=>{let{outlineColor:e}=t;return(0,d.G7)(e)}},sizing:{type:_.g.UNSIGNED_BYTE,count:4,pack:t=>{let{rawWidth:e,rawHeight:i,outlineSize:r,referenceSize:s}=t;const n=Math.max(e,i);return[(0,d.QS)(n,128),(0,d.QS)(r,128),(0,d.QS)(s,128),0]}},placementAngle:{type:_.g.UNSIGNED_BYTE,count:1,packTessellation:t=>{let{placementAngle:e}=t;return v(e)}},sdfDecodeCoeff:{type:_.g.UNSIGNED_SHORT,count:1,packPrecisionFactor:64,pack:t=>{let{sdfDecodeCoeff:e}=t;return e}}}};class w extends m.c{constructor(){super(...arguments),this.vertexSpec=k}getBoundsInfo(){return this.evaluatedMeshParams.boundsInfo}_write(t,e,i){var r;const s=null===(r=this.evaluatedMeshParams.sprite)||void 0===r?void 0:r.textureBinding,n=e.getDisplayId();t.recordStart(this.instanceId,this.attributeLayout,s);const o=this.evaluatedMeshParams.minPixelBuffer,a=Math.max(this.evaluatedMeshParams.computedWidth,o),l=Math.max(this.evaluatedMeshParams.computedHeight,o),u=-this.evaluatedMeshParams.anchorX*this.evaluatedMeshParams.computedWidth,h=this.evaluatedMeshParams.anchorY*this.evaluatedMeshParams.computedHeight,d=this.evaluatedMeshParams.offsetX+u,p=-this.evaluatedMeshParams.offsetY+h;if(null!=this.evaluatedMeshParams.placement)this._writePlacedMarkers(t,e,i,a,l);else if(null!==i&&void 0!==i&&i.nextPath()){i.nextPoint();const e=i.x,r=i.y;t.recordBounds(e+d,r+p,a,l),this._writeQuad(t,n,e,r)}else if("esriGeometryPolygon"===e.geometryType){const i=e.readCentroidForDisplay();if(!i)return;const[r,s]=i.coords;t.recordBounds(r+d,s+p,a,l),this._writeQuad(t,n,r,s)}else if("esriGeometryPoint"===e.geometryType){const i=e.readXForDisplay(),r=e.readYForDisplay();t.recordBounds(i+d,r+p,a,l),this._writeQuad(t,n,i,r)}else{const i=e.readGeometryForDisplay();null===i||void 0===i||i.forEachVertex(((e,i)=>{t.recordBounds(e+d,i+p,a,l),Math.abs(e)>c.Lr||Math.abs(i)>c.Lr||this._writeQuad(t,n,e,i)}))}t.recordEnd()}_writePlacedMarkers(t,e,i,s,n){var o;const l=null!==i&&void 0!==i?i:null===(o=a.z.fromFeatureSetReaderCIM(e))||void 0===o?void 0:o.clone();if(!l)return;const h=u.i.getPlacement(l,-1,this.evaluatedMeshParams.placement,(0,r.F2)(1),t.id,(0,y.n)());if(!h)return;const d=e.getDisplayId();let p=h.next();const x=this.evaluatedMeshParams.offsetX,f=-this.evaluatedMeshParams.offsetY;for(;null!=p;){const e=p.tx,i=-p.ty;if(Math.abs(e)>c.Lr||Math.abs(i)>c.Lr){p=h.next();continue}const r=-p.getAngle();t.recordBounds(e+x,i+f,s,n),this._writeQuad(t,d,e,i,r),p=h.next()}}_writeQuad(t,e,i,r,s){const n=t.vertexCount(),o=null==s?null:{placementAngle:s};this._writeVertex(t,e,i,r,o),t.indexWrite(n+0),t.indexWrite(n+1),t.indexWrite(n+2),t.indexWrite(n+1),t.indexWrite(n+3),t.indexWrite(n+2)}}},2744:(t,e,i)=>{i.d(e,{c:()=>x});var r=i(23895),s=i(95954),n=i(12914),o=i(73271),a=i(1413),c=(i(93169),i(89226)),l=i(8548);function u(t){switch(t){case l.g.BYTE:case l.g.UNSIGNED_BYTE:return 1;case l.g.SHORT:case l.g.UNSIGNED_SHORT:case l.g.HALF_FLOAT:return 2;case l.g.FLOAT:case l.g.INT:case l.g.UNSIGNED_INT:return 4}}class h{static fromVertexSpec(t,e){const{attributes:i,optionalAttributes:r}=t;let s,n,o;const c=[];for(const u in i){const t=i[u];"position"===t.pack?s=(0,a.Z)((0,a.Z)({},t),{},{name:u,offset:0}):"id"===t.pack?n=(0,a.Z)((0,a.Z)({},t),{},{name:u,offset:4}):"bitset"===u?o=(0,a.Z)((0,a.Z)({},t),{},{name:u,offset:7}):c.push((0,a.Z)((0,a.Z)({},t),{},{name:u}))}for(const u in r)if(!0===e[u]){const t=r[u];c.push((0,a.Z)((0,a.Z)({},t),{},{name:u}))}const l=function(t){const e=[],i=[],r=[];for(const s of t){const t=u(s.type)*s.count;switch(t%2||t%4||4){case 4:e.push(s);continue;case 2:i.push(s);continue;case 1:r.push(s);continue;default:throw new Error("Found unexpected dataType byte count")}}return e.push(...i),e.push(...r),e}(c),d=[];let p=8,x=1;for(const h of l)d.push((0,a.Z)((0,a.Z)({},h),{},{offset:p})),p+=u(h.type)*h.count,h.packAlternating&&(x=Math.max(h.packAlternating.count,x));const f=Uint32Array.BYTES_PER_ELEMENT,y=p%f;return new h(s,n,o,d,p+(y?f-y:0),x)}constructor(t,e,i,r,s,n){this.position=t,this.id=e,this.bitset=i,this.standardAttributes=r,this.stride=s,this.packVertexCount=n,r.push(i),this._attributes=[t,e,i,...r]}get attributeLayout(){if(!this._attributeLayout){const t=(0,c.ig)(this._attributes),e=this._attributes.map((t=>{var e;return{name:t.name,count:t.count,offset:t.offset,type:t.type,packPrecisionFactor:t.packPrecisionFactor,normalized:null!==(e=t.normalized)&&void 0!==e&&e}}));this._attributeLayout={attributes:e,hash:t,stride:this.stride}}return this._attributeLayout}}var d=i(70966);class p{static fromVertexSpec(t,e){const i=h.fromVertexSpec(t,e);return new p(i)}constructor(t){this._spec=t,this._packed=new Uint8Array(this._spec.stride*this._spec.packVertexCount),this._packedU32View=new Uint32Array(this._packed.buffer),this._dataView=new DataView(this._packed.buffer)}get attributeLayout(){return this._spec.attributeLayout}get stride(){return this._spec.stride}writeVertex(t,e,i,r,s,n){for(let a=0;a<this._spec.packVertexCount;a++){const t=a*this._spec.stride;this._packPosition(i,r,t),this._packId(e,t);const c=this._spec.bitset;if(n){if(c.packTessellation){const e=c.packTessellation(n,s);this._pack(e,c,t)}for(const e of this._spec.standardAttributes){var o;if(null!=e.packTessellation){const i=e.packTessellation(n,s);this._pack(i,e,t)}else if(null!==(o=e.packAlternating)&&void 0!==o&&o.packTessellation){const t=e.packAlternating.packTessellation(n,s);for(let i=0;i<this._spec.packVertexCount;i++){const r=t[i];this._pack(r,e,i*this._spec.stride)}}}}}t.vertexWriteRegion(this._packedU32View)}pack(t,e){for(const r of this._spec.standardAttributes){var i;if(r.pack&&"string"!=typeof r.pack){const i=r.pack(t,e);for(let t=0;t<this._spec.packVertexCount;t++)this._pack(i,r,t*this._spec.stride)}else if(null!==(i=r.packAlternating)&&void 0!==i&&i.pack){const i=r.packAlternating.pack(t,e);for(let t=0;t<this._spec.packVertexCount;t++){const e=i[t];this._pack(e,r,t*this._spec.stride)}}}}_packPosition(t,e,i){var r;const{offset:s}=this._spec.position,n=null!==(r=this._spec.position.packPrecisionFactor)&&void 0!==r?r:1,a=(0,o.UJ)(t*n,e*n);this._dataView.setUint32(i+s,a,!0)}_packId(t,e){var i;const r=t*(null!==(i=this._spec.id.packPrecisionFactor)&&void 0!==i?i:1),s=4278190080&this._dataView.getUint32(e+this._spec.id.offset,!0);this._dataView.setUint32(e+this._spec.id.offset,r|s,!0)}_pack(t,e,i){(0,d.G)(this._dataView,t,e,i)}}class x{constructor(t,e,i,r){this._instanceId=t,this._evaluator=e,this._enabledOptionalAttributes=i,this._viewParams=r,this._evaluator.evaluator=t=>this.vertexSpec.createComputedParams(t)}get _vertexPack(){if(!this._cachedVertexPack){const t=p.fromVertexSpec(this.vertexSpec,this._enabledOptionalAttributes);this._evaluator.hasDynamicProperties||t.pack(this._evaluator.evaluatedMeshParams,this._viewParams),this._cachedVertexPack=t}return this._cachedVertexPack}get evaluatedMeshParams(){return this._evaluator.evaluatedMeshParams}get hasEffects(){return!!this.evaluatedMeshParams.effects}get instanceId(){return this._instanceId}get attributeLayout(){return this._vertexPack.attributeLayout}setReferences(t){this._references=t}getBoundsInfo(){return null}getTileInfo(){return this._viewParams.tileInfo}async loadDependencies(){var t;(function(t){if(!t)return!1;for(const e of t)switch(e.effect.type){case"CIMGeometricEffectBuffer":case"CIMGeometricEffectOffset":case"CIMGeometricEffectDonut":return!0}return!1})(null===(t=this._evaluator.inputMeshParams.effects)||void 0===t?void 0:t.effectInfos)&&await(0,n.A)()}enqueueRequest(t,e,i){this._evaluator.hasDynamicProperties&&this._evaluator.enqueueRequest(t,e,i)}write(t,e,i,o,a){var c;this.ensurePacked(e,i,o);const l=this.evaluatedMeshParams.effects;if(!l||0===l.length)return void this._write(t,i,void 0,a);const u=null===(c=i.readGeometryForDisplay())||void 0===c?void 0:c.clone();if(!u)return;const h=r.z.fromOptimizedCIM(u,i.geometryType),d=(0,n.n)();h.invertY();const p=t.id||"",x=s.j.executeEffects(l,h,p,d);let f;for(;f=x.next();)f.invertY(),this._write(t,i,f,a)}ensurePacked(t,e,i){if(!this._evaluator.hasDynamicProperties)return;const r=this._evaluator.evaluateMeshParams(t,e,i);this._vertexPack.pack(r,this._viewParams)}_writeVertex(t,e,i,r,s){const n=this.evaluatedMeshParams;this._vertexPack.writeVertex(t,e,i,r,n,s)}}},12914:(t,e,i)=>{i.d(e,{A:()=>n,n:()=>s});let r=null;function s(){return r}async function n(){r=await Promise.all([i.e(9058),i.e(3953)]).then(i.bind(i,50309))}},16336:(t,e,i)=>{i.d(e,{q:()=>c});var r=i(17842),s=i(81308),n=i(2744),o=i(8548);const a={createComputedParams:t=>t,optionalAttributes:{},attributes:{pos:{type:o.g.SHORT,count:2,packPrecisionFactor:10,pack:"position"},id:{type:o.g.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:o.g.UNSIGNED_BYTE,count:1,pack:t=>0},offset:{type:o.g.SHORT,count:2,packPrecisionFactor:16,packAlternating:{count:4,pack:t=>{let{size:e}=t;const i=(0,r.F2)(e),s=-i/2,n=-i/2;return[[s,n],[s+i,n],[s,n+i],[s+i,n+i]]}}},texCoords:{type:o.g.SHORT,count:2,packPrecisionFactor:4,packAlternating:{count:4,pack:()=>[[0,1],[1,1],[0,0],[1,0]]}},size:{type:o.g.UNSIGNED_BYTE,count:2,pack:t=>{let{size:e}=t;return[e,e]}},referenceSize:{type:o.g.UNSIGNED_BYTE,count:1,pack:t=>{let{size:e}=t;return(0,r.F2)(e)}},zoomRange:{type:o.g.UNSIGNED_BYTE,count:2,pack:(t,e)=>{let{scaleInfo:i}=t,{tileInfo:r}=e;return(0,s._f)(i,r)}}}};class c extends n.c{constructor(){super(...arguments),this.vertexSpec=a}_write(t,e){const i=e.getDisplayId(),s=this.evaluatedMeshParams.minPixelBuffer,n=Math.max((0,r.F2)(this.evaluatedMeshParams.size),s);let o,a;if("esriGeometryPoint"===e.geometryType)o=e.readXForDisplay(),a=e.readYForDisplay();else{const t=e.readCentroidForDisplay();if(!t)return;o=null===t||void 0===t?void 0:t.coords[0],a=null===t||void 0===t?void 0:t.coords[1]}t.recordStart(this.instanceId,this.attributeLayout),t.recordBounds(o,a,n,n);const c=t.vertexCount();this._writeVertex(t,i,o,a),t.indexWrite(c+0),t.indexWrite(c+1),t.indexWrite(c+2),t.indexWrite(c+1),t.indexWrite(c+3),t.indexWrite(c+2),t.recordEnd()}}},24799:(t,e,i)=>{i.d(e,{lW:()=>F,PW:()=>_});var r=i(1413),s=i(16889),n=i(17842),o=i(23895),a=i(8827),c=i(38999),l=i(94109),u=i(62106),h=i(81308),d=i(12914),p=i(2744),x=i(17326),f=i(31027);class y{constructor(t){const{offsetX:e,offsetY:i,postAngle:r,fontSize:s,haloSize:n,outlineSize:o,scaleFactor:a,transforms:c}=t;if(this.offsetX=e,this.offsetY=i,this.postAngle=r,this.fontSize=Math.min(s,96),this.haloSize=null!==n&&void 0!==n?n:0,this.outlineSize=null!==o&&void 0!==o?o:0,this.transforms=c,c&&c.infos.length>1){const t=(0,f.yl)(s,r,!1,e,i,c,!1);this.fontSize=Math.min(t.size,96);const n=t.size/s;this.haloSize*=n,this.outlineSize*=n,this.postAngle=t.rotation,this.offsetX=t.offsetX,this.offsetY=t.offsetY}a&&(this.fontSize*=a,this.offsetX*=a,this.offsetY*=a)}}var m=i(8548);const _=28,g=[4,4],v=[16,4],k={topLeft:v,topRight:v,bottomLeft:v,bottomRight:v},w=[4,2],S=[4,6],b={topLeft:w,topRight:w,bottomLeft:S,bottomRight:S},T={topLeft:w,topRight:S,bottomLeft:w,bottomRight:S},P={topLeft:S,topRight:S,bottomLeft:g,bottomRight:g},E={topLeft:g,topRight:g,bottomLeft:S,bottomRight:S},M={topLeft:S,topRight:g,bottomLeft:S,bottomRight:g},N={topLeft:g,topRight:S,bottomLeft:g,bottomRight:S},z={createComputedParams:t=>t,optionalAttributes:{zoomRange:{type:m.g.UNSIGNED_SHORT,count:2,packPrecisionFactor:l.JS,packTessellation:t=>{let{minZoom:e,maxZoom:i}=t;return[e||0,i||_]}},clipAngle:{type:m.g.UNSIGNED_BYTE,count:1,packTessellation:t=>{let{clipAngle:e}=t;return A(e||0)}},referenceSymbol:{type:m.g.BYTE,count:4,packPrecisionFactor:1,packTessellation:(t,e)=>{const i=t.isLineLabel||!t.referenceBounds,r=(0,c.g)(i?"center":e.horizontalAlignment),s=(0,c.tf)(i?"middle":e.verticalAlignment),{offsetX:o,offsetY:a,size:l}=i?{offsetX:0,offsetY:0,size:0}:t.referenceBounds;return[(0,n.F2)(o),-(0,n.F2)(a),Math.round((0,n.F2)(l)),r+1<<2|s+1]}}},attributes:{pos:{type:m.g.SHORT,count:2,pack:"position",packPrecisionFactor:10},id:{type:m.g.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:m.g.UNSIGNED_BYTE,count:1,packTessellation:t=>{let{isBackground:e,mapAligned:i}=t;return(0,h.u)([[x.mL,e],[x.$r,!!i]])}},offset:{type:m.g.SHORT,count:2,packPrecisionFactor:8,packAlternating:{count:4,packTessellation:t=>{let{offsets:e}=t;const{bottomLeft:i,bottomRight:r,topLeft:s,topRight:n}=e;return[s,n,i,r]}}},textureUV:{type:m.g.SHORT,count:2,packPrecisionFactor:4,packAlternating:{count:4,packTessellation:t=>{let{texcoords:e}=t;const{bottomLeft:i,bottomRight:r,topLeft:s,topRight:n}=e;return[s,n,i,r]}}},color:{type:m.g.UNSIGNED_BYTE,count:4,normalized:!0,packTessellation:t=>{let{color:e}=t;return e}},fontSize:{type:m.g.UNSIGNED_SHORT,count:1,packPrecisionFactor:4,packTessellation:t=>{let{fontSize:e}=t;return Math.round((0,n.F2)(e))}},referenceSize:{type:m.g.UNSIGNED_BYTE,count:1,packPrecisionFactor:4,packTessellation:(t,e)=>{let{fontSize:i}=t,{referenceSize:r}=e;return Math.round((0,n.F2)(null!==r&&void 0!==r?r:i))}},outlineColor:{type:m.g.UNSIGNED_BYTE,count:4,normalized:!0,pack:t=>{let{outlineColor:e}=t;return(0,h.G7)(e)}},haloColor:{type:m.g.UNSIGNED_BYTE,count:4,normalized:!0,pack:t=>{let{haloColor:e}=t;return(0,h.G7)(e)}},outlineAndHaloSize:{type:m.g.UNSIGNED_SHORT,count:2,packPrecisionFactor:4,packTessellation:t=>{let{outlineSize:e,haloSize:i}=t;return[Math.round((0,n.F2)(e)),Math.round((0,n.F2)(i))]}}}};class F extends p.c{constructor(){super(...arguments),this.vertexSpec=z,this._textMeshParamsPropsInitialized=!1}ensurePacked(t,e,i){super.ensurePacked(t,e,i),this._textMeshParamsPropsInitialized&&!this._evaluator.hasDynamicProperties||(this._textMeshTransformProps=new y(this.evaluatedMeshParams),this._textMeshParamsPropsInitialized=!0)}_write(t,e,i){const r=this._getShaping();if(!r)return;const s=e.getDisplayId();if(null!=this.evaluatedMeshParams.placement)return this._writePlacedTextMarkers(t,e,r,i);if(null!==i&&void 0!==i&&i.nextPath())return i.nextPoint(),this._writeGlyphs(t,s,i.x,i.y,r,0);if("esriGeometryPolygon"===e.geometryType){const i=e.readCentroidForDisplay();if(!i)return;const[n,o]=i.coords;return this._writeGlyphs(t,s,n,o,r,0)}if("esriGeometryMultipoint"===e.geometryType){const i=e.readGeometryForDisplay();return void(null===i||void 0===i||i.forEachVertex(((e,i)=>this._writeGlyphs(t,s,e,i,r,0))))}const n=e.readXForDisplay(),o=e.readYForDisplay();return this._writeGlyphs(t,s,n,o,r,0)}_writePlacedTextMarkers(t,e,i,r){const s=null!==r&&void 0!==r?r:o.z.fromFeatureSetReaderCIM(e);if(!s)return;const c=a.i.getPlacement(s,-1,this.evaluatedMeshParams.placement,(0,n.F2)(1),t.id,(0,d.n)());if(!c)return;const l=e.getDisplayId();let u=c.next();for(;null!=u;){const e=u.tx,r=-u.ty,s=-u.getAngle();this._writeGlyphs(t,l,e,r,i,s),u=c.next()}}_getShaping(t){var e;const i=this._textMeshTransformProps,r=this.evaluatedMeshParams;if(null===(e=r.glyphs)||void 0===e||!e.glyphs.length)return null;const o=(0,n.F2)(i.fontSize),a=(0,n.F2)(i.offsetX),c=(0,n.F2)(i.offsetY),h=(0,s.uZ)((0,n.F2)(r.lineWidth),l.A5,l.NT),d=l.uk*(0,s.uZ)(r.lineHeightRatio,.25,4);return(0,u.Nr)(r.glyphs,{scale:o/l.iD,angle:i.postAngle,xOffset:a,yOffset:c,horizontalAlignment:r.horizontalAlignment,verticalAlignment:t||r.verticalAlignment,maxLineWidth:h,lineHeight:d,decoration:r.decoration,borderLineSizePx:(0,n.F2)(r.boxBorderLineSize),hasBackground:!!r.boxBackgroundColor,useCIMAngleBehavior:r.useCIMAngleBehavior})}_writeGlyphs(t,e,i,s,o,a,c,l){const u=this.evaluatedMeshParams,d=this._textMeshTransformProps,p=(0,n.F2)(d.fontSize),x=d.haloSize,f=d.outlineSize,y=(0,n.F2)(d.offsetX),m=(0,n.F2)(d.offsetY),[_,g]=(0,h._f)(u.scaleInfo,this.getTileInfo());0!==a&&o.setRotation(a);const v=o.bounds,k=i+v.x+y,w=s+v.y-m,S=2*(u.minPixelBuffer?u.minPixelBuffer/p:1),b=Math.max(v.width,v.height)*S;o.textBox&&(t.recordStart(this.instanceId,this.attributeLayout,o.glyphs[0].textureBinding),t.recordBounds(k,w,b,b),this._writeTextBox(t,e,i,s,o.textBox,c,l),t.recordEnd());for(const n of o.glyphs){t.recordStart(this.instanceId,this.attributeLayout,n.textureBinding),t.recordBounds(k,w,b,b);const{texcoords:o,offsets:a}=n;this._writeQuad(t,e,i,s,(0,r.Z)({texcoords:o,offsets:a,fontSize:p,haloSize:x,outlineSize:f,color:(0,h.G7)(u.color),isBackground:!1,referenceBounds:c,minZoom:_,maxZoom:g},l)),t.recordEnd()}0!==a&&o.setRotation(-a)}_writeTextBox(t,e,i,s,n,o,a){const c=this.evaluatedMeshParams,{fontSize:l,haloSize:u,outlineSize:d}=this._textMeshTransformProps,{boxBackgroundColor:p,boxBorderLineColor:x}=c,f=(0,r.Z)({isBackground:!0,fontSize:l,haloSize:u,outlineSize:d,referenceBounds:o},a);p&&(this._writeQuad(t,e,i,s,(0,r.Z)({texcoords:k,offsets:n.main,color:(0,h.G7)(p)},f)),x||(this._writeQuad(t,e,i,s,(0,r.Z)({texcoords:P,offsets:n.top,color:(0,h.G7)(p)},f)),this._writeQuad(t,e,i,s,(0,r.Z)({texcoords:E,offsets:n.bot,color:(0,h.G7)(p)},f)),this._writeQuad(t,e,i,s,(0,r.Z)({texcoords:M,offsets:n.left,color:(0,h.G7)(p)},f)),this._writeQuad(t,e,i,s,(0,r.Z)({texcoords:N,offsets:n.right,color:(0,h.G7)(p)},f)))),x&&(this._writeQuad(t,e,i,s,(0,r.Z)({texcoords:b,offsets:n.top,color:(0,h.G7)(x)},f)),this._writeQuad(t,e,i,s,(0,r.Z)({texcoords:b,offsets:n.bot,color:(0,h.G7)(x)},f)),this._writeQuad(t,e,i,s,(0,r.Z)({texcoords:T,offsets:n.left,color:(0,h.G7)(x)},f)),this._writeQuad(t,e,i,s,(0,r.Z)({texcoords:T,offsets:n.right,color:(0,h.G7)(x)},f)))}_writeQuad(t,e,i,r,s){const n=t.vertexCount();this._writeVertex(t,e,i,r,s),t.indexWrite(n+0),t.indexWrite(n+1),t.indexWrite(n+2),t.indexWrite(n+1),t.indexWrite(n+3),t.indexWrite(n+2)}}const A=t=>Math.round(t*(254/360))}}]);
//# sourceMappingURL=1181.13f520cc.chunk.js.map