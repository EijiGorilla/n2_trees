"use strict";(self.webpackChunkn2_trees=self.webpackChunkn2_trees||[]).push([[788],{88396:(e,t,r)=>{r.d(t,{a:()=>s,f:()=>i,n:()=>o});var n=r(18722);function o(e,t){s(e.typedBuffer,t.typedBuffer,e.typedBufferStride,t.typedBufferStride)}function s(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:r;const s=t.length/2;let i=0,a=0;if((0,n.kJ)(t)||(0,n.Q7)(t)){for(let n=0;n<s;++n)e[i]=t[a],e[i+1]=t[a+1],i+=r,a+=o;return}const l=(0,n.Op)(t);if((0,n.B3)(t))for(let n=0;n<s;++n)e[i]=Math.max(t[a]/l,-1),e[i+1]=Math.max(t[a+1]/l,-1),i+=r,a+=o;else for(let n=0;n<s;++n)e[i]=t[a]/l,e[i+1]=t[a+1]/l,i+=r,a+=o}function i(e,t,r,n){var o,s;const i=e.typedBuffer,a=e.typedBufferStride,l=null!==(o=null===n||void 0===n?void 0:n.count)&&void 0!==o?o:e.count;let u=(null!==(s=null===n||void 0===n?void 0:n.dstIndex)&&void 0!==s?s:0)*a;for(let c=0;c<l;++c)i[u]=t,i[u+1]=r,u+=a}Object.freeze(Object.defineProperty({__proto__:null,fill:i,normalizeIntegerBuffer:s,normalizeIntegerBufferView:o},Symbol.toStringTag,{value:"Module"}))},11186:(e,t,r)=>{r.d(t,{a:()=>u,b:()=>i,c:()=>s,d:()=>n,e:()=>c,f:()=>l,n:()=>f,s:()=>a,t:()=>o});r(93169),r(32718);function n(e,t,r){o(e.typedBuffer,t.typedBuffer,r,e.typedBufferStride,t.typedBufferStride)}function o(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:3,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:n;if(e.length/n!==Math.ceil(t.length/o))return e;const s=e.length/n,i=r[0],a=r[1],l=r[2],u=r[4],c=r[5],f=r[6],d=r[8],p=r[9],m=r[10],h=r[12],g=r[13],y=r[14];let v=0,x=0;for(let b=0;b<s;b++){const r=t[v],s=t[v+1],b=t[v+2];e[x]=i*r+u*s+d*b+h,e[x+1]=a*r+c*s+p*b+g,e[x+2]=l*r+f*s+m*b+y,v+=o,x+=n}return e}function s(e,t,r){i(e.typedBuffer,t.typedBuffer,r,e.typedBufferStride,t.typedBufferStride)}function i(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:3,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:n;if(e.length/n!==Math.ceil(t.length/o))return;const s=e.length/n,i=r[0],a=r[1],l=r[2],u=r[3],c=r[4],f=r[5],d=r[6],p=r[7],m=r[8];let h=0,g=0;for(let y=0;y<s;y++){const r=t[h],s=t[h+1],y=t[h+2];e[g]=i*r+u*s+d*y,e[g+1]=a*r+c*s+p*y,e[g+2]=l*r+f*s+m*y,h+=o,g+=n}}function a(e,t,r){l(e.typedBuffer,t.typedBuffer,r,e.typedBufferStride,t.typedBufferStride)}function l(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:3,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:n;const s=Math.min(e.length/n,t.length/o);let i=0,a=0;for(let l=0;l<s;l++)e[a]=r*t[i],e[a+1]=r*t[i+1],e[a+2]=r*t[i+2],i+=o,a+=n;return e}function u(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:3,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:n;const s=e.length/n;if(s!==Math.ceil(t.length/o))return e;let i=0,a=0;for(let l=0;l<s;l++)e[a]=t[i]+r[0],e[a+1]=t[i+1]+r[1],e[a+2]=t[i+2]+r[2],i+=o,a+=n;return e}function c(e,t){f(e.typedBuffer,t.typedBuffer,e.typedBufferStride,t.typedBufferStride)}function f(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:r;const o=Math.min(e.length/r,t.length/n);let s=0,i=0;for(let a=0;a<o;a++){const o=t[s],a=t[s+1],l=t[s+2],u=o*o+a*a+l*l;if(u>0){const t=1/Math.sqrt(u);e[i]=t*o,e[i+1]=t*a,e[i+2]=t*l}s+=n,i+=r}}Object.freeze(Object.defineProperty({__proto__:null,normalize:f,normalizeView:c,scale:l,scaleView:a,shiftRight:function(e,t,r){const n=Math.min(e.count,t.count),o=e.typedBuffer,s=e.typedBufferStride,i=t.typedBuffer,a=t.typedBufferStride;let l=0,u=0;for(let c=0;c<n;c++)o[u]=i[l]>>r,o[u+1]=i[l+1]>>r,o[u+2]=i[l+2]>>r,l+=a,u+=s},transformMat3:i,transformMat3View:s,transformMat4:o,transformMat4View:n,translate:u},Symbol.toStringTag,{value:"Module"}))},92770:(e,t,r)=>{function n(e,t){o(e.typedBuffer,t.typedBuffer,e.typedBufferStride,t.typedBufferStride)}function o(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:r;const o=t.length/n;let s=0,i=0;for(let a=0;a<o;++a)e[s]=t[i],e[s+1]=t[i+1],e[s+2]=t[i+2],s+=r,i+=n}function s(e,t,r,n,o){var s,i;const a=e.typedBuffer,l=e.typedBufferStride,u=null!==(s=null===o||void 0===o?void 0:o.count)&&void 0!==s?s:e.count;let c=(null!==(i=null===o||void 0===o?void 0:o.dstIndex)&&void 0!==i?i:0)*l;for(let f=0;f<u;++f)a[c]=t,a[c+1]=r,a[c+2]=n,c+=l}r.d(t,{a:()=>n,c:()=>o,f:()=>s});Object.freeze(Object.defineProperty({__proto__:null,copy:o,copyView:n,fill:s},Symbol.toStringTag,{value:"Module"}))},6754:(e,t,r)=>{r.d(t,{a:()=>o,b:()=>l,n:()=>i,s:()=>a,t:()=>s});r(93169);var n=r(32718);function o(e,t,r){s(e.typedBuffer,t.typedBuffer,r,e.typedBufferStride,t.typedBufferStride)}function s(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:4,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:n;if(e.length/n!=t.length/o)return;const s=e.length/n,i=r[0],a=r[1],l=r[2],u=r[3],c=r[4],f=r[5],d=r[6],p=r[7],m=r[8];let h=0,g=0;for(let y=0;y<s;y++){const r=t[h],s=t[h+1],y=t[h+2],v=t[h+3];e[g]=i*r+u*s+d*y,e[g+1]=a*r+c*s+p*y,e[g+2]=l*r+f*s+m*y,e[g+3]=v,h+=o,g+=n}}function i(e,t){const r=Math.min(e.count,t.count),n=e.typedBuffer,o=e.typedBufferStride,s=t.typedBuffer,i=t.typedBufferStride;for(let a=0;a<r;a++){const e=a*o,t=a*i,r=s[t],l=s[t+1],u=s[t+2],c=r*r+l*l+u*u;if(c>0){const t=1/Math.sqrt(c);n[e]=t*r,n[e+1]=t*l,n[e+2]=t*u}}}function a(e,t,r){l(e.typedBuffer,t,r,e.typedBufferStride)}function l(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:4;const o=Math.min(e.length/n,t.count),s=t.typedBuffer,i=t.typedBufferStride;let a=0,l=0;for(let u=0;u<o;u++)e[l]=r*s[a],e[l+1]=r*s[a+1],e[l+2]=r*s[a+2],e[l+3]=r*s[a+3],a+=i,l+=n}Object.freeze(Object.defineProperty({__proto__:null,normalize:i,scale:l,scaleView:a,transformMat3:s,transformMat3View:o,transformMat4:function(e,t,r){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:4,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:o;if(e.length/o!=t.length/s)return void n.Z.getLogger("esri.views.3d.support.buffer.math").error("source and destination buffers need to have the same number of elements");const i=e.length/o,a=r[0],l=r[1],u=r[2],c=r[3],f=r[4],d=r[5],p=r[6],m=r[7],h=r[8],g=r[9],y=r[10],v=r[11],x=r[12],b=r[13],w=r[14],B=r[15];let T=0,M=0;for(let n=0;n<i;n++){const r=t[T],n=t[T+1],i=t[T+2],S=t[T+3];e[M]=a*r+f*n+h*i+x*S,e[M+1]=l*r+d*n+g*i+b*S,e[M+2]=u*r+p*n+y*i+w*S,e[M+3]=c*r+m*n+v*i+B*S,T+=s,M+=o}},transformMat4View:function(e,t,r){if(e.count!==t.count)return;const n=e.count,o=r[0],s=r[1],i=r[2],a=r[3],l=r[4],u=r[5],c=r[6],f=r[7],d=r[8],p=r[9],m=r[10],h=r[11],g=r[12],y=r[13],v=r[14],x=r[15],b=e.typedBuffer,w=e.typedBufferStride,B=t.typedBuffer,T=t.typedBufferStride;for(let M=0;M<n;M++){const e=M*w,t=M*T,r=B[t],n=B[t+1],S=B[t+2],R=B[t+3];b[e]=o*r+l*n+d*S+g*R,b[e+1]=s*r+u*n+p*S+y*R,b[e+2]=i*r+c*n+m*S+v*R,b[e+3]=a*r+f*n+h*S+x*R}}},Symbol.toStringTag,{value:"Module"}))},69618:(e,t,r)=>{function n(e,t){o(e.typedBuffer,t,e.typedBufferStride)}function o(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4;const n=t.typedBuffer,o=t.typedBufferStride,s=t.count;let i=0,a=0;for(let l=0;l<s;++l)e[i]=n[a],e[i+1]=n[a+1],e[i+2]=n[a+2],e[i+3]=n[a+3],i+=r,a+=o}function s(e,t,r,n,o,s){var i,a;const l=e.typedBuffer,u=e.typedBufferStride,c=null!==(i=null===s||void 0===s?void 0:s.count)&&void 0!==i?i:e.count;let f=(null!==(a=null===s||void 0===s?void 0:s.dstIndex)&&void 0!==a?a:0)*u;for(let d=0;d<c;++d)l[f]=t,l[f+1]=r,l[f+2]=n,l[f+3]=o,f+=u}r.d(t,{a:()=>o,c:()=>n,f:()=>s});Object.freeze(Object.defineProperty({__proto__:null,copy:o,copyView:n,fill:s},Symbol.toStringTag,{value:"Module"}))},71277:(e,t,r)=>{function n(e){return e=e||globalThis.location.hostname,u.some((t=>{var r;return null!=(null===(r=e)||void 0===r?void 0:r.match(t))}))}function o(e,t){return e?(t=t||globalThis.location.hostname)?null!=t.match(s)||null!=t.match(a)?e.replace("static.arcgis.com","staticdev.arcgis.com"):null!=t.match(i)||null!=t.match(l)?e.replace("static.arcgis.com","staticqa.arcgis.com"):e:e:null}r.d(t,{XO:()=>n,pJ:()=>o});const s=/^devext\.arcgis\.com$/,i=/^qaext\.arcgis\.com$/,a=/^[\w-]*\.mapsdevext\.arcgis\.com$/,l=/^[\w-]*\.mapsqa\.arcgis\.com$/,u=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local\.esri\.com$/,s,i,/^jsapps\.esri\.com$/,a,l]},27053:(e,t,r)=>{r.d(t,{C:()=>l});var n=r(76200),o=r(14921),s=r(10064),i=r(66978),a=r(35995);class l{constructor(e){this._streamDataRequester=e}async loadJSON(e,t){return this._load("json",e,t)}async loadBinary(e,t){return(0,a.HK)(e)?((0,i.k_)(t),(0,a.AH)(e)):this._load("binary",e,t)}async loadImage(e,t){return this._load("image",e,t)}async _load(e,t,r){if(null==this._streamDataRequester)return(await(0,n.Z)(t,{responseType:u[e]})).data;const a=await(0,o.q6)(this._streamDataRequester.request(t,e,r));if(!0===a.ok)return a.value;throw(0,i.r9)(a.error),new s.Z("glt-loader-request-error","Request for resource failed: ".concat(a.error))}}const u={image:"image",binary:"array-buffer",json:"json","image+type":void 0}},32315:(e,t,r)=>{r.d(t,{p:()=>i});var n=r(18722),o=r(39406),s=r(8548);function i(e,t){switch(t){case s.MX.TRIANGLES:return"number"==typeof(r=e)?(0,o.KF)(r):(0,n.lq)(r)?new Uint16Array(r):r;case s.MX.TRIANGLE_STRIP:return function(e){const t="number"==typeof e?e:e.length;if(t<3)return[];const r=t-2,n=(0,o.$z)(3*r);if("number"==typeof e){let e=0;for(let t=0;t<r;t+=1)t%2==0?(n[e++]=t,n[e++]=t+1,n[e++]=t+2):(n[e++]=t+1,n[e++]=t,n[e++]=t+2)}else{let t=0;for(let o=0;o<r;o+=1)o%2==0?(n[t++]=e[o],n[t++]=e[o+1],n[t++]=e[o+2]):(n[t++]=e[o+1],n[t++]=e[o],n[t++]=e[o+2])}return n}(e);case s.MX.TRIANGLE_FAN:return function(e){const t="number"==typeof e?e:e.length;if(t<3)return new Uint16Array(0);const r=t-2,n=r<=65536?new Uint16Array(3*r):new Uint32Array(3*r);if("number"==typeof e){let e=0;for(let t=0;t<r;++t)n[e++]=0,n[e++]=t+1,n[e++]=t+2;return n}const o=e[0];let s=e[1],i=0;for(let a=0;a<r;++a){const t=e[a+2];n[i++]=o,n[i++]=s,n[i++]=t,s=t}return n}(e)}var r}},57661:(e,t,r)=>{r.d(t,{$A:()=>i,Ml:()=>l,NM:()=>s,i$:()=>a});var n=r(93169),o=r(68401);class s{constructor(e){this.data=e,this.type="encoded-mesh-texture",this.encoding=o.Ti.KTX2_ENCODING}}function i(e){return"encoded-mesh-texture"===(null===e||void 0===e?void 0:e.type)}async function a(e){const t=new Blob([e]),r=await t.text();return JSON.parse(r)}async function l(e,t){if(t===o.Ti.KTX2_ENCODING)return new s(e);const r=new Blob([e],{type:t}),i=URL.createObjectURL(r),a=new Image;if((0,n.Z)("esri-iPhone"))return new Promise(((e,t)=>{const r=()=>{o(),e(a)},n=e=>{o(),t(e)},o=()=>{URL.revokeObjectURL(i),a.removeEventListener("load",r),a.removeEventListener("error",n)};a.addEventListener("load",r),a.addEventListener("error",n),a.src=i}));try{a.src=i,await a.decode()}catch(l){console.warn("Failed decoding HTMLImageElement")}return URL.revokeObjectURL(i),a}},60788:(e,t,r)=>{r.d(t,{fetch:()=>re});var n=r(1413),o=r(71277),s=r(16889),i=r(29303),a=r(21389),l=r(29134),u=r(7025),c=r(6644),f=r(32035),d=r(12400),p=r(41414),m=r(38461),h=r(25158),g=r(11186),y=r(6754),v=r(88396),x=r(92770),b=r(69618),w=r(27053),B=r(32315),T=r(57661),M=r(30932);function S(e){if(null==e)return null;const t=null!=e.offset?e.offset:M.AG,r=null!=e.rotation?e.rotation:0,n=null!=e.scale?e.scale:M.hq,o=(0,a.al)(1,0,0,0,1,0,t[0],t[1],1),s=(0,a.al)(Math.cos(r),-Math.sin(r),0,Math.sin(r),Math.cos(r),0,0,0,1),l=(0,a.al)(n[0],0,0,0,n[1],0,0,0,1),u=(0,a.Ue)();return(0,i.Jp)(u,s,l),(0,i.Jp)(u,o,u),u}class R{constructor(){this.geometries=new Array,this.materials=new Array,this.textures=new Array}}class A{constructor(e,t,r){this.name=e,this.lodThreshold=t,this.pivotOffset=r,this.stageResources=new R,this.numberOfVertices=0}}var O=r(76200),I=r(14921),E=r(59896),_=r(10064),P=r(32718),U=r(59447),j=r(66978),L=r(49901),q=r(39406),C=r(38330),J=r(91526),F=r(68401),N=r(71228),k=r(33586),V=r(4760),G=r(49335),Z=r(8548);const z=()=>P.Z.getLogger("esri.views.3d.layers.graphics.objectResourceUtils");async function $(e,t){var r;const n=await async function(e,t){const r=null===t||void 0===t?void 0:t.streamDataRequester;if(r)return async function(e,t,r){const n=await(0,I.q6)(t.request(e,"json",r));if(!0===n.ok)return n.value;(0,j.r9)(n.error),D(n.error.details.url)}(e,r,t);const n=await(0,I.q6)((0,O.Z)(e,t));if(!0===n.ok)return n.value.data;(0,j.r9)(n.error),D(n.error)}(e,t),o=await async function(e,t){const r=new Array;for(const s in e){const n=e[s],o=n.images[0].data;if(!o){z().warn("Externally referenced texture data is not yet supported");continue}const i=n.encoding+";base64,"+o,a="/textureDefinitions/"+s,l="rgba"===n.channels?n.alphaChannelUsage||"transparency":"none",u={noUnpackFlip:!0,wrap:{s:Z.e8.REPEAT,t:Z.e8.REPEAT},preMultiplyAlpha:H(l)!==F.JJ.Opaque},c=null!==t&&void 0!==t&&t.disableTextures?Promise.resolve(null):(0,C.t)(i,t);r.push(c.then((e=>({refId:a,image:e,parameters:u,alphaChannelUsage:l}))))}const n=await Promise.all(r),o={};for(const s of n)o[s.refId]=s;return o}(null!==(r=n.textureDefinitions)&&void 0!==r?r:{},t);let s=0;for(const i in o)if(o.hasOwnProperty(i)){const e=o[i];s+=null!==e&&void 0!==e&&e.image?e.image.width*e.image.height*4:0}return{resource:n,textures:o,size:s+(0,E.Ul)(n)}}function D(e){throw new _.Z("","Request for object resource failed: ".concat(e))}function X(e){const t=e.params,r=t.topology;let n=!0;switch(t.vertexAttributes||(z().warn("Geometry must specify vertex attributes"),n=!1),t.topology){case"PerAttributeArray":break;case"Indexed":case null:case void 0:{const e=t.faces;if(e){if(t.vertexAttributes)for(const r in t.vertexAttributes){const t=e[r];null!==t&&void 0!==t&&t.values?(null!=t.valueType&&"UInt32"!==t.valueType&&(z().warn("Unsupported indexed geometry indices type '".concat(t.valueType,"', only UInt32 is currently supported")),n=!1),null!=t.valuesPerElement&&1!==t.valuesPerElement&&(z().warn("Unsupported indexed geometry values per element '".concat(t.valuesPerElement,"', only 1 is currently supported")),n=!1)):(z().warn("Indexed geometry does not specify face indices for '".concat(r,"' attribute")),n=!1)}}else z().warn("Indexed geometries must specify faces"),n=!1;break}default:z().warn("Unsupported topology '".concat(r,"'")),n=!1}e.params.material||(z().warn("Geometry requires material"),n=!1);const o=e.params.vertexAttributes;for(const s in o)o[s].values||(z().warn("Geometries with externally defined attributes are not yet supported"),n=!1);return n}function K(e){const t=(0,p.cS)();return e.forEach((e=>{const r=e.boundingInfo;null!=r&&((0,p.pp)(t,r.bbMin),(0,p.pp)(t,r.bbMax))})),t}function H(e){switch(e){case"mask":return F.JJ.Mask;case"maskAndTransparency":return F.JJ.MaskBlend;case"none":return F.JJ.Opaque;default:return F.JJ.Blend}}function W(e){const t=e.params;return{id:1,material:t.material,texture:t.texture,region:t.texture}}const Q=new L.G(1,2,"wosr");var Y=r(16010),ee=r(68845),te=r(45856);async function re(e,t){var a;const M=function(e){const t=e.match(/(.*\.(gltf|glb))(\?lod=([0-9]+))?$/);return t?{fileType:"gltf",url:t[1],specifiedLodIndex:null!=t[4]?Number(t[4]):null}:e.match(/(.*\.(json|json\.gz))$/)?{fileType:"wosr",url:e,specifiedLodIndex:null}:{fileType:"unknown",url:e,specifiedLodIndex:null}}((0,o.pJ)(e));if("wosr"===M.fileType){const e=await(t.cache?t.cache.loadWOSR(M.url,t):$(M.url,t)),{engineResources:r,referenceBoundingBox:n}=function(e,t){var r;const n=new Array,o=new Array,s=new Array,i=new U.r,a=e.resource,l=L.G.parse(a.version||"1.0","wosr");Q.validate(l);const u=a.model.name,c=a.model.geometries,f=null!==(r=a.materialDefinitions)&&void 0!==r?r:{},p=e.textures;let m=0;const h=new Map;for(let b=0;b<c.length;b++){var g,y;const e=c[b];if(!X(e))continue;const r=W(e),a=e.params.vertexAttributes,l=[],u=t=>{if("PerAttributeArray"===e.params.topology)return null;const r=e.params.faces;for(const e in r)if(e===t)return r[e].values;return null},w=a[V.T.POSITION],B=w.values.length/w.valuesPerElement;for(const t in a){var v;const e=a[t],r=e.values,n=null!==(v=u(t))&&void 0!==v?v:(0,q.KF)(B);l.push([t,new J.a(r,n,e.valuesPerElement,!0)])}const T=r.texture,M=p&&p[T];if(M&&!h.has(T)){const{image:e,parameters:t}=M,r=new k.x(e,t);o.push(r),h.set(T,r)}const S=h.get(T),R=S?S.id:void 0,A=r.material;let O=i.get(A,T);if(null==O){var x;const e=f[A.slice(A.lastIndexOf("/")+1)].params;1===e.transparency&&(e.transparency=0);const r=M&&M.alphaChannelUsage,n=e.transparency>0||"transparency"===r||"maskAndTransparency"===r,o=M?H(M.alphaChannelUsage):void 0,s={ambient:(0,d.nI)(e.diffuse),diffuse:(0,d.nI)(e.diffuse),opacity:1-(e.transparency||0),transparent:n,textureAlphaMode:o,textureAlphaCutoff:.33,textureId:R,initTextureTransparent:!0,doubleSided:!0,cullFace:F.Vr.None,colorMixMode:e.externalColorMixMode||"tint",textureAlphaPremultiplied:null!==(x=null===M||void 0===M?void 0:M.parameters.preMultiplyAlpha)&&void 0!==x&&x};null!==t&&void 0!==t&&t.materialParameters&&Object.assign(s,t.materialParameters),O=new G.Gp(s,t),i.set(A,T,O)}s.push(O);const I=new N.Z(O,l);m+=null!==(g=null===(y=l.find((e=>e[0]===V.T.POSITION)))||void 0===y||null===(y=y[1])||void 0===y?void 0:y.indices.length)&&void 0!==g?g:0,n.push(I)}return{engineResources:[{name:u,stageResources:{textures:o,materials:s,geometries:n},pivotOffset:a.model.pivotOffset,numberOfVertices:m,lodThreshold:null}],referenceBoundingBox:K(n)}}(e,t);return{lods:r,referenceBoundingBox:n,isEsriSymbolResource:!1,isWosr:!0}}let R;if(t.cache)R=await t.cache.loadGLTF(M.url,t,!!t.usePBR);else{const{loadGLTF:e}=await r.e(7516).then(r.bind(r,57516));R=await e(new w.C(t.streamDataRequester),M.url,t,t.usePBR)}const O=null===(a=R.model.meta)||void 0===a?void 0:a.ESRI_proxyEllipsoid,I=R.meta.isEsriSymbolResource&&null!=O&&"EsriRealisticTreesStyle"===R.meta.ESRI_webstyle;I&&!R.customMeta.esriTreeRendering&&(R.customMeta.esriTreeRendering=!0,function(e,t){for(let r=0;r<e.model.lods.length;++r){const n=e.model.lods[r];for(const o of n.parts){const n=o.attributes.normal;if(null==n)return;const s=o.attributes.position,i=s.count,a=(0,d.Ue)(),c=(0,d.Ue)(),p=(0,d.Ue)(),m=new Uint8Array(4*i),g=new Float64Array(3*i),y=(0,l.U_)((0,u.Ue)(),o.transform);let v=0,x=0;for(let l=0;l<i;l++){s.getVec(l,c),n.getVec(l,a),(0,f.t)(c,c,o.transform),(0,f.d)(p,c,t.center),(0,f.E)(p,p,t.radius);const i=p[2],u=(0,f.l)(p),d=Math.min(.45+.55*u*u,1);(0,f.E)(p,p,t.radius),null!==y&&(0,f.t)(p,p,y),(0,f.n)(p,p),r+1!==e.model.lods.length&&e.model.lods.length>1&&(0,f.m)(p,p,a,i>-1?.2:Math.min(-4*i-3.8,1)),g[v]=p[0],g[v+1]=p[1],g[v+2]=p[2],v+=3,m[x]=255*d,m[x+1]=255*d,m[x+2]=255*d,m[x+3]=255,x+=4}o.attributes.normal=new h.ct(g),o.attributes.color=new h.mc(m)}}}(R,O));const E=!!t.usePBR,_=R.meta.isEsriSymbolResource?{usePBR:E,isSchematic:!1,treeRendering:I,mrrFactors:te.eP}:{usePBR:E,isSchematic:!1,treeRendering:!1,mrrFactors:te.xq},P=(0,n.Z)((0,n.Z)({},t.materialParameters),{},{treeRendering:I}),{engineResources:j,referenceBoundingBox:C}=function(e,t,r,o,a){const l=e.model,u=new Array,f=new Map,d=new Map,w=l.lods.length,M=(0,p.cS)();return l.lods.forEach(((e,R)=>{const O=!0===o.skipHighLods&&(w>1&&0===R||w>3&&1===R)||!1===o.skipHighLods&&null!=a&&R!==a;if(O&&0!==R)return;const I=new A(e.name,e.lodThreshold,[0,0,0]);e.parts.forEach((e=>{const a=O?new G.Gp({},o):function(e,t,r,o,s,i,a,l){const u=t.material+(t.attributes.normal?"_normal":"")+(t.attributes.color?"_color":"")+(t.attributes.texCoord0?"_texCoord0":"")+(t.attributes.tangent?"_tangent":""),f=e.materials.get(t.material),d=null!=t.attributes.texCoord0,p=null!=t.attributes.normal;if(null==f)return null;const m=function(e){switch(e){case"BLEND":return F.JJ.Blend;case"MASK":return F.JJ.Mask;case"OPAQUE":case null:case void 0:return F.JJ.Opaque}}(f.alphaMode);if(!i.has(u)){var h,g;if(d){const t=function(t){let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(null!=t&&!a.has(t)){const o=e.textures.get(t);if(null!=o){const e=o.data;a.set(t,new k.x((0,T.$A)(e)?e.data:e,(0,n.Z)((0,n.Z)({},o.parameters),{},{preMultiplyAlpha:!(0,T.$A)(e)&&r,encoding:(0,T.$A)(e)&&null!=e.encoding?e.encoding:void 0})))}}};t(f.textureColor,m!==F.JJ.Opaque),t(f.textureNormal),t(f.textureOcclusion),t(f.textureEmissive),t(f.textureMetallicRoughness)}const r=f.color[0]**(1/ee.j),y=f.color[1]**(1/ee.j),v=f.color[2]**(1/ee.j),x=f.emissiveFactor[0]**(1/ee.j),b=f.emissiveFactor[1]**(1/ee.j),w=f.emissiveFactor[2]**(1/ee.j),B=null!=f.textureColor&&d?a.get(f.textureColor):null,M=(0,te.Ih)({normalTexture:f.textureNormal,metallicRoughnessTexture:f.textureMetallicRoughness,metallicFactor:f.metallicFactor,roughnessFactor:f.roughnessFactor,emissiveTexture:f.textureEmissive,emissiveFactor:f.emissiveFactor,occlusionTexture:f.textureOcclusion}),R=null!=(null===(h=f.normalTextureTransform)||void 0===h?void 0:h.scale)?null===(g=f.normalTextureTransform)||void 0===g?void 0:g.scale:c.hq;i.set(u,new G.Gp((0,n.Z)((0,n.Z)({},o),{},{transparent:m===F.JJ.Blend,customDepthTest:F.Gv.Lequal,textureAlphaMode:m,textureAlphaCutoff:f.alphaCutoff,diffuse:[r,y,v],ambient:[r,y,v],opacity:f.opacity,doubleSided:f.doubleSided,doubleSidedType:"winding-order",cullFace:f.doubleSided?F.Vr.None:F.Vr.Back,hasVertexColors:!!t.attributes.color,hasVertexTangents:!!t.attributes.tangent,normalType:p?Y.r.Attribute:Y.r.ScreenDerivative,castShadows:!0,receiveShadows:f.receiveShadows,receiveAmbientOcclusion:f.receiveAmbientOcclustion,textureId:null!=B?B.id:void 0,colorMixMode:f.colorMixMode,normalTextureId:null!=f.textureNormal&&d?a.get(f.textureNormal).id:void 0,textureAlphaPremultiplied:null!=B&&!!B.parameters.preMultiplyAlpha,occlusionTextureId:null!=f.textureOcclusion&&d?a.get(f.textureOcclusion).id:void 0,emissiveTextureId:null!=f.textureEmissive&&d?a.get(f.textureEmissive).id:void 0,metallicRoughnessTextureId:null!=f.textureMetallicRoughness&&d?a.get(f.textureMetallicRoughness).id:void 0,emissiveFactor:[x,b,w],mrrFactors:M?te.S7:[f.metallicFactor,f.roughnessFactor,o.mrrFactors[2]],isSchematic:M,colorTextureTransformMatrix:S(f.colorTextureTransform),normalTextureTransformMatrix:S(f.normalTextureTransform),scale:[R[0],R[1]],occlusionTextureTransformMatrix:S(f.occlusionTextureTransform),emissiveTextureTransformMatrix:S(f.emissiveTextureTransform),metallicRoughnessTextureTransformMatrix:S(f.metallicRoughnessTextureTransform)},s),l))}const y=i.get(u);if(r.stageResources.materials.push(y),d){const e=e=>{null!=e&&r.stageResources.textures.push(a.get(e))};e(f.textureColor),e(f.textureNormal),e(f.textureOcclusion),e(f.textureEmissive),e(f.textureMetallicRoughness)}return y}(l,e,I,t,r,f,d,o),{geometry:u,vertexCount:w}=function(e,t){const r=e.attributes.position.count,n=(0,B.p)(e.indices||r,e.primitiveType),o=(0,m.xx)(3*r),{typedBuffer:a,typedBufferStride:l}=e.attributes.position;(0,g.t)(o,a,e.transform,3,l);const u=[[V.T.POSITION,new J.a(o,n,3,!0)]];if(null!=e.attributes.normal){const t=(0,m.xx)(3*r),{typedBuffer:o,typedBufferStride:a}=e.attributes.normal;(0,i.XL)(ne,e.transform),(0,g.b)(t,o,ne,3,a),(0,s.oc)(ne)&&(0,g.n)(t,t),u.push([V.T.NORMAL,new J.a(t,n,3,!0)])}if(null!=e.attributes.tangent){const t=(0,m.xx)(4*r),{typedBuffer:o,typedBufferStride:a}=e.attributes.tangent;(0,i.xO)(ne,e.transform),(0,y.t)(t,o,ne,4,a),(0,s.oc)(ne)&&(0,g.n)(t,t,4),u.push([V.T.TANGENT,new J.a(t,n,4,!0)])}if(null!=e.attributes.texCoord0){const t=(0,m.xx)(2*r),{typedBuffer:o,typedBufferStride:s}=e.attributes.texCoord0;(0,v.a)(t,o,2,s),u.push([V.T.UV0,new J.a(t,n,2,!0)])}const c=e.attributes.color;if(null!=c){const t=new Uint8Array(4*r);4===c.elementCount?c instanceof h.ek?(0,y.b)(t,c,255):c instanceof h.mc?(0,b.a)(t,c):c instanceof h.v6&&(0,y.b)(t,c,1/256):(t.fill(255),c instanceof h.ct?(0,g.f)(t,c.typedBuffer,255,4,c.typedBufferStride):e.attributes.color instanceof h.ne?(0,x.c)(t,c.typedBuffer,4,e.attributes.color.typedBufferStride):e.attributes.color instanceof h.mw&&(0,g.f)(t,c.typedBuffer,1/256,4,c.typedBufferStride)),u.push([V.T.COLOR,new J.a(t,n,4,!0)])}return{geometry:new N.Z(t,u),vertexCount:r}}(e,null!==a&&void 0!==a?a:new G.Gp({},o)),A=u.boundingInfo;null!=A&&0===R&&((0,p.pp)(M,A.bbMin),(0,p.pp)(M,A.bbMax)),null!=a&&(I.stageResources.geometries.push(u),I.numberOfVertices+=w)})),O||u.push(I)})),{engineResources:u,referenceBoundingBox:M}}(R,_,P,t,M.specifiedLodIndex);return{lods:j,referenceBoundingBox:C,isEsriSymbolResource:R.meta.isEsriSymbolResource,isWosr:!1}}const ne=(0,a.Ue)()},68845:(e,t,r)=>{r.d(t,{j:()=>n});const n=2.1}}]);
//# sourceMappingURL=788.91f096a1.chunk.js.map